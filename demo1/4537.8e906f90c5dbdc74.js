"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[4537],{34537:(Fi,me,w)=>{w.r(me),w.d(me,{ConfiguartionStepperModule:()=>Mi});var a=w(86656),q=w(96814),g=w(56223),J=w(14934),De=w(94955),K=w(64190),e=w(65879);let Ze=(()=>{var n;class p{constructor(){}ngOnInit(){}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-configuartion-stepper"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},dependencies:[K.lC]})),p})();var C=w(15861),Q=w(65619);const _={unifierMAC_ID:"",deviceName:"",deviceLabel:"",alerts_configured:[{enable_sms:null,parameterID2:"",alert_percent:0,parameterID1:"",operator:"Greater than >",alert_text_snoozed:"Const_Alert",alert_text_closed:"Const_Alert",equTextarea:"",alertValuePrediction:null,escalation_level:0,alert_variabletype:"Constant",parameter_operator:null,severity:"",alert_time:!1,parameterID:"",operator_value:0,alert_text_active:"Const_Alert",enable_type_1:null,alert_time_based_ID:"",enable_type_2:null,enable_type_3:null,enable_type_4:null,enable_type_5:null,binding_parameter:[{text:"None",value:"None"}],enable_email:null,enable_telegram:null,alertID:"",alert_datatype:"",levels:[],notificationMatrixId:""}],rdtName:"",no_of_param:"1",rdtID:null,accountType:"",wdtName:"",rdt_by_type:"type_1",wdtID:null,wdt_no_of_param:"1",wdt_by_type:"type_1",company_id:null,operational_hours:"None",device_timeout:"1_hour",trans_timeout:15,alert_timeout:1,device_list:"NONE",primary_devices:"NONE",secondary_devices:"NONE",monthly_schedule:1,disable_alerts:null,device_profile:null,x_axis:null,y_axis:null,z_axis:null,block_number:null,enable_device:!0,redundant:null,customSchedule:null,critical:null,report:null,dashboard:null,alerts_duration:null,lgtdName:"77.58085013100799",latitude:"12.92422584151276",altitude:"",rdt_file:"",wdt_file:"",reserved:null},I={enable_sms:null,parameterID2:"",alert_percent:0,parameterID1:"",operator:"",alert_text_snoozed:"",alert_text_closed:"",alert_time_based_ID:"",equTextarea:"",alertValuePrediction:null,escalation_level:0,alert_variabletype:"",parameter_operator:"",severity:"",alert_time:!1,parameterID:"",operator_value:0,alert_text_active:"",enable_type_1:null,enable_type_2:null,enable_type_3:null,enable_type_4:null,enable_type_5:null,binding_parameter:[{text:"None",value:"None"}],enable_email:null,enable_telegram:null,alertID:"",alert_datatype:"",levels:[],notificationMatrixId:""};var Te=w(13519),x=w.n(Te),B=w(31552),P=w(5588),_e=w(81127);function Ce(n,p){1&n&&(e.TgZ(0,"h2",16),e._uU(1," New Device Configuration "),e.qZA())}function Ie(n,p){1&n&&(e.TgZ(0,"h2",16),e._uU(1," Update Device Configuration "),e.qZA())}function xe(n,p){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.hij(" ",s.errorForUniqueDevice," ")}}function Ae(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," Device Name is required "),e.qZA())}function Pe(n,p){if(1&n&&e.YNc(0,Ae,2,0,"div",17),2&n){const s=e.oxw();let t;e.Q6J("ngIf",(null==(t=s.form.get("deviceName"))?null:t.hasError("required"))&&(null==(t=s.form.get("deviceName"))?null:t.touched))}}function we(n,p){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.hij(" ",s.errorForUniqueDeviceLabel," ")}}function Se(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," Device Label is required "),e.qZA())}function ke(n,p){if(1&n&&e.YNc(0,Se,2,0,"div",17),2&n){const s=e.oxw();let t;e.Q6J("ngIf",(null==(t=s.form.get("deviceLabel"))?null:t.hasError("required"))&&(null==(t=s.form.get("deviceLabel"))?null:t.touched))}}function qe(n,p){1&n&&(e.TgZ(0,"div",9),e._uU(1," Unifier MAC ID is required "),e.qZA())}function Ne(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",18)(1,"label",5)(2,"span",6),e._uU(3,"Unifier MAC ID"),e.qZA(),e._UZ(4,"i",19),e.qZA(),e.TgZ(5,"ngx-select",20),e.NdJ("selectionChanges",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.validateDevice(i))}),e.qZA(),e.YNc(6,qe,2,0,"div",21),e.qZA()}if(2&n){const s=e.oxw();let t;e.xp6(5),e.Q6J("allowClear",!0)("items",s.allMacID),e.xp6(1),e.Q6J("ngIf",(null==(t=s.form.get("unifierMAC_ID"))?null:t.hasError("required"))&&(null==(t=s.form.get("unifierMAC_ID"))?null:t.touched))}}let fe=(()=>{var n;class p{constructor(t,i,o,r,u,l){(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"editOperation",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"dataEvent",new e.vpe),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"data_temp",void 0),(0,a.Z)(this,"companyList",void 0),(0,a.Z)(this,"confirmEdit",void 0),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"lookup_data_temp1",[]),(0,a.Z)(this,"errorForUniqueDevice",""),(0,a.Z)(this,"errorForUniqueDeviceLabel",""),(0,a.Z)(this,"subscriptionInfo",void 0),(0,a.Z)(this,"allMacID",[]),(0,a.Z)(this,"lookupdeviceData",void 0),(0,a.Z)(this,"currMAC",void 0),(0,a.Z)(this,"macID_current",void 0),(0,a.Z)(this,"valueChanged",new e.vpe),(0,a.Z)(this,"disableaddButton",!1),this.api=t,this.fb=i,this.companyConfiguration=o,this.getDiagnostics=r,this.operationalscheduleType=u,this.cdr=l}ngOnChanges(t){t.editOperation&&(this.confirmEdit=this.editOperation,console.log("EditValue",this.confirmEdit),this.form=this.fb.group({deviceName:[{value:this.defaultValues.deviceName,disabled:this.editOperation},[g.kI.required]],deviceLabel:[this.defaultValues.deviceLabel,[g.kI.required]],unifierMAC_ID:[this.defaultValues.unifierMAC_ID,[g.kI.required]]})),t.lookupdeviceData&&(this.lookup_data_temp1=this.lookupdeviceData,console.log("Devices which are added are ",this.lookup_data_temp1)),t.currMAC&&(console.log("Iam triggered BTW",this.currMAC),this.macID_current=this.currMAC)}ngAfterViewInit(){this.initForm(),this.updateParentModel({},this.checkForm())}triggerParentFunction(t){this.valueChanged.emit(t)}ngOnInit(){this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.clientID=this.getLoggedUser.attributes["custom:clientID"],this.initForm(),this.updateParentModel({},this.checkForm()),this.fetchTMData(1)}getClientinfo(){var t=this;return(0,C.Z)(function*(){try{t.api.GetClient(t.clientID,t.clientID).then(function(){var i=(0,C.Z)(function*(o){if(o&&o.subscription){t.subscriptionInfo=JSON.parse(o.subscription),t.allMacID=t.subscriptionInfo.map(l=>l.name),t.allMacID=t.subscriptionInfo.map(l=>({name:l.name,no_of_devices:l.no_of_devices})),console.log("all the mac id are here",t.allMacID);const r=new Set,u=t.lookup_data_temp1.filter(l=>{const d=r.has(l.P1);return r.add(l.P1),!d});for(let l of t.allMacID){const d=u.filter(f=>void 0!==f.P8&&f.P8==l.name);if(d.length>l.no_of_devices){const f=d.length-l.no_of_devices;x().fire({title:"<strong>Device Count Mismatch</strong>",icon:"warning",html:`\n                    <p>The number of devices added for MAC ID <strong>${l.name}</strong> exceeds the allotted number of <strong>${l.no_of_devices}</strong>.</p>\n                    <p>Please remove <strong>${f}</strong> devices and <strong>reload the page</strong> to proceed with device configuration.</p>\n                `,confirmButtonText:"OK",confirmButtonColor:"#3085d6",backdrop:"\n                    rgba(0,0,123,0.4)\n                    url('https://example.com/your-image.jpg')\n                    left top\n                    no-repeat\n                ",allowOutsideClick:!1}).then(()=>{t.form.reset(),t.form.disable(),t.disableaddButton=!0,t.dataEvent.emit(t.disableaddButton),t.updateParentModel(t.form.value,!1)});break}}t.cdr.detectChanges()}});return function(o){return i.apply(this,arguments)}}())}catch(i){console.error("Failed to fetch client Information ",i)}})()}initForm(){console.log("Edit Operation",this.editOperation),console.log("inisde init Form",this.defaultValues),this.form=this.fb.group({deviceName:[{value:this.defaultValues.deviceName,disabled:this.editOperation},[g.kI.required]],deviceLabel:[this.defaultValues.deviceLabel,[g.kI.required]],unifierMAC_ID:[this.defaultValues.unifierMAC_ID,[g.kI.required]]}),0==this.hideDeleteButton&&this.form.disable();const t=this.form.valueChanges.subscribe(i=>{console.log("I am entered properly"),this.updateParentModel(i,this.checkForm())});this.unsubscribe.push(t)}checkForm(){return""==this.errorForUniqueDevice&&""==this.errorForUniqueDeviceLabel&&!(this.form.get("deviceName")?.hasError("required")||this.form.get("deviceLabel")?.hasError("required")||this.form.get("unifierMAC_ID")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}getCompany(){this.companyConfiguration.getSpecificCompany(this.clientID).then(t=>{if(console.log("res_chek",t),t&&void 0!==t){this.data_temp=t,this.companyList=[];for(let i=0;i<t.length;i++)this.companyList.push(t[i]?.PK);console.log("unique sk values",this.companyList)}}).catch(t=>{console.log("cant fetch",t)})}fetchTMData(t){var i=this;return(0,C.Z)(function*(){console.log("iam trying to fetch",i.clientID);try{const o=yield i.api.GetLookupMasterTable(i.clientID+"#device",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h,P5:D,P6:A,P7:U,P8:S}=l[d];i.lookup_data_temp1.push({P1:f,P2:m,P3:v,P4:h,P5:D,P6:A,P7:U,P8:S})}}i.lookup_data_temp1.sort((u,l)=>l.P5-u.P5),console.log("Lookup sorting",i.lookup_data_temp1),yield i.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log("Device Configuration Datas",i.lookup_data_temp1),i.getClientinfo()}catch(o){console.error("Error:",o)}})()}checkuniqueDevice(t){this.errorForUniqueDevice="";for(let i of this.lookup_data_temp1)i.P1==t.target.value&&(this.errorForUniqueDevice="Device Name already exists");this.updateParentModel({},this.checkForm())}checkuniqueDeviceLabel(t){this.errorForUniqueDeviceLabel="";for(let i of this.lookup_data_temp1)i.P2==t.target.value&&(this.errorForUniqueDeviceLabel="Device Label already exists");this.updateParentModel({},this.checkForm())}validateDevice(t){var i=this;return(0,C.Z)(function*(){try{if(console.log("Changed value is",t),console.log("Current mac is here ",i.macID_current),i.macID_current==t[0].data.name)return;const o=new Set,r=i.lookup_data_temp1.filter(l=>{const d=o.has(l.P1);return o.add(l.P1),!d}),u=t[0].data.name;if(console.log("The value selected is here ",u),u){const l=i.allMacID.filter(f=>u===f.name);console.log("Value is selected value",typeof l);const d=r.filter(f=>void 0!==f.P8&&f.P8==l[0].name);console.log("All the devices with same macID",d),Array.isArray(d)&&0!=d.length&&(l[0].no_of_devices>d.length||(x().fire({title:`Insufficient Devices in MAC ID ${l[0].name}!`,text:`You are limited to add ${l[0].no_of_devices} devices for this MAC ID. Please purchase additional devices to proceed.`,icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6",allowOutsideClick:!1,allowEscapeKey:!1}).then(f=>{f.isConfirmed&&(i.form.get("unifierMAC_ID")?.reset(),i.updateParentModel({},!1))}),i.triggerParentFunction(!0)))}}catch(o){console.error("Something went wrong on change selection",o)}})()}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(B.t),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(P.F),e.Y36(e.sBO))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step1"]],inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",editOperation:"editOperation",hideDeleteButton:"hideDeleteButton",lookupdeviceData:"lookupdeviceData",currMAC:"currMAC"},outputs:{dataEvent:"dataEvent",valueChanged:"valueChanged"},features:[e.TTD],decls:27,vars:8,consts:[[1,"pb-10","pb-lg-15"],["class","fw-bolder d-flex align-items-center text-dark",4,"ngIf"],[3,"formGroup"],[1,"row","mb-7"],[1,"col"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["ngbTooltip","Check device settings in Unifier",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","deviceName","type","text","placeholder","Device Name",1,"form-control","form-control-solid",3,"keyup"],[1,"fv-plugins-message-container","invalid-feedback"],[4,"ngIf","ngIfElse"],["defaultErrorMessage1",""],["ngbTooltip","Will be shown in navigation menu and reports",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","deviceLabel","type","text","placeholder","Device Label",1,"form-control","form-control-solid",3,"keyup"],["defaultErrorMessage",""],["class","col-sm-6",4,"ngIf"],[1,"fw-bolder","d-flex","align-items-center","text-dark"],[4,"ngIf"],[1,"col-sm-6"],["ngbTooltip","Specify unique MAC ID assigned to the device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","unifierMAC_ID","optionValueField","name","optionTextField","name","placeholder","Select MAC ID",3,"allowClear","items","selectionChanges"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ce,2,0,"h2",1),e.YNc(2,Ie,2,0,"h2",1),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5)(7,"span",6),e._uU(8,"Device Name"),e.qZA(),e._UZ(9,"i",7),e.qZA(),e.TgZ(10,"input",8),e.NdJ("keyup",function(r){return i.checkuniqueDevice(r)}),e.qZA(),e.TgZ(11,"div",9),e.YNc(12,xe,2,1,"ng-container",10),e.YNc(13,Pe,1,1,"ng-template",null,11,e.W1O),e.qZA()(),e.TgZ(15,"div",4)(16,"label",5)(17,"span",6),e._uU(18,"Device Label"),e.qZA(),e._UZ(19,"i",12),e.qZA(),e.TgZ(20,"input",13),e.NdJ("keyup",function(r){return i.checkuniqueDeviceLabel(r)}),e.qZA(),e.TgZ(21,"div",9),e.YNc(22,we,2,1,"ng-container",10),e.YNc(23,ke,1,1,"ng-template",null,14,e.W1O),e.qZA()()(),e.TgZ(25,"div",3),e.YNc(26,Ne,7,3,"div",15),e.qZA()()),2&t){const o=e.MAs(14),r=e.MAs(24);e.xp6(1),e.Q6J("ngIf",!i.confirmEdit),e.xp6(1),e.Q6J("ngIf",i.confirmEdit),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(9),e.Q6J("ngIf",""!==i.errorForUniqueDevice)("ngIfElse",o),e.xp6(10),e.Q6J("ngIf",""!==i.errorForUniqueDeviceLabel)("ngIfElse",r),e.xp6(4),e.Q6J("ngIf",i.allMacID)}},dependencies:[q.O5,g.Fj,g.JJ,g.JL,g.sg,g.u,J._L,_e.O2],styles:["input[disabled][_ngcontent-%COMP%]{cursor:not-allowed}"]})),p})();var N=w(11486),ie=w(22939),se=w(18704);let oe=(()=>{var n;class p{constructor(){}onWheel(t){t.preventDefault()}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275dir",e.lG2({type:n,selectors:[["","appPreventScroll",""]],hostBindings:function(t,i){1&t&&e.NdJ("wheel",function(r){return i.onWheel(r)})}})),p})();function Ue(n,p){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw(2);e.xp6(1),e.hij(" ",s.errorForUniqueRDT_id," ")}}function Le(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," RDT ID is required "),e.qZA())}function Me(n,p){if(1&n&&e.YNc(0,Le,2,0,"div",28),2&n){const s=e.oxw(2);let t;e.Q6J("ngIf",(null==(t=s.form.get("rdtName"))?null:t.hasError("required"))&&(null==(t=s.form.get("rdtName"))?null:t.touched))}}function Oe(n,p){1&n&&(e.TgZ(0,"div",22),e._uU(1," Parameters is required "),e.qZA())}function Re(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",3)(1,"div",17)(2,"div",4)(3,"label",18)(4,"span",19),e._uU(5,"RDT ID"),e.qZA(),e._UZ(6,"i",20),e.qZA(),e.TgZ(7,"input",21),e.NdJ("keyup",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.checkUniqueRDT(i))}),e.qZA(),e.TgZ(8,"div",22),e.YNc(9,Ue,2,1,"ng-container",23),e.YNc(10,Me,1,1,"ng-template",null,24,e.W1O),e.qZA()(),e.TgZ(12,"div",4)(13,"label",18)(14,"span",19),e._uU(15,"Number of Parameters"),e.qZA(),e._UZ(16,"i",25),e.qZA(),e._UZ(17,"input",26),e.YNc(18,Oe,2,0,"div",27),e.qZA()()()}if(2&n){const s=e.MAs(11),t=e.oxw();let i;e.xp6(9),e.Q6J("ngIf",""!==t.errorForUniqueRDT_id)("ngIfElse",s),e.xp6(9),e.Q6J("ngIf",(null==(i=t.form.get("no_of_param"))?null:i.hasError("required"))&&(null==(i=t.form.get("no_of_param"))?null:i.touched))}}function Fe(n,p){if(1&n&&(e.TgZ(0,"option",35),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function Je(n,p){1&n&&(e.ynx(0),e._uU(1," No items found, please add RDT configuration "),e.BQk())}function Ee(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," RDT Type is required "),e.qZA())}function $e(n,p){if(1&n&&e.YNc(0,Ee,2,0,"div",28),2&n){const s=e.oxw(2);let t;e.Q6J("ngIf",(null==(t=s.form.get("rdtID"))?null:t.hasError("required"))&&(null==(t=s.form.get("rdtID"))?null:t.touched))}}function Be(n,p){if(1&n&&(e.TgZ(0,"div",3)(1,"div",29)(2,"label",18)(3,"span",19),e._uU(4,"Existing RDT"),e.qZA(),e._UZ(5,"i",30),e.qZA(),e.TgZ(6,"select",31)(7,"option",32),e._uU(8,"Select Reading Device Type"),e.qZA(),e.YNc(9,Fe,2,2,"option",33),e.qZA(),e.TgZ(10,"div",22),e.YNc(11,Je,2,0,"ng-container",23),e.YNc(12,$e,1,1,"ng-template",null,34,e.W1O),e.qZA()()()),2&n){const s=e.MAs(13),t=e.oxw();e.xp6(7),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.rdtList),e.xp6(2),e.Q6J("ngIf",0==t.rdtList.length)("ngIfElse",s)}}function Ke(n,p){if(1&n&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&n){const s=e.oxw(2);e.xp6(1),e.hij("Selected File:",s.selectedFileName,"")}}function Ve(n,p){1&n&&(e.TgZ(0,"span",22),e._uU(1,"No File Selected"),e.qZA())}function ze(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",3)(1,"div",36)(2,"label",18)(3,"span",19),e._uU(4,"Upload File"),e.qZA(),e._UZ(5,"i",37),e.qZA(),e.TgZ(6,"input",38,39),e.NdJ("change",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.createParameterConfig(i))}),e.qZA(),e.YNc(8,Ke,2,1,"span",40),e.YNc(9,Ve,2,0,"ng-template",null,41,e.W1O),e.qZA(),e.TgZ(11,"div",42)(12,"button",43),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.exportTemplate("parameter_xlsx"))}),e._UZ(13,"i",44),e._uU(14,"Export Template"),e.qZA()()()}if(2&n){const s=e.MAs(10),t=e.oxw();e.xp6(8),e.Q6J("ngIf",t.selectedFileName)("ngIfElse",s)}}let ge=(()=>{var n;class p{constructor(t,i,o,r,u,l){(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"toast",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"getReadingDeviceType",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"editOperation",void 0),(0,a.Z)(this,"dataChange",new e.vpe),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"lookupdeviceData",void 0),(0,a.Z)(this,"adminUser",void 0),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"SK_clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"rdtLabel",void 0),(0,a.Z)(this,"data_temp",void 0),(0,a.Z)(this,"rdtList",[]),(0,a.Z)(this,"alert_binding_parameter_RDT",void 0),(0,a.Z)(this,"parametersList",void 0),(0,a.Z)(this,"paramsBasedOnRDT",void 0),(0,a.Z)(this,"PK",void 0),(0,a.Z)(this,"SK",void 0),(0,a.Z)(this,"errorForUniqueRDT_id",""),(0,a.Z)(this,"parameterData",[]),(0,a.Z)(this,"RDT_Id",[]),(0,a.Z)(this,"ADD_finalData",{}),(0,a.Z)(this,"renameKeys",[]),(0,a.Z)(this,"tempMultiParams",[]),(0,a.Z)(this,"lookup_data_temp1",[]),(0,a.Z)(this,"parameterList",[]),(0,a.Z)(this,"previewData",[]),(0,a.Z)(this,"xlfileValid",!1),(0,a.Z)(this,"selectedFileName",""),(0,a.Z)(this,"deviceData",void 0),(0,a.Z)(this,"adminLogin",!1),this.api=t,this.toast=i,this.cdr=o,this.fb=r,this.getReadingDeviceType=u,this.getDiagnostics=l}ngAfterViewInit(){let t=localStorage.getItem("step3Validation");const i=this.form.valueChanges.subscribe(o=>{console.log("leme trigger"),"type_1"==this.form.get("rdt_by_type")?.value?this.updateParentModel(o,this.existingRDT()):"type_2"==this.form.get("rdt_by_type")?.value?this.updateParentModel(o,this.checkForm()):(console.log("Values testing",o),1==t||"true"==t?(console.log(t+typeof t),this.updateParentModel(o,!0)):this.updateParentModel(o,this.xlfileValid))});this.unsubscribe.push(i),this.form.get("rdtID")?.patchValue(this.defaultValues.rdtID)}ngOnChanges(t){t.lookupdeviceData&&(this.deviceData=this.lookupdeviceData,console.log("Devices which are added are RDT",this.deviceData)),t.adminUser&&(this.adminLogin=this.adminUser)}ngOnInit(){console.log("Default Values",this.defaultValues),this.initForm(),this.updateParentModel({},this.existingRDT()),this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.rdtList=[],this.adminLogin?(console.log("Show all RDT "),this.fetchTMData(1)):(console.log("Show Limited RDT"),this.rdtList=new Set(this.deviceData.map(t=>t.P3))),0==this.hideDeleteButton&&this.form.disable(),!0===this.editOperation&&this.form.get("rdt_by_type")?.disable()}initForm(){this.form=this.fb.group({rdt_by_type:[this.defaultValues.rdt_by_type,[g.kI.required]],rdtName:[this.defaultValues.rdtName,[g.kI.required]],no_of_param:[this.defaultValues.no_of_param,[g.kI.required]],rdtID:[this.defaultValues.rdtID,[g.kI.required]],file:[this.defaultValues.accountType,[g.kI.required]],rdt_file:[this.defaultValues.rdt_file]}),this.selectedFileName=this.defaultValues.rdt_file||""}checkfile(){return!this.form.get("file")?.hasError("required")}existingRDT(){return!this.form.get("rdtID")?.hasError("required")}checkForm(){return console.log("Inside RDT ID",this.errorForUniqueRDT_id),""==this.errorForUniqueRDT_id&&!(this.form.get("no_of_param")?.hasError("required")||this.form.get("rdtName")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}getRDT(){this.getReadingDeviceType.getSpecificRDT(this.SK_clientID).then(t=>{if(console.log(this.SK_clientID),t){this.data_temp=t,this.rdtList=[];for(let i=0;i<t.length;i++)this.rdtList.push(t[i]?.PK+"-"+t[i]?.rdtLabel);console.log("Default RDT list",this.rdtList),this.rdtList&&this.form.get("rdtID")?.patchValue(this.defaultValues.rdtID),this.cdr.detectChanges()}}).catch(t=>{console.log("cant fetch",t)})}fetchTMData(t){var i=this;return(0,C.Z)(function*(){console.log("iam trying to fetch",i.SK_clientID);try{const o=yield i.api.GetLookupMasterTable(i.SK_clientID+"#rdt",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h}=l[d];i.lookup_data_temp1.push({P1:f,P2:m,P3:v,P4:h}),console.log("d2 =",i.lookup_data_temp1)}}i.lookup_data_temp1.sort((u,l)=>l.P4-u.P4),console.log("Lookup sorting",i.lookup_data_temp1),yield i.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log();for(let r=0;r<i.lookup_data_temp1.length;r++)i.rdtList.push(i.lookup_data_temp1[r].P1);console.log("RDT to be displayed",i.rdtList),i.rdtList&&i.form.get("rdtID")?.patchValue(i.defaultValues.rdtID),i.cdr.detectChanges()}}catch(o){console.error("Error:",o)}})()}checkUniqueRDT(t){this.errorForUniqueRDT_id="";for(let i=0;i<this.rdtList.length;i++)console.log(t.target.value,"-------"),t.target.value==this.rdtList[i]&&(this.errorForUniqueRDT_id="RDT ID already exists");this.updateParentModel({},this.checkForm())}exportTemplate(t){let i,o;"parameter_xlsx"==t&&(i=[["RDT Id","Parameter ID","Parameter Label","Parameter Description","Decimal Point","mX+C Reading X Multiplication Factor","mX+C Reading C is Correction","Enable Schedule Parameter","Schedule Parameter Name","Schedule Parameter Max Value","Schedule Parameter Value Type","Schedule Parameter Operation Type","Schedule Parameter Heat Map Type","Enable Valuemappping","No of ValueMapping","Value Mapping Label","Value Mapping Value","Value Mapping Equation","Value Mapping Class Icon","Value Mapping Label Color","Value Mapping Animation","Value Mapping Font","Value Mapping Style Text Color","Value Mapping Font Size","Value Mapping Align","Enable Scaling","No of Scaling table","Scaling Table Threshold","Scaling Table Multiplication Factor","Scaling Table Unit","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]],o="Reading Parameters.xlsx");const r=N.P6.book_new(),u=N.P6.json_to_sheet([]);N.P6.sheet_add_aoa(u,i);let d=[];for(let f=0;f<i[0].length;f++)d[f]={wch:50};u["!cols"]=d,console.log("ws",u),N.P6.sheet_add_json(u,[]),N.P6.book_append_sheet(r,u,"Sheet1"),N.NC(r,o)}createParameterConfig(t){this.xlfileValid=!1,this.selectedFileName=t.target.files[0].name,this.form.controls.rdt_file.setValue(this.selectedFileName);const i=t.target;if(1!==i.files.length)throw new Error("Cannot use multiple files");const o=new FileReader;t.target.value.includes(".xlsx")&&(o.onload=r=>{const l=N.ij(r.target.result,{type:"binary"}),f=l.Sheets[l.SheetNames[0]];this.previewData=N.P6.sheet_to_json(f,{header:1}),this.RDT_Id=N.P6.sheet_to_json(f,{raw:!0}),console.log("Actual Data",this.previewData),this.ValidationCustom(this.previewData),this.resetFileInput(t.target)},o.readAsBinaryString(i.files[0]))}resetFileInput(t){t.value=""}updateData(t){this.tempMultiParams=t,this.dataChange.emit(this.tempMultiParams)}ValidationCustom(t){let i=[],o="true",r="false",u="",d="",f="",m="",v="",h="",D=[];if(!["RDT Id","Parameter ID","Parameter Label","Parameter Description","Decimal Point","mX+C Reading X Multiplication Factor","mX+C Reading C is Correction","Enable Schedule Parameter","Schedule Parameter Name","Schedule Parameter Max Value","Schedule Parameter Value Type","Schedule Parameter Operation Type","Schedule Parameter Heat Map Type","Enable Valuemappping","No of ValueMapping","Value Mapping Label","Value Mapping Value","Value Mapping Equation","Value Mapping Class Icon","Value Mapping Label Color","Value Mapping Animation","Value Mapping Font","Value Mapping Style Text Color","Value Mapping Font Size","Value Mapping Align","Enable Scaling","No of Scaling table","Scaling Table Threshold","Scaling Table Multiplication Factor","Scaling Table Unit","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"].every(c=>t[0].includes(c)))return this.toast.open("Select the proper Excel file with the correct template","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});console.log("All elements in Heading array are present in parameterData.");for(let c=1;c<t.length;c++)if(this.ADD_finalData={},console.log(t[c][0]),""===t[c][0]||void 0===t[c][0])return this.toast.open("Column:A  Row: "+c+" RDT ID needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let S=!1;for(let c=0;c<this.rdtList.length;c++){const O=this.rdtList[c].split("-");if(console.log("RDT NAme ",O[0]),O[0]===t[1][0].trim())return S=!0,this.toast.open("Column:A  RDT ID exists","Add Correct RDT ID",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}for(let c=1;c<t.length;c++)null!=t[c][1]&&D.push(t[c][1]);let M=(c=D).filter((O,F)=>c.indexOf(O)!=F);var c;if(console.log("params duplicates",M),0!=M.length)return this.toast.open("Column:B  Row:  "+M+" Duplicate Parameter ID not allowed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let c=1;c<t.length;c++){if(null==t[c][0]||""===t[c][0])return this.toast.open("Column:A  Row: "+c+" RDT ID needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[c][0].charCodeAt(0))return this.toast.open("Column:A  Row: "+c+" RDT ID not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][1]||""===t[c][0])return this.toast.open("Column:B  Row: "+c+" Parameter ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[c][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+c+" Parameter ID not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][2]||""===t[c][2])return this.toast.open("Column:C  Row: "+c+" Parameter Label is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[c][2].charCodeAt(0))return this.toast.open("Column:C  Row: "+c+" Parameter Label not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][3]||""===t[c][3])return this.toast.open("Column:D  Row: "+c+" Parameter Description is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[c][3].charCodeAt(0))return this.toast.open("Column:D  Row: "+c+" Parameter Description not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][4]||""===t[c][4])return this.toast.open("Column:E  Row: "+c+" Decimal Point should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[c][4]))return this.toast.open("Column:E  Row: "+c+" Decimal Point must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(t[c][4])))return this.toast.open("Column:E Row: "+c+" Decimal Point should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][4])<0)return this.toast.open("Column:E  Row: "+c+" Decimal Point should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[c][5]))return this.toast.open("Column:F  Row: "+c+" Multiplication factor must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][5]||""===t[c][5])return this.toast.open("Column:F  Row: "+c+" Multiplication factor should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][5])<0)return this.toast.open("Column:F  Row: "+c+" Multiplication factor should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][6]||""===t[c][6])return this.toast.open("Column:G  Row: "+c+" Correction factor should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!0===isNaN(t[c][6]))return this.toast.open("Column:G  Row: "+c+" Correction factor must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][6])<0)return this.toast.open("Column:G  Row: "+c+" Correction factor should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(u=t[c][7],null!=u&&""!==u){let b="";if("boolean"==typeof u?b=JSON.stringify(u).trim().toLowerCase():0==isNaN(u)||(b=u.trim().toLowerCase()),b!==o&&b!==r)return this.toast.open(u+"Column:H  Row: "+c+" Enable Schedule Parameter must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((b==o||b==r)&&(u=b),1==JSON.parse(u)){if(null==t[c][8]||""===t[c][8])return this.toast.open("Column:I  Row: "+c+" Schedule Parameter should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[c][9]))return this.toast.open("Column:J  Row: "+c+" Schedule Max value must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][9]||""===t[c][9])return this.toast.open("Column:J  Row: "+c+" Schedule Max value should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(t[c][9])))return this.toast.open("Column:J Row: "+c+" Schedule Max value should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][9])<0)return this.toast.open("Column:J  Row: "+c+" Schedule Max value should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][10]||""===t[c][10])return this.toast.open("Column:K  Row: "+c+" Schedule Parameter Value type should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if("Difference"===t[c][10]||"Difference"===t[c][10]){if(null==t[c][11]||""===t[c][11])return this.toast.open("Column:L  Row: "+c+" Schedule Parameter Operation type should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else if(null==t[c][12]||""===t[c][12])return this.toast.open("Column:M  Row: "+c+" Schedule Parameter HeatMap type should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}else u=r;if(d=t[c][16],f=t[c][23],null!=t[c][13]&&""!==t[c][13]&&1==JSON.parse(t[c][13])){if(console.log("vlaue mapping value",d),null==t[c][14]||""===t[c][14])return this.toast.open("Column:O  Row: "+c+" Number of value mapping should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[c][14]))return this.toast.open("Column:O  Row: "+c+" No of value mapping must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(t[c][14])))return this.toast.open("Column:O Row: "+c+" No of value mapping should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][14])<0)return this.toast.open("Column:O  Row: "+c+" No of value mapping should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[c][15]||""===t[c][15])return this.toast.open("Column:P  Row: "+c+" Value mapping Label should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==d||""===d)return this.toast.open("Column:Q  Row: "+c+" Value mapping Value should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0!=t[c][14]){if(1===JSON.parse(t[c][14])){if(!0===JSON.stringify(t[c][16]).includes(","))return this.toast.open(d+" Column:Q  Row: "+c+" Should be equal in length","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(d=t[c][16],1==isNaN(d))return this.toast.open(d+" Column:Q  Row: "+c+" Value Mapping Value must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else if(d=t[c][16].split(","),d)for(let b=0;b<d.length;b++)if(1==isNaN(d[b]))return this.toast.open(b+" Column:Q  Row: "+c+" Value Mapping Value must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else{if(!1!==isNaN(d))return this.toast.open("Column:Q  Row: "+c+" Value Mapping value must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(d)))return this.toast.open("Column:Q Row: "+c+" Value mapping Value should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(d)<0)return this.toast.open("Column:Q  Row: "+c+" No of value mapping should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0!=t[c][14]){if(1===JSON.parse(t[c][14])){if(f=t[c][23],1==isNaN(f))return this.toast.open("Column:X  Row: "+c+" Value Mapping Font size must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else if(f=t[c][23].split(","),f)for(let b=0;b<f.length;b++)if(1==isNaN(f[b]))return this.toast.open("Column:X  Row: "+c+" Value Mapping Font size must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else{if(!1!==isNaN(f))return this.toast.open("Column:X  Row: "+c+" Font size must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(f)))return this.toast.open("Column:X Row: "+c+" Font size should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(f)<0)return this.toast.open("Column:X  Row: "+c+" Font size should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}}if(m=t[c][27],v=t[c][28],h=t[c][29],null!=t[c][25]&&""!==t[c][25]){let b="";if("boolean"==typeof t[c][25]?b=JSON.stringify(t[c][25]).trim().toLowerCase():0==isNaN(t[c][25])||(b=t[c][25].trim().toLowerCase()),b!==o&&b!==r)return this.toast.open("Column:Z  Row: "+c+" Enable Scaling must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((b==o||b==r)&&(t[c][25]=b),1==JSON.parse(t[c][25])){if(null==t[c][26]||""===t[c][26])return this.toast.open("Column:AA  Row: "+c+" No of scaling table should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[c][26]))return this.toast.open("Column:AA  Row: "+c+" No of scaling table must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(t[c][26])))return this.toast.open("Column:AA Row: "+c+" No of scaling table should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[c][26])<0)return this.toast.open("Column:AA  Row: "+c+" No of scaling table should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==m||""===m)return this.toast.open("Column:AB  Row: "+c+" Scale threshold should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0!=t[c][26]){if(1===JSON.parse(t[c][26])){if(m=t[c][27],1==isNaN(m))return this.toast.open("Column:AB  Row: "+c+" Scaling threshold must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else if(m=t[c][27].split(","),m)for(let k=0;k<m.length;k++)if(1==isNaN(m[k]))return this.toast.open("Column:AB  Row: "+c+" Scaling threshold must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else{if(!1!==isNaN(m))return this.toast.open("Column:AB  Row: "+c+" Scale Threhold must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(m)))return this.toast.open("Column:AB Row: "+c+" Scale threshold should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(m)<0)return this.toast.open("Column:AB  Row: "+c+" Scale threshold should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if(null==v||""===v)return this.toast.open("Column:AC  Row: "+c+" Multi factor should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0!=t[c][26]){if(1===JSON.parse(t[c][26])){if(v=t[c][28],1==isNaN(v))return this.toast.open("Column:AC  Row: "+c+" Scaling Multiplication must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else if(v=t[c][28].split(","),v)for(let k=0;k<v.length;k++)if(1==isNaN(v[k]))return this.toast.open("Column:AC  Row: "+c+" Scaling multiplication must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else{if(!1!==isNaN(v))return this.toast.open("Column:AC  Row: "+c+" Multi factor must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(v)))return this.toast.open("Column:AC Row: "+c+" Multi factor should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(v)<0)return this.toast.open("Column:AC  Row: "+c+" Multi factor should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if(null==h||""===h)return this.toast.open("Column:AD  Row: "+c+" Scaling Unit should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}this.ADD_finalData.PK=t[c][0].trim(),this.ADD_finalData.SK=this.SK_clientID,this.ADD_finalData.parameters=[],this.renameKeys[1]="parameterID",this.renameKeys[2]="parameterLabel",this.renameKeys[3]="parameterDescription",this.renameKeys[4]="decimalpoint",this.renameKeys[5]="mX_C_X_Multiplication_Factor",this.renameKeys[6]="mX_C_C_Correction_Factor",this.renameKeys[7]="schedule_parameter",this.renameKeys[8]="schedule_parameter_name",this.renameKeys[9]="schedule_max",this.renameKeys[10]="schedule_value_type",this.renameKeys[11]="schedule_operation_type",this.renameKeys[12]="schedule_heatmap_type",this.renameKeys[13]="value_mapping",this.renameKeys[14]="valuemapping",this.renameKeys[25]="scaling_table",this.renameKeys[26]="scalingtable";let O=[],F=[],Z=14,T=1,V=1,Y=[],z=[],H=[],W=[],G=[],j=[],X=[],ee=[],ye=[],te=26;if(null!=t[c][14]&&""!==t[c][14])if("string"==typeof t[c][Z+T]&&!0===t[c][Z+T].includes(",")){Y=t[c][Z+T].split(","),z=null!=t[c][Z+T+2]&&""!==t[c][Z+T+2]?t[c][Z+T+2].split(","):t[c][Z+T+2],H=null!=t[c][Z+T+3]&&""!==t[c][Z+T+3]?t[c][Z+T+3].split(","):t[c][Z+T+3],W=null!=t[c][Z+T+4]&&""!==t[c][Z+T+4]?t[c][Z+T+4].split(","):t[c][Z+T+4],G=null!=t[c][Z+T+5]&&""!==t[c][Z+T+5]?t[c][Z+T+5].split(","):t[c][Z+T+5],j=null!=t[c][Z+T+6]&&""!==t[c][Z+T+6]?t[c][Z+T+6].split(","):t[c][Z+T+6],X=null!=t[c][Z+T+7]&&""!==t[c][Z+T+7]?t[c][Z+T+7].split(","):t[c][Z+T+7],ee=null!=t[c][Z+T+9]&&""!==t[c][Z+T+9]?t[c][Z+T+9].split(","):t[c][Z+T+9],console.log("splittedLabels",Y);for(let b=0;b<t[c][14];b++)O.push({vm_label:Y[b],vm_value:d[b],vm_equation:null!==z&&""!==z&&void 0!==z?z[b]:z,vm_icon:null!==H&&""!==H&&void 0!==H?H[b]:H,vm_label_color:null!==W&&""!==W&&void 0!==W?W[b]:W,vm_animation:null!==G&&""!==G&&void 0!==G?G[b]:G,vm_font:null!==j&&""!==j&&void 0!==j?j[b]:j,vm_text_color:null!==X&&""!==X&&void 0!==X?X[b]:X,vm_font_size:null!==f&&""!==f&&void 0!==f?f[b]:f,vm_align_type:null!==ee&&""!==ee&&void 0!==ee?ee[b]:ee})}else 0!=t[c][14]&&O.push({vm_label:t[c][Z+T],vm_value:t[c][Z+T+1],vm_equation:t[c][Z+T+2],vm_icon:t[c][Z+T+3],vm_label_color:t[c][Z+T+4],vm_animation:t[c][Z+T+5],vm_font:t[c][Z+T+6],vm_text_color:t[c][Z+T+7],vm_font_size:t[c][Z+T+8],vm_align_type:t[c][Z+T+9]});else O=[];if(null!=t[c][26]&&""!==t[c][26])if("string"==typeof t[c][te+V]&&!0===t[c][te+V].includes(",")){ye=t[c][te+V+2].split(",");for(let b=0;b<t[c][26];b++)F.push({scale_threshold:m[b],sc_multiply:v[b],sc_unit:ye[b]})}else 0!=t[c][26]&&F.push({scale_threshold:t[c][te+V],sc_multiply:t[c][te+V+1],sc_unit:t[c][te+V+2]});else F=[];for(let b=0;b<t[0].length;b++)null==t[c][b]?t[c][b]=null:(this.ADD_finalData[this.renameKeys[b]]=t[c][b],console.log("Parameter Data :",t[c][b]),console.log("Rename Keys :",this.renameKeys[b]),console.log("index",b));console.log("All the valuemapping are ",O),delete this.ADD_finalData.undefined,this.ADD_finalData.updated=new Date,this.ADD_finalData.valuemapping=O,this.ADD_finalData.scalingtable=F,this.ADD_finalData.schedule_parameter=u;const Oi=JSON.parse(JSON.stringify(this.ADD_finalData));i.push(Oi),console.log("count",c),console.log("Final_DAta",this.ADD_finalData),console.log("allParameter details",i);let he=[];for(let b=0;b<i.length;b++)he.push({PK:i[b].PK,SK:i[b].SK,updated:i[b].updated});const Ri=he.map(b=>b.PK),le=he.filter(({PK:b},k)=>!Ri.includes(b,k+1));let E=[];for(let b=0;b<le.length;b++)E.push({PK:le[b].PK,SK:le[b].SK,parameters:[],updated:le[b].updated});for(let b=0;b<i.length;b++)for(let k=0;k<E.length;k++)"PK"in E[k]&&E[k].PK==i[b].PK?E[k].parameters.push({parameterID:i[b].parameterID,parameterLabel:i[b].parameterLabel,parameterDescription:i[b].parameterDescription,decimalpoint:i[b].decimalpoint,mX_C_X_Multiplication_Factor:i[b].mX_C_X_Multiplication_Factor,mX_C_C_Correction_Factor:i[b].mX_C_C_Correction_Factor,schedule_parameter:i[b].schedule_parameter,schedule_parameter_name:i[b].schedule_parameter_name,schedule_max:i[b].schedule_max,schedule_value_type:i[b].schedule_value_type,schedule_operation_type:i[b].schedule_operation_type,schedule_heatmap_type:i[b].schedule_heatmap_type,value_mapping:i[b].value_mapping,valuemapping:i[b].valuemapping,scaling_table:i[b].scaling_table,scalingtable:i[b].scalingtable}):"PK"in E[k]||(E[k].PK=i[b].PK,E[k].parameters=[],E[k].parameters.push({parameterID:i[b].parameterID,parameterLabel:i[b].parameterLabel,parameterDescription:i[b].parameterDescription,decimalpoint:i[b].decimalpoint,mX_C_X_Multiplication_Factor:i[b].mX_C_X_Multiplication_Factor,mX_C_C_Correction_Factor:i[b].mX_C_C_Correction_Factor,schedule_parameter:i[b].schedule_parameter,schedule_parameter_name:i[b].schedule_parameter_name,schedule_max:i[b].schedule_max,schedule_value_type:i[b].schedule_value_type,schedule_operation_type:i[b].schedule_operation_type,schedule_heatmap_type:i[b].schedule_heatmap_type,value_mapping:i[b].value_mapping,valuemapping:i[b].valuemapping,scaling_table:i[b].scaling_table,scalingtable:i[b].scalingtable}));this.tempMultiParams=E}this.xlfileValid=!0,localStorage.setItem("step3Validation",JSON.stringify(this.xlfileValid)),this.updateParentModel(this.form.value,this.xlfileValid),this.updateData(this.tempMultiParams),console.log("New Oject",this.tempMultiParams)}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(B.t),e.Y36(ie.ux),e.Y36(e.sBO),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step3"]],inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",editOperation:"editOperation",hideDeleteButton:"hideDeleteButton",lookupdeviceData:"lookupdeviceData",adminUser:"adminUser"},outputs:{dataChange:"dataChange"},features:[e.TTD],decls:29,vars:6,consts:[[1,"pb-10","pb-lg-15"],[1,"fw-bolder","text-dark"],[1,"fv-row",3,"formGroup"],[1,"row"],[1,"col"],["formControlName","rdt_by_type","name","rdt_by_type","type","radio","id","kt_create_account_form_account_type_corporate","value","type_1",1,"btn-check"],["for","kt_create_account_form_account_type_corporate","id","btn1","ngbTooltip","Select from a list of pre-configured Reading Device Type",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","change-color"],["name","briefcase",1,"fs-1","me-5"],[1,"d-block","fw-bold","text-start"],[1,"text-dark","fw-bolder","d-block","fs-4","mb-2"],["formControlName","rdt_by_type","name","rdt_by_type","type","radio","id","kt_create_account_form_account_type_personal","value","type_2",1,"btn-check",3,"disabled"],["for","kt_create_account_form_account_type_personal","id","btn2","ngbTooltip","Automatically create a Reading Device Type with default settings, auto generated Parameter labels , IDs. Ideal for Quickly adding configuration,This option simplifies the configurations",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],[1,"bi","bi-lightning-charge-fill","fs-1","me-4"],["formControlName","rdt_by_type","name","rdt_by_type","type","radio","id","file_type_radio_button","value","type_3",1,"btn-check",3,"disabled"],["for","file_type_radio_button","id","btn3","ngbTooltip","Create a Reading Device Type by importing settings from an XLSX file. This method allows for detailed customization of labels and inputs specific to your needs",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],[1,"bi","bi-file-earmark-spreadsheet-fill","fs-1","me-4"],["class","row",4,"ngIf"],[1,"row","mb-7"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["ngbTooltip","Automatically generate a Reading Device Type with an assigned RDT ID",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","rdtName","type","text","placeholder","Enter The RDT ID",1,"form-control","form-control-solid",3,"keyup"],[1,"fv-plugins-message-container","invalid-feedback"],[4,"ngIf","ngIfElse"],["defaultErrorMessagerdt",""],["ngbTooltip","Specify total number of parameters associated with this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","no_of_param","type","number","placeholder","Enter no of param","appPreventScroll","",1,"form-control","form-control-solid"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[4,"ngIf"],[1,"d-flex","flex-column","mb-7","fv-row"],["ngbTooltip","Reading Device Type list",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","rdtID",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["disabled","",3,"value","selected"],[3,"value",4,"ngFor","ngForOf"],["defaultErrorExisting",""],[3,"value"],[1,"col-sm-6","mb-1"],["ngbTooltip","Upload an XLSX file to import a Reading Device Type. Ensure the file is formatted correctly with columns for labels, IDs, and any other necessary device parameters. This method allows for precise customization of your device configuration",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","file","type","file","placeholder","Enter no of param","accept",".xlsx",1,"form-control","form-control-solid",3,"change"],["fileInputrdt",""],["style","color: #1B84FF;",4,"ngIf","ngIfElse"],["notSelected",""],[1,"col",2,"margin-top","4.3%"],["type","button",1,"btn","fw-bold","custom-primary","btn-sm","export-button",3,"click"],[1,"bi","bi-file-earmark-arrow-down-fill",2,"font-size","16px","margin-bottom","1%"],[2,"color","#1B84FF"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Reading Device Type Configuration(RDT)"),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"input",5),e.TgZ(7,"label",6),e._UZ(8,"app-keenicon",7),e.TgZ(9,"span",8)(10,"span",9),e._uU(11,"Use Existing RDT"),e.qZA()()()(),e.TgZ(12,"div",4),e._UZ(13,"input",10),e.TgZ(14,"label",11),e._UZ(15,"i",12),e.TgZ(16,"span",8)(17,"span",9),e._uU(18,"Quick Add RDT"),e.qZA()()()(),e.TgZ(19,"div",4),e._UZ(20,"input",13),e.TgZ(21,"label",14),e._UZ(22,"i",15),e.TgZ(23,"span",8)(24,"span",9),e._uU(25,"Create RDT via Excel"),e.qZA()()()()(),e.YNc(26,Re,19,3,"div",16),e.YNc(27,Be,14,4,"div",16),e.YNc(28,ze,15,2,"div",16),e.qZA()),2&t){let o,r,u;e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(10),e.Q6J("disabled",i.editOperation),e.xp6(7),e.Q6J("disabled",i.editOperation),e.xp6(6),e.Q6J("ngIf","type_2"===(null==(o=i.form.get("rdt_by_type"))?null:o.value)),e.xp6(1),e.Q6J("ngIf","type_1"===(null==(r=i.form.get("rdt_by_type"))?null:r.value)),e.xp6(1),e.Q6J("ngIf","type_3"===(null==(u=i.form.get("rdt_by_type"))?null:u.value))}},dependencies:[q.sg,q.O5,g.YN,g.Kr,g.Fj,g.wV,g.EJ,g._,g.JJ,g.JL,g.sg,g.u,J._L,se.q,oe],styles:[".btn-check[_ngcontent-%COMP%]:checked + #btn1[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-check.btn-check[_ngcontent-%COMP%]:checked + #btn2[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-check[_ngcontent-%COMP%]:checked + #btn3[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-outline[_ngcontent-%COMP%]:hover{border:solid 1px}.export-button[_ngcontent-%COMP%]{background-color:#ffc700;color:#fff;font-size:14px}.export-button[_ngcontent-%COMP%]:hover{background-color:#ffc700;color:#fff;opacity:.9;transform:translateY(-2px);transition:.5s}"]})),p})();var Qe=w(6990);let ce=(()=>{var n;class p{constructor(t){(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"customInit",void 0),(0,a.Z)(this,"stateSubject",new Q.X(null)),(0,a.Z)(this,"state$",this.stateSubject.asObservable()),this.api=t}updateState(t){this.stateSubject.next(t)}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.LFG(B.t))}),(0,a.Z)(p,"\u0275prov",e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})),p})();var ae=w(88672),Ye=w(74260),He=w(36624),ve=w(16519);const We=["mapContainer"];function Ge(n,p){1&n&&(e.TgZ(0,"div",13)(1,"h2",14),e._uU(2,"Add Location Configuration "),e._UZ(3,"i",15),e.qZA()())}function je(n,p){1&n&&(e.TgZ(0,"div",13)(1,"h2",14),e._uU(2,"Update Location Configuration "),e._UZ(3,"i",15),e.qZA()())}function Xe(n,p){1&n&&(e.TgZ(0,"div",16),e._uU(1," Longitude is required "),e.qZA())}function et(n,p){1&n&&(e.TgZ(0,"div",16),e._uU(1," Latitude is required "),e.qZA())}let tt=(()=>{var n;class p{constructor(t,i){(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"zone",void 0),(0,a.Z)(this,"gmap",void 0),(0,a.Z)(this,"map",void 0),(0,a.Z)(this,"marker",void 0),(0,a.Z)(this,"latitude",12.9254),(0,a.Z)(this,"longitude",77.5918),(0,a.Z)(this,"editOperation",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"unsubscribe",[]),this.fb=t,this.zone=i}ngOnInit(){this.initForm(),this.updateParentModel({},this.checkForm()),0==this.hideDeleteButton&&this.form.disable()}ngAfterViewInit(){this.mapInitializer(),this.updateMarkerPosition()}mapInitializer(){const t={center:new google.maps.LatLng(this.latitude,this.longitude),zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.gmap.nativeElement,t),this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.latitude,this.longitude),map:this.map,draggable:!0,clickable:!0}),google.maps.event.addListener(this.map,"click",i=>{console.log("event new",i),this.latitude=i.latLng.lat(),this.longitude=i.latLng.lng(),this.form.controls.lgtdName.setValue(this.longitude),this.form.controls.latitude.setValue(this.latitude),console.log("Click",this.form.get("lgtdName")?.value+" "+this.form.get("latitude")?.value),this.updateParentModel({lgtdName:this.longitude.toString(),latitude:this.latitude.toString()},this.checkForm()),this.updateMarkerPosition()}),google.maps.event.addListener(this.marker,"dragend",i=>{this.latitude=i.latLng.lat(),this.longitude=i.latLng.lng(),this.form.controls.lgtdName.setValue(this.longitude),this.form.controls.latitude.setValue(this.latitude),this.updateParentModel({lgtdName:this.longitude.toString(),latitude:this.latitude.toString()},this.checkForm())})}updateMarkerPosition(){const t=parseFloat(this.form.controls.latitude.value),i=parseFloat(this.form.controls.lgtdName.value);if(console.log("latitude :",t+"    longitude :",i),isNaN(t)||isNaN(i))console.error("Latitude or longitude is not a valid number.");else{this.latitude=t,this.longitude=i;const o=new google.maps.LatLng(this.latitude,this.longitude);this.marker.setPosition(o),this.map.setCenter(o)}}initForm(){this.form=this.fb.group({lgtdName:[this.defaultValues.lgtdName,[g.kI.required]],latitude:[this.defaultValues.latitude,[g.kI.required]],altitude:[this.defaultValues.altitude]});const t=this.form.valueChanges.subscribe(i=>{this.updateParentModel(i,this.checkForm())});this.unsubscribe.push(t)}checkForm(){return!(this.form.get("lgtdName")?.hasError("required")||this.form.get("latitude")?.hasError("required")||this.form.get("altitude")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(g.qu),e.Y36(e.R0b))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step2"]],viewQuery:function(t,i){if(1&t&&e.Gf(We,5),2&t){let o;e.iGM(o=e.CRH())&&(i.gmap=o.first)}},inputs:{editOperation:"editOperation",hideDeleteButton:"hideDeleteButton",updateParentModel:"updateParentModel",defaultValues:"defaultValues"},decls:24,vars:5,consts:[["class","pb-10 pb-lg-12",4,"ngIf"],[1,"fv-row",3,"formGroup"],[1,"row","mb-7"],[1,"col"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["formControlName","lgtdName","type","number","placeholder","Longitude","appPreventScroll","",1,"form-control","form-control-solid",3,"keyup"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],["formControlName","latitude","name","latitude","type","number","placeholder","Latitude","appPreventScroll","",1,"form-control","form-control-solid",3,"keyup"],[1,"col-sm-6"],["formControlName","altitude","type","number","placeholder","Altitude","appPreventScroll","",1,"form-control","form-control-solid"],[2,"height","400px"],["mapContainer",""],[1,"pb-10","pb-lg-12"],[1,"fw-bolder","text-dark"],["ngbTooltip","To set latitude and longitude, click anywhere on the map or drag the marker to the desired location",1,"fas","fa-exclamation-circle","fs-7"],[1,"fv-plugins-message-container","invalid-feedback"]],template:function(t,i){if(1&t&&(e.YNc(0,Ge,4,0,"div",0),e.YNc(1,je,4,0,"div",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"label",4)(6,"span",5),e._uU(7,"Longitude"),e.qZA()(),e.TgZ(8,"input",6),e.NdJ("keyup",function(){return i.updateMarkerPosition()}),e.qZA(),e.YNc(9,Xe,2,0,"div",7),e.qZA(),e.TgZ(10,"div",3)(11,"label",4)(12,"span",5),e._uU(13,"Latitude"),e.qZA()(),e.TgZ(14,"input",8),e.NdJ("keyup",function(){return i.updateMarkerPosition()}),e.qZA(),e.YNc(15,et,2,0,"div",7),e.qZA()(),e.TgZ(16,"div",2)(17,"div",9)(18,"label",4)(19,"span"),e._uU(20,"Altitude"),e.qZA()(),e._UZ(21,"input",10),e.qZA()()(),e._UZ(22,"div",11,12)),2&t){let o,r;e.Q6J("ngIf",!i.editOperation),e.xp6(1),e.Q6J("ngIf",i.editOperation),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(7),e.Q6J("ngIf",(null==(o=i.form.get("lgtdName"))?null:o.hasError("required"))&&(null==(o=i.form.get("lgtdName"))?null:o.touched)),e.xp6(6),e.Q6J("ngIf",(null==(r=i.form.get("latitude"))?null:r.hasError("required"))&&(null==(r=i.form.get("latitude"))?null:r.touched))}},dependencies:[q.O5,g.Fj,g.wV,g.JJ,g.JL,g.sg,g.u,J._L,oe],styles:["#mapContainer[_ngcontent-%COMP%]{height:400px;width:100%}"]})),p})();function it(n,p){1&n&&(e.TgZ(0,"div",4),e._uU(1," If you want to view this device, you can add it to a location. "),e.qZA())}function ot(n,p){1&n&&(e.TgZ(0,"div",4),e._uU(1," If you want to view this device, you can add it to a location "),e.TgZ(2,"Strong"),e._uU(3,"(ignore if the device has already been added)"),e.qZA()())}let at=(()=>{var n;class p{constructor(){(0,a.Z)(this,"editOperation",void 0)}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step5"]],inputs:{editOperation:"editOperation"},decls:24,vars:2,consts:[[1,"pb-10","pb-lg-15"],[1,"fw-bolder","text-dark"],[1,"fs-6","text-gray-600","mb-5"],["class","fs-6 text-gray-600 mb-4",4,"ngIf"],[1,"fs-6","text-gray-600","mb-4"],[1,"ms-3"],["href","/location",1,"btn","btn-primary"],[1,"bi","bi-geo-alt-fill","fs-3","mb-1"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"You Are Done!"),e.qZA(),e.TgZ(3,"div",2),e._uU(4," Device Configured Successfully "),e.qZA(),e.YNc(5,it,2,0,"div",3),e.YNc(6,ot,4,0,"div",3),e.TgZ(7,"div",4)(8,"strong"),e._uU(9,"Steps to View and Add the Device to a Location:"),e.qZA(),e.TgZ(10,"ol",5)(11,"li"),e._uU(12,'Click on the "Go to Location Module" button below to open the Location Management page.'),e.qZA(),e.TgZ(13,"li"),e._uU(14,"Select the desired location from the list or create a new one."),e.qZA(),e.TgZ(15,"li"),e._uU(16,'Once you\'re in the location, click "Add Device" and search for the device you just configured.'),e.qZA(),e.TgZ(17,"li"),e._uU(18,'Confirm the device\'s details and click "Add" to finalize the process.'),e.qZA(),e.TgZ(19,"li"),e._uU(20,"Your device will now be visible and associated with the selected location, making it easier to manage."),e.qZA()()(),e.TgZ(21,"a",6),e._UZ(22,"i",7),e._uU(23,"Go to Location Module "),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!i.editOperation),e.xp6(1),e.Q6J("ngIf",i.editOperation))},dependencies:[q.O5],styles:[".btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.8s}"]})),p})();function nt(n,p){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const s=e.oxw(2);e.xp6(1),e.hij(" ",s.errorForUniqueWDTID," ")}}function rt(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," WDT ID is required "),e.qZA())}function lt(n,p){if(1&n&&e.YNc(0,rt,2,0,"div",29),2&n){const s=e.oxw(2);let t;e.Q6J("ngIf",(null==(t=s.form.get("wdtName"))?null:t.hasError("required"))&&(null==(t=s.form.get("wdtName"))?null:t.touched))}}function st(n,p){1&n&&(e.TgZ(0,"div",22),e._uU(1," Number of Parameters required "),e.qZA())}function ct(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",3)(1,"div",3)(2,"div",4)(3,"label",18)(4,"span",19),e._uU(5,"WDT ID"),e.qZA(),e._UZ(6,"i",20),e.qZA(),e.TgZ(7,"input",21),e.NdJ("keyup",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.checkUniqueIdentifier(i))}),e.qZA(),e.TgZ(8,"div",22),e.YNc(9,nt,2,1,"ng-container",23),e.YNc(10,lt,1,1,"ng-template",null,24,e.W1O),e.qZA()(),e.TgZ(12,"div",25)(13,"label",18)(14,"span",19),e._uU(15,"Number of Parameters"),e.qZA(),e._UZ(16,"i",26),e.qZA(),e._UZ(17,"input",27),e.YNc(18,st,2,0,"div",28),e.qZA()()()}if(2&n){const s=e.MAs(11),t=e.oxw();let i;e.xp6(9),e.Q6J("ngIf",""!==t.errorForUniqueWDTID)("ngIfElse",s),e.xp6(9),e.Q6J("ngIf",(null==(i=t.form.get("wdt_no_of_param"))?null:i.hasError("required"))&&(null==(i=t.form.get("wdt_no_of_param"))?null:i.touched))}}function dt(n,p){if(1&n&&(e.TgZ(0,"span",39),e._uU(1),e.qZA()),2&n){const s=e.oxw(2);e.xp6(1),e.hij("Selected File:",s.selectedFileName,"")}}function ut(n,p){1&n&&(e.TgZ(0,"span",22),e._uU(1,"No File Selected"),e.qZA())}function pt(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",3)(1,"div",3)(2,"div",4)(3,"div",30)(4,"div",31)(5,"label",18)(6,"span",19),e._uU(7,"Upload File"),e.qZA(),e._UZ(8,"i",32),e.qZA(),e.TgZ(9,"input",33),e.NdJ("change",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.createParameterConfig(i))}),e.qZA(),e.YNc(10,dt,2,1,"span",34),e.YNc(11,ut,2,0,"ng-template",null,35,e.W1O),e.qZA(),e.TgZ(13,"div",36)(14,"button",37),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.exportTemplate("parameter_xlsx"))}),e._UZ(15,"i",38),e._uU(16,"Export Template"),e.qZA()()()()()()}if(2&n){const s=e.MAs(12),t=e.oxw();e.xp6(10),e.Q6J("ngIf",t.selectedFileName)("ngIfElse",s)}}function ht(n,p){if(1&n&&(e.TgZ(0,"option",47),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function mt(n,p){if(1&n&&(e.TgZ(0,"select",44)(1,"option",45),e._uU(2,"Select Writing Device Type"),e.qZA(),e.YNc(3,ht,2,2,"option",46),e.qZA()),2&n){const s=e.oxw(2);e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",s.wdtList)}}function _t(n,p){1&n&&(e.ynx(0),e._uU(1," No items found, please add WDT configuration "),e.BQk())}function ft(n,p){1&n&&(e.TgZ(0,"div"),e._uU(1," WDT Type is required "),e.qZA())}function gt(n,p){if(1&n&&e.YNc(0,ft,2,0,"div",29),2&n){const s=e.oxw(2);let t;e.Q6J("ngIf",(null==(t=s.form.get("wdtID"))?null:t.hasError("required"))&&(null==(t=s.form.get("wdtID"))?null:t.touched))}}function vt(n,p){if(1&n&&(e.TgZ(0,"div",3)(1,"div",40)(2,"label",18)(3,"span",19),e._uU(4,"Existing WDT"),e.qZA(),e._UZ(5,"i",41),e.qZA(),e.YNc(6,mt,4,2,"select",42),e.TgZ(7,"div",22),e.YNc(8,_t,2,0,"ng-container",23),e.YNc(9,gt,1,1,"ng-template",null,43,e.W1O),e.qZA()()()),2&n){const s=e.MAs(10),t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.wdtList),e.xp6(2),e.Q6J("ngIf",0==t.wdtList.length)("ngIfElse",s)}}let bt=(()=>{var n;class p{constructor(t,i,o,r,u,l){(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"toast",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"getWritingDeviceType",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"editOperation",void 0),(0,a.Z)(this,"dataChange",new e.vpe),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"SK_clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"rdtLabel",void 0),(0,a.Z)(this,"data_temp",[]),(0,a.Z)(this,"wdtList",[]),(0,a.Z)(this,"alert_binding_parameter_RDT",void 0),(0,a.Z)(this,"parametersList",void 0),(0,a.Z)(this,"paramsBasedOnRDT",void 0),(0,a.Z)(this,"PK",void 0),(0,a.Z)(this,"SK",void 0),(0,a.Z)(this,"errorForUniqueWDTID",void 0),(0,a.Z)(this,"parameterData",[]),(0,a.Z)(this,"ADD_finalData",{}),(0,a.Z)(this,"enable_binding_parameter",""),(0,a.Z)(this,"renameKeys",[]),(0,a.Z)(this,"tempMultiParams",[]),(0,a.Z)(this,"xlfileValid",!1),(0,a.Z)(this,"previewData",[]),(0,a.Z)(this,"RDT_Id",[]),(0,a.Z)(this,"selectedFileName",""),(0,a.Z)(this,"lookup_data_user",[]),this.api=t,this.toast=i,this.cdr=o,this.fb=r,this.getWritingDeviceType=u,this.getDiagnostics=l}ngAfterViewInit(){this.form.get("wdtID")?.patchValue(this.defaultValues.wdtID)}ngOnInit(){this.initForm(),this.updateParentModel({},this.checkForm()),this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.getWDT(1),0==this.hideDeleteButton&&this.form.disable(),!0===this.editOperation&&this.form.get("wdt_by_type")?.disable()}initForm(){let t=localStorage.getItem("step4Validation");this.form=this.fb.group({wdt_by_type:[this.defaultValues.wdt_by_type,[g.kI.required]],wdtName:[this.defaultValues.wdtName,[g.kI.required]],wdt_no_of_param:[this.defaultValues.wdt_no_of_param,[g.kI.required]],wdtID:[this.defaultValues.wdtID,[g.kI.required]],file:[this.defaultValues.accountType,[g.kI.required]],wdt_file:[this.defaultValues.wdt_file]}),this.selectedFileName=this.defaultValues.wdt_file||"";const i=this.form.valueChanges.subscribe(o=>{"type_1"==this.form.get("wdt_by_type")?.value?this.updateParentModel(o,this.existingWDT()):"type_2"==this.form.get("wdt_by_type")?.value?this.updateParentModel(o,this.checkForm()):this.updateParentModel(o,1==t||"true"==t?t:this.xlfileValid)});this.unsubscribe.push(i)}checkxlsx(){return!this.form.get("file")?.hasError("required")}existingWDT(){return!this.form.get("wdtID")?.hasError("required")}checkForm(){return""==this.errorForUniqueWDTID&&!(this.form.get("wdtName")?.hasError("required")||this.form.get("wdt_no_of_param")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}getWDT(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.SK_clientID+"#wdt",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h}=l[d];i.lookup_data_user.push({P1:f,P2:m,P3:v,P4:h}),console.log("d2 =",i.lookup_data_user)}}i.lookup_data_user.sort((u,l)=>l.P4-u.P4),console.log("Lookup sorting",i.lookup_data_user),yield i.getWDT(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",i.lookup_data_user),i.wdtList=[];for(let r=0;r<i.lookup_data_user.length;r++)i.wdtList.push(i.lookup_data_user[r]?.P1),i.form.get("wdtID")?.patchValue(i.defaultValues.wdtID);i.cdr.detectChanges()}}catch(o){console.error("Error:",o)}})()}checkUniqueIdentifier(t){this.errorForUniqueWDTID="";for(let i=0;i<this.wdtList.length;i++)t.target.value===this.wdtList[i]&&(this.errorForUniqueWDTID="WDT ID already exists");this.updateParentModel({},this.checkForm())}exportTemplate(t){let i,o;"parameter_xlsx"==t&&(i=[["WDT Id","Parameter ID","Parameter Label","Parameter Description","Start Address","Variable Type","Min Value","Max Value","mX+C X Multiplication Factor","mX+C C Addition Factor","Control Type","Step","RDT ID","No of Binding Reading Parameter","Add Binding Reading Parameter","Enable Binding Reading Parameter","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5","No of Dropdown ","Label","Value"],["","","","","","","","","","","","","","","","","","","","","","",""]],o="Writing Parameters.xlsx");const r=N.P6.book_new(),u=N.P6.json_to_sheet([]);N.P6.sheet_add_aoa(u,i);let d=[];for(let f=0;f<i[0].length;f++)d[f]={wch:30};u["!cols"]=d,console.log("ws",u),N.P6.sheet_add_json(u,[]),N.P6.book_append_sheet(r,u,"Sheet1"),N.NC(r,o)}createParameterConfig(t){this.xlfileValid=!1,localStorage.setItem("step4Validation",JSON.stringify(this.xlfileValid)),this.selectedFileName=t.target.files[0].name,this.form.controls.wdt_file.setValue(this.selectedFileName);const i=t.target;if(1!==i.files.length)throw new Error("Cannot use multiple files");const o=new FileReader;t.target.value.includes(".xlsx")&&(o.onload=r=>{const l=N.ij(r.target.result,{type:"binary"}),f=l.Sheets[l.SheetNames[0]];this.previewData=N.P6.sheet_to_json(f,{header:1}),this.RDT_Id=N.P6.sheet_to_json(f,{raw:!0}),console.log("Actual Data",this.previewData),this.ValidationCustom(this.previewData),this.resetFileInput(t.target)},o.readAsBinaryString(i.files[0]))}resetFileInput(t){t.value=""}ValidationCustom(t){let i=[],o=[],r="true",u="false",l=[];if(!["WDT Id","Parameter ID","Parameter Label","Parameter Description","Start Address","Variable Type","Min Value","Max Value","mX+C X Multiplication Factor","mX+C C Addition Factor","Control Type","Step","RDT ID","No of Binding Reading Parameter","Add Binding Reading Parameter","Enable Binding Reading Parameter","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5","No of Dropdown ","Label","Value"].every(h=>t[0].includes(h)))return this.toast.open("Select the proper Excel file with the correct template","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});console.log("All elements in Heading array are present in parameterData.");for(let h=1;h<t.length;h++)if(""===t[h][0]||void 0===t[h][0])return this.toast.open("Column:A  Row: "+h+" WDT ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let h=1;h<t.length;h++)null!=t[h][1]&&o.push(t[h][1]);let v=(h=o).filter((D,A)=>h.indexOf(D)!=A);var h;if(0!=v.length)return this.toast.open("Column:B  Row:  "+v+" Duplicate Parameter ID not allowed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let h=1;h<t.length;h++){if(this.ADD_finalData={},l=[],t[h][0]&&t[h][0].trim().length>=2){if(!(null!==t[h][0]&&t[h][0].length>=2))return this.toast.open("Column:B  Row: "+h+" WDT ID should be atleast 2 character","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][0]||""===t[h][0])return this.toast.open("Column:A  Row: "+h+" WDT ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[h][0].charCodeAt(0))return this.toast.open("Column:A  Row: "+h+" WDT ID shouldn't starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let y=0;y<this.wdtList.length;y++)if(this.wdtList[y].split("-")[0]===t[h][0].trim())return this.toast.open("Column:A  WDT ID already exists","Add Correct WDT ID",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][1]||""===t[h][1])return this.toast.open("Column:B  Row: "+h+" Parameter ID should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[h][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+h+" Parameter ID should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][2]||""===t[h][2])return this.toast.open("Column:C  Row: "+h+" Parameter Label should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[h][2].charCodeAt(0))return this.toast.open("Column:C  Row: "+h+" Parameter Label should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][3]||""===t[h][3])return this.toast.open("Column:D  Row: "+h+" Parameter Description should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[h][3].charCodeAt(0))return this.toast.open("Column:D  Row: "+h+" Parameter Descrition should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][4]||""===t[h][4])return this.toast.open("Column:E  Row: "+h+" Start Address should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===JSON.stringify(t[h][4]).charCodeAt(0))return this.toast.open("Column:E  Row: "+h+" Start Address should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!0===isNaN(t[h][4]))return this.toast.open("Column:E  Row: "+h+" Start Address should be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][5]||""===t[h][5])return this.toast.open("Column:F  Row: "+h+" Variable Type should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===t[h][5].charCodeAt(0))return this.toast.open("Column:F  Row: "+h+" Variable Type should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[h][6]))return this.toast.open("Column:G  Row: "+h+" Min must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][6]||""===t[h][6])return this.toast.open("Column:G  Row: "+h+" Min should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[h][6])<0)return this.toast.open("Column:G  Row: "+h+" Min should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[h][7]))return this.toast.open("Column:H  Row: "+h+" Max must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][7]||""===t[h][7])return this.toast.open("Column:H  Row: "+h+" Max should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[h][7])<0)return this.toast.open("Column:H  Row: "+h+" Max should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[h][8]))return this.toast.open("Column:I  Row: "+h+" Multiplication factor must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][8]||""===t[h][8])return this.toast.open("Column:I  Row: "+h+" Multiplication factor should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[h][8])<0)return this.toast.open("Column:I  Row: "+h+" Multiplication factor should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(t[h][9]))return this.toast.open("Column:J  Row: "+h+" Addition factor must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][9]||""===t[h][9])return this.toast.open("Column:J  Row: "+h+" Addition factor should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(t[h][9])<0)return this.toast.open("Column:J  Row: "+h+" Addition factor should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.enable_binding_parameter=t[h][15],null!=this.enable_binding_parameter&&""!==this.enable_binding_parameter){let y="";if("boolean"==typeof this.enable_binding_parameter?y=JSON.stringify(this.enable_binding_parameter).trim().toLowerCase():0==isNaN(this.enable_binding_parameter)||(y=this.enable_binding_parameter.trim().toLowerCase()),y!==r&&y!==u)return this.toast.open("Column:P  Row: "+h+" Enable Binding Parameter must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(y!==u&&y!==r)return this.toast.open("Column:P  Row: "+h+" Enable Binding Parameter must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(y==r||y==u)&&(this.enable_binding_parameter=y)}else this.enable_binding_parameter=u;if(null==t[h][10]||""===t[h][10])return this.toast.open("Column:K  Row: "+h+" Control Type should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==t[h][11]||""===t[h][11])return this.toast.open("Column:L  Row: "+h+" Step should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});this.ADD_finalData.PK=t[h][0].trim(),this.ADD_finalData.SK=this.SK_clientID,this.ADD_finalData.parameters=[],this.renameKeys[1]="parameterID",this.renameKeys[2]="parameterLabel",this.renameKeys[3]="parameterDescription",this.renameKeys[4]="start_address",this.renameKeys[5]="variable_type",this.renameKeys[6]="min",this.renameKeys[7]="max",this.renameKeys[8]="mX_C_X_Multiplication_Factor",this.renameKeys[9]="mX_C_C_Addition_Factor",this.renameKeys[10]="control_type",this.renameKeys[11]="step",this.renameKeys[12]="rdt",this.renameKeys[13]="count_binding_parameter",this.renameKeys[14]="binding_parameter",this.renameKeys[15]="enable_binding_parameter",this.renameKeys[21]="dropdownLabel_value";let A=21;for(let y=1;y<=t[h][21];y++,A++)if(l.push({dropdown_label:t[h][A+y],dropdown_value:t[h][A+y+1]}),!0===isNaN(t[h][A+y+1])){if(A+y+1==23)return this.toast.open("Column:X  Row: "+h+" Value should be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(A+y+1==25)return this.toast.open("Column:Z  Row: "+h+" Value should be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}console.log("dropdown_label_value",l);for(let y=0;y<t[0].length;y++)null==t[h][y]?t[h][y]=null:(21==y&&(t[h][y]=JSON.stringify(l.length)),this.ADD_finalData[this.renameKeys[y]]=t[h][y]);delete this.ADD_finalData.undefined,this.ADD_finalData.updated=new Date,this.ADD_finalData.enable_binding_parameter=this.enable_binding_parameter,this.ADD_finalData.dropdownLabel_value=JSON.stringify(l),console.log("this.ADD_finalData",this.ADD_finalData);const U=JSON.parse(JSON.stringify(this.ADD_finalData));i.push(U);let S=[];for(let y=0;y<i.length;y++)S.push({PK:i[y].PK,SK:i[y].SK,updated:i[y].updated});const R=S.map(y=>y.PK),M=S.filter(({PK:y},c)=>!R.includes(y,c+1));let L=[];for(let y=0;y<M.length;y++)L.push({PK:M[y].PK,SK:M[y].SK,parameters:[],updated:M[y].updated});for(let y=0;y<i.length;y++)for(let c=0;c<L.length;c++)"PK"in L[c]&&L[c].PK==i[y].PK?L[c].parameters.push({parameterID:i[y].parameterID,parameterLabel:i[y].parameterLabel,parameterDescription:i[y].parameterDescription,start_address:i[y].start_address,variable_type:i[y].variable_type,min:i[y].min,max:i[y].max,mX_C_X_Multiplication_Factor:i[y].mX_C_X_Multiplication_Factor,mX_C_C_Addition_Factor:i[y].mX_C_C_Addition_Factor,control_type:i[y].control_type,dropdownLabel_value:i[y].dropdownLabel_value,step:i[y].step,rdt:i[y].rdt,count_binding_parameter:i[y].count_binding_parameter,binding_parameter:i[y].binding_parameter,enable_binding_parameter:i[y].enable_binding_parameter}):"PK"in L[c]||(L[c].PK=i[y].PK,L[c].parameters=[],L[c].parameters.push({parameterID:i[y].parameterID,parameterLabel:i[y].parameterLabel,parameterDescription:i[y].parameterDescription,start_address:i[y].start_address,variable_type:i[y].variable_type,min:i[y].min,max:i[y].max,mX_C_X_Multiplication_Factor:i[y].mX_C_X_Multiplication_Factor,mX_C_C_Addition_Factor:i[y].mX_C_C_Addition_Factor,control_type:i[y].control_type,dropdownLabel_value:i[y].dropdownLabel_value,step:i[y].step,rdt:i[y].rdt,count_binding_parameter:i[y].count_binding_parameter,binding_parameter:i[y].binding_parameter,enable_binding_parameter:i[y].enable_binding_parameter}));this.tempMultiParams=L}this.xlfileValid=!0,localStorage.setItem("step4Validation",JSON.stringify(this.xlfileValid)),this.updateParentModel(this.form.value,this.xlfileValid),console.log("Final Object :",this.tempMultiParams),this.updateData(this.tempMultiParams)}}updateData(t){this.tempMultiParams=t,this.dataChange.emit(this.tempMultiParams)}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(B.t),e.Y36(ie.ux),e.Y36(e.sBO),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step4temp"]],inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",hideDeleteButton:"hideDeleteButton",editOperation:"editOperation"},outputs:{dataChange:"dataChange"},decls:32,vars:4,consts:[[1,"pb-10","pb-lg-15"],[1,"fw-bolder","text-dark"],[1,"fv-row",3,"formGroup"],[1,"row"],[1,"col"],["formControlName","wdt_by_type","name","wdt_by_type","type","radio","id","kt_create_account_form_account_type_corporate","value","type_1",1,"btn-check"],["for","kt_create_account_form_account_type_corporate","id","btn1_wdt","ngbTooltip","Select from a list of pre-configured Writing Device Type",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center"],["name","briefcase",1,"fs-1","me-5"],[1,"d-block","fw-bold","text-start"],[1,"text-dark","fw-bolder","d-block","fs-4","mb-2"],[1,"text-gray-400","fw-bold","fs-6"],["formControlName","wdt_by_type","name","wdt_by_type","type","radio","id","kt_create_account_form_account_type_personal","value","type_2",1,"btn-check"],["for","kt_create_account_form_account_type_personal","id","btn2_wdt","ngbTooltip","Automatically create a Writing Device type with default settings, auto generated Parameter labels , IDs. Ideal for Quickly adding configuration,This option simplifies the configurations",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],[1,"bi","bi-lightning-charge-fill","fs-1","me-4"],["formControlName","wdt_by_type","name","wdt_by_type","type","radio","id","xlsx_wdt","value","type_3",1,"btn-check"],["for","xlsx_wdt","id","btn3_wdt","ngbTooltip","Create a Writing Device Type by importing settings from an XLSX file. This method allows for detailed customization of labels and inputs specific to your needs",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],[1,"bi","bi-file-earmark-spreadsheet-fill","fs-1","me-4"],["class","row",4,"ngIf"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["ngbTooltip","Automatically generate a Writing Device Type with an assigned WDT ID",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","wdtName","type","text","placeholder","Enter The WDT ID",1,"form-control","form-control-solid",3,"keyup"],[1,"fv-plugins-message-container","invalid-feedback"],[4,"ngIf","ngIfElse"],["defaultErrorMessagewdt",""],[1,"col","mb-7"],["ngbTooltip","Provide number of parameters associated with the WDT",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","wdt_no_of_param","type","number","placeholder","Enter no of param","appPreventScroll","",1,"form-control","form-control-solid"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[4,"ngIf"],[1,"row","mb-7"],[1,"col-sm-6"],["ngbTooltip","Upload an XLSX file to import a Writing Device Type. Ensure the file is formatted correctly with columns for labels, IDs, and any other necessary device parameters. This method allows for precise customization of your device configuration",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","file","type","file","placeholder","Enter no of param","accept",".xlsx",1,"form-control","form-control-solid",3,"change"],["style","color: #1B84FF;",4,"ngIf","ngIfElse"],["notSelected",""],[1,"col",2,"margin-top","4.3%"],["type","button",1,"btn","fw-bold","custom-primary","btn-sm","export-button",3,"click"],[1,"bi","bi-file-earmark-arrow-down-fill",2,"font-size","16px","margin-bottom","1%"],[2,"color","#1B84FF"],[1,"d-flex","flex-column","mb-7","fv-row"],["ngbTooltip","Select Existing Writing Device Type",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["class","form-select form-select-solid form-select-lg  gridster-item-content","formControlName","wdtID",4,"ngIf"],["defaultErrorExisting",""],["formControlName","wdtID",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["disabled","",3,"value","selected"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Writing Device Type Configuration(WDT)"),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"input",5),e.TgZ(7,"label",6),e._UZ(8,"app-keenicon",7),e.TgZ(9,"span",8)(10,"span",9),e._uU(11,"Use Existing WDT"),e.qZA(),e._UZ(12,"span",10),e.qZA()()(),e.TgZ(13,"div",4),e._UZ(14,"input",11),e.TgZ(15,"label",12),e._UZ(16,"i",13),e.TgZ(17,"span",8)(18,"span",9),e._uU(19,"Quick Add WDT"),e.qZA(),e._UZ(20,"span",10),e.qZA()()(),e.TgZ(21,"div",4),e._UZ(22,"input",14),e.TgZ(23,"label",15),e._UZ(24,"i",16),e.TgZ(25,"span",8)(26,"span",9),e._uU(27,"Create WDT via Excel"),e.qZA(),e._UZ(28,"span",10),e.qZA()()()(),e.YNc(29,ct,19,3,"div",17),e.YNc(30,pt,17,2,"div",17),e.YNc(31,vt,11,3,"div",17),e.qZA()),2&t){let o,r,u;e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(26),e.Q6J("ngIf","type_2"===(null==(o=i.form.get("wdt_by_type"))?null:o.value)),e.xp6(1),e.Q6J("ngIf","type_3"===(null==(r=i.form.get("wdt_by_type"))?null:r.value)),e.xp6(1),e.Q6J("ngIf","type_1"===(null==(u=i.form.get("wdt_by_type"))?null:u.value))}},dependencies:[q.sg,q.O5,g.YN,g.Kr,g.Fj,g.wV,g.EJ,g._,g.JJ,g.JL,g.sg,g.u,J._L,se.q,oe],styles:[".btn-check[_ngcontent-%COMP%]:checked + #btn1_wdt[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-check.btn-check[_ngcontent-%COMP%]:checked + #btn2_wdt[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-check[_ngcontent-%COMP%]:checked + #btn3_wdt[_ngcontent-%COMP%]{background-color:var(--bs-stepper-icon-bg-color-completed)}.btn-outline[_ngcontent-%COMP%]:hover{border:solid 1px}.export-button[_ngcontent-%COMP%]{background-color:#ffc700;color:#fff;font-size:14px}.export-button[_ngcontent-%COMP%]:hover{background-color:#ffc700;color:#fff;opacity:.9;transform:translateY(-2px);transition:.5s}"]})),p})();var be=w(70053);function yt(n,p){if(1&n&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function Dt(n,p){if(1&n&&(e.TgZ(0,"select",72)(1,"option",28),e._uU(2,"Select Company ID"),e.qZA(),e.YNc(3,yt,2,2,"option",73),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",s.companyList)}}function Zt(n,p){if(1&n&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ","None"==s?s.toUpperCase():s," ")}}function Tt(n,p){if(1&n&&(e.TgZ(0,"select",75)(1,"option",28),e._uU(2,"Select Operational Hours"),e.qZA(),e.YNc(3,Zt,2,2,"option",73),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",s.opsList_Device)}}function Ct(n,p){if(1&n&&(e.TgZ(0,"option",74),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s.P1),e.xp6(1),e.hij(" ",s.P1," ")}}function It(n,p){if(1&n&&(e.TgZ(0,"div",50)(1,"label",5)(2,"span"),e._uU(3,"Select MQTT"),e.qZA(),e._UZ(4,"i",76),e.qZA(),e.TgZ(5,"select",77)(6,"option",28),e._uU(7,"Select MQTT"),e.qZA(),e.YNc(8,Ct,2,2,"option",73),e.qZA()()),2&n){const s=e.oxw();e.xp6(6),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",s.mqttItems)}}function xt(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",78)(1,"div",79),e._UZ(2,"input",80)(3,"input",81),e._uU(4," \xa0 "),e.TgZ(5,"button",82),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.remove(i.index))}),e._UZ(6,"span",83),e.qZA(),e._uU(7," \xa0 "),e.qZA()()}2&n&&(e.Q6J("formGroupName",p.index),e.xp6(6),e.Q6J("inlineSVG","./assets/media/icons/duotune/arrows/arr061.svg"))}let At=(()=>{var n;class p{constructor(t,i,o,r,u,l){(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"metaData",new e.vpe),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"companyList",[]),(0,a.Z)(this,"data_temp",[]),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"SK_clientID",void 0),(0,a.Z)(this,"opsList_Device",[]),(0,a.Z)(this,"opsList_Alerts",[]),(0,a.Z)(this,"index",void 0),(0,a.Z)(this,"metadataForm",void 0),(0,a.Z)(this,"lookup_data_company",[]),(0,a.Z)(this,"user_companyID",void 0),(0,a.Z)(this,"lookup_data_user",[]),(0,a.Z)(this,"mqttItems",[]),this.cdr=t,this.api=i,this.fb=o,this.companyConfiguration=r,this.getDiagnostics=u,this.operationalscheduleType=l}ngAfterViewInit(){this.form.get("device_timeout")?.patchValue(this.defaultValues.device_timeout)}ngOnInit(){this.metadataForm=this.fb.group({metadata:this.fb.array([])}),this.metadataForm.valueChanges.subscribe(()=>{this.metaData.emit(this.metadataForm)}),this.initForm(),this.updateParentModel({},this.checkForm()),this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.user_companyID=this.getLoggedUser.attributes["custom:companyID"],this.getCompany(1),this.getOperational(1),this.fetchMqtt(1),0==this.hideDeleteButton&&this.form.disable()}initForm(){this.form=this.fb.group({company_id:[this.defaultValues.company_id,[g.kI.required]],operational_hours:[this.defaultValues.operational_hours],device_timeout:[this.defaultValues.device_timeout],trans_timeout:[this.defaultValues.trans_timeout],alert_timeout:[this.defaultValues.alert_timeout],device_list:[this.defaultValues.device_list],primary_devices:[this.defaultValues.primary_devices],secondary_devices:[this.defaultValues.secondary_devices],monthly_schedule:[this.defaultValues.monthly_schedule],disable_alerts:[this.defaultValues.disable_alerts],device_profile:[this.defaultValues.device_profile],block_number:[this.defaultValues.block_number],x_axis:[this.defaultValues.x_axis],y_axis:[this.defaultValues.y_axis],z_axis:[this.defaultValues.z_axis],enable_device:[this.defaultValues.enable_device],redundant:[this.defaultValues.redundant],customSchedule:[this.defaultValues.customSchedule],critical:[this.defaultValues.critical],report:[this.defaultValues.report],dashboard:[this.defaultValues.dashboard],alerts_duration:[this.defaultValues.alerts_duration],reserved:[this.defaultValues.reserved]});const t=this.form.valueChanges.subscribe(i=>{this.updateParentModel(i,this.checkForm())});this.unsubscribe.push(t)}checkForm(){return!this.form.get("company_id")?.hasError("required")}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}fetchMqtt(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.SK_clientID+"#mqtt",t);if(o&&o.items){let r=JSON.parse(o.items);if(Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v}=l[d];i.mqttItems.push({P1:f,P2:m,P3:v}),console.log("d2 =",i.mqttItems)}}yield i.fetchMqtt(t+1)}else console.error("Invalid data format - not an array.");console.log("MQtt table data is",i.mqttItems),i.form.get("reserved")?.patchValue(i.defaultValues.reserved)}}catch(o){console.error("Error:",o)}})()}getCompany(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.SK_clientID+"#company",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v}=l[d];i.lookup_data_company.push({P1:f,P2:m,P3:v}),console.log("d2 =",i.lookup_data_company)}}i.lookup_data_company.sort((u,l)=>l.P3-u.P3),console.log("Lookup sorting",i.lookup_data_company),yield i.getCompany(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Comapny to be displayed to be displayed",i.lookup_data_company),i.companyList=[];for(let r=0;r<i.lookup_data_company.length;r++)i.companyList.push(i.lookup_data_company[r]?.P1);console.log("unique sk values",i.companyList),i.form.get("company_id")?.patchValue(i.defaultValues.company_id),i.form.get("reserved")?.patchValue(i.defaultValues.reserved)}}catch(o){console.error("Error:",o)}i.cdr.detectChanges()})()}getOperational(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.SK_clientID+"#operationalschedule",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v}=l[d];i.lookup_data_user.push({P1:f,P2:m,P3:v}),console.log("d2 =",i.lookup_data_user)}}i.lookup_data_user.sort((u,l)=>l.P3-u.P3),console.log("Lookup sorting",i.lookup_data_user),yield i.getOperational(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",i.lookup_data_user);for(let r=0;r<=i.lookup_data_user.length;r++)0==r&&(i.opsList_Alerts.push("Disabled"),i.opsList_Device.push("None"),i.opsList_Alerts.push("None")),1==r&&i.opsList_Alerts.push("Always"),0!==r&&(i.opsList_Alerts.push(i.lookup_data_user[r-1]?.P1+"-"+i.lookup_data_user[r-1]?.P2),i.opsList_Device.push(i.lookup_data_user[r-1]?.P1+"-"+i.lookup_data_user[r-1]?.P2));console.log("result op list",i.opsList_Device),i.form.get("operational_hours")?.patchValue(i.defaultValues.operational_hours),i.cdr.detectChanges()}}catch(o){console.error("Error:",o)}})()}createItem(){return this.fb.group({key:new g.NI([""]),value:new g.NI([""])})}get metadata(){return this.metadataForm.get("metadata")}remove(t){this.metadataForm.get("metadata").removeAt(t)}add(){this.metadata.push(this.createItem())}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(B.t),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(P.F))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-step5t"]],inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",hideDeleteButton:"hideDeleteButton"},outputs:{metaData:"metaData"},decls:201,vars:12,consts:[[1,"pb-10","pb-lg-15"],[1,"fw-bolder","d-flex","align-items-center","text-dark"],[3,"formGroup"],[1,"row","mb-7"],[1,"col","d-flex","flex-column"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["ngbTooltip","Specify ID assigned to the company associated with this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["class","form-select form-select-solid form-select-lg  gridster-item-content","formControlName","company_id","name","company_id",4,"ngIf"],["ngbTooltip","Provide operational hours of the device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["class","form-select form-select-solid form-select-lg  gridster-item-content","formControlName","operational_hours","name","operational_hours",4,"ngIf"],["ngbTooltip","Provide duration after which the device times out",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","device_timeout","formControlName","device_timeout","required","",1,"form-select","form-select-solid","form-select-lg"],["value","null","disabled","true",3,"selected"],["value","Disabled"],["value","15_minute"],["value","30_minute"],["value","1_hour"],["value","6_hour"],["value","12_hour"],["value","1_day"],["value","7_day"],["ngbTooltip","Specify duration after which transmission times out",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","min","1","placeholder","Enter Transmission Interval","name","trans_timeout","formControlName","trans_timeout","required","","appPreventScroll","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["ngbTooltip","Specify duration after which alerts time out",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","alert_timeout","appPreventScroll","","formControlName","alert_timeout","placeholder","Alert Timeout",1,"form-control","form-control-solid"],["ngbTooltip","A list of devices associated with this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","device_list","name","device_list",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["disabled","",3,"value","selected"],["value","NONE"],["value","MG2GFRP1"],["value","PIR_test1"],["ngbTooltip","Select primary devices linked to this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","primary_devices","name","primary_devices",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["ngbTooltip","Select secondary devices linked to this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","secondary_devices","name","secondary_devices",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["ngbTooltip","Specify schedule followed by the device on a monthly basis",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","monthly_schedule","formControlName","monthly_schedule","placeholder","Monthly Schedule","appPreventScroll","",1,"form-control","form-control-solid"],["ngbTooltip","Indicates whether alerts are currently disabled for this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","datetime-local","max","9999-12-31T23:59","min","0001-01-01T00:00","name","alerts_duration","formControlName","alerts_duration","placeholder","Monthly Schedule",1,"form-control","form-control-solid"],["ngbTooltip","Specify profile assigned to this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","device_profile","name","device_profile",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["value","THC DCH1"],["value","THC DCH2"],["ngbTooltip","Provide block number assigned to this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","block_number","formControlName","block_number","placeholder","Block Number","appPreventScroll","",1,"form-control","form-control-solid"],["ngbTooltip","The value of the X-axis for this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","x_axis","formControlName","x_axis","placeholder","X-axis","appPreventScroll","",1,"form-control","form-control-solid"],["ngbTooltip","The value of the Y-axis for this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","y_axis","formControlName","y_axis","placeholder","Y-axis","appPreventScroll","",1,"form-control","form-control-solid"],[1,"col-sm-6","d-flex","flex-column"],["ngbTooltip","The value of the Z-axis for this device",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","name","z_axis","formControlName","z_axis","placeholder","z-axis","appPreventScroll","",1,"form-control","form-control-solid"],["class","col-sm-6 d-flex flex-column",4,"ngIf"],[1,"row"],[1,"col-sm"],[1,"form-check","form-check-inline","form-check-solid","me-5"],["name","checkDevice","checked","","type","checkbox","formControlName","enable_device",1,"form-check-input"],[1,"fw-bold","ps-2","fc-8"],["name","customSchedule","type","checkbox","checked","","formControlName","customSchedule",1,"form-check-input"],["name","redundant","type","checkbox","checked","","formControlName","redundant",1,"form-check-input"],[1,"row","mt-6"],["name","critical","type","checkbox","checked","","formControlName","critical",1,"form-check-input"],["name","disable_alerts","type","checkbox","checked","","formControlName","disable_alerts",1,"form-check-input"],["name","report","type","checkbox","checked","","formControlName","report",1,"form-check-input"],["name","dashboard","type","checkbox","checked","","formControlName","dashboard",1,"form-check-input"],[1,"row","mt-5"],["type","button","ngbTooltip","Add Carefully!!!",1,"btn","btn-sm","btn-icon","btn-primary","me-2",2,"font-size","5px",3,"click"],[1,"svg-icon","svg-icon-3",3,"inlineSVG"],[1,"col-lg-12"],["formArrayName","metadata"],[3,"formGroupName",4,"ngFor","ngForOf"],["formControlName","company_id","name","company_id",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","operational_hours","name","operational_hours",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["ngbTooltip","select the mqtt id",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","reserved","formControlName","reserved",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],[3,"formGroupName"],[2,"margin","2px","display","flex","align-items","center"],["type","text","formControlName","key","placeholder","key",1,"form-control","key-class"],["type","text","formControlName","value","placeholder","value",1,"form-control","key-class"],["type","button","ngbTooltip","Delete Carefully!!!",1,"btn","btn-sm","btn-icon","btn-danger",2,"font-size","10px","margin-top","1%",3,"click"],[1,"svg-icon","svg-icon-1",3,"inlineSVG"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2," Other Settings "),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5)(7,"span",6),e._uU(8,"Company ID"),e.qZA(),e._UZ(9,"i",7),e.qZA(),e.YNc(10,Dt,4,2,"select",8),e.qZA(),e.TgZ(11,"div",4)(12,"label",5)(13,"span"),e._uU(14,"Operational Hours"),e.qZA(),e._UZ(15,"i",9),e.qZA(),e.YNc(16,Tt,4,2,"select",10),e.qZA()(),e.TgZ(17,"div",3)(18,"div",4)(19,"label",5)(20,"span"),e._uU(21,"Device Timeout"),e.qZA(),e._UZ(22,"i",11),e.qZA(),e.TgZ(23,"select",12)(24,"option",13),e._uU(25,"Select Device Timeout"),e.qZA(),e.TgZ(26,"option",14),e._uU(27,"Disabled"),e.qZA(),e.TgZ(28,"option",15),e._uU(29,"15 Minute"),e.qZA(),e.TgZ(30,"option",16),e._uU(31,"30 Minute"),e.qZA(),e.TgZ(32,"option",17),e._uU(33,"1 Hour"),e.qZA(),e.TgZ(34,"option",18),e._uU(35,"6 Hour"),e.qZA(),e.TgZ(36,"option",19),e._uU(37,"12 Hour"),e.qZA(),e.TgZ(38,"option",20),e._uU(39,"1 Day"),e.qZA(),e.TgZ(40,"option",21),e._uU(41,"7 Day"),e.qZA()()(),e.TgZ(42,"div",4)(43,"label",5)(44,"span"),e._uU(45,"Transmission Interval Time"),e.qZA(),e._UZ(46,"i",22),e.qZA(),e._UZ(47,"input",23),e.qZA()(),e.TgZ(48,"div",3)(49,"div",4)(50,"label",5)(51,"span"),e._uU(52,"Alert Timeout"),e.qZA(),e._UZ(53,"i",24),e.qZA(),e._UZ(54,"input",25),e.qZA(),e.TgZ(55,"div",4)(56,"label",5)(57,"span"),e._uU(58,"Devices list"),e.qZA(),e._UZ(59,"i",26),e.qZA(),e.TgZ(60,"select",27)(61,"option",28),e._uU(62,"Select Devices"),e.qZA(),e.TgZ(63,"option",29),e._uU(64,"NONE"),e.qZA(),e.TgZ(65,"option",30),e._uU(66,"MG2GFRP1"),e.qZA(),e.TgZ(67,"option",31),e._uU(68,"PIR_test1"),e.qZA()()()(),e.TgZ(69,"div",3)(70,"div",4)(71,"label",5)(72,"span"),e._uU(73,"Primary Devices"),e.qZA(),e._UZ(74,"i",32),e.qZA(),e.TgZ(75,"select",33)(76,"option",28),e._uU(77,"Select Devices"),e.qZA(),e.TgZ(78,"option",29),e._uU(79,"NONE"),e.qZA(),e.TgZ(80,"option",30),e._uU(81,"MG2GFRP1"),e.qZA(),e.TgZ(82,"option",31),e._uU(83,"PIR_test1"),e.qZA()()(),e.TgZ(84,"div",4)(85,"label",5)(86,"span"),e._uU(87,"Secondary Devices"),e.qZA(),e._UZ(88,"i",34),e.qZA(),e.TgZ(89,"select",35)(90,"option",28),e._uU(91,"Select Devices"),e.qZA(),e.TgZ(92,"option",29),e._uU(93,"NONE"),e.qZA(),e.TgZ(94,"option",30),e._uU(95,"MG2GFRP1"),e.qZA(),e.TgZ(96,"option",31),e._uU(97,"PIR_test1"),e.qZA()()()(),e.TgZ(98,"div",3)(99,"div",4)(100,"label",5)(101,"span"),e._uU(102,"Monthly Schedule Calculation Day"),e.qZA(),e._UZ(103,"i",36),e.qZA(),e._UZ(104,"input",37),e.qZA(),e.TgZ(105,"div",4)(106,"label",5)(107,"span"),e._uU(108,"Disable Alerts(Duration)"),e.qZA(),e._UZ(109,"i",38),e.qZA(),e._UZ(110,"input",39),e.qZA()(),e.TgZ(111,"div",3)(112,"div",4)(113,"label",5)(114,"span"),e._uU(115,"Device Profile"),e.qZA(),e._UZ(116,"i",40),e.qZA(),e.TgZ(117,"select",41)(118,"option",28),e._uU(119,"Select Device Profile"),e.qZA(),e.TgZ(120,"option",29),e._uU(121,"NONE"),e.qZA(),e.TgZ(122,"option",42),e._uU(123,"THC DCH1"),e.qZA(),e.TgZ(124,"option",43),e._uU(125,"THC DCH2"),e.qZA()()(),e.TgZ(126,"div",4)(127,"label",5)(128,"span"),e._uU(129,"Block Number"),e.qZA(),e._UZ(130,"i",44),e.qZA(),e._UZ(131,"input",45),e.qZA()(),e.TgZ(132,"div",3)(133,"div",4)(134,"label",5)(135,"span"),e._uU(136,"X-axis"),e.qZA(),e._UZ(137,"i",46),e.qZA(),e._UZ(138,"input",47),e.qZA(),e.TgZ(139,"div",4)(140,"label",5)(141,"span"),e._uU(142,"Y-axis"),e.qZA(),e._UZ(143,"i",48),e.qZA(),e._UZ(144,"input",49),e.qZA()(),e.TgZ(145,"div",3)(146,"div",50)(147,"label",5)(148,"span"),e._uU(149,"Z-axis"),e.qZA(),e._UZ(150,"i",51),e.qZA(),e._UZ(151,"input",52),e.qZA(),e.YNc(152,It,9,2,"div",53),e.qZA(),e.TgZ(153,"div",54)(154,"div",55)(155,"label",56),e._UZ(156,"input",57),e.TgZ(157,"span",58),e._uU(158,"Enable Device"),e.qZA()()(),e.TgZ(159,"div",55)(160,"label",56),e._UZ(161,"input",59),e.TgZ(162,"span",58),e._uU(163,"Custom Schedule "),e.qZA()()(),e.TgZ(164,"div",55)(165,"label",56),e._UZ(166,"input",60),e.TgZ(167,"span",58),e._uU(168,"Redundant "),e.qZA()()()(),e.TgZ(169,"div",61)(170,"div",55)(171,"label",56),e._UZ(172,"input",62),e.TgZ(173,"span",58),e._uU(174,"Critical "),e.qZA()()(),e.TgZ(175,"div",55)(176,"label",56),e._UZ(177,"input",63),e.TgZ(178,"span",58),e._uU(179,"Disable Alerts "),e.qZA()()(),e.TgZ(180,"div",55)(181,"label",56),e._UZ(182,"input",64),e.TgZ(183,"span",58),e._uU(184,"Report "),e.qZA()()()(),e.TgZ(185,"div",61)(186,"div",55)(187,"label",56),e._UZ(188,"input",65),e.TgZ(189,"span",58),e._uU(190,"Dashboard "),e.qZA()()()(),e.TgZ(191,"div",66)(192,"div",55)(193,"button",67),e.NdJ("click",function(){return i.add()}),e._UZ(194,"span",68),e.qZA(),e.TgZ(195,"label",58),e._uU(196,"Metadata"),e.qZA()(),e.TgZ(197,"div",69)(198,"form",2)(199,"div",70),e.YNc(200,xt,8,2,"div",71),e.qZA()()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(7),e.Q6J("ngIf",i.companyList),e.xp6(6),e.Q6J("ngIf",i.opsList_Device),e.xp6(8),e.Q6J("selected",!0),e.xp6(37),e.Q6J("value",null),e.xp6(15),e.Q6J("value",null),e.xp6(14),e.Q6J("value",null),e.xp6(28),e.Q6J("value",null),e.xp6(34),e.Q6J("ngIf",i.mqttItems.length>0||null!=i.defaultValues.reserved),e.xp6(42),e.Q6J("inlineSVG","./assets/media/icons/duotune/arrows/arr075.svg"),e.xp6(4),e.Q6J("formGroup",i.metadataForm),e.xp6(2),e.Q6J("ngForOf",i.metadata.controls))},dependencies:[q.sg,q.O5,g._Y,g.YN,g.Kr,g.Fj,g.wV,g.Wl,g.EJ,g.JJ,g.JL,g.Q7,g.qQ,g.sg,g.u,g.x0,g.CE,J._L,be.d$,oe],styles:[".key-class[_ngcontent-%COMP%]{width:30%;margin-top:10px;margin-right:10px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}"]})),p})();const Pt=["closeModal"],wt=["closeAlert"];function St(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.redirectnewconfig())}),e._UZ(1,"i",40),e._uU(2,"Add"),e.qZA()}if(2&n){const s=e.oxw();e.Q6J("disabled",1===s.currentStep$.value&&0==s.EditOperation)}}function kt(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"app-step1",41),e.NdJ("valueChanged",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.handleValueChanged(i))})("dataEvent",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.handleData(i))}),e.qZA(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("editOperation",s.EditOperation)("hideDeleteButton",s.hideDeleteButton)("lookupdeviceData",s.lookup_data_user)("currMAC",s.currMAC)}}function qt(n,p){if(1&n&&(e.ynx(0),e._UZ(1,"app-step2",42),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("editOperation",s.EditOperation)("hideDeleteButton",s.hideDeleteButton)}}function Nt(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"app-step3",43),e.NdJ("dataChange",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.onDataChange(i))}),e.qZA(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("hideDeleteButton",s.hideDeleteButton)("editOperation",s.EditOperation)("lookupdeviceData",s.lookup_data_user)("adminUser",s.showAlldevice)}}function Ut(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"app-step4temp",44),e.NdJ("dataChange",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.onDataChangeWDT(i))}),e.qZA(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("hideDeleteButton",s.hideDeleteButton)("editOperation",s.EditOperation)}}function Lt(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"app-step5t",45),e.NdJ("metaData",function(i){e.CHM(s);const o=e.oxw();return e.KtG(o.checkData(i))}),e.qZA(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("hideDeleteButton",s.hideDeleteButton)}}function Mt(n,p){if(1&n&&(e.ynx(0),e._UZ(1,"app-step5",46),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("editOperation",s.EditOperation)}}function Ot(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"button",47),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.prevStep())}),e._UZ(2,"i",48),e._uU(3," Back "),e.qZA(),e.BQk()}}function Rt(n,p){1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n&&(e.xp6(1),e.hij(" Continue "," "," "))}function Ft(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"button",49),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.nextStep())}),e.TgZ(3,"span",50),e.YNc(4,Rt,2,1,"ng-container",24),e.qZA(),e._UZ(5,"i",51),e.qZA()(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(2),e.Q6J("disabled",!s.isCurrentFormValid$.value),e.xp6(2),e.Q6J("ngIf",s.currentStep$.value<s.formsCount-1)}}function Jt(n,p){1&n&&(e.ynx(0),e._uU(1," Submit "),e.BQk())}function Et(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(s);const i=e.oxw(2);return e.KtG(i.OnSubmit())}),e.TgZ(1,"span",50),e.YNc(2,Jt,2,0,"ng-container",24),e.qZA()()}if(2&n){const s=e.oxw(2);e.Q6J("disabled",!s.isCurrentFormValid$.value||!s.hideDeleteButton),e.xp6(2),e.Q6J("ngIf",s.currentStep$.value===s.formsCount-1)}}function $t(n,p){1&n&&(e.ynx(0),e._uU(1," Update "),e.BQk())}function Bt(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(s);const i=e.oxw(2);return i.updateDeviceConfiguration(i.account$.value,"device"),e.KtG(i.nextStep())}),e.TgZ(1,"span",50),e.YNc(2,$t,2,0,"ng-container",24),e.qZA()()}if(2&n){const s=e.oxw(2);e.Q6J("disabled",!s.isCurrentFormValid$.value||"Device Name already exists"==s.errorForUniqueID||!s.hideDeleteButton),e.xp6(2),e.Q6J("ngIf",s.currentStep$.value===s.formsCount-1)}}function Kt(n,p){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e.YNc(2,Et,3,2,"button",52),e.YNc(3,Bt,3,2,"ng-template",null,53,e.W1O),e.qZA(),e.BQk()),2&n){const s=e.MAs(4),t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.EditOperation)("ngIfElse",s)}}function Vt(n,p){1&n&&(e.TgZ(0,"tr",55)(1,"th"),e._uU(2,"MN"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"MN Label"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Reading Device Type"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"MAC ID"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Company ID"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Updated At"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Alert"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Edit"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Delete"),e.qZA()())}function zt(n,p){1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"MN"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"MN Label"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Reading Device Type"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"MAC ID"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Company ID"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Updated At"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Alert"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Edit"),e.qZA()())}const ne=function(n,p){return{current:n,completed:p}},Qt=function(n){return{current:n}};let Yt=(()=>{var n;class p{constructor(t,i,o,r,u,l,d,f,m,v,h,D,A,U,S,R){(0,a.Z)(this,"deviceState",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"getWritingDeviceType",void 0),(0,a.Z)(this,"getReadingDeviceType",void 0),(0,a.Z)(this,"router",void 0),(0,a.Z)(this,"deviceService",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"cd",void 0),(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"toast",void 0),(0,a.Z)(this,"getPowerBoard",void 0),(0,a.Z)(this,"spinner",void 0),(0,a.Z)(this,"locationPermissionService",void 0),(0,a.Z)(this,"DynamicApi",void 0),(0,a.Z)(this,"auditTrialServices",void 0),(0,a.Z)(this,"closeModal",void 0),(0,a.Z)(this,"closeAlert",void 0),(0,a.Z)(this,"step1Comp",void 0),(0,a.Z)(this,"childComponent",void 0),(0,a.Z)(this,"formsCount",6),(0,a.Z)(this,"account$",new Q.X(_)),(0,a.Z)(this,"currentStep$",new Q.X(1)),(0,a.Z)(this,"isCurrentFormValid$",new Q.X(!1)),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"allDatas",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"operationalScheduleHour_value",""),(0,a.Z)(this,"SK_clientID",void 0),(0,a.Z)(this,"username",void 0),(0,a.Z)(this,"metaData",void 0),(0,a.Z)(this,"rdt",void 0),(0,a.Z)(this,"wdt",void 0),(0,a.Z)(this,"dataform",[]),(0,a.Z)(this,"hideDeleteButton",!0),(0,a.Z)(this,"columnDatatable",[]),(0,a.Z)(this,"deviceTableData",[]),(0,a.Z)(this,"lookup_data_temp1",[]),(0,a.Z)(this,"maxlength",600),(0,a.Z)(this,"alertsDatatable",[]),(0,a.Z)(this,"multi_Alerts",[]),(0,a.Z)(this,"allPermissions_user",[]),(0,a.Z)(this,"data_temp",[]),(0,a.Z)(this,"opsList_Alerts",[]),(0,a.Z)(this,"opsList_Device",[]),(0,a.Z)(this,"rdtList",[]),(0,a.Z)(this,"rdt_ID_alerts",[]),(0,a.Z)(this,"wdtList",[]),(0,a.Z)(this,"companyList",[]),(0,a.Z)(this,"alert_binding_parameter_RDT",void 0),(0,a.Z)(this,"bindingParametersList",[]),(0,a.Z)(this,"parametersList",[]),(0,a.Z)(this,"paramsBasedOnRDT",[]),(0,a.Z)(this,"EditOperation",!1),(0,a.Z)(this,"equation_textarea_string",[]),(0,a.Z)(this,"alert_MN",void 0),(0,a.Z)(this,"alert_MN_label",void 0),(0,a.Z)(this,"alert_RDT",void 0),(0,a.Z)(this,"isParameterID",!1),(0,a.Z)(this,"isConstantID",!1),(0,a.Z)(this,"isEquationID",!1),(0,a.Z)(this,"showUpdateAlertButton",!1),(0,a.Z)(this,"getDialogData",{PK:"",SK:"",device_id:"",reading_device_type:""}),(0,a.Z)(this,"createNewField",void 0),(0,a.Z)(this,"accountForm",void 0),(0,a.Z)(this,"showModal",!1),(0,a.Z)(this,"showHeading",!1),(0,a.Z)(this,"hideUpdateButton",void 0),(0,a.Z)(this,"parametersObj_file",[]),(0,a.Z)(this,"errorForUniqueID",void 0),(0,a.Z)(this,"customInit",void 0),(0,a.Z)(this,"addAlerts",void 0),(0,a.Z)(this,"enableSaveButton",!1),(0,a.Z)(this,"allRDTDetails",void 0),(0,a.Z)(this,"allWDTDetails",void 0),(0,a.Z)(this,"parametersObj_file_WDT",[]),(0,a.Z)(this,"temparray",void 0),(0,a.Z)(this,"dataformDevice",[]),(0,a.Z)(this,"lookup_data_user",[]),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"columnTableData",[]),(0,a.Z)(this,"deviceDateTable",[]),(0,a.Z)(this,"currMAC",void 0),(0,a.Z)(this,"disableAddbutton",!1),(0,a.Z)(this,"user_companyID",void 0),(0,a.Z)(this,"locationTree",void 0),(0,a.Z)(this,"showAlldevice",!1),(0,a.Z)(this,"cloneOperation",!1),(0,a.Z)(this,"updateAccount",(M,L)=>{const y=this.account$.value;console.log("Form values are here ",this.account$.value);const c={...y,...M};this.account$.next(c),this.isCurrentFormValid$.next(L),this.cd.detectChanges(),console.log("AFTER SUBMIT",c)}),this.deviceState=t,this.companyConfiguration=i,this.fb=o,this.getWritingDeviceType=r,this.getReadingDeviceType=u,this.router=l,this.deviceService=d,this.operationalscheduleType=f,this.cd=m,this.api=v,this.toast=h,this.getPowerBoard=D,this.spinner=A,this.locationPermissionService=U,this.DynamicApi=S,this.auditTrialServices=R,this.router.events.subscribe(M=>{M instanceof K.m2&&(console.log("NavigationEnd event in PowerBoard1Component"),_.unifierMAC_ID="",_.deviceName="",_.deviceLabel="",_.rdtName="",_.no_of_param="1",_.rdtID=null,_.rdt_by_type="type_1",_.accountType="",_.wdtName="",_.wdtID=null,_.wdt_no_of_param="1",_.wdt_by_type="type_1",_.company_id=null,_.operational_hours="None",_.device_timeout="1_hour",_.trans_timeout=15,_.alert_timeout=1,_.device_list="NONE",_.primary_devices="NONE",_.secondary_devices="NONE",_.monthly_schedule=1,_.disable_alerts=null,_.alerts_duration=null,_.device_profile=null,_.x_axis=null,_.y_axis=null,_.z_axis=null,_.block_number=null,_.enable_device=!0,_.redundant=null,_.customSchedule=null,_.critical=null,_.report=null,_.dashboard=null,_.alerts_duration=null,_.lgtdName="77.58085013100799",_.latitude="12.92422584151276",_.altitude="",_.reserved=null,this.account$.next(_))})}onDataChange(t){this.parametersObj_file=t,console.log("Final Parameters RDT from the file :",this.parametersObj_file)}onDataChangeWDT(t){this.parametersObj_file_WDT=t,console.log("Final Parameters WDT from the file :",this.parametersObj_file_WDT)}ngOnInit(){var t=this;return(0,C.Z)(function*(){t.getLoggedUser=t.getPowerBoard.getLoggedUserDetails(),t.user_companyID=t.getLoggedUser.attributes["custom:companyID"],t.SK_clientID=t.getLoggedUser.attributes["custom:clientID"],t.clientID=t.getLoggedUser.attributes["custom:clientID"]+"#device",t.username=t.getLoggedUser.attributes["custom:username"],t.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),t.auditTrialServices.audit_trail("2.1","Device","Page Load","Device configuration Page Loaded","1"),yield t.getuserConfiguration(),t.showAlldevice||(yield t.getLocationConfiguration()),t.addFromService(),console.log("replicateInit",_),localStorage.setItem("step3Validation",JSON.stringify(!1)),localStorage.setItem("step4Validation",JSON.stringify(!1)),console.log("Only one time bro"),t.fetchDeviceLookup(1)})()}nextStep(){const t=this.currentStep$.value+1;t>this.formsCount?console.log(this.SK_clientID):this.currentStep$.next(t)}prevStep(){const t=this.currentStep$.value-1;0!==t&&this.currentStep$.next(t)}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}OnSubmit(){this.showAlldevice?(this.nextStep(),console.log("this.currentStep$.value",this.currentStep$.value),console.log("from button AFTER SUBMIT",this.account$.value),this.createNewDevice(this.account$.value)):x().fire({position:"center",text:"You do not have full permissions to view all devices. Adding this device will not make it visible to you. After adding it, you will need to request access from an admin via email to view it. Do you want to Continue?",icon:"warning",allowOutsideClick:!1,confirmButtonText:"Yes, continue",showCancelButton:!0}).then(t=>{t.isConfirmed&&(this.nextStep(),this.cd.detectChanges(),console.log("this.currentStep$.value",this.currentStep$.value),console.log("from button AFTER SUBMIT",this.account$.value),this.createNewDevice(this.account$.value))})}handleValueChanged(t){1==t&&this.newconfig(t)}loadingDeviceList(){$("#datatables").DataTable().destroy(),this.dataformDevice=[],this.lookup_data_user=[],this.spinner.show(),this.fetchDeviceLookup(1)}checkData(t){this.metaData=t.value}fetchDeviceLookup(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.clientID,t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h,P5:D,P6:A,P7:U,P8:S}=l[d];i.lookup_data_user.push({P1:f,P2:m,P3:v,P4:h,P5:D,P6:A,P7:U,P8:S})}}i.lookup_data_user.sort((u,l)=>l.P5-u.P5),console.log("Lookup sorting",i.lookup_data_user),yield i.fetchDeviceLookup(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Devices from the Lookup to be displayed",i.lookup_data_user),i.showAlldevice||(i.lookup_data_user=i.lookup_data_user.filter(r=>i.locationTree&&1==i.locationTree.includes(r.P1))),i.lookup_data_user=(0,Qe.toArray)(new Set(i.lookup_data_user)),i.getTableUser(i.lookup_data_user),i.spinner.hide()}catch(o){console.error("Error:",o)}})()}getTableUser(t){let i="btn btn-sm btn-success editclassdevice",o="btn btn-sm btn-primary editclassdevice ";if(typeof t<"u")for(let d=0;d<t.length;d++)this.dataformDevice.push({mn:t[d].P1,mn_label:t[d].P2,reading_device_type:t[d].P3,mac_id:t[d].P8,company_id:t[d].P4,updatedTime:new Date(1e3*t[d].P5).toDateString()+" "+new Date(1e3*t[d].P5).toLocaleTimeString()});else this.dataformDevice=[];let u=[];if(typeof t<"u")for(let d=0;d<t.length;d++)u[d]=new Date(t[d].updatedTime).toLocaleString(),t[d].updatedTime=u[d];else t=[];!0===this.hideDeleteButton?this.columnTableData.push({defaultContent:"<button class='"+i+"'data-bs-dismiss='modal'><i class='fa fa-bell'></i></button>"},{defaultContent:"<button class='"+o+"'data-bs-dismiss='modal'><i class='fa fa-edit'></i></button>"},{defaultContent:"<button class='btn btn-sm btn-danger editclassdevice '><i class='fa fa-trash'></i></button>"}):this.columnTableData.push({defaultContent:"<button class='"+i+"'data-bs-dismiss='modal'><i class='fa fa-bell'></i></button>"},{defaultContent:"<button class='"+o+"'data-bs-dismiss='modal'><i class='fa fa-edit'></i></button>"}),console.log("columnDatatable",this.columnTableData),console.log("dataform",this.dataformDevice),$("#device_lookup_table").off("click"),$("#device_lookup_table").on("click",".editclassdevice",function(){let d=$(this).closest("tr"),f=l.deviceDateTable.row(d),m=$(this).attr("class");m?.includes("btn-success")?l.showAlertHelper(f.data(),"new"):m?.includes("btn-primary")?(l.showUpdateAlertButton=!1,l.openModalHelper(f.data())):m?.includes("btn-danger")&&l.deleteHelper(f.data())}),this.getLookupTableDevice(this.dataformDevice,this.columnTableData),this.addFromService();let l=this}getLookupTableDevice(t,i){var o=this;return(0,C.Z)(function*(){console.log("chk1 tm",t),console.log("chk2 tm",i);try{o.deviceDateTable&&$.fn.DataTable.isDataTable("#device_lookup_table")&&o.deviceDateTable.destroy();const r={pagingType:"full_numbers",destroy:!0,lengthChange:!0,responsive:!0,data:t,ordering:!0,order:[[5,"desc"]],columnDefs:[{type:"date",targets:5}],dom:"Bfrtip",buttons:[{extend:"colvis",text:"Column Visibility"}],columns:i};o.deviceDateTable=$("#device_lookup_table").DataTable(r)}catch(r){console.error("Error initializing DataTable:",r)}})()}createWDTviaFile(t){var i=this;this.allWDTDetails={PK:this.wdt,SK:this.SK_clientID,wdt_parameter_id:this.wdt,wdt_parameter_label:this.wdt,created:new Date,parameters:JSON.stringify(t[0].parameters),updated:new Date},this.api.CreateWritingDeviceType(this.allWDTDetails).then(function(){var o=(0,C.Z)(function*(r){i.addFromService();let u=JSON.parse(i.allWDTDetails.parameters),l="";l=1==u.length?t[0].parameters[0].parameterID:u.length>1?t[0].parameters[0].parameterID+"...("+u.length+")":"...(0)";const d=Math.ceil((new Date).getTime()/1e3),f={P1:i.allWDTDetails.PK,P2:i.allWDTDetails.wdt_parameter_label,P3:l,P4:d};r?(yield i.createLookUpWdt(f,1),i.toast.open("New Writing Device Type configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})):alert("Error in Creating Writing Device Type Configuration")});return function(r){return o.apply(this,arguments)}}()).catch(o=>{console.log("err for creation",o),this.toast.open("Error in Creating New WDT Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}createRDTviaFile(t){var i=this;this.allRDTDetails={PK:this.rdt,SK:this.SK_clientID,rdtLabel:this.rdt.replace(/_/g," "),dashboard_type:"Dashboard 1",schedule_type:!1,reading_device_type_id:this.rdt,updateTime:1,deviceTimeout:1,mxC:!1,alerts:!1,parameters_view:!1,parameters:JSON.stringify(t[0].parameters),updated:new Date},console.log("after adding RDT",this.allRDTDetails),this.api.CreateReadingDeviceType(this.allRDTDetails).then(function(){var o=(0,C.Z)(function*(r){i.addFromService();let u=JSON.parse(i.allRDTDetails.parameters),l="";console.log("Parameter ID",t[0].parameters[0].parameterID),console.log("parameters all",t[0].parameters),l=1==u.length?t[0].parameters[0].parameterID:u.length>1?t[0].parameters[0].parameterID+"...("+u.length+")":"...(0)";const f=Math.ceil((new Date).getTime()/1e3),m={P1:i.rdt,P2:i.allRDTDetails.rdtLabel,P3:l,P4:f};r?(yield i.createLookUpRdt(m,1),i.toast.open("New Reading Device Type configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})):alert("Error in Creating Reading Device Type Configuration")});return function(r){return o.apply(this,arguments)}}()).catch(o=>{console.log("err for creation",o),this.toast.open("Error in Creating New RDT Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}createNewRDT(t){var i=this;const o=[];for(let r=0;r<t.no_of_param;r++)o.push({parameterDescription:this.rdt+"_RP"+(r+1),parameterID:this.rdt+"_RP"+(r+1),parameterLabel:this.rdt+"_RP"+(r+1),scalingtable:[],scaling_table:!1,schedule_parameter:!1,decimalpoint:1,mX_C_C_Correction_Factor:0,mX_C_X_Multiplication_Factor:1,valuemapping:[],value_mapping:!1});this.allRDTDetails={PK:this.rdt,SK:this.SK_clientID,rdtLabel:this.rdt.replace(/_/g," "),dashboard_type:"Dashboard 1",schedule_type:!1,reading_device_type_id:this.rdt,updateTime:1,deviceTimeout:1,mxC:!1,alerts:!1,parameters_view:!1,parameters:JSON.stringify(o),updated:new Date},console.log("after adding RDT",this.allRDTDetails),this.api.CreateReadingDeviceType(this.allRDTDetails).then(function(){var r=(0,C.Z)(function*(u){i.addFromService();let l=JSON.parse(i.allRDTDetails.parameters),d="";console.log("Parameter ID",o[0].parameterID),console.log("parameters all",o),d=1==l.length?o[0].parameterID:l.length>1?o[0].parameterID+"...("+l.length+")":"...(0)";const m=Math.ceil((new Date).getTime()/1e3),v={P1:i.rdt,P2:i.allRDTDetails.rdtLabel,P3:d,P4:m};u?(yield i.createLookUpRdt(v,1),i.toast.open("New Reading Device Type configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})):alert("Error in Creating Reading Device Type Configuration")});return function(u){return r.apply(this,arguments)}}()).catch(r=>{console.log("err for creation",r),this.toast.open("Error in Creating New RDT Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}createNewWDT(t){var i=this;const o=[];for(let r=0;r<t.wdt_no_of_param;r++)o.push({binding_parameter:[],control_type:"Slider",enable_binding_parameter:null,max:10,min:1,mX_C_C_Addition_Factor:4,mX_C_X_Multiplication_Factor:32,parameterDescription:this.wdt+"_WP"+(r+1),parameterID:this.wdt+"_WP"+(r+1),parameterLabel:this.wdt+"_WP"+(r+1),rdt:this.rdt,start_address:"google.com",step:"1",variable_type:"TCPIP"});this.allWDTDetails={PK:this.wdt,SK:this.SK_clientID,wdt_parameter_id:this.wdt,wdt_parameter_label:this.wdt,created:new Date,parameters:JSON.stringify(o),updated:new Date},this.api.CreateWritingDeviceType(this.allWDTDetails).then(function(){var r=(0,C.Z)(function*(u){i.addFromService();let l=JSON.parse(i.allWDTDetails.parameters),d="";d=1==l.length?l[0].parameterID:l.length>1?l[0].parameterID+"...("+l.length+")":"...(0)";const f=Math.ceil((new Date).getTime()/1e3),m={P1:i.allWDTDetails.PK,P2:i.allWDTDetails.wdt_parameter_label,P3:d,P4:f};u?(yield i.createLookUpWdt(m,1),i.toast.open("New Writing Device Type configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})):alert("Error in Creating Writing Device Type Configuration")});return function(u){return r.apply(this,arguments)}}()).catch(r=>{console.log("err for creation",r),this.toast.open("Error in Creating New WDT Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}createNewDevice(t){var i=this;if("type_2"==t.rdt_by_type)this.rdt=t.rdtName;else if("type_1"==t.rdt_by_type){const l=t.rdtID.split("-");this.rdt=l[0]}else this.rdt=this.parametersObj_file[0].PK;if("type_2"==t.wdt_by_type)this.wdt=t.wdtName;else if("type_1"==t.wdt_by_type){const l=t.wdtID.split("-");this.wdt=l[0]}else this.wdt=this.parametersObj_file_WDT[0].PK;"type_2"==t.rdt_by_type&&this.createNewRDT(t),"type_3"==t.rdt_by_type&&this.createRDTviaFile(this.parametersObj_file),"type_2"==t.wdt_by_type&&this.createNewWDT(t),"type_3"==t.wdt_by_type&&this.createWDTviaFile(this.parametersObj_file_WDT);const o=t.deviceName.trim();this.allDatas={PK:o,SK:this.SK_clientID,unifier_identifier:t.unifierMAC_ID,alerts_duration:t.alerts_duration,block_number:t.block_number,company_id:t.company_id,deviceProfile:t.device_profile,rdt_by_type:t.rdt_by_type,data_interval:t.trans_timeout,reading_device_type:this.rdt,writing_device_type:this.wdt,mn:o,mn_label:t.deviceLabel.trim(),metadata:JSON.stringify(this.metaData),longitude:t.lgtdName,latitude:t.latitude,altitude:t.altitude,operational_hours:t.operational_hours,device_timeout:t.device_timeout,svg_x:t.x_axis,svg_y:t.y_axis,svg_z:t.z_axis,schedule_month_generation_day:t.monthly_schedule,enable_device:t.enable_device,critical:t.critical,customSchedule:t.customSchedule,redundant:t.redundant,disable_alerts:t.disable_alerts,report:t.report,dashboard:t.dashboard,deviceslist:t.device_list,primary_devices:t.primary_devices,secondary_devices:t.secondary_devices,alertslist:"",alert_timeout:t.alert_timeout,reserved:t.reserved,updatedTime:new Date,alerts_configured:this.cloneOperation?JSON.stringify(_.alerts_configured):JSON.stringify([])},console.log("Device values to be added to DB are here  ",this.allDatas);const r=Math.ceil((new Date).getTime()/1e3),u={P1:this.allDatas.PK,P2:this.allDatas.mn_label.trim(),P3:this.allDatas.reading_device_type,P4:this.allDatas.company_id,P5:r,P6:this.allDatas.longitude,P7:this.allDatas.latitude,P8:this.allDatas.unifier_identifier};this.api.CreateDeviceConfiguration(this.allDatas).then(function(){var l=(0,C.Z)(function*(d){if(d)return i.auditTrialServices.audit_trail("2.1","Device","Create",`${i.allDatas.mn_label} Device was created`,"1"),i.showAlldevice||i.DynamicApi.sendData({type:"device_permission",deviceName:i.account$.value.deviceLabel,userName:i.username,clientID:i.SK_clientID}).subscribe(m=>{console.log("Response from Lambda:",m),i.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},m=>{console.error("Error:",m)}),console.log("value added ",d),yield i.createLookUpTimeMachine(u,1),i.addFromService(),i.loadingDeviceList(),x().fire({position:"center",text:"Configuration Added successfully",icon:"success",allowOutsideClick:!1});alert("Error in Creating New Configuration")});return function(d){return l.apply(this,arguments)}}()).catch(l=>{console.log("err for creation",l),this.toast.open("Error in Creating New Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}isJSON(t){try{return JSON.parse(t),!0}catch{return!1}}getDatatable(t){let i="btn btn-sm btn-success selectAll",o="btn btn-sm btn-primary selectAll",r="btn btn-sm btn-danger selectAll";if(typeof t<"u")for(let d=0;d<t.length;d++)this.dataform.push({mn:t[d].P1,mn_label:t[d].P2,reading_device_type:t[d].P3,company_id:t[d].P4,updatedTime:new Date(1e3*t[d].P5).toDateString()+" "+new Date(1e3*t[d].P5).toLocaleTimeString()});else this.dataform=[];let u=[];if(typeof t<"u")for(let d=0;d<t.length;d++)u[d]=new Date(t[d].updatedTime).toLocaleString(),t[d].updatedTime=u[d];else t=[];!0===this.hideDeleteButton?this.columnDatatable.push({defaultContent:"<button class='"+i+"'data-bs-dismiss='modal' ><i class='fa fa-bell'></i></button>"},{defaultContent:"<button class='"+o+"'data-bs-dismiss='modal' ><i class='fa fa-edit'></i></button>"},{defaultContent:"<button class='"+r+"'><i class='fa fa-trash'></i></button>"}):this.columnDatatable.push({defaultContent:"<button class='"+i+"'data-bs-dismiss='modal' ><i class='fa fa-bell'></i></button>"},{defaultContent:"<button class='"+o+"'data-bs-dismiss='modal'' ><i class='fa fa-edit'></i></button>"}),$("#datatables_stepper").off("click"),$("#datatables_stepper").on("click",".selectAll",function(){console.log("this.className ",this.className);let d=$(this).closest("tr"),f=l.deviceTableData.row(d);this.className==o?(this.showUpdateAlertButton=!1,l.openModalHelper(f.data())):this.className==r?l.deleteHelper(f.data()):this.className==i&&l.showAlertHelper(f.data(),"new")}),this.getLookupTableData(this.dataform,this.columnDatatable),this.addFromService();let l=this}openModalHelper(t){var i=this;this.cloneOperation=!1,console.log("hadavidi",t),this.currentStep$.next(1),this.api.GetDeviceConfiguration(t.mn,this.SK_clientID).then(function(){var o=(0,C.Z)(function*(r){r&&(i.auditTrialServices.audit_trail("2.1","Device","View",`${t.mn_label} Device was viewed`,"1"),console.log("Data that is being coming from db",r),i.openModal(r),i.cd.detectChanges())});return function(r){return o.apply(this,arguments)}}())}showAlertHelper(t,i){this.api.GetDeviceConfiguration(t.mn,this.SK_clientID).then(o=>{o&&(console.log("Iam Coming from the DB Itself:",o),this.alertTrigger(o),this.cd.detectChanges())})}showAlert(t,i){this.addAlerts.get("alertID")?.disable(),this.addAlerts.reset(),this.equation_textarea_string="",this.enableSaveButton=!1,this.getRDT(),this.alert_MN=t.PK,this.alert_MN_label=t.mn_label,this.alert_RDT=t.reading_device_type,this.alert_binding_parameter_RDT=t.reading_device_type,"new"==i&&t&&t.alerts_configured&&null!==t.alerts_configured&&(this.isConstantID=!1,this.isEquationID=!1,this.isParameterID=!1,this.showUpdateAlertButton=!1,this.addAlerts.reset()),this.operationalScheduleHour_value=t.operational_hours,this.addAlerts.get("alertID")?.disable()}alertTrigger(t){console.log("Alerts COnfgi",t),_.unifierMAC_ID=t.unifier_identifier,_.deviceName=t.mn,_.deviceLabel=t.mn_label,_.alerts_configured=JSON.parse(t.alerts_configured),_.rdtName=t.reading_device_type,_.no_of_param="1",_.rdtID=null,_.rdt_by_type="create_RDT",_.accountType="",_.wdtName=t.writing_device_type,_.wdtID=null,_.wdt_no_of_param="1",_.wdt_by_type="type_1",_.company_id=t.company_id,_.operational_hours=t.operational_hours,_.device_timeout=t.device_timeout,_.trans_timeout=t.data_interval,_.alert_timeout=t.alert_timeout,_.device_list=t.deviceslist,_.primary_devices=t.primary_devices,_.secondary_devices=t.secondary_devices,_.monthly_schedule=t.schedule_month_generation_day,_.disable_alerts=t.disable_alerts,_.device_profile=t.deviceProfile,_.x_axis=t.svg_x,_.alerts_duration=t.alerts_duration,_.y_axis=t.svg_y,_.z_axis=t.svg_z,_.block_number=t.block_number,_.enable_device=t.enable_device,_.redundant=t.redundant,_.customSchedule=t.customSchedule,_.critical=t.critical,_.report=t.report,_.dashboard=t.dashboard,_.disable_alerts=t.disable_alerts,_.lgtdName=t.longitude,_.latitude=t.latitude,_.altitude=t.altitude,_.reserved=t.reserved,localStorage.setItem("customInit",JSON.stringify(_)),this.router.navigate(["Device-Configuration/alerts"])}deleteHelper(t){this.api.GetDeviceConfiguration(t.mn,this.SK_clientID).then(i=>{i&&(this.deleteDeviceConfiguration(i),console.log("delete response",i),this.cd.detectChanges())}),this.newconfig(!1)}getLookupTableData(t,i){var o=this;return(0,C.Z)(function*(){console.log("chk1 tm",t),console.log("chk2 tm",i);try{o.deviceTableData&&$.fn.DataTable.isDataTable("#datatables_stepper")&&o.deviceTableData.destroy(),o.deviceTableData=$("#datatables_stepper").DataTable({pagingType:"full_numbers",destroy:!0,lengthChange:!0,responsive:!0,data:t,ordering:!0,order:[[5,"asc"]],columnDefs:[{type:"date",targets:4}],columns:i})}catch(r){console.error("Error initializing DataTable:",r)}})()}fetchTMData(t){var i=this;return(0,C.Z)(function*(){console.log("iam trying to fetch",i.SK_clientID);try{const o=yield i.api.GetLookupDeviceConfig(i.SK_clientID,t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h,P5:D}=l[d];i.lookup_data_temp1.push({P1:f,P2:m,P3:v,P4:h,P5:D})}}i.lookup_data_temp1.sort((u,l)=>l.P5-u.P5),console.log("Lookup sorting",i.lookup_data_temp1),yield i.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Data to be displayed",i.lookup_data_temp1),i.getDatatable(i.lookup_data_temp1),i.auditTrialServices.audit_trail("2.1","Device","View","Device Table was viewed",i.lookup_data_temp1.length),i.spinner.hide()}catch(o){console.error("Error:",o)}})()}loading(){$("#datatables_stepper").DataTable().destroy(),this.dataform=[],this.lookup_data_temp1=[],this.spinner.show(),this.fetchTMData(1)}createLookUpRdt(t,i){var o=this;return(0,C.Z)(function*(){try{console.log("iam a calleddd dude",t,i);const r=yield o.api.GetLookupMasterTable(o.SK_clientID+"#rdt",i);let u=[];if(null!=r&&r.items&&"string"==typeof r.items&&(u=JSON.parse(r.items)),null!=r&&u.length<o.maxlength){let l=[];r.items&&"string"==typeof r.items&&JSON.parse(r.items).forEach(v=>{for(const h in v)Object.prototype.hasOwnProperty.call(v,h)&&l.push(v[h])}),l.unshift(t),l=l.map((m,v)=>({[`L${v+1}`]:m})),console.log("newdata 11111111 :>> ",l);let d={PK:o.SK_clientID+"#rdt",SK:r.SK,createdTime:"",updatedTime:"",items:JSON.stringify(l)};const f=yield o.api.UpdateLookupMasterTable(d);console.log("createResponse :>> ",f)}else if(null==r){let l=[];l.push(t),l=l.map((m,v)=>({[`L${v+1}`]:m}));let d={SK:i,PK:o.SK_clientID+"#rdt",items:JSON.stringify(l)};console.log(d);const f=yield o.api.CreateLookupMasterTable(d);console.log(f)}else yield o.createLookUpRdt(t,i+1)}catch(r){console.log("err :>> ",r)}})()}createLookUpTimeMachine(t,i){var o=this;return(0,C.Z)(function*(){try{console.log("iam a calleddd dude",t,i);const r=yield o.api.GetLookupMasterTable(o.clientID,i);let u=[];if(null!=r&&r.items&&"string"==typeof r.items&&(u=JSON.parse(r.items)),null!=r&&u.length<o.maxlength){let l=[];r.items&&"string"==typeof r.items&&JSON.parse(r.items).forEach(v=>{for(const h in v)Object.prototype.hasOwnProperty.call(v,h)&&l.push(v[h])}),l.unshift(t),l=l.map((m,v)=>({[`L${v+1}`]:m})),console.log("newdata 11111111 :>> ",l);let d={PK:o.clientID,SK:r.SK,createdTime:"",updatedTime:"",items:JSON.stringify(l)};const f=yield o.api.UpdateLookupMasterTable(d);console.log("createResponse :>> ",f)}else if(null==r){let l=[];l.push(t),l=l.map((m,v)=>({[`L${v+1}`]:m}));let d={SK:i,PK:o.clientID,items:JSON.stringify(l)};console.log(d);const f=yield o.api.CreateLookupMasterTable(d);console.log(f)}else yield o.createLookUpTimeMachine(t,i+1)}catch(r){console.log("err :>> ",r)}})()}addFromService(){this.columnDatatable=[],this.alertsDatatable=[],this.columnTableData=[],this.columnTableData=[{data:"mn"},{data:"mn_label"},{data:"reading_device_type"},{data:"mac_id"},{data:"company_id"},{data:"updatedTime"}],this.columnDatatable=[{data:"mn"},{data:"mn_label"},{data:"reading_device_type"},{data:"mac_id"},{data:"company_id"},{data:"updatedTime"}],this.alertsDatatable=[{data:"alert_datatype"},{data:"alert_variabletype"},{data:"parameterID"},{data:"severity"}],this.checkPermission(),this.getOperationalSchedule(),this.getRDT(),this.getWDT(),this.getCompany()}checkPermission(){let t=!1,i=!1;for(let o=0;o<this.allPermissions_user.length;o++)"Device - Update"===this.allPermissions_user[o]?t=!0:"Device - View"===this.allPermissions_user[o]&&(i=!0);t&&i||t?this.hideDeleteButton=!0:i?this.hideDeleteButton=!1:this.router.navigate(["/404"])}getOperationalSchedule(){this.operationalscheduleType.getSpecificOperationalSchedule(this.SK_clientID).then(t=>{if(void 0!==t){if(this.data_temp=t,this.opsList_Alerts=[],this.opsList_Device=[],1==t.length){for(let i=0;i<=2;i++)if(0==i&&(this.opsList_Alerts.push("Disabled"),this.opsList_Device.push("None")),1==i&&this.opsList_Alerts.push("Always"),0!==i&&1!==i){let o=0;this.opsList_Alerts.push(t[o]?.PK+"-"+t[o]?.oslabel),this.opsList_Device.push(t[o]?.PK+"-"+t[o]?.oslabel)}}else if(0!==t.length)for(let i=0;i<=t.length;i++)0==i&&(this.opsList_Alerts.push("Disabled"),this.opsList_Device.push("None")),1==i&&this.opsList_Alerts.push("Always"),0!==i&&(this.opsList_Alerts.push(t[i-1]?.PK+"-"+t[i-1]?.oslabel),this.opsList_Device.push(t[i-1]?.PK+"-"+t[i-1]?.oslabel))}else this.opsList_Device.push("None")}).catch(t=>{console.log("cant fetch",t)})}getRDT(){this.getReadingDeviceType.getSpecificRDT(this.SK_clientID).then(t=>{if(t){this.data_temp=t,this.getBindingParameters(this.data_temp),this.rdtList=[];for(let i=0;i<t.length;i++)this.rdtList.push(t[i]?.PK+"-"+t[i]?.rdtLabel),this.rdt_ID_alerts.push(t[i]?.PK)}}).catch(t=>{console.log("cant fetch",t)})}getWDT(){this.getWritingDeviceType.getSpecificWDT(this.SK_clientID).then(t=>{if(t){this.data_temp=t,this.wdtList=[];for(let i=0;i<t.length;i++)this.wdtList.push(t[i]?.PK+"-"+t[i]?.wdt_parameter_label)}}).catch(t=>{console.log("cant fetch",t)})}getCompany(){this.companyConfiguration.getSpecificCompany(this.SK_clientID).then(t=>{if(t&&void 0!==t){this.data_temp=t,this.companyList=[];for(let i=0;i<t.length;i++)this.companyList.push(t[i]?.PK)}}).catch(t=>{console.log("cant fetch",t)})}getBindingParameters(t){let i="";i=this.alert_binding_parameter_RDT,this.bindingParametersList=[];for(let o=0;o<t.length;o++)i==t[o].reading_device_type_id&&(this.parametersList=JSON.parse(t[o].parameters));for(let o=0;o<=this.parametersList.length;o++)0==o&&this.bindingParametersList.push({value:"All",text:"All"}),1==o&&this.bindingParametersList.push({value:"None",text:"None"}),0!==o&&this.bindingParametersList.push({value:this.parametersList[o-1].parameterID,text:this.parametersList[o-1].parameterID+"-"+this.parametersList[o-1].parameterLabel});this.paramsBasedOnRDT=[];for(let o=0;o<this.parametersList.length;o++)this.paramsBasedOnRDT.push({value:this.parametersList[o].parameterID,text:this.parametersList[o].parameterID+"-"+this.parametersList[o].parameterLabel})}deleteDeviceConfiguration(t){var i=this;this.getDialogData=t,this.getDialogData={PK:this.getDialogData.PK,SK:this.getDialogData.SK};let o=t.PK,r=[t.PK,t.mn_label,t.reading_device_type,t.company_id,Math.ceil((new Date).getTime()/1e3)];x().fire({customClass:{container:"my-swal"},position:"center",title:"Are you sure?",text:"You wont get these details back again",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(u=>{u.dismiss!==x().DismissReason.cancel?this.api.DeleteDeviceConfiguration(this.getDialogData).then(function(){var l=(0,C.Z)(function*(d){i.addFromService(),d&&(i.auditTrialServices.audit_trail("2.1","Device","Delete",`${d.mn_label} Device was deleted`,"1"),yield i.fetchTimeMachineById(1,o,"delete",r),i.loadingDeviceList(),x().fire("Removed!","Device Configuration removed successfully.","success")),i.multi_Alerts=[]});return function(d){return l.apply(this,arguments)}}()).catch(l=>{console.log("error for deleting",l)}):u.dismiss===x().DismissReason.cancel&&x().fire("Cancelled","Device Configuration not removed","error")})}fetchTimeMachineById(t,i,o,r){var u=this;return(0,C.Z)(function*(){try{const l=yield u.api.GetLookupMasterTable(u.clientID,t);if(l&&l.items){let d=yield JSON.parse(l.items),f=d.findIndex(m=>m[Object.keys(m)[0]].P1===i);if(-1!==f){if("update"===o){d[f][`L${f+1}`]=r;const v=[];for(let h=0;h<d.length;h++){const D=Object.keys(d[h])[0],A=`L${h+1}`;if(D){const U={[A]:d[h][D]},S=v.findIndex(R=>Object.keys(R)[0]===A);-1!==S?Object.assign(v[S][A],d[h][D]):v.push(U)}else console.error(`Original key not found for renaming in data[${h}].`)}d=v}else"delete"===o&&d.splice(f,1);let m={PK:u.clientID,SK:l.SK,items:JSON.stringify(d)};yield u.api.UpdateLookupMasterTable(m)}else yield new Promise(m=>setTimeout(m,500)),yield u.fetchTimeMachineById(t+1,i,o,r)}else x().fire({position:"top-right",icon:"error",title:`ID ${i} not found`,showConfirmButton:!1,timer:1500})}catch(l){console.error("Error:",l)}})()}openModal(t){this.showModal=!0,this.showHeading=!1;for(let D=0;D<this.allPermissions_user.length;D++){if("Device - Update"===this.allPermissions_user[D]){this.hideUpdateButton=!1;break}"Device - View"===this.allPermissions_user[D]&&(this.hideUpdateButton=!0)}let i=[],o=[],r=[],u="",l="",d="";for(let D=0;D<this.rdtList.length;D++)i[D]=this.rdtList[D].split("-")[0];for(let D=0;D<this.wdtList.length;D++)o[D]=this.wdtList[D].split("-")[0];for(let D=0;D<this.opsList_Device.length;D++)r[D]=this.opsList_Device[D].split("-")[0];JSON.parse(t.metadata);let m=t.reading_device_type.split("-"),v=t.writing_device_type.split("-"),h=t.operational_hours.split("-");for(let D=0;D<i.length;D++)m==i[D]&&(u=this.rdtList[D]);console.log("WDT Name",v[0]);for(let D=0;D<o.length;D++)v==o[D]&&(l=this.wdtList[D]);for(let D=0;D<r.length;D++)h==r[D]&&(d=this.opsList_Device[D]);this.errorForUniqueID="",_.unifierMAC_ID=t.unifier_identifier,_.alerts_configured=JSON.parse(t.alerts_configured),_.deviceName=t.mn,_.deviceLabel=t.mn_label,_.no_of_param="1",_.rdtID=t.reading_device_type,_.rdt_by_type="type_1",_.accountType="",_.wdtID=t.writing_device_type,_.wdt_no_of_param="1",_.wdt_by_type="type_1",_.company_id=t.company_id,_.operational_hours=t.operational_hours,_.device_timeout=t.device_timeout,_.trans_timeout=t.data_interval,_.alert_timeout=t.alert_timeout,_.device_list=t.deviceslist,_.primary_devices=t.primary_devices,_.secondary_devices=t.secondary_devices,_.monthly_schedule=t.schedule_month_generation_day,_.disable_alerts=t.disable_alerts,_.device_profile=t.deviceProfile,_.alerts_duration=t.alerts_duration,_.x_axis=t.svg_x,_.y_axis=t.svg_y,_.z_axis=t.svg_z,_.block_number=t.block_number,_.enable_device=t.enable_device,_.redundant=t.redundant,_.customSchedule=t.customSchedule,_.critical=t.critical,_.report=t.report,_.dashboard=t.dashboard,_.disable_alerts=t.disable_alerts,_.lgtdName=t.longitude,_.latitude=t.latitude,_.altitude=t.altitude,_.reserved=t.reserved,this.currMAC=t.unifier_identifier,this.operationalScheduleHour_value=t.operational_hours,this.account$.next(_),console.log(_),console.log("see that data coming",this.account$.value),this.EditOperation=!0,this.isCurrentFormValid$.next(!0),this.cd.detectChanges(),this.step1Comp.initForm()}updateDeviceConfiguration(t,i){var o=this;let r=this.account$.value.rdtID.split("-"),u=this.account$.value.wdtID.split("-");if("deleteParameter"==i&&(this.allDatas={PK:this.account$.value.deviceName,SK:this.SK_clientID,alerts_configured:JSON.stringify(this.multi_Alerts),updatedTime:new Date}),"alerts"==i)this.allDatas={PK:this.account$.value.deviceName,SK:this.SK_clientID,alerts_configured:JSON.stringify(this.multi_Alerts),alerts_duration:this.account$.value.alert_timeout,block_number:this.account$.value.block_number,company_id:this.account$.value.company_id,deviceProfile:this.account$.value.device_profile,data_interval:"",reading_device_type:r[0],writing_device_type:u[0],mn:this.account$.value.deviceName,mn_label:this.account$.value.deviceLabel,metadata:JSON.stringify(this.metaData),longitude:this.account$.value.lgtdName,latitude:this.account$.value.latitude,altitude:this.account$.value.altitude,operational_hours:this.account$.value.operational_hours,device_timeout:this.account$.value.device_timeout,svg_x:this.account$.value.x_axis,svg_y:this.account$.value.y_axis,svg_z:this.account$.value.z_axis,schedule_month_generation_day:this.account$.value.monthly_schedule,enable_device:null!=this.account$.value.enable_device&&this.account$.value.enable_device,critical:null!=this.account$.value.critical&&this.account$.value.critical,customSchedule:null!=this.account$.value.customSchedule&&this.account$.value.customSchedule,redundant:null!=this.account$.value.redundant&&this.account$.value.redundant,disable_alerts:null!=this.account$.value.disable_alerts&&this.account$.value.disable_alerts,report:null!=this.account$.value.report&&this.account$.value.report,dashboard:null!=this.account$.value.dashboard&&this.account$.value.dashboard,deviceslist:this.account$.value.device_list,primary_devices:this.account$.value.primary_devices,secondary_devices:this.account$.value.secondary_devices,alertslist:"",alert_timeout:this.account$.value.alert_timeout,reserved:this.account$.value.reserved,updatedTime:new Date};else if("deleteParameter"!==i){const m=this.account$.value;console.log("All the form values are :",m),this.allDatas={PK:m.deviceName,SK:this.SK_clientID,unifier_identifier:m.unifierMAC_ID,block_number:m.block_number,company_id:m.company_id,deviceProfile:m.device_profile,data_interval:m.trans_timeout,reading_device_type:r[0],writing_device_type:u[0],mn:m.deviceName,mn_label:m.deviceLabel.trim(),metadata:JSON.stringify(this.metaData),longitude:m.lgtdName,latitude:m.latitude,altitude:m.altitude,operational_hours:m.operational_hours,device_timeout:m.device_timeout,svg_x:m.x_axis,svg_y:m.y_axis,svg_z:m.z_axis,schedule_month_generation_day:m.monthly_schedule,enable_device:m.enable_device,critical:m.critical,customSchedule:m.customSchedule,redundant:m.redundant,disable_alerts:m.disable_alerts,report:m.report,alerts_duration:m.alerts_duration,dashboard:m.dashboard,deviceslist:m.device_list,primary_devices:m.primary_devices,secondary_devices:m.secondary_devices,alertslist:"",alert_timeout:m.alert_timeout,reserved:m.reserved,updatedTime:new Date},console.log("Data that will be edited is :",this.allDatas),console.log("replicateInit",_)}const d=Math.ceil((new Date).getTime()/1e3),f={P1:this.allDatas.mn,P2:this.allDatas.mn_label.trim(),P3:this.allDatas.reading_device_type,P4:this.allDatas.company_id,P5:d,P6:this.allDatas.longitude,P7:this.allDatas.latitude,P8:this.allDatas.unifier_identifier};this.api.UpdateDeviceConfiguration(this.allDatas).then(function(){var m=(0,C.Z)(function*(v){if(v)return o.auditTrialServices.audit_trail("2.1","Device","Update",`${o.allDatas.mn_label} Device was updated`,"1"),yield o.fetchTimeMachineById(1,o.allDatas.mn,"update",f),x().fire({position:"center",text:"Configuration Updated successfully",icon:"success",allowOutsideClick:!1});alert("Error in updating Configuration")});return function(v){return m.apply(this,arguments)}}()).catch(m=>{console.log("error for updating",m)})}copyConfig(){console.log("All the data is here ",_),this.EditOperation=!1,this.currMAC="",_.deviceName="",_.deviceLabel="",this.cloneOperation=!0,this.isCurrentFormValid$.next(!1),this.account$.next(_),1!=this.currentStep$.value&&this.currentStep$.next(1),this.toast.open("Device Configuration Cloned Successfully"," ",{duration:2e3,verticalPosition:"bottom"}),1==this.currentStep$.value&&setTimeout(()=>{this.step1Comp.validateDevice([{data:{name:_.unifierMAC_ID}}]),this.step1Comp.initForm()},500)}redirectnewconfig(){let t="";t=this.EditOperation?"Do you want to cancel the Update Device process?":"Do you want to cancel the Add Device process?",x().fire({customClass:{container:"my-swal"},position:"center",title:"Are you sure?",text:t,icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(i=>{console.log("inside sweetalert",i),i.dismiss!==x().DismissReason.cancel&&1==i.isConfirmed&&this.newconfig(!1)})}newconfig(t){this.cloneOperation=!1,localStorage.setItem("step3Validation",JSON.stringify(!1)),localStorage.setItem("step4Validation",JSON.stringify(!1)),1!=t&&(this.EditOperation=!1,this.currMAC="",_.unifierMAC_ID="",_.deviceName="",_.deviceLabel="",_.rdtName="",_.no_of_param="1",_.rdtID=null,_.rdt_by_type="type_1",_.accountType="",_.wdtName="",_.wdtID=null,_.wdt_no_of_param="1",_.wdt_by_type="type_1",_.company_id=null,_.operational_hours="None",_.device_timeout="1_hour",_.trans_timeout=15,_.alert_timeout=1,_.device_list="NONE",_.primary_devices="NONE",_.secondary_devices="NONE",_.monthly_schedule=1,_.disable_alerts=null,_.device_profile=null,_.x_axis=null,_.y_axis=null,_.z_axis=null,_.block_number=null,_.enable_device=!0,_.redundant=null,_.customSchedule=null,_.reserved=null,_.critical=null,_.report=null,_.dashboard=null,_.disable_alerts=null,_.alerts_configured=[],_.lgtdName="77.58085013100799",_.latitude="12.92422584151276",_.altitude="",console.log("this called new"),console.log("this called new",_),this.isCurrentFormValid$.next(!1),this.account$.next(_),this.currentStep$.next(1),console.log("this accow",this.account$.value))}handleData(t){this.disableAddbutton=t}createLookUpWdt(t,i){var o=this;return(0,C.Z)(function*(){try{console.log("iam a calleddd dude",t,i);const r=yield o.api.GetLookupMasterTable(o.SK_clientID+"#wdt",i);let u=[];if(null!=r&&r.items&&"string"==typeof r.items&&(u=JSON.parse(r.items)),null!=r&&u.length<o.maxlength){let l=[];r.items&&"string"==typeof r.items&&JSON.parse(r.items).forEach(v=>{for(const h in v)Object.prototype.hasOwnProperty.call(v,h)&&l.push(v[h])}),l.unshift(t),l=l.map((m,v)=>({[`L${v+1}`]:m})),console.log("newdata 11111111 :>> ",l);let d={PK:o.SK_clientID+"#wdt",SK:r.SK,createdTime:"",updatedTime:"",items:JSON.stringify(l)};const f=yield o.api.UpdateLookupMasterTable(d);console.log("createResponse :>> ",f)}else if(null==r){let l=[];l.push(t),l=l.map((m,v)=>({[`L${v+1}`]:m}));let d={SK:i,PK:o.SK_clientID+"#wdt",items:JSON.stringify(l)};console.log(d);const f=yield o.api.CreateLookupMasterTable(d);console.log(f)}else yield o.createLookUpRdt(t,i+1)}catch(r){console.log("err :>> ",r)}})()}getLocationConfiguration(){var t=this;return(0,C.Z)(function*(){try{const i=yield t.locationPermissionService.fetchGlobalLocationTree();if(!i)throw new Error("No data returned");if(console.log("Data from location:",i),i)try{if(Array.isArray(i)){const o=i.filter(r=>"device"===r.node_type);t.locationTree=Array.from(new Set(o.map(r=>r.mn||""))),console.log("Filtered devices are here which will be shown",t.locationTree)}else console.error("Parsed tree is not an array")}catch(o){console.error("Error parsing JSON",o)}}catch(i){console.error("Error fetching location configuration",i)}})()}getuserConfiguration(){var t=this;return(0,C.Z)(function*(){console.log("We will get the user configuration now ",t.username);try{const i=yield t.api.GetUserManagement(t.username,t.SK_clientID);i&&(console.log("Fetched user is here",i),Array.isArray(i.device_permission)&&1==i.device_permission.length&&"All"==i.device_permission[0]&&1==i.device_permission.length&&i.location_permission&&"All"==i.location_permission[0]&&i.device_type_permission&&"All"==i.device_type_permission[0]&&(t.showAlldevice=!0))}catch(i){console.log("Error fetching user Configuration",i)}})()}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(ce),e.Y36(P.F),e.Y36(g.QS),e.Y36(P.F),e.Y36(P.F),e.Y36(K.F0),e.Y36(ce),e.Y36(P.F),e.Y36(e.sBO),e.Y36(B.t),e.Y36(ie.ux),e.Y36(P.F),e.Y36(ae.t2),e.Y36(Ye.G),e.Y36(He.y),e.Y36(ve.C))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-vertical"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Pt,5),e.Gf(wt,5),e.Gf(fe,5),e.Gf(ge,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.closeModal=o.first),e.iGM(o=e.CRH())&&(i.closeAlert=o.first),e.iGM(o=e.CRH())&&(i.step1Comp=o.first),e.iGM(o=e.CRH())&&(i.childComponent=o.first)}},decls:105,vars:33,consts:[[1,"app-container"],[1,"page-title",2,"display","flex","justify-content","space-between","padding","1%"],[1,"page-heading","text-gray-900","fw-bold","fs-3"],["type","button","ngbTooltip","Copy Configuration of Selected Device","placement","bottom",1,"btn","btn-sm","fw-bold","custom-primary","btn-equal-size",2,"margin-right","10px",3,"disabled","click"],[1,"fa-regular","fa-copy","fs-4","text-white"],["type","button","class","btn btn-sm fw-bold btn-primary btn-equal-size","style","margin-right: 10px;","ngbTooltip","Add New Device","placement","bottom",3,"disabled","click",4,"ngIf"],["data-bs-toggle","modal","data-bs-target","#kt_modal_create_app","ngbTooltip","Show Devices List","placement","bottom",1,"btn","btn-sm","fw-bold","btn-dark","btn-equal-size",3,"click"],[1,"bi","bi-card-list"],["id","kt_create_account_stepper",1,"stepper","stepper-pills","stepper-column","d-flex","flex-column","flex-xl-row","flex-row-fluid"],[1,"card","d-flex","justify-content-center","justify-content-xl-start","flex-row-auto","w-100","w-xl-300px","w-xxl-400px","me-9","ms-9"],[1,"card-body","px-6","px-lg-10","px-xxl-15","py-20"],[1,"stepper-nav"],[1,"stepper-item",3,"ngClass"],[1,"stepper-wrapper"],[1,"stepper-icon","w-40px","h-40px"],[1,"stepper-check","fas","fa-check"],[1,"stepper-number"],[1,"stepper-label"],[1,"stepper-title"],[1,"stepper-desc","fw-semibold"],[1,"stepper-line","h-40px"],[1,"d-flex","flex-row-fluid","flex-center","bg-body","rounded"],["noValidate","","id","kt_create_account_form",1,"py-20","w-100","w-xl-700px","px-9"],[1,"current"],[4,"ngIf"],[1,"d-flex","flex-stack","pt-10"],[1,"mr-2"],["id","kt_modal_create_app","tabindex","-1","aria-labelledby","","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"table-responsive"],["id","device_lookup_table",1,"table","table-row-dashed","table-row-gray-300","align-middle","gs-0","gy-4"],["class","fw-bold",4,"ngIf"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],["type","button","ngbTooltip","Add New Device","placement","bottom",1,"btn","btn-sm","fw-bold","btn-primary","btn-equal-size",2,"margin-right","10px",3,"disabled","click"],[1,"bi","bi-plus-square-fill","fs-4","text-white"],[1,"w-100",3,"updateParentModel","defaultValues","editOperation","hideDeleteButton","lookupdeviceData","currMAC","valueChanged","dataEvent"],[1,"w-100",3,"updateParentModel","defaultValues","editOperation","hideDeleteButton"],[1,"w-100",3,"updateParentModel","defaultValues","hideDeleteButton","editOperation","lookupdeviceData","adminUser","dataChange"],[1,"w-100",3,"updateParentModel","defaultValues","hideDeleteButton","editOperation","dataChange"],[1,"w-100",3,"updateParentModel","defaultValues","hideDeleteButton","metaData"],[1,"w-100",3,"editOperation"],["type","button",1,"btn","fw-bold","btn-lg","btn-light-primary","me-3",3,"click"],[1,"fa-solid","fa-arrow-left"],["type","button",1,"btn","fw-bold","btn-lg","btn-primary","me-3","me-3","d-flex",3,"disabled","click"],[1,"indicator-label"],[1,"fa-solid","fa-chevron-right"],["type","button","class","btn fw-bold btn-lg btn-primary me-3",3,"disabled","click",4,"ngIf","ngIfElse"],["other_btn",""],["type","button",1,"btn","fw-bold","btn-lg","btn-primary","me-3",3,"disabled","click"],[1,"fw-bold"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3,"Device Configuration"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return i.copyConfig()}),e._UZ(6,"i",4),e._uU(7,"Clone Device"),e.qZA(),e.YNc(8,St,3,1,"button",5),e.TgZ(9,"a",6),e.NdJ("click",function(){return i.loadingDeviceList()}),e._UZ(10,"i",7),e._uU(11,"Show Devices"),e.qZA()()()(),e.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14),e._UZ(19,"i",15),e.TgZ(20,"span",16),e._uU(21,"1"),e.qZA()(),e.TgZ(22,"div",17)(23,"h3",18),e._uU(24," Device Identification "),e.qZA(),e.TgZ(25,"div",19),e._uU(26," Configure the basic settings and properties of the device. "),e.qZA()()(),e._UZ(27,"div",20),e.qZA(),e.TgZ(28,"div",12)(29,"div",13)(30,"div",14),e._UZ(31,"i",15),e.TgZ(32,"span",16),e._uU(33,"2"),e.qZA()(),e.TgZ(34,"div",17)(35,"h3",18),e._uU(36," Location "),e.qZA(),e.TgZ(37,"div",19),e._uU(38," Specify the physical location or placement of the device. "),e.qZA()()(),e._UZ(39,"div",20),e.qZA(),e.TgZ(40,"div",12)(41,"div",13)(42,"div",14),e._UZ(43,"i",15),e.TgZ(44,"span",16),e._uU(45,"3"),e.qZA()(),e.TgZ(46,"div",17)(47,"h3",18),e._uU(48," Reading Device Type Configuration "),e.qZA(),e.TgZ(49,"div",19),e._uU(50," Configure the settings and parameters specific to the reading device type "),e.qZA()()(),e._UZ(51,"div",20),e.qZA(),e.TgZ(52,"div",12)(53,"div",13)(54,"div",14),e._UZ(55,"i",15),e.TgZ(56,"span",16),e._uU(57,"4"),e.qZA()(),e.TgZ(58,"div",17)(59,"h3",18),e._uU(60," Writing Device Type Configuration "),e.qZA(),e.TgZ(61,"div",19),e._uU(62," Configure the settings and parameters specific to the writing device type "),e.qZA()()(),e._UZ(63,"div",20),e.qZA(),e.TgZ(64,"div",12)(65,"div",13)(66,"div",14),e._UZ(67,"i",15),e.TgZ(68,"span",16),e._uU(69,"5"),e.qZA()(),e.TgZ(70,"div",17)(71,"h3",18),e._uU(72," Other Settings "),e.qZA(),e.TgZ(73,"div",19),e._uU(74," Configure additional settings or advanced options for the device "),e.qZA()()()()()()(),e.TgZ(75,"div",21)(76,"form",22)(77,"div",23),e.YNc(78,kt,2,6,"ng-container",24),e.YNc(79,qt,2,4,"ng-container",24),e.YNc(80,Nt,2,6,"ng-container",24),e.YNc(81,Ut,2,4,"ng-container",24),e.YNc(82,Lt,2,3,"ng-container",24),e.YNc(83,Mt,2,1,"ng-container",24),e.qZA(),e.TgZ(84,"div",25)(85,"div",26),e.YNc(86,Ot,4,0,"ng-container",24),e.qZA(),e.YNc(87,Ft,6,2,"ng-container",24),e.YNc(88,Kt,5,2,"ng-container",24),e.qZA()()()(),e.TgZ(89,"div",27)(90,"div",28)(91,"div",29)(92,"div",30)(93,"h2",31),e._uU(94,"Device List"),e.qZA(),e._UZ(95,"button",32),e.qZA(),e.TgZ(96,"div",33)(97,"div",34)(98,"table",35)(99,"thead"),e.YNc(100,Vt,19,0,"tr",36),e.YNc(101,zt,17,0,"tr",24),e.qZA()()()()()()(),e.TgZ(102,"ngx-spinner",37)(103,"p",38),e._uU(104,"Please wait your dashboard is Loading... "),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("disabled",0==i.EditOperation),e.xp6(3),e.Q6J("ngIf",!i.disableAddbutton),e.xp6(8),e.Q6J("ngClass",e.WLB(19,ne,1===i.currentStep$.value,i.currentStep$.value>1)),e.xp6(12),e.Q6J("ngClass",e.WLB(22,ne,2===i.currentStep$.value,i.currentStep$.value>2)),e.xp6(12),e.Q6J("ngClass",e.WLB(25,ne,3===i.currentStep$.value,i.currentStep$.value>3)),e.xp6(12),e.Q6J("ngClass",e.WLB(28,ne,4===i.currentStep$.value,i.currentStep$.value>4)),e.xp6(12),e.Q6J("ngClass",e.VKq(31,Qt,5===i.currentStep$.value)),e.xp6(14),e.Q6J("ngIf",1===i.currentStep$.value),e.xp6(1),e.Q6J("ngIf",2===i.currentStep$.value),e.xp6(1),e.Q6J("ngIf",3===i.currentStep$.value),e.xp6(1),e.Q6J("ngIf",4===i.currentStep$.value),e.xp6(1),e.Q6J("ngIf",5===i.currentStep$.value),e.xp6(1),e.Q6J("ngIf",6===i.currentStep$.value),e.xp6(3),e.Q6J("ngIf",1!==i.currentStep$.value&&i.currentStep$.value!==i.formsCount),e.xp6(1),e.Q6J("ngIf",i.currentStep$.value!==i.formsCount&&i.currentStep$.value<i.formsCount-1),e.xp6(1),e.Q6J("ngIf",i.currentStep$.value!==i.formsCount&&i.currentStep$.value===i.formsCount-1),e.xp6(12),e.Q6J("ngIf",!0===i.hideDeleteButton),e.xp6(1),e.Q6J("ngIf",!1===i.hideDeleteButton),e.xp6(1),e.Q6J("fullScreen",!0))},dependencies:[q.mk,q.O5,g._Y,g.JL,J._L,ae.Ro,fe,tt,ge,at,bt,At],styles:[".btn-light-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}.bi-card-list[_ngcontent-%COMP%]{font-size:16px;margin-right:3px;margin-bottom:2px}.bi-plus-lg[_ngcontent-%COMP%]{font-size:16px;margin-left:2px;margin-bottom:2px}a[_ngcontent-%COMP%]{font-size:13px}.fa-chevron-right[_ngcontent-%COMP%]{font-size:11px;margin-top:6px;margin-left:6%}.fa-arrow-left[_ngcontent-%COMP%]{margin-bottom:4%}.card[_ngcontent-%COMP%]{margin-bottom:30px;margin-left:30px;margin-right:30px;border:1px solid #dee2e6;border-radius:10px}.rounded[_ngcontent-%COMP%]{margin-bottom:30px;margin-right:30px;border:1px solid #dee2e6;border-radius:10px}.stepper-item.current[_ngcontent-%COMP%]   .stepper-desc[_ngcontent-%COMP%]{color:#595252!important;font-weight:600!important}.stepper-item.current[_ngcontent-%COMP%]   .stepper-title[_ngcontent-%COMP%]{color:#000!important;font-weight:600!important}.btn-equal-size[_ngcontent-%COMP%]{min-width:150px}.btn-dark[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}.custom-primary[_ngcontent-%COMP%]{background-color:#ff6f1e;color:#fff}.custom-primary[_ngcontent-%COMP%]:hover{background-color:#ff6f1e;color:#fff;opacity:1;transform:translateY(-2px);transition:.5s}"]})),p})();var de=w(60540);function Ht(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Alert Data Type is Required "),e.qZA())}function Wt(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Parameter ID is required "),e.qZA())}function Gt(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Operator is required "),e.qZA())}function jt(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Value is required "),e.qZA())}function Xt(n,p){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"label",45),e._uU(3,"Parameter ID "),e.qZA(),e.TgZ(4,"div",46),e._UZ(5,"ng-multiselect-dropdown",47),e.qZA(),e.YNc(6,Wt,2,0,"div",17),e.qZA(),e.TgZ(7,"div",2)(8,"label",45),e._uU(9,"Operator "),e.qZA(),e.TgZ(10,"select",48)(11,"option",49),e._uU(12,"Select Operator "),e.qZA(),e.TgZ(13,"option",50),e._uU(14,"Greater than >"),e.qZA(),e.TgZ(15,"option",51),e._uU(16,"Lesser than <"),e.qZA(),e.TgZ(17,"option",52),e._uU(18,"Greater than or Equal to >="),e.qZA(),e.TgZ(19,"option",53),e._uU(20,"Lesser than or Equal to <= "),e.qZA(),e.TgZ(21,"option",54),e._uU(22,"Equal to =="),e.qZA(),e.TgZ(23,"option",55),e._uU(24,"Not Equal to !="),e.qZA(),e.TgZ(25,"option",56),e._uU(26,"Logical AND &&"),e.qZA(),e.TgZ(27,"option",57),e._uU(28,"Logical OR ||"),e.qZA(),e.TgZ(29,"option",58),e._uU(30,"XOR"),e.qZA()(),e.YNc(31,Gt,2,0,"div",17),e.qZA(),e.TgZ(32,"div",2)(33,"label",45),e._uU(34,"Value "),e.qZA(),e._UZ(35,"input",59),e.YNc(36,jt,2,0,"div",17),e.qZA()()),2&n){const s=e.oxw();let t,i,o;e.xp6(5),e.Q6J("placeholder","Select Parameters")("settings",s.dropdownSettings_single)("data",s.paramsBasedOnRDT)("formControl",s.form.controls.parameterID),e.xp6(1),e.Q6J("ngIf",(null==(t=s.form.get("parameterID"))?null:t.hasError("required"))&&(null==(t=s.form.get("parameterID"))?null:t.touched)),e.xp6(5),e.Q6J("selected",!0),e.xp6(20),e.Q6J("ngIf",(null==(i=s.form.get("operator"))?null:i.hasError("required"))&&(null==(i=s.form.get("operator"))?null:i.touched)),e.xp6(5),e.Q6J("ngIf",(null==(o=s.form.get("operator_value"))?null:o.hasError("required"))&&(null==(o=s.form.get("operator_value"))?null:o.touched))}}function ei(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Parameter ID1 is required "),e.qZA())}function ti(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Parameter Operator is required "),e.qZA())}function ii(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Parameter ID2 is required "),e.qZA())}function oi(n,p){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"label",45),e._uU(3,"Parameter ID 1 "),e.qZA(),e.TgZ(4,"div",60)(5,"div",46),e._UZ(6,"ng-multiselect-dropdown",61),e.qZA(),e.YNc(7,ei,2,0,"div",17),e.qZA()(),e.TgZ(8,"div",2)(9,"label",45),e._uU(10,"Operator "),e.qZA(),e.TgZ(11,"select",62)(12,"option",49),e._uU(13,"Select Operator "),e.qZA(),e.TgZ(14,"option",50),e._uU(15,"Greater than >"),e.qZA(),e.TgZ(16,"option",51),e._uU(17,"Lesser than < "),e.qZA(),e.TgZ(18,"option",52),e._uU(19,"Greater than or Equal to >="),e.qZA(),e.TgZ(20,"option",53),e._uU(21,"Lesser than or Equal to <= "),e.qZA(),e.TgZ(22,"option",54),e._uU(23,"Equal to =="),e.qZA(),e.TgZ(24,"option",55),e._uU(25,"Not Equal to !="),e.qZA(),e.TgZ(26,"option",56),e._uU(27,"Logical AND &&"),e.qZA(),e.TgZ(28,"option",57),e._uU(29,"Logical OR ||"),e.qZA(),e.TgZ(30,"option",58),e._uU(31,"XOR"),e.qZA()(),e.YNc(32,ti,2,0,"div",17),e.qZA(),e.TgZ(33,"div",2)(34,"label",45),e._uU(35,"Parameter ID 2 "),e.qZA(),e.TgZ(36,"div")(37,"div",46),e._UZ(38,"ng-multiselect-dropdown",63),e.qZA(),e.YNc(39,ii,2,0,"div",17),e.qZA()()()),2&n){const s=e.oxw();let t,i,o;e.xp6(6),e.Q6J("placeholder","Select Parameters")("settings",s.dropdownSettings_single)("data",s.paramsBasedOnRDT)("formControl",s.form.controls.parameterID1),e.xp6(1),e.Q6J("ngIf",(null==(t=s.form.get("parameterID1"))?null:t.hasError("required"))&&(null==(t=s.form.get("parameterID1"))?null:t.touched)),e.xp6(5),e.Q6J("selected",!0),e.xp6(20),e.Q6J("ngIf",(null==(i=s.form.get("parameter_operator"))?null:i.hasError("required"))&&(null==(i=s.form.get("parameter_operator"))?null:i.touched)),e.xp6(6),e.Q6J("placeholder","Select Parameters")("settings",s.dropdownSettings_single)("data",s.paramsBasedOnRDT)("formControl",s.form.controls.parameterID2),e.xp6(1),e.Q6J("ngIf",(null==(o=s.form.get("parameterID2"))?null:o.hasError("required"))&&(null==(o=s.form.get("parameterID2"))?null:o.touched))}}function ai(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Parameter is required "),e.qZA())}function ni(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," Equation is required "),e.qZA())}function ri(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"label",45),e._uU(3,"Parameter "),e.qZA(),e.TgZ(4,"div",46),e._UZ(5,"ng-multiselect-dropdown",64),e.YNc(6,ai,2,0,"div",17),e.qZA()(),e.TgZ(7,"div",2)(8,"div",65)(9,"button",66),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();let o;return e.KtG(i.getEqu_Textarea(null==(o=i.form.get("paraID"))?null:o.value))}),e._UZ(10,"i",67),e._uU(11," Parameter "),e.qZA()()(),e.TgZ(12,"div",2)(13,"label",45),e._uU(14,"Equation "),e.qZA(),e.TgZ(15,"textarea",68),e._uU(16,"                  "),e.qZA(),e.YNc(17,ni,2,0,"div",17),e.qZA()()}if(2&n){const s=e.oxw();let t,i;e.xp6(5),e.Q6J("placeholder","Select Parameters")("settings",s.dropdownSettings_single)("data",s.paramsBasedOnRDT)("formControl",s.form.controls.paraID),e.xp6(1),e.Q6J("ngIf",(null==(t=s.form.get("paraID"))?null:t.hasError("required"))&&(null==(t=s.form.get("paraID"))?null:t.touched)),e.xp6(11),e.Q6J("ngIf",(null==(i=s.form.get("equTextarea"))?null:i.hasError("required"))&&(null==(i=s.form.get("equTextarea"))?null:i.touched))}}function li(n,p){if(1&n&&(e.TgZ(0,"option",69),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}function si(n,p){1&n&&(e.TgZ(0,"div",44),e._uU(1," severity is required "),e.qZA())}function ci(n,p){1&n&&(e.TgZ(0,"div",70)(1,"label",3)(2,"span"),e._uU(3,"Alert Value Prediction(Threshold value)"),e.qZA(),e._UZ(4,"i",71),e.qZA(),e._UZ(5,"input",72),e.qZA())}let ue=(()=>{var n;class p{constructor(t,i,o,r,u,l,d,f){(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"getWritingDeviceType",void 0),(0,a.Z)(this,"getReadingDeviceType",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"customInit",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"data_temp",void 0),(0,a.Z)(this,"companyList",void 0),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"dropdownSettings_single",{}),(0,a.Z)(this,"paramsBasedOnRDT",[]),(0,a.Z)(this,"equation_textarea_string",[]),(0,a.Z)(this,"addAlerts",void 0),(0,a.Z)(this,"columnDatatable",[]),(0,a.Z)(this,"alertsDatatable",[]),(0,a.Z)(this,"rdtList",[]),(0,a.Z)(this,"rdt_ID_alerts",[]),(0,a.Z)(this,"alert_binding_parameter_RDT",void 0),(0,a.Z)(this,"bindingParametersList",[]),(0,a.Z)(this,"parametersList",[]),(0,a.Z)(this,"opsList_Alerts",[]),(0,a.Z)(this,"opsList_Device",[]),(0,a.Z)(this,"wdtList",[]),(0,a.Z)(this,"username",void 0),(0,a.Z)(this,"lookup_data_temp1",[]),(0,a.Z)(this,"parsedData",void 0),(0,a.Z)(this,"Lookupdata",[]),(0,a.Z)(this,"listofNMIds",[]),(0,a.Z)(this,"showAlertTime",!1),this.api=t,this.getWritingDeviceType=i,this.getReadingDeviceType=o,this.fb=r,this.companyConfiguration=u,this.getDiagnostics=l,this.operationalscheduleType=d,this.cdr=f}ngOnInit(){this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.dropdownSettings_single=this.getDiagnostics.showSingleSelection(),this.clientID=this.getLoggedUser.attributes["custom:clientID"],this.username=this.getLoggedUser.attributes["custom:username"],this.initForm(),this.updateParentModel({},this.checkForm()),this.addFromService(),this.fetchTMData(1),console.log("Lists of parameters:",this.paramsBasedOnRDT),console.log("Bindingparameter step1",this.bindingParametersList)}patchValues(){console.log("PAtching values to be patched ",this.defaultValues);const t=this.defaultValues;this.form.get("alert_datatype")?.patchValue(t?.alert_datatype),this.form.get("alertID")?.patchValue(t?.alertID),this.form.get("alert_variabletype")?.patchValue(t?.alert_variabletype),this.form.get("operator")?.patchValue(t?.operator),this.form.get("operator_value")?.patchValue(t?.operator_value),this.form.get("equTextarea")?.patchValue(t?.equTextarea),this.form.get("alert_percent")?.patchValue(t?.alert_percent),this.form.get("notificationMatrixId")?.patchValue(t?.notificationMatrixId),this.form.get("severity")?.patchValue(t?.severity),this.form.get("parameter_operator")?.patchValue(t?.parameter_operator),this.form.get("alertValuePrediction")?.patchValue(t?.alertValuePrediction),"Constant"==this.defaultValues.alert_datatype?(console.log("Iam executed in constant :"),this.form.get("parameterID")?.patchValue(this.patchValueToLabel(t?.parameterID))):"Parameter"==this.defaultValues.alert_datatype&&(console.log("Iam called Bro :"),this.form.get("parameterID2")?.patchValue(this.patchValueToLabel(t?.parameterID2)),this.form.get("parameterID1")?.patchValue(this.patchValueToLabel(t?.parameterID1))),console.log("parameterID: ",t?.parameterID),this.cdr.detectChanges()}initForm(){console.log("inisde init Form",this.defaultValues);let t=this.defaultValues;const i=Math.floor(Date.now()/1e3);console.log("AlertID",[this.username+"_"+this.clientID+"_"+i]),this.form=this.fb.group({alert_datatype:[t?.alert_datatype,[g.kI.required]],alert_variabletype:[t?.alert_variabletype],parameterID:[""!=t?.parameterID&&0==Array.isArray(t?.parameterID)?[t?.parameterID]:t?.parameterID,[g.kI.required]],operator:[t?.operator,[g.kI.required]],operator_value:[t?.operator_value,[g.kI.required]],parameterID1:[""!=t?.parameterID1&&0==Array.isArray(t?.parameterID1)?[t?.parameterID1]:t?.parameterID1,[g.kI.required]],parameter_operator:[t?.parameter_operator,[g.kI.required]],parameterID2:[""!=t?.parameterID2&&0==Array.isArray(t?.parameterID2)?[t?.parameterID2]:t?.parameterID2,[g.kI.required]],equTextarea:[t?.equTextarea,[g.kI.required]],alert_percent:[t?.alert_percent,[g.kI.required]],alertID:[{value:t?.alertID,disabled:!0}],notificationMatrixId:[t?.notificationMatrixId],severity:[t?.severity,[g.kI.required]],paraID:[[]],alertValuePrediction:[t?.alertValuePrediction]}),0==this.hideDeleteButton&&this.form.disable(),this.Lookupdata=[],this.fetchNMData(1),console.log("Notification matrix id",this.Lookupdata),this.getInputField();const o=this.form.valueChanges.subscribe(r=>{"Constant"==this.form.get("alert_variabletype")?.value?(console.log("checked for constant"),this.updateParentModel(r,this.checkform2())):"Parameter"==this.form.get("alert_variabletype")?.value?(console.log("checked for parameter"),this.updateParentModel(r,this.checkform3())):"Equation"==this.form.get("alert_variabletype")?.value&&(console.log("checked for equation"),this.updateParentModel(r,this.checkForm())),this.cdr.detectChanges()});this.unsubscribe.push(o)}checkform2(){return!(this.form.get("alert_datatype")?.hasError("required")||this.form.get("parameterID")?.hasError("required")||this.form.get("operator")?.hasError("required")||this.form.get("operator_value")?.hasError("required")||this.form.get("alert_variabletype")?.hasError("required")||this.form.get("alert_percent")?.hasError("required")||this.form.get("severity")?.hasError("required"))}patchValueToLabel(t){const i=this.paramsBasedOnRDT.find(o=>o.startsWith(t+"-"));return console.log("The final patched value will be ",i),i}checkform3(){return!(this.form.get("alert_datatype")?.hasError("required")||this.form.get("parameterID1")?.hasError("required")||this.form.get("alert_variabletype")?.hasError("required")||this.form.get("parameter_operator")?.hasError("required")||this.form.get("parameterID2")?.hasError("required")||this.form.get("alert_percent")?.hasError("required")||this.form.get("severity")?.hasError("required"))}checkForm(){return!(this.form.get("alert_datatype")?.hasError("required")||this.form.get("alert_variabletype")?.hasError("required")||this.form.get("equTextarea")?.hasError("required")||this.form.get("alert_percent")?.hasError("required")||this.form.get("severity")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}getEqu_Textarea(t){console.log("getValue",typeof t),this.equation_textarea_string=[],this.equation_textarea_string+=" "+t.toString().split("-")[0],null===this.form.value.equTextarea?(this.form.get("equTextarea")?.patchValue(""),this.form.get("equTextarea")?.setValue(this.form.get("equTextarea")?.value+this.equation_textarea_string)):this.form.get("equTextarea")?.setValue(this.form.get("equTextarea")?.value+this.equation_textarea_string)}addFromService(){this.columnDatatable=[],this.alertsDatatable=[],this.columnDatatable=[{data:"mn"},{data:"mn_label"},{data:"reading_device_type"},{data:"company_id"},{data:"updatedTime"}],this.alertsDatatable=[{data:"alert_datatype"},{data:"alert_variabletype"},{data:"parameterID"},{data:"severity"}],this.getRDT(),this.getWDT(),this.getCompany()}getOperationalSchedule(){this.operationalscheduleType.getSpecificOperationalSchedule(this.clientID).then(t=>{if(void 0!==t){if(this.data_temp=t,this.opsList_Alerts=[],this.opsList_Device=[],1==t.length){for(let i=0;i<=2;i++)if(0==i&&(this.opsList_Alerts.push("Disabled"),this.opsList_Device.push("None")),1==i&&this.opsList_Alerts.push("Always"),0!==i&&1!==i){let o=0;this.opsList_Alerts.push(t[o]?.PK+"-"+t[o]?.oslabel),this.opsList_Device.push(t[o]?.PK+"-"+t[o]?.oslabel)}}else if(0!==t.length)for(let i=0;i<=t.length;i++)0==i&&(this.opsList_Alerts.push("Disabled"),this.opsList_Device.push("None")),1==i&&this.opsList_Alerts.push("Always"),0!==i&&(this.opsList_Alerts.push(t[i-1]?.PK+"-"+t[i-1]?.oslabel),this.opsList_Device.push(t[i-1]?.PK+"-"+t[i-1]?.oslabel))}else this.opsList_Device.push("None")}).catch(t=>{console.log("cant fetch",t)})}getRDT(){this.getReadingDeviceType.getLookUpRDT(this.customInit.rdtName,this.clientID).then(t=>{if(t){console.log("GetRdt ",t),this.data_temp=t,this.getBindingParameters(this.data_temp),this.rdtList=[],console.log("get RDT",this.data_temp),this.parsedData=JSON.parse(this.data_temp.parameters),console.log("Parameters",this.parsedData[0].parameterID);for(let i=0;i<this.parsedData.length;i++)this.paramsBasedOnRDT.push(this.parsedData[i].parameterID+"-"+this.parsedData[i].parameterLabel);this.patchValues()}}).catch(t=>{console.log("cant fetch",t)})}getWDT(){this.getWritingDeviceType.getSpecificWDT(this.clientID).then(t=>{if(t){this.data_temp=t,this.wdtList=[];for(let i=0;i<t.length;i++)this.wdtList.push(t[i]?.PK+"-"+t[i]?.wdt_parameter_label)}}).catch(t=>{console.log("cant fetch",t)})}getCompany(){this.companyConfiguration.getSpecificCompany(this.clientID).then(t=>{if(t&&void 0!==t){this.data_temp=t,this.companyList=[];for(let i=0;i<t.length;i++)this.companyList.push(t[i]?.PK)}}).catch(t=>{console.log("cant fetch",t)})}getBindingParameters(t){console.log("Data Temp",t);let i="";i=this.customInit.rdtName,this.bindingParametersList=[];for(let o=0;o<t.length;o++)console.log("Coming",t[o].reading_device_type_id),console.log("rdtName packet",i),i==t[o].reading_device_type_id&&(this.parametersList=JSON.parse(t[o].parameters)),console.log("Parameters List",this.parametersList);for(let o=0;o<=this.parametersList.length;o++)0==o&&this.bindingParametersList.push({value:"All",text:"All"}),1==o&&this.bindingParametersList.push({value:"None",text:"None"}),0!==o&&this.bindingParametersList.push({value:this.parametersList[o-1].parameterID,text:this.parametersList[o-1].parameterID+"-"+this.parametersList[o-1].parameterLabel});this.paramsBasedOnRDT=[];for(let o=0;o<this.parametersList.length;o++)this.paramsBasedOnRDT.push({value:this.parametersList[o].parameterID,text:this.parametersList[o].parameterID+"-"+this.parametersList[o].parameterLabel});console.log("Binding Parameter based on rdt",this.bindingParametersList)}fetchTMData(t){var i=this;return(0,C.Z)(function*(){console.log("iam trying to fetch",i.clientID);try{const o=yield i.api.GetLookupRdt(i.clientID,t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h}=l[d];i.lookup_data_temp1.push({P1:f,P2:m,P3:v,P4:h}),console.log("d2 =",i.lookup_data_temp1)}}i.lookup_data_temp1.sort((u,l)=>l.P4-u.P4),console.log("Lookup sorting",i.lookup_data_temp1),yield i.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("RDT to be displayed",i.lookup_data_temp1)}catch(o){console.error("Error:",o)}})()}fetchNMData(t){var i=this;return(0,C.Z)(function*(){try{console.log(i.clientID,t);const o=yield i.api.GetLookupMasterTable(i.clientID+"#notification_matrix",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;console.log("server Response",l),i.Lookupdata.push(l)}yield i.fetchNMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.items is not a string.");else{console.log("Notification matrixs id are ",i.Lookupdata),i.listofNMIds=[];for(let r=0;r<i.Lookupdata.length;r++)try{const u=i.Lookupdata[r][`L${r+1}`];console.log("keyTemp ",u),i.listofNMIds.includes(u.P1)||i.listofNMIds.push(u.P1)}catch{continue}i.listofNMIds=Array.from(new Set(i.listofNMIds)),console.log("List of mn Lists",i.listofNMIds),i.form.get("notificationMatrixId")?.patchValue(i.defaultValues.notificationMatrixId),i.form.get("operator")?.patchValue(i.defaultValues.operator),i.form.get("parameter_operator")?.patchValue(i.defaultValues.parameter_operator)}}catch(o){console.error("Error:",o),console.log("Finished parsing through the pages"),console.log("ADDING TO THE TABLE")}})()}getInputField(){console.log("Iam Called Inside :");let t=this.form.get("alert_datatype")?.value.split("-");Array.isArray(t)&&2===t.length?(console.log("Checking second condition :"),"Prediction"==t[1].trim()?(console.log("Completly executed :"),this.showAlertTime=!0):this.showAlertTime=!1):this.showAlertTime=!1}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(B.t),e.Y36(P.F),e.Y36(P.F),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(P.F),e.Y36(e.sBO))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-alert-step1"]],inputs:{updateParentModel:"updateParentModel",customInit:"customInit",hideDeleteButton:"hideDeleteButton",defaultValues:"defaultValues"},decls:108,vars:14,consts:[[3,"formGroup"],[1,"row","mb-7"],[1,"col"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],["type","text","disabled","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"value"],[1,"required"],["ngbTooltip","Specify the data type of the alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","alert_datatype","formControlName","alert_datatype","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold",3,"change"],["value","","disabled","true",3,"selected"],["value","Spontaneous"],["value","Accumulated - Hour"],["value","Accumulated - Day"],["value","Accumulated - Month"],["value","Spontaneous - Prediction"],["value","Accumulated Hour - Prediction"],["value","Accumulated Day - Prediction"],["value","Accumulated Month - Prediction"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[1,"row"],[1,"col",2,"display","none"],["ngbTooltip","Alert ID will be Auto generated",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","text","placeholder","AlertID","name","alertID","formControlName","alertID",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["ngbTooltip"," Specify the variable type associated with this alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["formControlName","alert_variabletype","name","alert_variabletype","type","radio","id","kt_create_account_form_account_type_corporate","value","Constant",1,"btn-check"],["for","kt_create_account_form_account_type_corporate","id","btn1_atype",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center"],["name","briefcase",1,"fs-1","me-5"],[1,"d-block","fw-bold","text-start"],[1,"text-dark","fw-bolder","d-block","fs-4","mb-2"],["formControlName","alert_variabletype","name","alert_variabletype","type","radio","id","kt_create_account_form_account_type_personal","value","Parameter",1,"btn-check"],["for","kt_create_account_form_account_type_personal","id","btn2_atype",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],["name","address-book",1,"fs-1","me-5"],["formControlName","alert_variabletype","name","alert_variabletype","type","radio","id","kt_create_account_form_account_type_pers","value","Equation",1,"btn-check"],["for","kt_create_account_form_account_type_pers","id","btn3_atype",1,"btn","btn-outline","btn-outline-dashed","btn-outline-default","p-7","d-flex","align-items-center","mb-10"],["class","row mb-7",4,"ngIf"],["ngbTooltip","Set the percentage threshold for triggering this alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","placeholder","Enter Alert Percent","name","alert_percent","formControlName","alert_percent","appPreventScroll","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"disabled"],["ngbTooltip","Specify the identifier for the notification matrix associated with this alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","notificationMatrixId","formControlName","notificationMatrixId",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[3,"value",4,"ngFor","ngForOf"],["ngbTooltip","Set the severity level of this alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","severity","formControlName","severity","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","Major"],["value","Minor"],["class","col-sm-4",4,"ngIf"],[1,"fv-plugins-message-container","invalid-feedback"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","required"],[1,"custom-multiselect"],["name","parameterID",1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl"],["name","operator","formControlName","operator","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","null","disabled","true",3,"selected"],["value","Greater than >"],["value","Lesser than <"],["value","Greater than or Equal to >="],["value","Lesser than or Equal to <="],["value","Equal to =="],["value","Not Equal to !="],["value","Logical AND &&"],["value","Logical OR ||"],["value","XOR"],["type","number","placeholder","Enter value","name","operator_value","formControlName","operator_value","required","","appPreventScroll","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],[1,"col-sm-12"],["name","parameterID1",1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl"],["name","parameter_operator","formControlName","parameter_operator","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["name","parameterID2",1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl"],["name","paraID",1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl"],[1,"col-md-4",2,"padding-top","40px"],["type","button",1,"btn","btn-primary","fw-bold",2,"display","flex",3,"click"],[1,"fa","fa-plus-circle"],["placeholder","Enter equation","formControlName","equTextarea","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",2,"height","10px"],[3,"value"],[1,"col-sm-4"],["ngbTooltip","Set the threshold for triggering this alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","number","placeholder","Enter Threshold value","name","alertValuePrediction","formControlName","alertValuePrediction","appPreventScroll","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3)(4,"span"),e._uU(5,"MN"),e.qZA(),e._UZ(6,"br"),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"input",4),e.qZA()(),e.TgZ(9,"div",2)(10,"label",3)(11,"span"),e._uU(12,"MN Label"),e.qZA(),e._UZ(13,"br"),e.qZA(),e.TgZ(14,"div"),e._UZ(15,"input",4),e.qZA()(),e.TgZ(16,"div",2)(17,"label",3)(18,"span",5),e._uU(19,"Alert Data Type"),e.qZA(),e._UZ(20,"i",6),e.qZA(),e.TgZ(21,"select",7),e.NdJ("change",function(){return i.getInputField()}),e.TgZ(22,"option",8),e._uU(23,"Select Alert Datatype "),e.qZA(),e.TgZ(24,"option",9),e._uU(25,"Spontaneous "),e.qZA(),e.TgZ(26,"option",10),e._uU(27,"Accumulated - Hour "),e.qZA(),e.TgZ(28,"option",11),e._uU(29,"Accumulated - Day "),e.qZA(),e.TgZ(30,"option",12),e._uU(31,"Accumulated - Month "),e.qZA(),e.TgZ(32,"option",13),e._uU(33,"Spontaneous - Prediction "),e.qZA(),e.TgZ(34,"option",14),e._uU(35,"Accumulated Hour - Prediction "),e.qZA(),e.TgZ(36,"option",15),e._uU(37,"Accumulated Day - Prediction "),e.qZA(),e.TgZ(38,"option",16),e._uU(39,"Accumulated Month - Prediction "),e.qZA()(),e.YNc(40,Ht,2,0,"div",17),e.qZA()(),e.TgZ(41,"div",18)(42,"div",19)(43,"label",3)(44,"span"),e._uU(45,"Alert ID"),e.qZA(),e._UZ(46,"i",20),e.qZA(),e._UZ(47,"input",21),e.qZA()(),e.TgZ(48,"div",18)(49,"label",3)(50,"span",5),e._uU(51,"Alert Variable Type"),e.qZA(),e._UZ(52,"i",22),e.qZA(),e.TgZ(53,"div",2),e._UZ(54,"input",23),e.TgZ(55,"label",24),e._UZ(56,"app-keenicon",25),e.TgZ(57,"span",26)(58,"span",27),e._uU(59,"Constant"),e.qZA()()()(),e.TgZ(60,"div",2),e._UZ(61,"input",28),e.TgZ(62,"label",29),e._UZ(63,"app-keenicon",30),e.TgZ(64,"span",26)(65,"span",27),e._uU(66,"Parameter"),e.qZA()()()(),e.TgZ(67,"div",2),e._UZ(68,"input",31),e.TgZ(69,"label",32),e._UZ(70,"app-keenicon",30),e.TgZ(71,"span",26)(72,"span",27),e._uU(73,"Equation"),e.qZA()()()()(),e.YNc(74,Xt,37,8,"div",33),e.YNc(75,oi,40,12,"div",33),e.YNc(76,ri,18,6,"div",33),e.TgZ(77,"div",1)(78,"div",2)(79,"label",3)(80,"span",5),e._uU(81,"Alert Percent"),e.qZA(),e._UZ(82,"i",34),e.qZA(),e._UZ(83,"input",35),e.qZA(),e.TgZ(84,"div",2)(85,"label",3)(86,"span"),e._uU(87,"Notification Matrix ID"),e.qZA(),e._UZ(88,"i",36),e.qZA(),e.TgZ(89,"select",37)(90,"option",8),e._uU(91,"Select Notification Matrix ID "),e.qZA(),e.YNc(92,li,2,2,"option",38),e.qZA()(),e.TgZ(93,"div",2)(94,"label",3)(95,"span",5),e._uU(96,"Severity"),e.qZA(),e._UZ(97,"i",39),e.qZA(),e.TgZ(98,"select",40)(99,"option",8),e._uU(100,"Select Severity "),e.qZA(),e.TgZ(101,"option",41),e._uU(102,"Major"),e.qZA(),e.TgZ(103,"option",42),e._uU(104,"Minor"),e.qZA()(),e.YNc(105,si,2,0,"div",17),e.qZA()(),e.TgZ(106,"div",1),e.YNc(107,ci,6,0,"div",43),e.qZA()()),2&t){let o,r,u,l,d;e.Q6J("formGroup",i.form),e.xp6(8),e.s9C("value",i.customInit.deviceName),e.xp6(7),e.s9C("value",i.customInit.deviceLabel),e.xp6(7),e.Q6J("selected",!0),e.xp6(18),e.Q6J("ngIf",(null==(o=i.form.get("alert_datatype"))?null:o.hasError("required"))&&(null==(o=i.form.get("alert_datatype"))?null:o.touched)),e.xp6(34),e.Q6J("ngIf","Constant"===(null==(r=i.form.get("alert_variabletype"))?null:r.value)),e.xp6(1),e.Q6J("ngIf","Parameter"===(null==(u=i.form.get("alert_variabletype"))?null:u.value)),e.xp6(1),e.Q6J("ngIf","Equation"===(null==(l=i.form.get("alert_variabletype"))?null:l.value)),e.xp6(7),e.Q6J("disabled",!0),e.xp6(7),e.Q6J("selected",!0),e.xp6(2),e.Q6J("ngForOf",i.listofNMIds),e.xp6(7),e.Q6J("selected",!0),e.xp6(6),e.Q6J("ngIf",(null==(d=i.form.get("severity"))?null:d.hasError("required"))&&(null==(d=i.form.get("severity"))?null:d.touched)),e.xp6(2),e.Q6J("ngIf",1==i.showAlertTime)}},dependencies:[q.sg,q.O5,g.YN,g.Kr,g.Fj,g.wV,g.EJ,g._,g.JJ,g.JL,g.Q7,g.oH,g.sg,g.u,J._L,se.q,de.O,oe],styles:[".btn-check[_ngcontent-%COMP%]:checked + #btn1_atype[_ngcontent-%COMP%]{background-color:var(--bs-primary-light)}.btn-check[_ngcontent-%COMP%]:checked + #btn2_atype[_ngcontent-%COMP%]{background-color:var(--bs-primary-light)}.btn-check[_ngcontent-%COMP%]:checked + #btn3_atype[_ngcontent-%COMP%]{background-color:var(--bs-primary-light)}.btn-outline[_ngcontent-%COMP%]:hover{border:solid 1px}.fa-plus-circle[_ngcontent-%COMP%]{font-size:14px;margin-top:4%}[_nghost-%COMP%]     .custom-multiselect .form-select .multiselect-dropdown .dropdown-btn{border:none!important;font-weight:600;font-size:16px}input[disabled][_ngcontent-%COMP%]{cursor:not-allowed}"]})),p})();function di(n,p){1&n&&(e.TgZ(0,"div",12),e._uU(1," alert text active is required "),e.qZA())}function ui(n,p){1&n&&(e.TgZ(0,"div",12),e._uU(1," alert text closed is required "),e.qZA())}function pi(n,p){1&n&&(e.TgZ(0,"div",12),e._uU(1," alert text snoozed is required "),e.qZA())}let hi=(()=>{var n;class p{constructor(t,i,o,r,u){(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"data_temp",void 0),(0,a.Z)(this,"companyList",void 0),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),this.fb=t,this.companyConfiguration=i,this.getDiagnostics=o,this.operationalscheduleType=r,this.cdr=u}ngOnInit(){this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.clientID=this.getLoggedUser.attributes["custom:clientID"],this.initForm(),this.updateParentModel({},this.checkForm()),0==this.hideDeleteButton&&this.form.disable()}initForm(){console.log("inisde init Form",this.defaultValues);const t=this.defaultValues;this.form=this.fb.group({alert_text_active:[t?.alert_text_active,[g.kI.required]],alert_text_closed:[t?.alert_text_closed,[g.kI.required]],alert_text_snoozed:[t?.alert_text_snoozed,[g.kI.required]]});const i=this.form.valueChanges.subscribe(o=>{this.updateParentModel(o,this.checkForm())});this.unsubscribe.push(i)}checkForm(){return!(this.form.get("alert_text_active")?.hasError("required")||this.form.get("alert_text_closed")?.hasError("required")||this.form.get("alert_text_snoozed")?.hasError("required"))}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(P.F),e.Y36(e.sBO))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-alert-step2"]],inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",hideDeleteButton:"hideDeleteButton"},decls:23,vars:4,consts:[[3,"formGroup"],[1,"row","mb-7"],[1,"col"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],[1,"required"],["ngbTooltip","Enter the message to be sent when this alert is active",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","text","name","alert_text_active","formControlName","alert_text_active","placeholder","Enter text active","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],["ngbTooltip"," Enter the message to be sent when this alert is closed",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","text","name","alert_text_closed","formControlName","alert_text_closed","placeholder","Enter text closed","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["ngbTooltip","Enter the message to be sent when this alert is snoozed",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["type","text","name","alert_text_snoozed","formControlName","alert_text_snoozed","placeholder","Enter text snoozed","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],[1,"fv-plugins-message-container","invalid-feedback"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3)(4,"span",4),e._uU(5,"Active "),e.qZA(),e._UZ(6,"i",5),e.qZA(),e._UZ(7,"input",6),e.YNc(8,di,2,0,"div",7),e.qZA(),e.TgZ(9,"div",2)(10,"label",3)(11,"span",4),e._uU(12,"Closed "),e.qZA(),e._UZ(13,"i",8),e.qZA(),e._UZ(14,"input",9),e.YNc(15,ui,2,0,"div",7),e.qZA(),e.TgZ(16,"div",2)(17,"label",3)(18,"span",4),e._uU(19,"Snoozed "),e.qZA(),e._UZ(20,"i",10),e.qZA(),e._UZ(21,"input",11),e.YNc(22,pi,2,0,"div",7),e.qZA()()()),2&t){let o,r,u;e.Q6J("formGroup",i.form),e.xp6(8),e.Q6J("ngIf",(null==(o=i.form.get("alert_text_active"))?null:o.hasError("required"))&&(null==(o=i.form.get("alert_text_active"))?null:o.touched)),e.xp6(7),e.Q6J("ngIf",(null==(r=i.form.get("alert_text_closed"))?null:r.hasError("required"))&&(null==(r=i.form.get("alert_text_closed"))?null:r.touched)),e.xp6(7),e.Q6J("ngIf",(null==(u=i.form.get("alert_text_snoozed"))?null:u.hasError("required"))&&(null==(u=i.form.get("alert_text_snoozed"))?null:u.touched))}},dependencies:[q.O5,g.Fj,g.JJ,g.JL,g.Q7,g.sg,g.u,J._L]})),p})();function mi(n,p){if(1&n&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&n){const s=p.$implicit;e.Q6J("value",s),e.xp6(1),e.hij(" ",s," ")}}let _i=(()=>{var n;class p{constructor(t,i,o,r,u,l,d,f){(0,a.Z)(this,"getWritingDeviceType",void 0),(0,a.Z)(this,"getReadingDeviceType",void 0),(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"fb",void 0),(0,a.Z)(this,"companyConfiguration",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"operationalscheduleType",void 0),(0,a.Z)(this,"cdr",void 0),(0,a.Z)(this,"updateParentModel",void 0),(0,a.Z)(this,"form",void 0),(0,a.Z)(this,"defaultValues",void 0),(0,a.Z)(this,"step1Comp",void 0),(0,a.Z)(this,"customInit",void 0),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"data_temp",[]),(0,a.Z)(this,"companyList",void 0),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"getLoggedUser",void 0),(0,a.Z)(this,"opsList_Alerts",[]),(0,a.Z)(this,"dropdownSettings",{}),(0,a.Z)(this,"bindingParametersList",[]),(0,a.Z)(this,"Lookupdata",[]),(0,a.Z)(this,"listofNMIds",[]),(0,a.Z)(this,"columnDatatable",[]),(0,a.Z)(this,"alertsDatatable",[]),(0,a.Z)(this,"rdtList",[]),(0,a.Z)(this,"rdt_ID_alerts",[]),(0,a.Z)(this,"alert_binding_parameter_RDT",void 0),(0,a.Z)(this,"parametersList",[]),(0,a.Z)(this,"opsList_Device",[]),(0,a.Z)(this,"parsedData",[]),(0,a.Z)(this,"paramsBasedOnRDT",[]),(0,a.Z)(this,"wdtList",[]),(0,a.Z)(this,"lookup_data_temp1",[]),(0,a.Z)(this,"lookup_data_user",[]),this.getWritingDeviceType=t,this.getReadingDeviceType=i,this.api=o,this.fb=r,this.companyConfiguration=u,this.getDiagnostics=l,this.operationalscheduleType=d,this.cdr=f}ngAfterViewInit(){this.form.get("alert_time_based_ID")?.patchValue(this.defaultValues.alert_time_based_ID),this.form.get("binding_parameter")?.patchValue(this.defaultValues.binding_parameter)}ngOnInit(){this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.clientID=this.getLoggedUser.attributes["custom:clientID"],this.initForm(),this.updateParentModel({},this.checkForm()),this.addFromService(),0==this.hideDeleteButton&&this.form.disable(),this.dropdownSettings=this.getDiagnostics.getSettings(),this.getOS_alertTime(),console.log("All the inits are here",this.customInit)}initForm(){console.log("inisde init Form",this.defaultValues);const t=this.defaultValues;this.form=this.fb.group({alert_time:[t?.alert_time],binding_parameter:[t?.binding_parameter],alert_time_based_ID:[t?.alert_time_based_ID]});const i=this.form.valueChanges.subscribe(o=>{this.updateParentModel(o,this.checkForm()),this.cdr.detectChanges()});this.unsubscribe.push(i)}checkForm(){return!0}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}addFromService(){this.columnDatatable=[],this.alertsDatatable=[],this.columnDatatable=[{data:"mn"},{data:"mn_label"},{data:"reading_device_type"},{data:"company_id"},{data:"updatedTime"}],this.alertsDatatable=[{data:"alert_datatype"},{data:"alert_variabletype"},{data:"parameterID"},{data:"severity"}],this.getOperationalSchedule(1),this.getRDT(),this.getWDT(),this.getCompany()}getOperationalSchedule(t){var i=this;return(0,C.Z)(function*(){console.log("Iam called Bro");try{const o=yield i.api.GetLookupMasterTable(i.clientID+"#operationalschedule",t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v}=l[d];i.lookup_data_user.push({P1:f,P2:m,P3:v}),console.log("d2 =",i.lookup_data_user)}}i.lookup_data_user.sort((u,l)=>l.P3-u.P3),console.log("Lookup sorting",i.lookup_data_user),yield i.getOperationalSchedule(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",i.lookup_data_user);for(let r=0;r<=i.lookup_data_user.length;r++)0==r&&(i.opsList_Alerts.push("Disabled"),i.opsList_Device.push("None"),i.opsList_Alerts.push("None")),1==r&&i.opsList_Alerts.push("Always"),0!==r&&(i.opsList_Alerts.push(i.lookup_data_user[r-1]?.P1+"-"+i.lookup_data_user[r-1]?.P2),i.opsList_Device.push(i.lookup_data_user[r-1]?.P1+"-"+i.lookup_data_user[r-1]?.P2));i.form.get("alert_time_based_ID")?.patchValue(i.defaultValues.alert_time_based_ID)}}catch(o){console.error("Error:",o)}})()}getRDT(){this.getReadingDeviceType.getLookUpRDT(this.customInit.rdtName,this.clientID).then(t=>{if(t){console.log("GetRdt ",t),this.data_temp=t,this.getBindingParameters(this.data_temp),this.rdtList=[],console.log("get RDT",this.data_temp),this.parsedData=JSON.parse(this.data_temp.parameters),console.log("Parameters",this.parsedData[0].parameterID);for(let i=0;i<this.parsedData.length;i++)this.paramsBasedOnRDT.push(this.parsedData[i].parameterID+"-"+this.parsedData[i].parameterLabel)}}).catch(t=>{console.log("cant fetch",t)})}getWDT(){this.getWritingDeviceType.getSpecificWDT(this.clientID).then(t=>{if(t){this.data_temp=t,this.wdtList=[];for(let i=0;i<t.length;i++)this.wdtList.push(t[i]?.PK+"-"+t[i]?.wdt_parameter_label)}}).catch(t=>{console.log("cant fetch",t)})}getCompany(){this.companyConfiguration.getSpecificCompany(this.clientID).then(t=>{if(t&&void 0!==t){this.data_temp=t,this.companyList=[];for(let i=0;i<t.length;i++)this.companyList.push(t[i]?.PK)}}).catch(t=>{console.log("cant fetch",t)})}getBindingParameters(t){console.log("Data Temp",t);let i="";i=this.data_temp.PK,this.bindingParametersList=[],this.parametersList=JSON.parse(t.parameters),console.log("Parameters List",this.parametersList);for(let o=0;o<=this.parametersList.length;o++)0==o&&this.bindingParametersList.push({value:"None",text:"None"}),0!==o&&this.bindingParametersList.push({value:this.parametersList[o-1].parameterID,text:this.parametersList[o-1].parameterID+"-"+this.parametersList[o-1].parameterLabel});this.paramsBasedOnRDT=[];for(let o=0;o<this.parametersList.length;o++)this.paramsBasedOnRDT.push({value:this.parametersList[o].parameterID,text:this.parametersList[o].parameterID+"-"+this.parametersList[o].parameterLabel});console.log("Binding Parameter based on rdt",this.bindingParametersList)}fetchTMData(t){var i=this;return(0,C.Z)(function*(){console.log("iam trying to fetch",i.clientID);try{const o=yield i.api.GetLookupRdt(i.clientID,t);if(o&&o.items)if("string"==typeof o.items){let r=JSON.parse(o.items);if(console.log("d1 =",r),Array.isArray(r)){for(let u=0;u<r.length;u++){const l=r[u];if(null==l)break;{const d=Object.keys(l)[0],{P1:f,P2:m,P3:v,P4:h}=l[d];i.lookup_data_temp1.push({P1:f,P2:m,P3:v,P4:h}),console.log("d2 =",i.lookup_data_temp1)}}i.lookup_data_temp1.sort((u,l)=>l.P4-u.P4),console.log("Lookup sorting",i.lookup_data_temp1),yield i.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("RDT to be displayed",i.lookup_data_temp1)}catch(o){console.error("Error:",o)}})()}getOS_alertTime(){this.form.valueChanges.subscribe(t=>{if(t.alert_time){let i=this.customInit.operational_hours;console.log("VAlue to be patched",i),"NONE"==i||"None"==i?(this.form.get("alert_time_based_ID")?.patchValue(this.opsList_Alerts[1],{emitEvent:!1}),this.form.get("alert_time_based_ID")?.disable({emitEvent:!1})):(this.form.get("alert_time_based_ID")?.patchValue(i,{emitEvent:!1}),this.form.get("alert_time_based_ID")?.disable({emitEvent:!1}))}else this.form.get("alert_time_based_ID")?.enable({emitEvent:!1})})}onSelectAll(t){console.log("All the items :",t);const i=t.findIndex(o=>"None"===o.value);i>-1&&t.splice(i,1),t.push({value:"All",text:"All"}),this.form.controls.binding_parameter.setValue(t),this.cdr.detectChanges()}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(P.F),e.Y36(P.F),e.Y36(B.t),e.Y36(g.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(P.F),e.Y36(e.sBO))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-alert-step3"]],viewQuery:function(t,i){if(1&t&&e.Gf(ue,5),2&t){let o;e.iGM(o=e.CRH())&&(i.step1Comp=o.first)}},inputs:{updateParentModel:"updateParentModel",defaultValues:"defaultValues",customInit:"customInit",hideDeleteButton:"hideDeleteButton"},decls:26,vars:7,consts:[[3,"formGroup"],[1,"row","mb-7"],[1,"col"],[1,"d-flex","align-items-center","fs-6","fw-bold","form-label","mb-2"],["ngbTooltip","Specify Alert Time",1,"fas","fa-exclamation-circle","ms-2","fs-7"],[1,"form-check","form-check-inline","form-check-solid","me-5","mt-4"],["name","report","type","checkbox","formControlName","alert_time","required","",1,"form-check-input"],["ngbTooltip","Specify an identifier for this time-based alert",1,"fas","fa-exclamation-circle","ms-2","fs-7"],["name","alert_time_based_ID","formControlName","alert_time_based_ID","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","","disabled","true",3,"selected"],[3,"value",4,"ngFor","ngForOf"],["ngbTooltip","Select Binding Reading Parameter",1,"fas","fa-exclamation-circle","ms-2","fs-7"],[1,"custom-multiselect"],["name","binding_parameter",1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl","onSelectAll"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3)(4,"span"),e._uU(5,"Alert Time"),e.qZA(),e._UZ(6,"i",4),e.qZA(),e.TgZ(7,"label",5),e._UZ(8,"input",6),e.TgZ(9,"span"),e._uU(10,"Same as Operational Schedule"),e.qZA()()(),e.TgZ(11,"div",2)(12,"label",3)(13,"span"),e._uU(14,"Operational ID"),e.qZA(),e._UZ(15,"i",7),e.qZA(),e.TgZ(16,"select",8)(17,"option",9),e._uU(18,"Select Operational ID "),e.qZA(),e.YNc(19,mi,2,2,"option",10),e.qZA()(),e.TgZ(20,"div",2)(21,"label",3),e._uU(22,"Add Binding Reading Parameter"),e._UZ(23,"i",11),e.qZA(),e.TgZ(24,"div",12)(25,"ng-multiselect-dropdown",13),e.NdJ("onSelectAll",function(r){return i.onSelectAll(r)}),e.qZA()()()()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(17),e.Q6J("selected",!0),e.xp6(2),e.Q6J("ngForOf",i.opsList_Alerts),e.xp6(6),e.Q6J("placeholder","Select Binding Reading Parameters")("settings",i.dropdownSettings)("data",i.bindingParametersList)("formControl",i.form.controls.binding_parameter))},dependencies:[q.sg,g.YN,g.Kr,g.Wl,g.EJ,g.JJ,g.JL,g.Q7,g.Zs,g.oH,g.sg,g.u,J._L,de.O],styles:["input[disabled][_ngcontent-%COMP%]{cursor:not-allowed}"]})),p})(),fi=(()=>{var n;class p{}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-alert-step4"]],decls:5,vars:0,consts:[[1,"pb-10","pb-lg-15",2,"align-items","center"],[1,"fw-bolder","text-dark"],[1,"fs-6","text-gray-600","mb-5"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"You Are Done!"),e.qZA(),e.TgZ(3,"div",2),e._uU(4," Alert Configured Successfully "),e.qZA()())}})),p})();function gi(n,p){1&n&&(e.TgZ(0,"h1",36),e._uU(1,"Add Alert Configuration"),e.qZA())}function vi(n,p){1&n&&(e.TgZ(0,"h1",36),e._uU(1,"Update Alert Configuration"),e.qZA())}function bi(n,p){if(1&n&&(e.TgZ(0,"a",37),e._uU(1),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.Oqu(s.editedAlert)}}function yi(n,p){if(1&n&&(e.ynx(0),e._UZ(1,"app-alert-step1",38),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("customInit",s.customInit)("hideDeleteButton",s.hideDeleteButton)}}function Di(n,p){if(1&n&&(e.ynx(0),e._UZ(1,"app-alert-step2",39),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("hideDeleteButton",s.hideDeleteButton)}}function Zi(n,p){if(1&n&&(e.ynx(0),e._UZ(1,"app-alert-step3",38),e.BQk()),2&n){const s=e.oxw();e.xp6(1),e.Q6J("updateParentModel",s.updateAccount)("defaultValues",s.account$.value)("customInit",s.customInit)("hideDeleteButton",s.hideDeleteButton)}}function Ti(n,p){1&n&&(e.ynx(0),e._UZ(1,"app-alert-step4",40),e.BQk())}function Ci(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"button",41),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.prevStep())}),e._UZ(2,"i",42),e._uU(3," Back "),e.qZA(),e.BQk()}}function Ii(n,p){1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n&&(e.xp6(1),e.hij(" Continue "," "," "))}function xi(n,p){if(1&n){const s=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"button",43),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.nextStep())}),e.TgZ(3,"span",44),e.YNc(4,Ii,2,1,"ng-container",23),e.qZA(),e._UZ(5,"i",45),e.qZA()(),e.BQk()}if(2&n){const s=e.oxw();e.xp6(2),e.Q6J("disabled",!s.isCurrentFormValid$.value),e.xp6(2),e.Q6J("ngIf",s.alertCurrentStep$.value<s.formsCount-1)}}function Ai(n,p){1&n&&(e.ynx(0),e._uU(1," Submit "),e.BQk())}function Pi(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(s);const i=e.oxw(2);return i.OnSubmit(),e.KtG(i.nextStep())}),e.TgZ(1,"span",44),e.YNc(2,Ai,2,0,"ng-container",23),e.qZA()()}if(2&n){const s=e.oxw(2);e.Q6J("disabled",!s.isCurrentFormValid$.value||!s.hideDeleteButton),e.xp6(2),e.Q6J("ngIf",s.alertCurrentStep$.value===s.formsCount-1)}}function wi(n,p){1&n&&(e.ynx(0),e._uU(1," Update "),e.BQk())}function Si(n,p){if(1&n){const s=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(s);const i=e.oxw(2);return i.updateAlert(),e.KtG(i.nextStep())}),e.TgZ(1,"span",44),e.YNc(2,wi,2,0,"ng-container",23),e.qZA()()}if(2&n){const s=e.oxw(2);e.Q6J("disabled",!s.isCurrentFormValid$.value||!s.hideDeleteButton),e.xp6(2),e.Q6J("ngIf",s.alertCurrentStep$.value===s.formsCount-1)}}function ki(n,p){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e.YNc(2,Pi,3,2,"button",46),e.YNc(3,Si,3,2,"ng-template",null,47,e.W1O),e.qZA(),e.BQk()),2&n){const s=e.MAs(4),t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.EditOperation)("ngIfElse",s)}}function qi(n,p){1&n&&(e.TgZ(0,"table",48)(1,"thead")(2,"tr")(3,"th"),e._uU(4,"Alert ID"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Data Type"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Variable Type"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Parameter"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Operator/Equation"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Severity"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Updated"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Edit"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Delete"),e.qZA()()()())}const pe=function(n,p){return{current:n,completed:p}},Ni=[{path:"",component:Ze,children:[{path:"add",component:Yt},{path:"alerts",component:(()=>{var n;class p{constructor(t,i,o,r,u,l,d,f,m){(0,a.Z)(this,"deviceState",void 0),(0,a.Z)(this,"toast",void 0),(0,a.Z)(this,"api",void 0),(0,a.Z)(this,"route",void 0),(0,a.Z)(this,"cd",void 0),(0,a.Z)(this,"getDiagnostics",void 0),(0,a.Z)(this,"router",void 0),(0,a.Z)(this,"spinner",void 0),(0,a.Z)(this,"auditTrialServices",void 0),(0,a.Z)(this,"customInit",void 0),(0,a.Z)(this,"addAlertInTable",!1),(0,a.Z)(this,"temp_alertDetails",[]),(0,a.Z)(this,"alerts_Table",[]),(0,a.Z)(this,"tempArray",[]),(0,a.Z)(this,"columnDatatable",[]),(0,a.Z)(this,"alertsDatatable",[]),(0,a.Z)(this,"opsList_Alerts",void 0),(0,a.Z)(this,"opsList_Device",void 0),(0,a.Z)(this,"valuesHolder",void 0),(0,a.Z)(this,"username",void 0),(0,a.Z)(this,"clientID",void 0),(0,a.Z)(this,"getLoggedUser",[]),(0,a.Z)(this,"multi_Alerts",[]),(0,a.Z)(this,"allDatas",void 0),(0,a.Z)(this,"currentState",void 0),(0,a.Z)(this,"EditOperation",!1),(0,a.Z)(this,"allPermissions_user",[]),(0,a.Z)(this,"hideDeleteButton",void 0),(0,a.Z)(this,"maxlength",500),(0,a.Z)(this,"formsCount",4),(0,a.Z)(this,"step1Comp",void 0),(0,a.Z)(this,"account$",new Q.X(I)),(0,a.Z)(this,"alertCurrentStep$",new Q.X(1)),(0,a.Z)(this,"isCurrentFormValid$",new Q.X(!1)),(0,a.Z)(this,"unsubscribe",[]),(0,a.Z)(this,"parameterList",void 0),(0,a.Z)(this,"editedAlert",void 0),(0,a.Z)(this,"updateAccount",(v,h)=>{const A={...this.account$.value,...v};this.account$.next(A),this.isCurrentFormValid$.next(h)}),this.deviceState=t,this.toast=i,this.api=o,this.route=r,this.cd=u,this.getDiagnostics=l,this.router=d,this.spinner=f,this.auditTrialServices=m,this.router.events.subscribe(v=>{v instanceof K.m2&&(I.enable_sms=null,I.parameterID2="",I.alert_percent=0,I.parameterID1="",I.operator="",I.alert_text_snoozed="",I.alert_text_closed="",I.alert_time_based_ID="",I.equTextarea="",I.alertValuePrediction=0,I.escalation_level=0,I.alert_variabletype="",I.parameter_operator="",I.severity="",I.alert_time=!1,I.parameterID="",I.operator_value=20,I.alert_text_active="",I.enable_type_1=null,I.enable_type_2=null,I.enable_type_3=null,I.enable_type_4=null,I.enable_type_5=null,I.enable_email=null,I.enable_telegram=null,I.alertID="",I.alert_datatype="",I.levels=[],I.notificationMatrixId="",this.account$.next(I))})}ngOnInit(){this.deviceState.state$.subscribe(i=>{this.currentState=i,console.log("currentSTate",this.currentState)});const t=localStorage.getItem("customInit");this.customInit=t?JSON.parse(t):null,console.log("localstrorage",this.customInit),this.valuesHolder=I,this.getLoggedUser=this.getDiagnostics.getLoggedUserDetails(),this.clientID=this.getLoggedUser.attributes["custom:clientID"],this.username=this.getLoggedUser.attributes["custom:username"],console.log("alertscheck",this.customInit),this.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),this.addFromService()}nextStep(){const t=this.alertCurrentStep$.value+1;t>this.formsCount||this.alertCurrentStep$.next(t)}prevStep(){const t=this.alertCurrentStep$.value-1;0!==t&&this.alertCurrentStep$.next(t)}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}addFromService(){var t=this;this.columnDatatable=[],this.alertsDatatable=[],this.columnDatatable=[{data:"mn"},{data:"mn_label"},{data:"reading_device_type"},{data:"company_id"},{data:"updatedTime"}],this.alertsDatatable=[{data:"alert_datatype"},{data:"alert_variabletype"},{data:"parameterID"},{data:"severity"}],this.checkPermission(),console.log("getting the RDT parameters is here ");try{this.api.GetReadingDeviceType(this.customInit.rdtName,this.clientID).then(function(){var i=(0,C.Z)(function*(o){o?(t.parameterList=JSON.parse(o.parameters||""),console.log("All the reading device parameters are here ",o),t.showTable()):x().fire({title:"RDT Not Found",text:"The requested RDT may have been deleted or not added. Please consider adding a new RDT for this Device.",icon:"error",confirmButtonText:"OK"})});return function(o){return i.apply(this,arguments)}}())}catch{console.log("Error fetching RDT parameters")}}checkPermission(){let t=!1,i=!1;for(let o=0;o<this.allPermissions_user.length;o++)"Device - Update"===this.allPermissions_user[o]?t=!0:"Device - View"===this.allPermissions_user[o]&&(i=!0);t&&i||t?this.hideDeleteButton=!0:i?this.hideDeleteButton=!1:this.router.navigate(["/404"])}showTable(){const t=localStorage.getItem("customInit");if(this.customInit=t?JSON.parse(t):null,this.auditTrialServices.audit_trail("2.1","Device","View",`${this.customInit.deviceLabel} Device Alerts Table was viewed`,"1"),null!=this.customInit.alerts_configured){this.alerts_Table=[];for(let d=0;d<this.customInit.alerts_configured.length;d++){const m=(this.customInit.alerts_configured[d]?.alertID??"").split("_"),U=new Date(1e3*(m.length>0?m[m.length-1]:"")).toLocaleString("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});this.alerts_Table.push({alertID:this.customInit.alerts_configured[d].alertID,alert_datatype:this.customInit.alerts_configured[d].alert_datatype,alert_variabletype:this.customInit.alerts_configured[d].alert_variabletype,parameterID:this.customInit.alerts_configured[d].parameterID,equTextarea:this.customInit.alerts_configured[d].equTextarea,severity:this.customInit.alerts_configured[d].severity,alert_percent:this.customInit.alerts_configured[d].alert_percent,alert_text_active:this.customInit.alerts_configured[d].alert_text_active,alert_text_closed:this.customInit.alerts_configured[d].alert_text_closed,alert_text_snoozed:this.customInit.alerts_configured[d].alert_text_snoozed,alert_time:this.customInit.alerts_configured[d].alert_time,alert_time_based_ID:this.customInit.alerts_configured[d].alert_time_based_ID,parameterID1:this.customInit.alerts_configured[d].parameterID1,parameterID2:this.customInit.alerts_configured[d].parameterID2,parameterLabel:this.getParameterLabel(this.customInit.alerts_configured[d]),parameterlabel2:this.getParameterlabel2(this.customInit.alerts_configured[d]),alertValuePrediction:this.customInit.alerts_configured[d].alertValuePrediction,parameter_operator:this.customInit.alerts_configured[d].parameter_operator,operator:this.customInit.alerts_configured[d].operator,operator_value:this.customInit.alerts_configured[d].operator_value,operational_schedule:this.customInit.alerts_configured[d].operational_schedule,binding_parameter:this.customInit.alerts_configured[d].binding_parameter,enable_email:this.customInit.alerts_configured[d].enable_email,enable_sms:this.customInit.alerts_configured[d].enable_sms,enable_telegram:this.customInit.alerts_configured[d].enable_telegram,enable_type_1:this.customInit.alerts_configured[d].enable_type_1,enable_type_2:this.customInit.alerts_configured[d].enable_type_2,enable_type_3:this.customInit.alerts_configured[d].enable_type_3,enable_type_4:this.customInit.alerts_configured[d].enable_type_4,enable_type_5:this.customInit.alerts_configured[d].enable_type_5,notificationMatrixId:this.customInit.alerts_configured[d].notificationMatrixId,alert_updated:this.customInit.alerts_configured[d].alert_updated?this.customInit.alerts_configured[d].alert_updated:U})}}console.log("Alert Table",this.alerts_Table);for(let d=0;d<this.alerts_Table.length;d++){let f=this.calculateCRC(this.alerts_Table[d]);console.log("The CRC obkect is :",this.alerts_Table[d]),console.log("Final CRC :",f+"Type of ",typeof this.alerts_Table[d]),console.log("CRC16 checksum for the object:",f.toString(16).toUpperCase())}$("#alert_tables").off("click"),$("#alert_tables").on("click",".editdeletealerts",function(){let d=$(this).closest("tr"),f=u.row(d),m=f.index();"btn btn-sm btn-primary editdeletealerts"==this.className?(l.alertCurrentStep$.next(1),l.editAlertFromDatatable(f.data(),m)):"btn btn-sm btn-danger editdeletealerts"==this.className&&l.deleteDeviceConfigurationLocally(f.data())});const r={pagingType:"full_numbers",destroy:!0,lengthChange:!0,responsive:!0,data:this.alerts_Table,columns:[{data:"alertID",visible:!1},{data:"alert_datatype"},{data:"alert_variabletype"},{data:"parameterLabel",render:function(d,f,m){return d||m.parameterID||m.parameterID1||m.parameterID1||""}},{data:"equTextarea",render:function(d,f,m){if(d&&"Equation"===m.alert_variabletype)return`<span data-bs-toggle="tooltip" title="${d}"><i class="fas fa-exclamation-circle ms-2 fs-7"></i></span>`;{let v="";return v=m.parameter_operator&&"Parameter"==m.alert_variabletype?"XOR"==m.parameter_operator?m.parameter_operator:m.parameter_operator.split(" ").pop():"XOR"==m.operator?m.operator:m.operator.split(" ").pop(),console.log("Operator text is ",v),`${v} ${null!=m.operator_value&&"Parameter"!=m.alert_variabletype?m.operator_value:m.parameterlabel2}`}}},{data:"severity"},{data:"alert_updated"},{defaultContent:"<button class='btn btn-sm btn-primary editdeletealerts' data-bs-dismiss='modal'><i class='fa fa-edit'></i></button>"},{defaultContent:`<button class='btn btn-sm btn-danger editdeletealerts' ${this.hideDeleteButton?"":"disabled"}><i class='fa fa-trash'></i></button>`}],dom:"Bfrtip",buttons:[{extend:"colvis",text:"Column Visibility"}],order:[[6,"asc"]]};let u=$("#alert_tables").DataTable(r);$("#alert_tables").off("click"),$("#alert_tables").on("click",".editdeletealerts",function(){let d=$(this).closest("tr"),f=u.row(d),m=f.index();$(this).hasClass("btn-primary")?(l.alertCurrentStep$.next(1),l.editAlertFromDatatable(f.data(),m)):$(this).hasClass("btn-danger")&&l.deleteDeviceConfigurationLocally(f.data())});let l=this}getParameterlabel2(t){let i="";if(Array.isArray(this.parameterList)&&this.parameterList.length>0)if("Parameter"===t.alert_variabletype){const o=this.parameterList.find(r=>r.parameterID===t.parameterID2);o&&o.parameterLabel&&(i=o.parameterLabel)}else i="";return i}getParameterLabel(t){let i="";if(Array.isArray(this.parameterList)&&this.parameterList.length>0)if("Constant"===t.alert_variabletype){const o=this.parameterList.find(r=>r.parameterID===t.parameterID);if(console.log("Filtered constant is ",o),!o)return x().fire({icon:"error",title:"Oops! RDT Mismatch",text:"It looks like the selected device alerts are set to a different RDT. To proceed, please either switch back to the original RDT or remove the current alerts and add new ones.",confirmButtonText:"Got it!"});o&&o.parameterLabel&&(i=o.parameterLabel)}else if("Parameter"===t.alert_variabletype){const o=this.parameterList.find(r=>r.parameterID===t.parameterID1);if(console.log("Filtered constant is ",o),!o)return x().fire({icon:"error",title:"Oops! RDT Mismatch",text:"It looks like the selected device alerts are set to a different RDT. To proceed, please either switch back to the original RDT or remove the current alerts and add new ones.",confirmButtonText:"Got it!"});o&&o.parameterLabel&&(i=o.parameterLabel)}return i}editAlertFromDatatable(t,i){this.EditOperation=!0,console.log("EDIT FORM DATATABLE ALERT CONFIGURATION",t),console.log("EDIT FORM DATATABLE ALERT CONFIGURATION INDEX",i),this.auditTrialServices.audit_trail("2.1","Device","View",`${this.customInit.deviceLabel} Device Alert was viewed`,"1"),this.editedAlert=t.alertID;const o=this.valuesHolder;o.alert_datatype=t.alert_datatype,o.enable_sms=t.enable_sms,o.parameterID2=t.parameterID2,o.alert_percent=t.alert_percent,o.parameterID1=t.parameterID1,o.operator=t.operator,o.alert_text_snoozed=t.alert_text_snoozed,o.alert_text_closed=t.alert_text_closed,o.equTextarea=t.equTextarea,o.alertValuePrediction=t.alertValuePrediction,o.escalation_level=t.escalation,o.alert_variabletype=t.alert_variabletype,o.parameter_operator=t.parameter_operator,o.severity=t.severity,o.alert_time=t.alert_time,o.parameterID=t.parameterID,o.operator_value=t.operator_value,o.alert_text_active=t.alert_text_active,o.enable_type_1=t.enable_type_1,o.enable_type_2=t.enable_type_2,o.enable_type_3=t.enable_type_3,o.enable_type_4=t.enable_type_4,o.enable_type_5=t.enable_type_5,o.binding_parameter=t.binding_parameter,o.enable_email=t.enable_email,o.enable_telegram=t.enable_telegram,o.alertID=t.alertID,o.alert_datatype=t.alert_datatype,o.levels=[],o.alert_time_based_ID=t.alert_time_based_ID,o.notificationMatrixId=t.notificationMatrixId,console.log("befor edit row",this.valuesHolder),this.account$.next(this.valuesHolder),setTimeout(()=>{this.step1Comp.initForm()},100),this.cd.detectChanges()}redirectNewAlert(){4!=this.alertCurrentStep$.value?x().fire({customClass:{container:"my-swal"},position:"center",title:"Are you sure?",text:"you want to cancel the Add/Update Alert process?",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(t=>{console.log("inside sweetalert",t),t.dismiss!==x().DismissReason.cancel&&1==t.isConfirmed&&this.newAlert()}):this.newAlert()}newAlert(){this.editedAlert="",this.EditOperation=!1;const t=I;t.alert_datatype="null",t.enable_sms=!1,t.parameterID2="",t.alert_percent=0,t.parameterID1="",t.operator="",t.alert_text_snoozed="",t.alert_text_closed="",t.equTextarea="",t.alertValuePrediction=0,t.escalation_level=0,t.alert_variabletype="",t.parameter_operator="",t.severity="",t.alert_time=!1,t.parameterID="",t.operator_value=0,t.alert_text_active="",t.enable_type_1=!1,t.enable_type_2=!1,t.enable_type_3=!1,t.enable_type_4=!1,t.enable_type_5=!1,t.binding_parameter=[{text:"None",value:"None"}],t.enable_email=!1,t.enable_telegram=!1,t.alertID="",t.alert_datatype="",t.levels=[],t.alert_time_based_ID="",t.notificationMatrixId="",this.cd.detectChanges(),this.account$.next(I),this.isCurrentFormValid$.next(!1),this.alertCurrentStep$.next(1),setTimeout(()=>{this.step1Comp.initForm()},100),console.log("new Button",I)}OnSubmit(){this.spinner.show();const o=(new Date).toLocaleString("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});console.log("After Submit inits",this.customInit),console.log("After Submit valuesform",this.valuesHolder),console.log("from button AFTER SUBMIT",this.account$.value);const r=Math.floor(Date.now()/1e3),l=this.valuesHolder;l.alertID=this.username+"_"+this.clientID+"_"+r,l.alert_datatype=this.account$.value.alert_datatype,l.enable_sms=this.account$.value.enable_sms,l.parameterID2=this.account$.value.parameterID2||"",l.alert_percent=this.account$.value.alert_percent,l.parameterID1=this.account$.value.parameterID1||"",l.operator=this.account$.value.operator,l.alert_text_snoozed=this.account$.value.alert_text_snoozed,l.alert_text_closed=this.account$.value.alert_text_closed,l.equTextarea=this.account$.value.equTextarea,l.alert_variabletype=this.account$.value.alert_variabletype,l.parameter_operator=this.account$.value.parameter_operator,l.severity=this.account$.value.severity,l.alert_time=this.account$.value.alert_time,l.parameterID=this.account$.value.parameterID||"",l.operator_value=this.account$.value.operator_value,l.alert_text_active=this.account$.value.alert_text_active,l.enable_type_1=this.account$.value.enable_type_1,l.enable_type_2=this.account$.value.enable_type_2,l.enable_type_3=this.account$.value.enable_type_3,l.enable_type_4=this.account$.value.enable_type_4,l.enable_type_5=this.account$.value.enable_type_5,l.alertValuePrediction=this.account$.value.alertValuePrediction,l.binding_parameter=this.account$.value.binding_parameter,l.enable_email=this.account$.value.enable_email,l.enable_telegram=this.account$.value.enable_telegram,l.alert_datatype=this.account$.value.alert_datatype,l.levels=[],l.notificationMatrixId=this.account$.value.notificationMatrixId,l.alert_time_based_ID=this.account$.value.alert_time_based_ID,console.log("Final valuesform",[this.valuesHolder]),this.tempArray=[],this.tempArray.push({alertID:this.valuesHolder.alertID,alert_datatype:this.valuesHolder.alert_datatype,alert_variabletype:this.valuesHolder.alert_variabletype,parameterID:this.convertToString(this.valuesHolder.parameterID),severity:this.valuesHolder.severity,alert_percent:this.valuesHolder.alert_percent,alert_text_active:this.valuesHolder.alert_text_active,alert_text_closed:this.valuesHolder.alert_text_closed,alert_text_snoozed:this.valuesHolder.alert_text_snoozed,alert_time:this.valuesHolder.alert_time,alert_time_based_ID:this.valuesHolder.alert_time_based_ID,parameterID1:this.convertToString(this.valuesHolder.parameterID1),parameterID2:this.convertToString(this.valuesHolder.parameterID2),equTextarea:this.valuesHolder.equTextarea,parameter_operator:this.valuesHolder.parameter_operator,operator:this.valuesHolder.operator,operator_value:this.valuesHolder.operator_value,binding_parameter:this.valuesHolder.binding_parameter,operational_schedule:!0,alertValuePrediction:this.valuesHolder.alertValuePrediction,enable_email:this.valuesHolder.enable_email,enable_sms:this.valuesHolder.enable_sms,enable_telegram:this.valuesHolder.enable_telegram,enable_type_1:this.valuesHolder.enable_type_1,enable_type_2:this.valuesHolder.enable_type_2,enable_type_3:this.valuesHolder.enable_type_3,enable_type_4:this.valuesHolder.enable_type_4,enable_type_5:this.valuesHolder.enable_type_5,notificationMatrixId:this.valuesHolder.notificationMatrixId});const d=[{alert_datatype:this.valuesHolder.alert_datatype,alert_variabletype:this.valuesHolder.alert_variabletype,parameterID:this.convertToString(this.valuesHolder.parameterID),severity:this.valuesHolder.severity,alert_percent:this.valuesHolder.alert_percent,alert_time:this.valuesHolder.alert_time,alert_time_based_ID:this.valuesHolder.alert_time_based_ID,parameterID1:this.convertToString(this.valuesHolder.parameterID1),parameterID2:this.convertToString(this.valuesHolder.parameterID2),equTextarea:this.valuesHolder.equTextarea,parameter_operator:this.valuesHolder.parameter_operator,operator:this.valuesHolder.operator,operator_value:this.valuesHolder.operator_value,alertValuePrediction:this.valuesHolder.alertValuePrediction,notificationMatrixId:this.valuesHolder.notificationMatrixId}];console.log("crcArray ",d[0]);let f=this.calculateCRC(d[0]),m=!1;for(let v=0;v<this.alerts_Table.length;v++){console.log("this.alerts_Table[i] ",this.alerts_Table[v]);const{alert_datatype:h,alert_variabletype:D,parameterID:A,severity:U,alert_percent:S,alert_time:R,alert_time_based_ID:M,parameterID1:L,parameterID2:y,equTextarea:c,parameter_operator:O,operator:F,operator_value:Z,alertValuePrediction:T,notificationMatrixId:V}=this.alerts_Table[v],Y=[{alert_datatype:h,alert_variabletype:D,parameterID:A,severity:U,alert_percent:S,alert_time:R,alert_time_based_ID:M,parameterID1:L,parameterID2:y,equTextarea:c,parameter_operator:O,operator:F,operator_value:Z,alertValuePrediction:T,notificationMatrixId:V}],re=this.calculateCRC(Y[0]);console.log("currentCRCArray ",Y[0]),console.log("checkCRC",f,"typeof ",typeof f,"currentCRC",re,typeof re),f===re&&(m=!0,this.spinner.hide(),console.log("Duplicate alert found at index",v),x().fire({position:"center",title:"Already added?",text:"Alert Already Added with this condtion: Do you want to continue ",icon:"warning",allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Continue"}).then(z=>{z.isConfirmed?this.helpherAlertUpdate(o):(this.alertCurrentStep$.next(1),this.cd.detectChanges())}))}m||this.helpherAlertUpdate(o)}helpherAlertUpdate(t){const o=this.calculateCRC(this.tempArray[0]).toString(16).toUpperCase();this.showTable();for(let r=0;r<this.alerts_Table.length;r++){let u=this.calculateCRC(this.alerts_Table[r]);if(console.log("check1",o+"==="+u.toString(16).toUpperCase()),o==u.toString(16).toUpperCase()){let l=[];return"Equation"==this.valuesHolder.alert_variabletype?(l=this.valuesHolder.equTextarea.split("-"),x().fire({position:"center",title:"Already added?",text:"Alert Already Added with this condtion :  "+l[1],icon:"warning",allowOutsideClick:!1})):x().fire({position:"center",title:"Already added?",text:"Alert Already Added with this condtion :  "+this.valuesHolder.parameterID+" "+this.valuesHolder.parameterID1,icon:"warning",allowOutsideClick:!1})}}null==this.customInit.alerts_configured&&(this.customInit.alerts_configured=[]),this.customInit.alerts_configured.push(this.valuesHolder),this.alerts_Table.push({alertID:this.valuesHolder.alertID,alert_datatype:this.valuesHolder.alert_datatype,alert_variabletype:this.valuesHolder.alert_variabletype,parameterID:this.convertToString(this.valuesHolder.parameterID),severity:this.valuesHolder.severity,alert_percent:this.valuesHolder.alert_percent,alert_text_active:this.valuesHolder.alert_text_active,alert_text_closed:this.valuesHolder.alert_text_closed,alert_text_snoozed:this.valuesHolder.alert_text_snoozed,alert_time:this.valuesHolder.alert_time,alert_time_based_ID:this.valuesHolder.alert_time_based_ID,parameterID1:this.convertToString(this.valuesHolder.parameterID1),parameterID2:this.convertToString(this.valuesHolder.parameterID2),equTextarea:this.valuesHolder.equTextarea,parameter_operator:this.valuesHolder.parameter_operator,operator:this.valuesHolder.operator,operator_value:this.valuesHolder.operator_value,binding_parameter:this.valuesHolder.binding_parameter,operational_schedule:this.valuesHolder.alert_time,alertValuePrediction:this.valuesHolder.alertValuePrediction,enable_email:this.valuesHolder.enable_email,enable_sms:this.valuesHolder.enable_sms,enable_telegram:this.valuesHolder.enable_telegram,enable_type_1:this.valuesHolder.enable_type_1,enable_type_2:this.valuesHolder.enable_type_2,enable_type_3:this.valuesHolder.enable_type_3,enable_type_4:this.valuesHolder.enable_type_4,enable_type_5:this.valuesHolder.enable_type_5,escalation_level:this.valuesHolder.escalation_level,levels:this.valuesHolder.levels,notificationMatrixId:this.valuesHolder.notificationMatrixId,alert_updated:t}),console.log("key is multi alerts",this.alerts_Table),this.updateDeviceConfiguration(this.customInit,"alerts"),console.log("final customINIT",this.customInit.alerts_configured),console.log("final customINIT Object",this.customInit)}convertToString(t){if(Array.isArray(t)){let o=t.join(",").split("-").map(r=>r.trim());return console.log(o),o[0]}{let i="";return console.log(i),i}}calculateCRC(t){const i=[0,52225,55297,5120,61441,15360,10240,58369,40961,27648,30720,46081,20480,39937,34817,17408];let o=65535;const r=Object.keys(t).sort();for(let u=1;u<r.length;u++){const l=r[u];for(let f=0;f<l.length;f++){const m=l.charCodeAt(f);let v=15&(o^m);o=o>>4^i[v],v=15&(o>>4^m),o=o>>4^i[v]}const d=t[l];if(null!=d){const f=JSON.stringify(d);for(let m=0;m<f.length;m++){const v=f.charCodeAt(m);let h=15&(o^v);o=o>>4^i[h],h=15&(o>>4^v),o=o>>4^i[h]}}}return o}updateDeviceConfiguration(t,i){var o=this;let r=this.customInit.operational_hours.split("-");this.allDatas={PK:this.customInit.deviceName,SK:this.clientID,alerts_configured:JSON.stringify(this.alerts_Table),alerts_duration:this.customInit.alert_time,block_number:this.customInit.block_number,company_id:this.customInit.company_id,deviceProfile:this.customInit.device_profile,data_interval:this.customInit.data_interval,reading_device_type:this.customInit.rdtName,writing_device_type:this.customInit.wdtName,mn:this.customInit.deviceName,mn_label:this.customInit.deviceLabel,metadata:JSON.stringify(this.customInit.metadata),longitude:this.customInit.lgtdName,latitude:this.customInit.latitude,altitude:this.customInit.altitude,binding_parameter:this.customInit.binding_parameter,operational_hours:r[0],device_timeout:this.customInit.device_timeout,svg_x:this.customInit.x_axis,svg_y:this.customInit.y_axis,svg_z:this.customInit.z_axis,schedule_month_generation_day:this.customInit.monthly_schedule,enable_device:null!=this.customInit.enable_device&&this.customInit.enable_device,critical:null!=this.customInit.critical&&this.customInit.critical,customSchedule:null!=this.customInit.customSchedule&&this.customInit.customSchedule,redundant:null!=this.customInit.redundant&&this.customInit.redundant,disable_alerts:null!=this.customInit.disable_alerts&&this.customInit.disable_alerts,report:null!=this.customInit.report&&this.customInit.report,dashboard:null!=this.customInit.dashboard&&this.customInit.dashboard,deviceslist:this.customInit.device_list,primary_devices:this.customInit.primary_devices,secondary_devices:this.customInit.secondary_devices,alertslist:this.customInit.alertslist,alert_timeout:this.customInit.alert_timeout,notificationMatrixId:this.customInit.notificationMatrixId,updatedTime:new Date},console.log("All_Datas",this.allDatas);const u=Math.ceil((new Date).getTime()/1e3),l={P1:this.allDatas.mn,P2:this.allDatas.mn_label,P3:this.allDatas.reading_device_type,P4:this.allDatas.company_id,P5:u,P6:this.customInit.longitude,P7:this.customInit.latitude,P8:this.customInit.unifierMAC_ID};this.api.UpdateDeviceConfiguration(this.allDatas).then(function(){var d=(0,C.Z)(function*(f){if(o.auditTrialServices.audit_trail("2.1","Device","Created",`${o.customInit.deviceLabel} Device Alert was created with (${o.valuesHolder.alertID}) AlertID`,"1"),f)return o.spinner.hide(),o.customInit.alerts_configured=o.alerts_Table,localStorage.setItem("customInit",JSON.stringify(o.customInit)),yield o.fetchTimeMachineById(1,o.allDatas.mn,"update",l),x().fire({position:"center",text:"Configuration updated successfully",icon:"success",allowOutsideClick:!1});o.spinner.hide(),alert("Error in updating Configuration")});return function(f){return d.apply(this,arguments)}}()).catch(d=>{this.spinner.hide(),console.log("error for updating",d)})}deleteDeviceConfigurationLocally(t){x().fire({customClass:{container:"my-swal"},position:"center",title:"Are you sure?",text:"You wont get these details back again",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(i=>{if(console.log("inside sweetalert",i),i.dismiss!==x().DismissReason.cancel){if(1==i.isConfirmed){const o=this.alerts_Table.indexOf(t);this.auditTrialServices.audit_trail("2.1","Device","Delete",`${this.customInit.deviceLabel} Device Alert was deleted (${this.alerts_Table[o].alertID})`,"1"),this.alerts_Table.splice(o,1),this.customInit.alerts_configured.splice(o,1),this.deleteRow(this.alerts_Table),x().fire("Removed!","Alert removed successfully.","success")}}else i.dismiss===x().DismissReason.cancel&&x().fire("Cancelled","Alert not removed","error");console.log("Alert Table ",this.alerts_Table)})}deleteRow(t){var i=this;let o=this.customInit.operational_hours.split("-");this.allDatas={PK:this.customInit.deviceName,SK:this.clientID,alerts_configured:JSON.stringify(t),alerts_duration:this.customInit.alert_time,block_number:this.customInit.block_number,company_id:this.customInit.company_id,deviceProfile:this.customInit.device_profile,data_interval:this.customInit.data_interval,reading_device_type:this.customInit.rdtName,writing_device_type:this.customInit.wdtName,mn:this.customInit.deviceName,mn_label:this.customInit.deviceLabel,metadata:JSON.stringify(this.customInit.metadata),longitude:this.customInit.lgtdName,latitude:this.customInit.latitude,altitude:this.customInit.altitude,operational_hours:o[0],device_timeout:this.customInit.device_timeout,svg_x:this.customInit.x_axis,svg_y:this.customInit.y_axis,svg_z:this.customInit.z_axis,schedule_month_generation_day:this.customInit.monthly_schedule,enable_device:null!=this.customInit.enable_device&&this.customInit.enable_device,critical:null!=this.customInit.critical&&this.customInit.critical,customSchedule:null!=this.customInit.customSchedule&&this.customInit.customSchedule,redundant:null!=this.customInit.redundant&&this.customInit.redundant,disable_alerts:null!=this.customInit.disable_alerts&&this.customInit.disable_alerts,report:null!=this.customInit.report&&this.customInit.report,dashboard:null!=this.customInit.dashboard&&this.customInit.dashboard,deviceslist:this.customInit.device_list,primary_devices:this.customInit.primary_devices,secondary_devices:this.customInit.secondary_devices,alertslist:this.customInit.alertslist,alert_timeout:this.customInit.alert_timeout,updatedTime:new Date,alert_time_based_ID:this.customInit.alert_time_based_ID,notificationMatrixId:this.customInit.notificationMatrixId},console.log("All_Datas",this.allDatas);const r=Math.ceil((new Date).getTime()/1e3),u={P1:this.allDatas.mn,P2:this.allDatas.mn_label,P3:this.allDatas.reading_device_type,P4:this.allDatas.company_id,P5:r,P6:this.customInit.longitude,P7:this.customInit.latitude,P8:this.customInit.unifierMAC_ID};this.api.UpdateDeviceConfiguration(this.allDatas).then(function(){var l=(0,C.Z)(function*(d){d?(yield i.fetchTimeMachineById(1,i.allDatas.mn,"update",u),i.customInit.alerts_configured=t,i.showTable(),i.toast.open("Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),i.addFromService(),i.multi_Alerts=[]):alert("Error in updating Configuration")});return function(d){return l.apply(this,arguments)}}()).catch(l=>{console.log("error for updating",l)}),localStorage.setItem("customInit",JSON.stringify(this.customInit)),console.log("After Delete ",this.customInit),this.newAlert()}updateAlert(){this.auditTrialServices.audit_trail("2.1","Device","Updated",`${this.customInit.deviceLabel} Device Alert was updated (${this.account$.value.alertID}) AlertID`,"1"),this.spinner.show(),console.log("Update BeforeTable",this.alerts_Table),console.log("Values Update",this.account$.value),this.tempArray=[],this.tempArray.push({alertID:this.account$.value.alertID,alert_datatype:this.account$.value.alert_datatype,alert_variabletype:this.account$.value.alert_variabletype,parameterID:this.convertToString(this.account$.value.parameterID),severity:this.account$.value.severity,alert_percent:this.account$.value.alert_percent,alert_text_active:this.account$.value.alert_text_active,alert_text_closed:this.account$.value.alert_text_closed,alert_text_snoozed:this.account$.value.alert_text_snoozed,alert_time:this.account$.value.alert_time,alert_time_based_ID:this.account$.value.alert_time_based_ID,parameterID1:this.convertToString(this.account$.value.parameterID1),parameterID2:this.convertToString(this.account$.value.parameterID2),equTextarea:this.account$.value.equTextarea,parameter_operator:this.account$.value.parameter_operator,operator:this.account$.value.operator,operator_value:this.account$.value.operator_value,binding_parameter:this.account$.value.binding_parameter,operational_schedule:void 0,enable_email:this.account$.value.enable_email,enable_sms:this.account$.value.enable_sms,enable_telegram:this.account$.value.enable_telegram,enable_type_1:this.account$.value.enable_type_1,enable_type_2:this.account$.value.enable_type_2,enable_type_3:this.account$.value.enable_type_3,enable_type_4:this.account$.value.enable_type_4,enable_type_5:this.account$.value.enable_type_5,notificationMatrixId:this.account$.value.notificationMatrixId,alertValuePrediction:this.account$.value.alertValuePrediction}),console.log("Data to be Added :",this.tempArray);const t=[{alertID:this.account$.value.alertID,alert_datatype:this.account$.value.alert_datatype,alert_variabletype:this.account$.value.alert_variabletype,parameterID:this.convertToString(this.account$.value.parameterID),severity:this.account$.value.severity,alert_percent:this.account$.value.alert_percent,alert_time:this.account$.value.alert_time,alert_time_based_ID:this.account$.value.alert_time_based_ID,parameterID1:this.convertToString(this.account$.value.parameterID1),parameterID2:this.convertToString(this.account$.value.parameterID2),equTextarea:this.account$.value.equTextarea,parameter_operator:this.account$.value.parameter_operator,operator:this.account$.value.operator,operator_value:this.account$.value.operator_value,alertValuePrediction:this.account$.value.alertValuePrediction,notificationMatrixId:this.account$.value.notificationMatrixId}];let i=!1;for(let o=0;o<this.alerts_Table.length;o++){console.log("this.alerts_Table[i] ",this.alerts_Table[o]);const{alertID:r,alert_datatype:u,alert_variabletype:l,parameterID:d,severity:f,alert_percent:m,alert_time:v,alert_time_based_ID:h,parameterID1:D,parameterID2:A,equTextarea:U,parameter_operator:S,operator:R,operator_value:M,alertValuePrediction:L,notificationMatrixId:y}=this.alerts_Table[o],c=[{alertID:r,alert_datatype:u,alert_variabletype:l,parameterID:d,severity:f,alert_percent:m,alert_time:v,alert_time_based_ID:h,parameterID1:D,parameterID2:A,equTextarea:U,parameter_operator:S,operator:R,operator_value:M,alertValuePrediction:L,notificationMatrixId:y}];if(t[0].alertID==r)continue;t[0].alertID===c[0].alertID&&(delete t[0].alertID,delete c[0].alertID);const O=this.calculateCRC(c[0]);let F=this.calculateCRC(t[0]);console.log("currentCRCArray ",c[0]),console.log("crcArray ",t[0]),console.log("checkCRC",F,"typeof ",typeof F,"currentCRC",O,typeof O),F===O&&(i=!0,this.spinner.hide(),console.log("Duplicate alert found at index",o),x().fire({position:"center",title:"Already added?",text:"Alert Already Added with this condtion: Do you want to continue ",icon:"warning",allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Continue"}).then(Z=>{Z.isConfirmed?this.updateHelperAlert():(this.alertCurrentStep$.next(1),this.cd.detectChanges())}))}i||this.updateHelperAlert()}updateHelperAlert(){var t=this;let i=this.calculateCRC(this.tempArray[0]);console.log("Final CRC :",i+"Type of ",typeof this.tempArray[0]),console.log("VAlue of Temparray",this.tempArray[0]),console.log("CRC16 checksum for the object: TempArray",i.toString(16).toUpperCase()),console.log("Alerts table before CRC :",this.alerts_Table);for(let m=0;m<this.alerts_Table.length;m++){let v=this.calculateCRC(this.alerts_Table[m]);if(console.log("Actual object for the CRC is:",this.alerts_Table[m]),console.log(i.toString(16).toUpperCase()+"Double Check"+v.toString(16).toUpperCase()),i.toString(16).toUpperCase()==v.toString(16).toUpperCase())return console.log("inside"+i.toString(16).toUpperCase()+"Double Check"+v.toString(16).toUpperCase()),x().fire({position:"center",title:"Already added?",text:"Alert Already Added with this condtion :  "+this.valuesHolder.parameterID+" "+this.valuesHolder.parameterID1+" for "+this.valuesHolder.alert_variabletype,icon:"warning",allowOutsideClick:!1})}this.account$.value.parameterID&&(this.account$.value.parameterID=Array.isArray(this.account$.value.parameterID)?this.convertToString(this.account$.value.parameterID):""),this.account$.value.parameterID1&&(this.account$.value.parameterID1=Array.isArray(this.account$.value.parameterID1)?this.convertToString(this.account$.value.parameterID1):""),this.account$.value.parameterID2&&(this.account$.value.parameterID2=Array.isArray(this.account$.value.parameterID2)?this.convertToString(this.account$.value.parameterID2):"");const u=(new Date).toLocaleString("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});for(let m=0;m<this.alerts_Table.length;m++)if(this.account$.value.alertID==this.alerts_Table[m].alertID){console.log("going inside will check before",this.alerts_Table),console.log("going inside will check",m),this.alerts_Table.splice(m,1);const v={...this.account$.value,alert_updated:u};this.alerts_Table.push(v)}let l=this.customInit.operational_hours.split("-");this.allDatas={PK:this.customInit.deviceName,SK:this.clientID,alerts_configured:JSON.stringify(this.alerts_Table),alerts_duration:this.customInit.alert_time,block_number:this.customInit.block_number,company_id:this.customInit.company_id,deviceProfile:this.customInit.device_profile,data_interval:this.customInit.data_interval,reading_device_type:this.customInit.rdtName,writing_device_type:this.customInit.wdtName,binding_parameter:this.customInit.binding_parameter,mn:this.customInit.deviceName,mn_label:this.customInit.deviceLabel,metadata:JSON.stringify(this.customInit.metadata),longitude:this.customInit.lgtdName,latitude:this.customInit.latitude,altitude:this.customInit.altitude,operational_hours:l[0],device_timeout:this.customInit.device_timeout,svg_x:this.customInit.x_axis,svg_y:this.customInit.y_axis,svg_z:this.customInit.z_axis,schedule_month_generation_day:this.customInit.monthly_schedule,enable_device:null!=this.customInit.enable_device&&this.customInit.enable_device,critical:null!=this.customInit.critical&&this.customInit.critical,customSchedule:null!=this.customInit.customSchedule&&this.customInit.customSchedule,redundant:null!=this.customInit.redundant&&this.customInit.redundant,disable_alerts:null!=this.customInit.disable_alerts&&this.customInit.disable_alerts,report:null!=this.customInit.report&&this.customInit.report,dashboard:null!=this.customInit.dashboard&&this.customInit.dashboard,deviceslist:this.customInit.device_list,primary_devices:this.customInit.primary_devices,secondary_devices:this.customInit.secondary_devices,alert_timeout:this.customInit.alert_timeout,alert_time_based_ID:this.customInit.alert_time_based_ID,notificationMatrixId:this.customInit.notificationMatrixId,updatedTime:new Date},console.log("All_Datas",this.allDatas);const d=Math.ceil((new Date).getTime()/1e3),f={P1:this.allDatas.mn,P2:this.allDatas.mn_label,P3:this.allDatas.reading_device_type,P4:this.allDatas.company_id,P5:d,P6:this.customInit.longitude,P7:this.customInit.latitude,P8:this.customInit.unifierMAC_ID};this.api.UpdateDeviceConfiguration(this.allDatas).then(function(){var m=(0,C.Z)(function*(v){if(v)return t.customInit.alerts_configured=t.alerts_Table,localStorage.setItem("customInit",JSON.stringify(t.customInit)),yield t.fetchTimeMachineById(1,t.allDatas.mn,"update",f),t.spinner.hide(),x().fire({position:"center",text:"Configuration updated successfully",icon:"success",allowOutsideClick:!1});alert("Error in updating Configuration"),t.spinner.hide()});return function(v){return m.apply(this,arguments)}}()).catch(m=>{this.spinner.hide(),console.log("error for updating",m)})}redirectDevice(){this.router.navigate(["Device-Configuration"]).then(()=>{})}fetchTimeMachineById(t,i,o,r){var u=this;return(0,C.Z)(function*(){try{const l=yield u.api.GetLookupMasterTable(u.clientID+"#device",t);if(l&&l.items){let d=yield JSON.parse(l.items),f=d.findIndex(m=>m[Object.keys(m)[0]].P1===i);if(-1!==f){if("update"===o){d[f][`L${f+1}`]=r;const v=[];for(let h=0;h<d.length;h++){const D=Object.keys(d[h])[0],A=`L${h+1}`;if(D){const U={[A]:d[h][D]},S=v.findIndex(R=>Object.keys(R)[0]===A);-1!==S?Object.assign(v[S][A],d[h][D]):v.push(U)}else console.error(`Original key not found for renaming in data[${h}].`)}d=v}else"delete"===o&&d.splice(f,1);let m={PK:u.clientID+"#device",SK:l.SK,items:JSON.stringify(d)};yield u.api.UpdateLookupMasterTable(m)}else yield new Promise(m=>setTimeout(m,500)),yield u.fetchTimeMachineById(t+1,i,o,r)}else x().fire({position:"top-right",icon:"error",title:`ID ${i} not found`,showConfirmButton:!1,timer:1500})}catch(l){console.error("Error:",l)}})()}}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)(e.Y36(ce),e.Y36(ie.ux),e.Y36(B.t),e.Y36(K.gz),e.Y36(e.sBO),e.Y36(P.F),e.Y36(K.F0),e.Y36(ae.t2),e.Y36(ve.C))}),(0,a.Z)(p,"\u0275cmp",e.Xpm({type:n,selectors:[["app-alerts-stepper"]],viewQuery:function(t,i){if(1&t&&e.Gf(ue,5),2&t){let o;e.iGM(o=e.CRH())&&(i.step1Comp=o.first)}},decls:55,vars:25,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],[1,"d-flex","flex-column","flex-column-fluid"],[1,"app-toolbar","py-3","py-lg-6"],[1,"app-container","container-fluid","d-flex","flex-stack"],[1,"col",2,"display","flex"],["class","page-heading d-flex text-gray-900 fw-bold fs-3 my-0 flex-column justify-content-center",4,"ngIf"],["class","btn btn-sm btn-success fw-bolder ms-2 fs-8 py-1 px-3 ",4,"ngIf"],[2,"display","flex","gap","10px","align-items","center"],["ngbTooltip","Add New Device","placement","bottom",1,"btn","btn-sm","fw-bold","btn-primary","btn-equal-size",2,"margin-right","1px",3,"click"],[1,"bi","bi-arrow-left-short"],["type","button","ngbTooltip","Add New Alert","placement","bottom",1,"btn","btn-sm","fw-bold","btn-primary","btn-equal-size",2,"margin-right","1px",3,"disabled","click"],[1,"bi","bi-plus-square-fill","fs-4","text-white"],["ngbTooltip","Show Alert Lists","placement","bottom","data-bs-toggle","modal","data-bs-target","#modal_alert_table",1,"btn","btn-sm","fw-bold","btn-dark","btn-equal-size",2,"margin-right","1px",3,"click"],[1,"bi","bi-card-list"],[1,"card"],[1,"card-body"],["id","kt_create_account_stepper",1,"stepper","stepper-links","d-flex","flex-column","pt-15"],[1,"stepper-nav","mb-5"],[1,"stepper-item",3,"ngClass"],[1,"stepper-title",2,"cursor","not-allowed"],["noValidate","","id","kt_create_account_form",1,"mx-auto","w-100","pt-15","pb-10"],[1,"current"],[4,"ngIf"],[1,"d-flex","flex-stack","pt-15"],[1,"mr-2"],["id","modal_alert_table","tabindex","-1","aria-labelledby","","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title",2,"padding","0.5%"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body",2,"padding","0.5%"],[1,"table-responsive"],[1,"container","table-responsive"],["class","modal","id","alert_tables","class","table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4","style","width:100%","tabindex","-1","aria-labelledby","","aria-hidden","true",4,"ngIf"],[1,"page-heading","d-flex","text-gray-900","fw-bold","fs-3","my-0","flex-column","justify-content-center"],[1,"btn","btn-sm","btn-success","fw-bolder","ms-2","fs-8","py-1","px-3"],[1,"w-100",3,"updateParentModel","defaultValues","customInit","hideDeleteButton"],[1,"w-100",3,"updateParentModel","defaultValues","hideDeleteButton"],[1,"w-100"],["type","button",1,"btn","fw-bold","btn-lg","btn-light-primary","me-3",3,"click"],[1,"fa-solid","fa-arrow-left"],["type","button",1,"btn","fw-bold","btn-lg","btn-primary","me-3",3,"disabled","click"],[1,"indicator-label"],[1,"fa-solid","fa-chevron-right"],["type","button","class","btn fw-bold btn-lg btn-primary me-3",3,"disabled","click",4,"ngIf","ngIfElse"],["other_btn",""],["id","alert_tables","tabindex","-1","aria-labelledby","","aria-hidden","true",1,"table","table-row-dashed","table-row-gray-300","align-middle","gs-0","gy-4",2,"width","100%"]],template:function(t,i){1&t&&(e.TgZ(0,"ngx-spinner",0)(1,"p",1),e._uU(2,"Please wait your dashboard is Loading... "),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e.YNc(7,gi,2,0,"h1",6),e.YNc(8,vi,2,0,"h1",6),e.YNc(9,bi,2,1,"a",7),e.qZA(),e.TgZ(10,"div",8)(11,"a",9),e.NdJ("click",function(){return i.redirectDevice()}),e._UZ(12,"i",10),e._uU(13,"Configure Device"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return i.redirectNewAlert()}),e._UZ(15,"i",12),e._uU(16,"Add"),e.qZA(),e.TgZ(17,"a",13),e.NdJ("click",function(){return i.showTable()}),e._UZ(18,"i",14),e._uU(19,"Show Alerts"),e.qZA()()()()(),e.TgZ(20,"div",15)(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",19)(25,"h3",20),e._uU(26,"Alert Types"),e.qZA()(),e.TgZ(27,"div",19)(28,"h3",20),e._uU(29,"Alert Text"),e.qZA()(),e.TgZ(30,"div",19)(31,"h3",20),e._uU(32,"Others"),e.qZA()()(),e.TgZ(33,"form",21)(34,"div",22),e.YNc(35,yi,2,4,"ng-container",23),e.YNc(36,Di,2,3,"ng-container",23),e.YNc(37,Zi,2,4,"ng-container",23),e.YNc(38,Ti,2,0,"ng-container",23),e.qZA(),e.TgZ(39,"div",24)(40,"div",25),e.YNc(41,Ci,4,0,"ng-container",23),e.qZA(),e.YNc(42,xi,6,2,"ng-container",23),e.YNc(43,ki,5,2,"ng-container",23),e.qZA()()()()(),e.TgZ(44,"div",26)(45,"div",27)(46,"div",28)(47,"div",29)(48,"h2",30),e._uU(49,"Alert Configurations"),e.qZA(),e._UZ(50,"button",31),e.qZA(),e.TgZ(51,"div",32)(52,"div",33)(53,"div",34),e.YNc(54,qi,21,0,"table",35),e.qZA()()()()()()),2&t&&(e.Q6J("fullScreen",!0),e.xp6(7),e.Q6J("ngIf",!i.EditOperation),e.xp6(1),e.Q6J("ngIf",i.EditOperation),e.xp6(1),e.Q6J("ngIf",i.editedAlert),e.xp6(5),e.Q6J("disabled",1===i.alertCurrentStep$.value&&0==i.EditOperation),e.xp6(10),e.Q6J("ngClass",e.WLB(16,pe,1===i.alertCurrentStep$.value,i.alertCurrentStep$.value>1)),e.xp6(3),e.Q6J("ngClass",e.WLB(19,pe,2===i.alertCurrentStep$.value,i.alertCurrentStep$.value>2)),e.xp6(3),e.Q6J("ngClass",e.WLB(22,pe,3===i.alertCurrentStep$.value,i.alertCurrentStep$.value>3)),e.xp6(5),e.Q6J("ngIf",1===i.alertCurrentStep$.value),e.xp6(1),e.Q6J("ngIf",2===i.alertCurrentStep$.value),e.xp6(1),e.Q6J("ngIf",3===i.alertCurrentStep$.value),e.xp6(1),e.Q6J("ngIf",4===i.alertCurrentStep$.value),e.xp6(3),e.Q6J("ngIf",i.alertCurrentStep$.value>=2&&4!=i.alertCurrentStep$.value),e.xp6(1),e.Q6J("ngIf",i.alertCurrentStep$.value!==i.formsCount&&i.alertCurrentStep$.value<i.formsCount-1),e.xp6(1),e.Q6J("ngIf",i.alertCurrentStep$.value!==i.formsCount&&i.alertCurrentStep$.value===i.formsCount-1),e.xp6(11),e.Q6J("ngIf",i.addAlertInTable||i.temp_alertDetails))},dependencies:[q.mk,q.O5,g._Y,g.JL,J._L,ae.Ro,ue,hi,_i,fi],styles:[".btn-light-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:hover, .btn-dark[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}.bi-card-list[_ngcontent-%COMP%]{font-size:20px}.bi-database-add[_ngcontent-%COMP%]{font-size:20px;margin-left:2px}.card[_ngcontent-%COMP%]{margin-bottom:30px;margin-left:30px;margin-right:30px;border:1px solid #dee2e6;border-radius:10px}.bi-card-list[_ngcontent-%COMP%]{font-size:16px;margin-right:3px;margin-bottom:2px}.bi-plus-lg[_ngcontent-%COMP%]{font-size:16px;margin-left:2px;margin-bottom:2px}.bi-arrow-left-short[_ngcontent-%COMP%]{font-size:20px}.fa-arrow-left[_ngcontent-%COMP%]{margin-bottom:4%}.btn-equal-size[_ngcontent-%COMP%]{min-width:160px}"]})),p})()},{path:"",redirectTo:"add",pathMatch:"full"},{path:"**",redirectTo:"add",pathMatch:"full"}]}];let Ui=(()=>{var n;class p{}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275mod",e.oAB({type:n})),(0,a.Z)(p,"\u0275inj",e.cJS({imports:[K.Bz.forChild(Ni),K.Bz]})),p})();var Li=w(69862);let Mi=(()=>{var n;class p{}return n=p,(0,a.Z)(p,"\u0275fac",function(t){return new(t||n)}),(0,a.Z)(p,"\u0275mod",e.oAB({type:n})),(0,a.Z)(p,"\u0275inj",e.cJS({imports:[q.ez,ie.ZX,Ui,g.UX,J.HK,De.m,be.vi,de.Z,_e.i4,ae.ef,Li.JF]})),p})()}}]);