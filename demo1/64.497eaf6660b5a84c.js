"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[64],{60064:(Ie,V,I)=>{I.r(V),I.d(V,{UserXlsxModule:()=>be});var u=I(86656),$=I(96814),S=I(15861),M=I(56223),K=I(20553),E=I(5816),B=I(11486),Y=I(48847),F=I(13519),Z=I.n(F),A=I(98983),ee=I(18240),te=I(90775),H=I.n(te),s=I(65879),X=I(22939),ie=I(31552);let oe=(()=>{var w;class P{constructor(){(0,u.Z)(this,"columnValidations",{UserName:{required:!0,validate:e=>this.isString(e)?/\s/.test(e)?{isValid:!1,error:"Cannot contain Whitespaces"}:{isValid:!0}:{isValid:!1,error:"Must be text"}},Password:{required:!0,validate:e=>this.isString(e)?e.length<8?{isValid:!1,error:"Must be at least 8 characters long"}:/(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])(?=.*[A-Z])/.test(e)?{isValid:!0}:{isValid:!1,error:"Must contain letters, numbers, special characters, and at least one uppercase letter"}:{isValid:!1,error:"Must be text"}},"Client ID":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},"Company ID":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},Email:{required:!0,validate:e=>this.isString(e)?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}:{isValid:!1,error:"Must be text"}},"User ID":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},Description:{required:!0,validate:e=>this.isString(e)?e.length>500?{isValid:!1,error:"Must not exceed 500 characters"}:{isValid:!0}:{isValid:!1,error:"Must be text"}},Mobile:{required:!0,validate:e=>isNaN(e)?{isValid:!1,error:"Must be a number"}:/^\d{10}$/.test(e.toString())?{isValid:!0}:{isValid:!1,error:"Must be exactly 10 digits"}},"Mobile Privacy":{required:!0,validate:e=>this.isString(e)?this.isString(e)&&!1===["Visible","Invisible"].includes(e)?{isValid:!1,error:"Must be Either Visible or Invisible"}:{isValid:!0}:{isValid:!1,error:"Must be text"}},"Telegram Channel ID":{required:!1,validate:e=>e&&this.isString(e)?{isValid:!1,error:"Must be Number if provided"}:{isValid:!0}},"Permission ID":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},"Location Permission":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},"Device Type Permission":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},"Device Permission":{required:!0,validate:e=>this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text"}},"Default Module":{required:!1,validate:e=>e?this.isString(e)?{isValid:!0}:{isValid:!1,error:"Must be text if provided"}:{isValid:!0}},"Escalation:Email":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Escalation:Email must be boolean such as true/false"}:{isValid:!0}},"Escalation:SMS":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Escalation:SMS must be boolean such as true/false"}:{isValid:!0}},"Escalation:Telegram":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Escalation:Telegram must be boolean such as true/false"}:{isValid:!0}},"Health Check":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Health Check must be boolean such as true/false"}:{isValid:!0}},"Device Timeout":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Device Timeou must be boolean such as true/false"}:{isValid:!0}},"Alert Timeout":{required:!1,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Alert Timeout must be boolean such as true/false"}:{isValid:!0}},"Enable User":{required:!0,validate:(e,i)=>null!=e&&""!==e&&"boolean"!=typeof e&&"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?{isValid:!1,error:"Enable User must be boolean such as true/false"}:{isValid:!0}}})}getColumnLetter(e){let i="";for(;e>=0;)i=String.fromCharCode(e%26+65)+i,e=Math.floor(e/26)-1;return i}isString(e){return"string"==typeof e||e instanceof String}isNumber(e){return!isNaN(Number(e))&&"boolean"!=typeof e}isInteger(e){return Number.isInteger(Number(e))}isPositive(e){return e>0}isWhitespace(e){return/\s/.test(e)}validateExcelFile(e,i,a,n,t,r,l,o,d,c){var h=this;return(0,S.Z)(function*(){return new Promise((f,y)=>{new FileReader;const m=[],U=[],b=[];console.log("Existing Username is here ",i),console.log("Unique list is here ",a);try{const C=e[0];e.slice(1).map(_=>({paramID:_[1],device:_[0]})),e.slice(1).map(_=>_[2]),h.columnValidations&&1==r&&delete h.columnValidations.Password,Object.entries(h.columnValidations).forEach(([_,z])=>{if(z.required&&!C.includes(_)){const v=Object.keys(h.columnValidations).indexOf(_);m.push({row:1,column:_,columnLetter:h.getColumnLetter(v),value:"Missing",error:`Required column "${_}" is missing`})}});const k=e.map(_=>_[0]),N=e.map(_=>_[7]),J=e.map(_=>_[22]);for(let _=1;_<e.length;_++){const z=e[_];if(console.log("Row is here ",z),0==z.length)break;C.forEach((v,W)=>{const x=h.columnValidations[v];if(x){const p=z[W],L=h.getColumnLetter(W);if(x.required&&(null==p||""===p)&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${v} is required`}),"UserName"===v&&!r&&x.required&&i.includes(p.toLowerCase())&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:"Username already present"}),("Location Permission"===v||"Device Type Permission"===v||"Device Permission"===v)&&void 0!==p&&""!==p&&x.required){const O={"Location Permission":{list:c,label:"Location"},"Device Type Permission":{list:o,label:"Device Type Permission"},"Device Permission":{list:d,label:"Device Permission"}},{list:Ce,label:Pe}=O[v],G=p.includes(",")?p.split(","):[p];G.forEach(ke=>{const Q=ke.trim();Ce.includes(Q)||m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${Pe} does not exist${G.length>1?` (${Q})`:""}`})})}if("UserName"===v&&r&&x.required&&0==i.includes(p.toLowerCase())&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:"Username does not exist"}),"UserName"===v&&x.required&&"string"==typeof p&&k.filter(O=>"string"==typeof O&&p.toLowerCase()===O.toLowerCase()).length>1&&(console.log("Duplicate user found: ",p),m.push({row:_+1,column:v,columnLetter:L,value:p,error:"Duplicate username found"})),"Client ID"===v&&x.required&&p!=n&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`You can Either Add or Update only ${n} client Users`}),"Client ID"===v&&null!=p&&""!=p&&x.required&&a&&a[0]&&0==a[0].includes(p)&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${p} ${v} does not exist `}),"Company ID"===v&&null!=p&&""!=p&&x.required&&a&&a[1]&&0==a[1].includes(p)&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${v} does not exist `}),"Email"===v&&null!=p&&""!=p&&""!=p&&x.required&&a&&a[2]&&1==a[2].includes(p)&&!r&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${p} ${v} already exist`}),"Email"===v&&x.required&&"string"==typeof p&&N.filter(O=>"string"==typeof O&&p.toLowerCase()===O.toLowerCase()).length>1&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:"Duplicate email found"}),"User ID"===v&&null!=p&&""!=p&&x.required&&a&&a[3]&&1==a[3].includes(p)&&!r&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${p} ${v} already exist`}),"User ID"===v&&x.required&&"string"==typeof p&&J.filter(O=>"string"==typeof O&&p.toLowerCase()===O.toLowerCase()).length>1&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:"Duplicate userID found"}),"Permission ID"===v&&null!=p&&""!=p&&x.required&&a&&a[4]&&0==a[4].includes(p)&&m.push({row:_+1,column:v,columnLetter:L,value:p,error:`${p} ${v} does not exist `}),null!=p&&""!==p){const O=x.validate(p);O.isValid||m.push({row:_+1,column:v,columnLetter:L,value:p,error:O.error})}}}),r?b.push(z):U.push(z),console.log("Updated rows are here ",b),console.log("Created rows are here ",U)}f({isValid:0===m.length,errors:m,createRows:U,updateRows:b})}catch(C){y(`Error processing file: ${C.message}`)}})})()}formatValidationErrors(e){return e.map(i=>`Row ${i.row}, Column ${i.columnLetter} (${i.column}): ${i.error}${i.value?` (${i.value})`:""}`)}}return w=P,(0,u.Z)(P,"\u0275fac",function(e){return new(e||w)}),(0,u.Z)(P,"\u0275prov",s.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"})),P})();var ae=I(14934),se=I(5588),j=I(64190),ne=I(74260),re=I(36624),q=I(88672);const le=["fileUpload"],ce=["container"];function he(w,P){1&w&&(s.TgZ(0,"small",7),s._uU(1," Type is required. "),s.qZA())}function ue(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"div",5)(1,"label",25),s._uU(2,"Upload File"),s.qZA(),s.TgZ(3,"input",26),s.NdJ("change",function(i){s.CHM(g);const a=s.oxw();let n;return s.KtG(a.onFileChange(i,null==(n=a.createUserXlsx.get("type"))?null:n.value))}),s.qZA()()}}function de(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"button",27),s.NdJ("click",function(i){s.CHM(g);const a=s.oxw();return s.KtG(a.onFileSelected(i,"update"))}),s._uU(1," \u270f\ufe0f Update "),s.qZA()}if(2&w){const g=s.oxw();let e;s.Q6J("disabled",!(null!=(e=g.createUserXlsx.get("type"))&&e.value))}}function me(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"button",28),s.NdJ("click",function(){s.CHM(g);const i=s.oxw();let a;return s.KtG(i.fetchLoggedInUser_Client(null==(a=i.createUserXlsx.get("type"))?null:a.value))}),s._uU(1," \u{1f4e5} Get Data "),s.qZA()}if(2&w){const g=s.oxw();let e;s.Q6J("disabled",!(null!=(e=g.createUserXlsx.get("type"))&&e.value))}}function pe(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"button",29),s.NdJ("click",function(i){s.CHM(g);const a=s.oxw();return s.KtG(a.onFileSelected(i,"add"))}),s._uU(1," \u2795 Add New "),s.qZA()}if(2&w){const g=s.oxw();let e;s.Q6J("disabled",!(null!=(e=g.createUserXlsx.get("type"))&&e.value))}}function fe(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"button",30),s.NdJ("click",function(){s.CHM(g);const i=s.oxw();let a;return s.KtG(i.download(null==(a=i.createUserXlsx.get("type"))?null:a.value))}),s._UZ(1,"i",31),s._uU(2," Download "),s.qZA()}if(2&w){const g=s.oxw();let e;s.Q6J("disabled",!(null!=(e=g.createUserXlsx.get("type"))&&e.value))}}function ge(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"div",32)(1,"button",33),s.NdJ("click",function(){s.CHM(g);const i=s.oxw();return s.KtG(i.prevPage())}),s._uU(2,"Previous"),s.qZA(),s.TgZ(3,"span"),s._uU(4),s.qZA(),s.TgZ(5,"button",33),s.NdJ("click",function(){s.CHM(g);const i=s.oxw();return s.KtG(i.nextPage())}),s._uU(6,"Next"),s.qZA()()}if(2&w){const g=s.oxw();s.xp6(1),s.Q6J("disabled",0===g.currentPage),s.xp6(3),s.AsE("Page ",g.currentPage+1," of ",g.totalPages,""),s.xp6(1),s.Q6J("disabled",g.currentPage>=g.totalPages-1)}}function _e(w,P){if(1&w&&(s.TgZ(0,"div",42)(1,"strong"),s._uU(2,"Error:"),s.qZA(),s._uU(3),s.qZA()),2&w){const g=s.oxw(2);s.xp6(3),s.hij(" ",g.error," ")}}function De(w,P){if(1&w&&(s.TgZ(0,"tr")(1,"td",50),s._uU(2),s.qZA(),s.TgZ(3,"td"),s._uU(4),s.qZA(),s.TgZ(5,"td"),s._uU(6),s.qZA()()),2&w){const g=P.$implicit;s.xp6(2),s.Oqu(g.split(",")[0].replace("Row ","")),s.xp6(2),s.Oqu(g.split(":")[0].split(",")[1].trim()),s.xp6(2),s.Oqu(g.split(":")[1].trim())}}function we(w,P){if(1&w&&(s.TgZ(0,"div",43)(1,"div",42)(2,"div",44)(3,"strong"),s._uU(4,"Errors Found:"),s.qZA(),s.TgZ(5,"span",45),s._uU(6),s.qZA()(),s.TgZ(7,"div",46)(8,"table",47)(9,"thead",48)(10,"tr")(11,"th"),s._uU(12,"Row"),s.qZA(),s.TgZ(13,"th"),s._uU(14,"Column"),s.qZA(),s.TgZ(15,"th"),s._uU(16,"Error"),s.qZA()()(),s.TgZ(17,"tbody"),s.YNc(18,De,7,3,"tr",49),s.qZA()()()()()),2&w){const g=s.oxw(2);s.xp6(6),s.hij("",g.validationErrors.length," issues"),s.xp6(12),s.Q6J("ngForOf",g.validationErrors)}}function ve(w,P){if(1&w){const g=s.EpF();s.TgZ(0,"div",34)(1,"h5",35),s._uU(2,"Validation Issues"),s.qZA(),s.TgZ(3,"button",36),s.NdJ("click",function(){const a=s.CHM(g).$implicit;return s.KtG(a.dismiss())}),s.qZA()(),s.TgZ(4,"div",37),s.YNc(5,_e,4,1,"div",38),s.YNc(6,we,19,2,"div",39),s.qZA(),s.TgZ(7,"div",40)(8,"button",41),s.NdJ("click",function(){const a=s.CHM(g).$implicit;return s.KtG(a.dismiss())}),s._uU(9,"Close"),s.qZA()()}if(2&w){const g=s.oxw();s.xp6(5),s.Q6J("ngIf",g.error),s.xp6(1),s.Q6J("ngIf",g.validationErrors.length>0)}}let ye=(()=>{var w;class P{constructor(e,i,a,n,t,r,l,o,d,c,h){(0,u.Z)(this,"fb",void 0),(0,u.Z)(this,"toast",void 0),(0,u.Z)(this,"api",void 0),(0,u.Z)(this,"uservalidate",void 0),(0,u.Z)(this,"modalService",void 0),(0,u.Z)(this,"userConfiguration",void 0),(0,u.Z)(this,"router",void 0),(0,u.Z)(this,"locationPermissionService",void 0),(0,u.Z)(this,"DynamicApi",void 0),(0,u.Z)(this,"spinner",void 0),(0,u.Z)(this,"cd",void 0),(0,u.Z)(this,"fileUpload",void 0),(0,u.Z)(this,"createUserXlsx",void 0),(0,u.Z)(this,"previewData",[[],[]]),(0,u.Z)(this,"user_Id",void 0),(0,u.Z)(this,"specific_devices",void 0),(0,u.Z)(this,"grid",void 0),(0,u.Z)(this,"multiUser",[]),(0,u.Z)(this,"ADD_finalData",{}),(0,u.Z)(this,"renameKeys",[]),(0,u.Z)(this,"data_temp",void 0),(0,u.Z)(this,"uniqueUserList",[]),(0,u.Z)(this,"uniqueuser_SKList",[]),(0,u.Z)(this,"cognitoUSER",void 0),(0,u.Z)(this,"listofSK",[]),(0,u.Z)(this,"listofUserID",[]),(0,u.Z)(this,"listofReportingUsers",[]),(0,u.Z)(this,"listofEmails",[]),(0,u.Z)(this,"tempMultiData",[]),(0,u.Z)(this,"other_client",""),(0,u.Z)(this,"new_client",""),(0,u.Z)(this,"other_companyID",""),(0,u.Z)(this,"new_companyID",""),(0,u.Z)(this,"alert_enable_email",""),(0,u.Z)(this,"alert_enable_sms",""),(0,u.Z)(this,"alert_enable_telegram",""),(0,u.Z)(this,"escalation_enable_email",""),(0,u.Z)(this,"escalation_enable_SMS",""),(0,u.Z)(this,"escalation_enable_telegram",""),(0,u.Z)(this,"health_check",""),(0,u.Z)(this,"device_timeout",""),(0,u.Z)(this,"alert_timeout",""),(0,u.Z)(this,"account",""),(0,u.Z)(this,"cognito_update",""),(0,u.Z)(this,"getLoggedUser",void 0),(0,u.Z)(this,"SK_clientID",void 0),(0,u.Z)(this,"allPermissions_user",void 0),(0,u.Z)(this,"hideUpdateButton",!1),(0,u.Z)(this,"hideGetButton",!1),(0,u.Z)(this,"container",void 0),(0,u.Z)(this,"maxlength",500),(0,u.Z)(this,"lookup_data_temp1",[]),(0,u.Z)(this,"accessPermission",""),(0,u.Z)(this,"finalPermission",void 0),(0,u.Z)(this,"fileName",""),(0,u.Z)(this,"savedFileEvent",void 0),(0,u.Z)(this,"error",void 0),(0,u.Z)(this,"validationErrors",[]),(0,u.Z)(this,"selectedFile",void 0),(0,u.Z)(this,"validExcelData",void 0),(0,u.Z)(this,"lookup_data_client",[]),(0,u.Z)(this,"listofClientIDs",[]),(0,u.Z)(this,"lookup_data_user",[]),(0,u.Z)(this,"uniqueListArrays",[]),(0,u.Z)(this,"lookup_data_dynamic",[]),(0,u.Z)(this,"allUserDetails",void 0),(0,u.Z)(this,"userPool",void 0),(0,u.Z)(this,"combinedUserData",[]),(0,u.Z)(this,"locationPermissionArray",[]),(0,u.Z)(this,"lookup_data",[]),(0,u.Z)(this,"deviceListWorkAround",[]),(0,u.Z)(this,"rdtListWorkAround",[]),(0,u.Z)(this,"lookup_data_rdt",[]),(0,u.Z)(this,"treeDataArray",[]),(0,u.Z)(this,"selectedLocationObject",void 0),(0,u.Z)(this,"idSelected",void 0),(0,u.Z)(this,"storePasswordForUpdates",[]),(0,u.Z)(this,"storedResponseCognito",[]),(0,u.Z)(this,"temp",[]),(0,u.Z)(this,"pagedPreviewData",[]),(0,u.Z)(this,"pageSize",50),(0,u.Z)(this,"currentPage",0),(0,u.Z)(this,"totalPages",void 0),this.fb=e,this.toast=i,this.api=a,this.uservalidate=n,this.modalService=t,this.userConfiguration=r,this.router=l,this.locationPermissionService=o,this.DynamicApi=d,this.spinner=c,this.cd=h}ngOnInit(){var e=this;return(0,S.Z)(function*(){e.initializeUserxlsxFields(),e.getLoggedUser=e.userConfiguration.getLoggedUserDetails(),e.SK_clientID=e.getLoggedUser.attributes["custom:clientID"],e.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),e.checkPermission(),e.getTreeData(),e.fetchDataConfig(1),e.fetchTMData(1),yield e.listAllCognitoUsers(),yield e.getAllrequiredLists(),e.uniqueListArrays.push(e.listofClientIDs),e.lookup_data_dynamic=[],yield e.dynamicLookupRetriver(1,`${e.SK_clientID}#company`),e.uniqueListArrays.push(e.lookup_data_dynamic.map(i=>i.P1),e.listofEmails,e.listofUserID),e.lookup_data_dynamic=[],yield e.dynamicLookupRetriver(1,`${e.SK_clientID}#permission`),e.uniqueListArrays.push(e.lookup_data_dynamic.map(i=>i.P1)),console.log("this.uniqueListArrays ",e.uniqueListArrays)})()}getTreeData(){this.locationPermissionService.fetchGlobalLocationTree().then(e=>{if(!e)throw Z().fire({title:"Tree is not Defined"}),new Error("No data returned");this.temp=e,0!=this.temp.length&&(this.locationPermissionArray=[]);for(let i=0;i<this.temp.length;i++)"location"==this.temp[i].node_type&&(0==i&&this.locationPermissionArray.push("All"),this.locationPermissionArray.push(this.temp[i].text)),this.treeDataArray.push(this.temp[i].text.toString());console.log("Data given to the array Location Array Permission",this.locationPermissionArray)})}getJsTreeNode(e,i){let a=null;const n=(l,o,d=[])=>{for(const c of l){const h=[...d,c.id];if(c.id.split("#")[0]===o)return h;if(c.children&&c.children.length>0){const f=n(c.children,o,h);if(f)return f}}return null},t=l=>{let o=[];if(l.children&&l.children.length>0)for(const d of l.children)o.push(d.id),o=o.concat(t(d));return o},r=(l,o,d="#")=>{for(const c of l){if(c.id.split("#")[0]===o){const h=n(e,o)||[];return{id:c.id,text:Array.isArray(c.text)?c.text:[c.text],parent:c.original?.parent||d,parents:[...h.reverse(),"#"],children:(c.children||[]).map(f=>f.id),children_d:0==t(c).length?[c.id]:t(c),icon:c.icon||c.original?.icon||"fa fa-folder",li_attr:{id:c.id,...c.li_attr||{}},a_attr:{href:"#",id:`${c.id}_anchor`},original:c.original||c,state:{disabled:!1,loaded:!0,opened:!1,selected:!0}}}if(c.children&&c.children.length>0){const h=r(c.children,o,c.id);if(h)return h}}return null};return a=r(e,i),a}listAllCognitoUsers(){var e=this;return(0,S.Z)(function*(){let i;const a={type:"cognitoServices",event:{path:"/listAllUsers",queryStringParameters:{},clientID:e.SK_clientID}};try{e.listofSK=[],e.listofEmails=[],e.listofUserID=[];const n=yield e.DynamicApi.getData(a);console.log("Response is here ",JSON.parse(n.body)),i=JSON.parse(n.body).users.map(t=>({username:t.username,email:t.attributes.email,userID:t.attributes["custom:userID"],password:t.attributes["custom:name"]})).filter(t=>null!==t),console.log("All the cognito users list is here ",i),e.combinedUserData=i,e.listofSK=i.map(t=>t.username),e.listofEmails=i.map(t=>t.email),e.listofUserID=i.map(t=>t.userID),e.storedResponseCognito=JSON.parse(JSON.stringify(i))}catch(n){console.error("Error calling dynamic lambda:",n)}})()}getAllrequiredLists(){var e=this;return(0,S.Z)(function*(){yield e.getClientID()})()}getClientID(){var e=this;return(0,S.Z)(function*(){let i;try{do{const n=yield e.api.ListLookupMasterTables({PK:{contains:"#client"}},500,i);if(console.log("Fetched data:",n),n&&n.items&&Array.isArray(n.items)){for(const t of n.items)yield e.filterListOfClients(t);i=n.nextToken}else console.warn("No items found or result.items is not an array"),i=null}while(i);console.log("All the clients are here BTW",e.lookup_data_user),e.listofClientIDs=e.lookup_data_user.map(n=>n.P1)}catch(n){console.error("Error fetching all the clients",n)}})()}filterListOfClients(e){var i=this;return(0,S.Z)(function*(){if(e&&e.items)if("string"==typeof e.items){let a=JSON.parse(e.items);if(console.log("d1 =",a),Array.isArray(a)){for(let n=0;n<a.length;n++){const t=a[n];if(null==t)break;{const r=Object.keys(t)[0],{P1:l,P2:o,P3:d,P4:c,P5:h,P6:f}=t[r];i.lookup_data_user.push({P1:l,P2:o,P3:d,P4:c,P5:h,P6:f}),console.log("d2 =",i.lookup_data_user)}}i.lookup_data_user.sort((n,t)=>t.P5-n.P5),console.log("Lookup sorting",i.lookup_data_user)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Lookup to be displayed",i.lookup_data_user)})()}catch(e){console.error("Error:",e)}dynamicLookupRetriver(e,i){var a=this;return(0,S.Z)(function*(){try{const n=yield a.api.GetLookupMasterTable(i,e);if(n&&n.items)if("string"==typeof n.items){let t=JSON.parse(n.items);if(console.log("d1 =",t),Array.isArray(t)){for(let r=0;r<t.length;r++){const l=t[r];if(null==l)break;{const o=Object.keys(l)[0],{P1:d,P2:c,P3:h,P4:f,P5:y,P6:D,P7:m,P8:U}=l[o];a.lookup_data_dynamic.push({P1:d,P2:c,P3:h,P4:f,P5:y,P6:D,P7:m,P8:U}),console.log("d2 =",a.lookup_data_dynamic)}}a.lookup_data_dynamic.sort((r,l)=>l.P8-r.P8),console.log("Lookup sorting",a.lookup_data_dynamic),a.lookup_data_dynamic.push({P1:"All"}),yield a.dynamicLookupRetriver(e+1,i)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log("All the data is here that is fetched",a.lookup_data_dynamic)}catch(n){console.error("Error:",n)}})()}checkPermission(){let e=!1,i=!1;for(let a=0;a<this.allPermissions_user.length;a++)"User - xlsx Update"===this.allPermissions_user[a]?(e=!0,this.hideGetButton=!0,this.hideUpdateButton=!0):"User - xlsx View"===this.allPermissions_user[a]&&(i=!0,this.hideGetButton=!0,this.hideUpdateButton=!1);e&&i||e||i?this.hideGetButton=!0:this.router.navigate(["/404"])}checkUniqueFields(e){var i=this;return(0,S.Z)(function*(){console.log("iam trying to fetch",i.SK_clientID);try{const a=yield i.api.GetLookupMasterTable(i.SK_clientID+"#user",e);if(a&&a.items)if("string"==typeof a.items){let n=JSON.parse(a.items);if(console.log("d1 =",n),Array.isArray(n)){for(let t=0;t<n.length;t++){const r=n[t];if(null==r)break;{const l=Object.keys(r)[0],{P1:o,P2:d,P3:c,P4:h,P5:f,P6:y,P7:D,P8:m}=r[l];i.lookup_data_temp1.push({P1:o,P2:d,P3:c,P4:h,P5:f,P6:y,P7:D,P8:m}),console.log("d2 =",i.lookup_data_temp1)}}i.lookup_data_temp1.sort((t,r)=>r.P8-t.P8),console.log("Lookup sorting",i.lookup_data_temp1),yield i.checkUniqueFields(e+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log("All the data is here that is fetched",i.lookup_data_temp1);const n=i.lookup_data_temp1;i.listofSK=[],i.listofReportingUsers=[],i.listofEmails=[];for(let t=0;t<n.length;t++)i.listofSK.push(n[t]?.P1.toLowerCase()),i.listofUserID.push(n[t]?.P1),i.listofReportingUsers.push(n[t]?.P1),i.listofEmails.push(n[t]?.P3);console.log("All the users are",i.listofUserID)}}catch(a){console.error("Error:",a)}})()}initializeUserxlsxFields(){this.createUserXlsx=this.fb.group({type:["",M.kI.required]})}onFileChange(e,i){this.savedFileEvent=e.target.files[0];const a=e.target;if(1!==a.files.length)throw new Error("Cannot use multiple files");if(!e.target.value.includes(".xlsx"))return this.toast.open(" Error :Invalid file format","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});{const n=new FileReader;n.onload=t=>{const l=B.ij(t.target.result,{type:"binary"}),d=l.Sheets[l.SheetNames[0]];this.previewData=B.P6.sheet_to_json(d,{header:1,raw:!1}),this.user_Id=B.P6.sheet_to_json(d,{raw:!0}),this.grid?(this.grid.data=[],this.grid.scrollIndexTop=0):(this.grid=Y({parentNode:this.container.nativeElement,data:[]}),this.grid.style.heigth="1440px",this.grid.style.width="100%"),this.grid.data=this.previewData,this.previewData=this.grid.data,this.currentPage=0,this.updatePagedData(),this.grid.addEventListener("afteredit",c=>{this.previewData[this.currentPage*this.pageSize+c.rowIndex][c.cellIndex]=c.value,console.log("this.previewData ",this.previewData)});try{if(this.grid&&this.grid.data&&this.grid.data[0]){const c=this.grid.data[0];console.log("Heading are here ",c);const h=["UserName","Password","Client ID","Company ID","Description","Mobile","Mobile Privacy","Email","Telegram ID","Location Permission","Device Type Permission","Device Permission","Tree","Redirection","Default Module","Permission ID","Escalation:Email","Escalation:SMS","Escalation:Telegram","Health Check","Device Timeout","Alert Timeout","User ID","Enable User","L1","L2","L3","L4","L5","L6","L7","L8","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"];if(JSON.stringify(c)!=JSON.stringify(h))return console.log("Heading are here ",h),this.grid.data=[],this.grid.scrollIndexTop=0,Z().fire({title:"User Template Mismatch",text:"Please check the file for the correct User template format.",icon:"error",confirmButtonText:"Ok"})}}catch(c){console.log("Error checking the heading ",c)}},n.readAsBinaryString(a.files[0])}}download(e){let i,a,n={};if(!this.previewData[0]||0===this.previewData[0].length)return this.toast.open("Error: No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});"user_xlsx"===e&&(i=[["UserName","Password","Client ID","Company ID","Description","Mobile","Mobile Privacy","Email","Telegram ID","Location Permission","Device Type Permission","Device Permission","Tree","Redirection","Default Module","Permission ID","Escalation:Email","Escalation:SMS","Escalation:Telegram","Health Check","Device Timeout","Alert Timeout","User ID","Enable User","L1","L2","L3","L4","L5","L6","L7","L8","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"]],a="User.xlsx",n={"Default Module":["MagicBoard","PowerBoard","DreamBoard"],"Mobile Privacy":["Visible","Invisible"]});const t=["User ID","Password","Client ID","Company ID","UserName","Description","Mobile","Mobile Privacy","Email","Location Permission","Device Type Permission","Device Permission","Permission ID","Enable User"],r=new(H().Workbook),l=r.addWorksheet("Sheet1"),o=r.addWorksheet("DropdownOptions");o.state="veryHidden";const d=this.locationPermissionArray||["All"],c=this.deviceListWorkAround||["All"],h=this.rdtListWorkAround||["All"],f=this.uniqueListArrays[4]||["All"],y=this.uniqueListArrays[1]||[],D=this.treeDataArray||["World"];d.forEach((b,C)=>o.getCell(`A${C+1}`).value=b),c.forEach((b,C)=>o.getCell(`B${C+1}`).value=b),h.forEach((b,C)=>o.getCell(`C${C+1}`).value=b),f.forEach((b,C)=>o.getCell(`D${C+1}`).value=b),y.forEach((b,C)=>o.getCell(`E${C+1}`).value=b),D.forEach((b,C)=>o.getCell(`F${C+1}`).value=b);const m={"Location Permission":`DropdownOptions!$A$1:$A$${d.length}`,"Device Permission":`DropdownOptions!$B$1:$B$${c.length}`,"Device Type Permission":`DropdownOptions!$C$1:$C$${h.length}`,"Permission ID":`DropdownOptions!$D$1:$D$${f.length}`,"Company ID":`DropdownOptions!$E$1:$E$${y.length}`,Tree:`DropdownOptions!$F$1:$F$${D.length}`};l.addRows(i),l.columns=i[0].map(()=>({width:20})),i[0].forEach((b,C)=>{const R=l.getCell(1,C+1),T=l.getColumn(C+1).letter;R.style={fill:{type:"pattern",pattern:"solid",fgColor:{argb:t.includes(b)?"FF0000":"FFA500"}},font:{bold:!0,color:{argb:"FFFFFF"}}},m[b]?l.dataValidations.add(`${T}2:${T}1000`,{type:"list",allowBlank:!0,formulae:[`=${m[b]}`]}):n[b]&&l.dataValidations.add(`${T}2:${T}1000`,{type:"list",allowBlank:!0,formulae:[`"${n[b].join(",")}"`]})});const U=this.grid?.data&&JSON.parse(JSON.stringify(this.grid.data));U&&U.splice(1).forEach(b=>{l.addRow(b)}),r.xlsx.writeBuffer().then(b=>{const C=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),R=document.createElement("a");R.href=URL.createObjectURL(C),R.download=a,R.click()}).catch(b=>{console.error("Error exporting Excel file",b)})}exportTemplate(e){if(""===e)return void this.toast.open("Select type","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let i,a,n={};"user_xlsx"===e&&(i=[["UserName","Password","Client ID","Company ID","Description","Mobile","Mobile Privacy","Email","Telegram ID","Location Permission","Device Type Permission","Device Permission","Tree","Redirection","Default Module","Permission ID","Escalation:Email","Escalation:SMS","Escalation:Telegram","Health Check","Device Timeout","Alert Timeout","User ID","Enable User","L1","L2","L3","L4","L5","L6","L7","L8","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]],a="User.xlsx",n={"Default Module":["MagicBoard","PowerBoard","DreamBoard"],"Mobile Privacy":["Visible","Invisible"]});const t=["User ID","Password","Client ID","Company ID","UserName","Description","Mobile","Mobile Privacy","Email","Location Permission","Device Type Permission","Device Permission","Permission ID","Enable User"],r=new(H().Workbook),l=r.addWorksheet("WDT");l.addRows(i),l.columns=i[0].map(()=>({width:50}));const o=this.locationPermissionArray||["All"],d=this.deviceListWorkAround||["All"],c=this.rdtListWorkAround||["All"],h=this.uniqueListArrays[4]||["All"],f=this.uniqueListArrays[1]||[],y=this.treeDataArray||["World"],D=r.addWorksheet("DropdownOptions");D.state="veryHidden",o.forEach((k,N)=>{D.getCell(`A${N+1}`).value=k}),d.forEach((k,N)=>{D.getCell(`B${N+1}`).value=k}),c.forEach((k,N)=>{D.getCell(`C${N+1}`).value=k}),h.forEach((k,N)=>{D.getCell(`D${N+1}`).value=k}),f.forEach((k,N)=>{D.getCell(`E${N+1}`).value=k}),y.forEach((k,N)=>{D.getCell(`F${N+1}`).value=k});const m=`DropdownOptions!$A$1:$A$${o.length}`,U=`DropdownOptions!$B$1:$B$${d.length}`,b=`DropdownOptions!$C$1:$C$${c.length}`,C=`DropdownOptions!$D$1:$D$${h.length}`,R=`DropdownOptions!$E$1:$E$${f.length}`,T=`DropdownOptions!$F$1:$F$${y.length}`;i[0].forEach((k,N)=>{const J=l.getCell(1,N+1),_=l.getColumn(N+1).letter;J.style={fill:{type:"pattern",pattern:"solid",fgColor:{argb:t.includes(k)?"FF0000":"FFA500"}},font:{bold:!0,color:{argb:"FFFFFF"}}},"Location Permission"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${m}`]}):"Device Permission"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${U}`]}):"Device Type Permission"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${b}`]}):"Permission ID"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${C}`]}):"Company ID"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${R}`]}):"Tree"===k?l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`=${T}`]}):n[k]&&l.dataValidations.add(`${_}2:${_}1000`,{type:"list",allowBlank:!0,formulae:[`"${n[k].join(",")}"`]})}),r.xlsx.writeBuffer().then(k=>{const N=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),J=document.createElement("a");J.href=URL.createObjectURL(N),J.download=a,J.click()}).catch(k=>{console.error("Error writing the file",k)})}fetchTMData(e){var i=this;return(0,S.Z)(function*(){console.log("iam trying to fetch",i.SK_clientID);try{const a=yield i.api.GetLookupMasterTable(i.SK_clientID+"#rdt",e);if(a&&a.items)if("string"==typeof a.items){let n=JSON.parse(a.items);if(console.log("d1 =",n),Array.isArray(n)){for(let t=0;t<n.length;t++){const r=n[t];if(null==r)break;{const l=Object.keys(r)[0],{P1:o,P2:d,P3:c,P4:h}=r[l];i.lookup_data_rdt.push({P1:o,P2:d,P3:c,P4:h})}}i.lookup_data_rdt.sort((t,r)=>r.P4-t.P4),console.log("Lookup sorting",i.lookup_data_rdt),yield i.fetchTMData(e+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{if(console.log("All RDTS",i.lookup_data_rdt),0==i.lookup_data_rdt.length)i.rdtListWorkAround.push("All");else for(let n=0;n<i.lookup_data_rdt.length;n++)0==n&&i.rdtListWorkAround.push("All"),i.rdtListWorkAround.push(i.lookup_data_rdt[n].P1);console.log("Data given to the list ",i.rdtListWorkAround)}}catch(a){console.error("Error:",a)}})()}fetchDataConfig(e){var i=this;return(0,S.Z)(function*(){try{const a=yield i.api.GetLookupMasterTable(i.SK_clientID+"#device",e);if(a&&a.items)if("string"==typeof a.items){let n=JSON.parse(a.items);if(console.log("d1 =",n),Array.isArray(n)){for(let t=0;t<n.length;t++){const r=n[t];if(null==r)break;{const l=Object.keys(r)[0],{P1:o,P2:d,P3:c,P4:h,P5:f}=r[l];i.lookup_data.push({P1:o,P2:d,P3:c,P4:h,P5:f})}}i.lookup_data.sort((t,r)=>r.P5-t.P5),console.log("Lookup sorting Device",i.lookup_data),yield i.fetchDataConfig(e+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{i.lookup_data.unshift("None");for(let n=0;n<i.lookup_data.length;n++)0==n&&i.deviceListWorkAround.push("All"),0!==n&&i.deviceListWorkAround.push(i.lookup_data[n].P2),console.log("Device List given to the drop down",i.deviceListWorkAround)}}catch(a){console.error("Error:",a)}})()}onFileSelected(e,i){this.handleFile(this.savedFileEvent,i,e)}openFileUploadModal(e){this.modalService.open(e,{backdrop:"static",keyboard:!1,size:"lg",centered:!0})}handleFile(e,i,a){var n=this;return(0,S.Z)(function*(){if(n.error="",n.validationErrors=[],e?.name.toLowerCase().endsWith(".xlsx"))if(e.size>5242880)n.error="File size must be less than 5MB";else{n.selectedFile=e;try{let t={};if(t="add"==i?yield n.uservalidate.validateExcelFile(n.previewData,n.listofSK,n.uniqueListArrays,n.SK_clientID,[],!1,n.combinedUserData,n.rdtListWorkAround,n.deviceListWorkAround,n.locationPermissionArray):yield n.uservalidate.validateExcelFile(n.previewData,n.listofSK,n.uniqueListArrays,n.SK_clientID,[],!0,n.combinedUserData,n.rdtListWorkAround,n.deviceListWorkAround,n.locationPermissionArray),t.isValid){if(n.validExcelData=t,!n.selectedFile||n.validationErrors.length>0)return;try{const r=n.validExcelData.createRows,l=n.validExcelData.updateRows;if(console.log("Temp created User is here ",r),r&&Array.isArray(r)&&r.length>0)for(let o of r)n.spinner.show(),yield n.createNewUser(o);if(l&&Array.isArray(l)&&l.length>0)for(let o of l)n.spinner.show(),yield n.updateUser(o);console.log("Data to be added/update is here ",r),r&&Array.isArray(r)&&r.length>0?Z().fire({icon:"success",title:`${r.length} ${r.length>1?"Users added Successfully":"User added Successfully"}`,showConfirmButton:!0}):Z().fire({icon:"success",title:`${l.length} Users updated Successfully`,showConfirmButton:!0})}catch(r){n.error="Error uploading file. Please try again.",n.spinner.hide()}finally{n.spinner.hide()}}else n.validationErrors=n.uservalidate.formatValidationErrors(t.errors),n.openFileUploadModal(n.fileUpload)}catch(t){console.log("Error message is here ",t),n.error=t.message||"Error validating file",n.selectedFile=null}}else n.error="Please select an XLSX file"})()}updateUser(e){var i=this;return(0,S.Z)(function*(){console.log("Update function is being called ");try{i.allUserDetails={};let a=[];try{for(let m=24;m<=31;m++)a.push(0==e[m]||"0"==e[m]?0:1)}catch(m){console.log("Error in Access specifiers ",m)}const n=[{accessPermission:a.join("")}];let t=" ";i.temp&&i.temp.length>0&&""!=e[12]&&(t=i.getJsTreeNode(i.temp,e[12]),console.log("tempRedirectionID is here ",t)),i.allUserDetails={PK:e[0].trim(),SK:e[2],userID:e[22],clientID:e[2],companyID:e[3],username:e[0].trim(),description:e[4],mobile:parseInt(e[5]),mobile_privacy:e[6],escalation_email:!!e[16]&&("string"!=typeof e[16]||"true"!==e[16].toLowerCase()&&"false"!==e[16].toLowerCase()?e[16]:JSON.parse(e[16].toString().toLowerCase())),escalation_sms:!!e[17]&&("string"!=typeof e[17]||"true"!==e[17].toLowerCase()&&"false"!==e[17].toLowerCase()?e[17]:JSON.parse(e[17].toString().toLowerCase())),escalation_telegram:!!e[18]&&("string"!=typeof e[18]||"true"!==e[18].toLowerCase()&&"false"!==e[18].toLowerCase()?e[18]:JSON.parse(e[18].toString().toLowerCase())),email:e[7],location_object:JSON.stringify(t),telegramID:e[8],location_permission:1==e[9].includes(",")?e[9].split(","):[e[9]],default_module:e[14],device_type_permission:1==e[10].includes(",")?e[10].split(","):[e[10]],device_permission:1==e[11].includes(",")?e[11].split(","):[e[11]],permission_ID:e[15],enable_user:!!e[23]&&("string"!=typeof e[23]||"true"!==e[23].toLowerCase()&&"false"!==e[23].toLowerCase()?e[23]:JSON.parse(e[23].toString().toLowerCase())),health_check:!!e[19]&&("string"!=typeof e[17]||"true"!==e[19].toLowerCase()&&"false"!==e[19].toLowerCase()?e[19]:JSON.parse(e[19].toString().toLowerCase())),device_timeout:!!e[20]&&("string"!=typeof e[20]||"true"!==e[20].toLowerCase()&&"false"!==e[20].toLowerCase()?e[20]:JSON.parse(e[20].toString().toLowerCase())),alert_timeout:!!e[21]&&("string"!=typeof e[21]||"true"!==e[21].toLowerCase()&&"false"!==e[21].toLowerCase()?e[21]:JSON.parse(e[21].toString().toLowerCase())),others:JSON.stringify(n),updated:new Date},console.log("User Details are here ",i.allUserDetails);let r=i.allUserDetails.device_permission,l="";const o=new Set;r=r.filter(m=>{const U=o.has(m.value);return o.add(m.value),!U}),l=r?1===r.length?r[0]:r.length>1?r[0]+"...("+r.length+")":"...(0)":"...(0)";let d=i.allUserDetails.location_permission,c="";c=d?1===d.length?d[0]:d.length>1?d[0]+"...("+d.length+")":"...(0)":"...(0)";let h=i.allUserDetails.device_type_permission,f="";f=h?1===h.length?h[0]:h.length>1?h[0]+"...("+h.length+")":"...(0)":"...(0)";const y=Math.ceil((new Date).getTime()/1e3),D={P1:i.allUserDetails.PK,P2:i.allUserDetails.mobile,P3:i.allUserDetails.email,P4:i.allUserDetails.permission_ID,P5:c,P6:f,P7:l,P8:y,P9:i.allUserDetails.userID,P10:i.allUserDetails.health_check,P11:i.allUserDetails.device_timeout};yield i.api.UpdateUserManagement(i.allUserDetails).then(function(){var m=(0,S.Z)(function*(U){if(U){yield i.fetchTimeMachineById(1,i.allUserDetails.PK,"update",D),1!=i.allUserDetails.enable_user&&(yield i.updateCognitoAttributesV2(i.allUserDetails));let b={};b=1==i.allUserDetails.enable_user?{path:"/enableUser",queryStringParameters:{username:D.P1}}:{path:"/disableUser",queryStringParameters:{username:D.P1}};const C={type:"cognitoServices",event:b};try{const R=yield i.DynamicApi.getData(C);console.log("Response is here ",JSON.parse(R.body))}catch(R){console.error("Error calling dynamic lambda:",R)}1==i.allUserDetails.enable_user&&(yield i.updateCognitoAttributesV2(i.allUserDetails))}else console.log("Error updating user"),i.spinner.hide()});return function(U){return m.apply(this,arguments)}}()).catch(m=>{console.warn("Error updating user ",m),i.spinner.hide()})}catch(a){console.log("Error updating user ",a),i.spinner.hide()}})()}updateCognitoAttributesV2(e){var i=this;return(0,S.Z)(function*(){console.log("this.storePasswordForUpdates1 ",i.storePasswordForUpdates);const a=i.storedResponseCognito.find(D=>e.username.toLowerCase()==D.username).password;console.log("this.storePasswordForUpdates2 ",a);const n=e.username,r={Username:n,Password:a},o=new E.AM({UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"}),c=new E.ws({Username:n,Pool:o}),h=new E.sD(r),f={email:e.email,"custom:userID":e.userID,"custom:name":a,"custom:clientID":e.clientID,"custom:companyID":e.companyID,"custom:username":n,"custom:description":e.description,"custom:mobile":JSON.stringify(e.mobile),"custom:mobile_privacy":e.mobile_privacy,"custom:enable_user":JSON.stringify(e.enable_user??!1),"custom:escalation_email":JSON.stringify(e.escalation_email??!1),"custom:escalation_sms":JSON.stringify(e.escalation_sms??!1),"custom:escalation_telegram":JSON.stringify(e.escalation_telegram??!1),"custom:telegramID":JSON.stringify(e.telegramID),"custom:location_permission":e.location_permission.toString(),"custom:device_type_permi":e.device_type_permission.toString(),"custom:device_permission":e.device_permission.toString(),"custom:permission_id":e.permission_ID,"custom:health_check":JSON.stringify(e.health_check??!1),"custom:device_timeout":JSON.stringify(e.device_timeout??!1),"custom:alert_timeout":JSON.stringify(e.alert_timeout??!1)},y=Object.entries(f).map(([D,m])=>new E.KC({Name:D,Value:m}));try{const D=yield i.authenticateUserAsync(c,h);console.log("Authenticated successfully",D);const m=yield i.updateAttributesAsync(c,y);console.log("Attributes updated successfully",m)}catch(D){console.error("Error during Cognito update:",D)}})()}authenticateUserAsync(e,i){return new Promise((a,n)=>{e.authenticateUser(i,{onSuccess:a,onFailure:n})})}updateAttributesAsync(e,i){return new Promise((a,n)=>{e.updateAttributes(i,(t,r)=>{if(t)return n(t);a(r)})})}createNewUser(e){var i=this;return(0,S.Z)(function*(){console.log("Create function is being called ");try{i.allUserDetails={};let a=[];try{for(let m=24;m<=31;m++)a.push(0==e[m]||"0"==e[m]?0:1)}catch(m){console.log("Error in Access specifiers ",m)}const n=[{accessPermission:a.join("")}];let t=" ";i.temp&&i.temp.length>0&&""!=e[12]&&(t=i.getJsTreeNode(i.temp,e[12]),console.log("tempRedirectionID is here ",t)),i.allUserDetails={PK:e[0].trim(),SK:e[2],userID:e[22],name:e[1],clientID:e[2],companyID:e[3],username:e[0].trim(),description:e[4],mobile:parseInt(e[5]),mobile_privacy:e[6],escalation_email:!!e[16]&&("string"!=typeof e[16]||"true"!==e[16].toLowerCase()&&"false"!==e[16].toLowerCase()?e[16]:JSON.parse(e[16].toString().toLowerCase())),escalation_sms:!!e[17]&&("string"!=typeof e[17]||"true"!==e[17].toLowerCase()&&"false"!==e[17].toLowerCase()?e[17]:JSON.parse(e[17].toString().toLowerCase())),escalation_telegram:!!e[18]&&("string"!=typeof e[18]||"true"!==e[18].toLowerCase()&&"false"!==e[18].toLowerCase()?e[18]:JSON.parse(e[18].toString().toLowerCase())),email:e[7],location_object:JSON.stringify(t),telegramID:e[8],location_permission:1==e[9].includes(",")?e[9].split(","):[e[9]],default_module:e[14],device_type_permission:1==e[10].includes(",")?e[10].split(","):[e[10]],device_permission:1==e[11].includes(",")?e[11].split(","):[e[11]],permission_ID:e[15],enable_user:!0,health_check:!!e[19]&&("string"!=typeof e[17]||"true"!==e[19].toLowerCase()&&"false"!==e[19].toLowerCase()?e[19]:JSON.parse(e[19].toString().toLowerCase())),device_timeout:!!e[20]&&("string"!=typeof e[20]||"true"!==e[20].toLowerCase()&&"false"!==e[20].toLowerCase()?e[20]:JSON.parse(e[20].toString().toLowerCase())),alert_timeout:!!e[21]&&("string"!=typeof e[21]||"true"!==e[21].toLowerCase()&&"false"!==e[21].toLowerCase()?e[21]:JSON.parse(e[21].toString().toLowerCase())),others:JSON.stringify(n),updated:new Date},console.log("User Details are here ",i.allUserDetails);let r=i.allUserDetails.device_permission,l="";const o=new Set;r=r.filter(m=>{const U=o.has(m.value);return o.add(m.value),!U}),l=r?1===r.length?r[0]:r.length>1?r[0]+"...("+r.length+")":"...(0)":"...(0)";let d=i.allUserDetails.location_permission,c="";c=d?1===d.length?d[0]:d.length>1?d[0]+"...("+d.length+")":"...(0)":"...(0)";let h=i.allUserDetails.device_type_permission,f="";f=h?1===h.length?h[0]:h.length>1?h[0]+"...("+h.length+")":"...(0)":"...(0)";const y=Math.ceil((new Date).getTime()/1e3),D={P1:i.allUserDetails.PK,P2:i.allUserDetails.mobile,P3:i.allUserDetails.email,P4:i.allUserDetails.permission_ID,P5:c,P6:f,P7:l,P8:y,P9:i.allUserDetails.userID,P10:i.allUserDetails.health_check,P11:i.allUserDetails.device_timeout};yield i.api.CreateUserManagement(i.allUserDetails).then(function(){var m=(0,S.Z)(function*(U){U?(i.DynamicApi.sendData({type:"userVerify",username:i.allUserDetails.PK,name:i.allUserDetails.name,email:i.allUserDetails.email}).subscribe(C=>{console.log("Response from Lambda:",C)},C=>{console.error("Error calling dynamic lambda:",C)}),yield i.createLookUpRdt(D,1,i.allUserDetails.SK+"#user"),yield i.addtoCognitoTable(i.allUserDetails)):console.log("Error adding user")});return function(U){return m.apply(this,arguments)}}()).catch(m=>{console.warn("Error adding user ",m)})}catch(a){console.log("Error adding user ",a)}})()}addtoCognitoTable(e){return new Promise((i,a)=>{if(console.log("cognito table",e),!e)return console.warn("Error adding user in Cognito: getValues is undefined"),a("No values provided");const n={UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"};console.log("poolData after user added to cognito",n),this.userPool=new E.AM(n);const t=[],r={email:e.email,"custom:userID":e.userID,"custom:name":e.name,"custom:clientID":e.clientID,"custom:companyID":e.companyID,"custom:username":e.username,"custom:description":e.description,"custom:mobile":JSON.stringify(e.mobile),"custom:mobile_privacy":e.mobile_privacy,"custom:enable_user":JSON.stringify(e.enable_user??!1),"custom:escalation_email":JSON.stringify(e.escalation_email??!1),"custom:escalation_sms":JSON.stringify(e.escalation_sms??!1),"custom:escalation_telegram":JSON.stringify(e.escalation_telegram??!1),"custom:telegramID":JSON.stringify(e.telegramID),"custom:location_permission":e.location_permission?.toString(),"custom:device_type_permi":e.device_type_permi?.toString(),"custom:device_permission":e.device_permission?.toString(),"custom:permission_id":e.permission_ID,"custom:health_check":JSON.stringify(e.health_check??!1),"custom:device_timeout":JSON.stringify(e.device_timeout??!1),"custom:alert_timeout":JSON.stringify(e.alert_timeout??!1)};for(let l in r){const d=new E.KC({Name:l,Value:r[l]});t.push(d)}this.userPool.signUp(e.username,e.name,t,[],(l,o)=>{if(l)return console.error("Error on sign up:",l),a(l.message||JSON.stringify(l));console.log("Result after user is added:",o),i(o)})})}fetchLoggedInUser_Client(e){if(0===this.previewData[0].length)return this.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if("user_xlsx"==e)for(let i=1;i<this.grid.data.length;i++)if(this.previewData[i]&&this.previewData[i][0]&&this.previewData[i][0].trim().length>=2){for(let a=0;a<this.listofReportingUsers.length&&this.grid.data[i][9].trim()!==this.listofReportingUsers[a];a++)if(a==this.listofReportingUsers.length-1)return void this.toast.open(this.grid.data[i][0]+" Column:J  Row: "+i+" Username not exists","Add Already added username",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});this.multiUser.push(this.grid.data[i][0].trim())}console.log("after devices fetched",this.multiUser),this.api.ListUserManagements({PK:{in:this.multiUser},SK:{contains:this.SK_clientID}},500).then(i=>{if(0==i.items?.length)return this.toast.open("No User found","Check other user",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(i&&i.items&&i.items.length>0){this.specific_devices=i.items,delete this.specific_devices[0].__typename,console.log("Key items are listed here :",i.items),this.storePasswordForUpdates=[];for(let a=0;a<i.items.length;a++)if(this.grid.data[a+1][22]=i.items[a]?.userID,this.grid.data[a+1][1]=(i.items[a]?.name||"").replace(/.*/g,"xxxxxx"),this.storePasswordForUpdates.push({password:i.items[a]?.name,username:i.items[a]?.username}),this.grid.data[a+1][2]=i.items[a]?.clientID,this.grid.data[a+1][3]=i.items[a]?.companyID,this.grid.data[a+1][0]=i.items[a]?.username,this.grid.data[a+1][4]=i.items[a]?.description,this.grid.data[a+1][5]=i.items[a]?.mobile,this.grid.data[a+1][6]=i.items[a]?.mobile_privacy,this.grid.data[a+1][7]=i.items[a]?.email,this.grid.data[a+1][8]=i.items[a]?.telegramID,this.grid.data[a+1][9]=i.items[a]?.location_permission?.toString(),this.grid.data[a+1][10]=i.items[a]?.device_type_permission?.toString(),this.grid.data[a+1][11]=i.items[a]?.device_permission?.toString(),this.grid.data[a+1][14]=i.items[a]?.default_module,this.grid.data[a+1][19]=i.items[a]?.default_type,this.grid.data[a+1][12]=i.items[a]?.location_object?JSON.parse(i.items[a]?.location_object||"")?.id?.split("#")[0]:"",this.grid.data[a+1][13]=i.items[a]?.location_object,this.grid.data[a+1][15]=i.items[a]?.permission_ID,this.grid.data[a+1][16]=i.items[a]?.escalation_email,this.grid.data[a+1][17]=i.items[a]?.escalation_sms,this.grid.data[a+1][18]=i.items[a]?.escalation_telegram,this.grid.data[a+1][19]=i.items[a]?.health_check,this.grid.data[a+1][20]=i.items[a]?.device_timeout,this.grid.data[a+1][21]=i.items[a]?.alert_timeout,this.grid.data[a+1][23]=i.items[a]?.enable_user,null!=i.items[a]?.others||null!=i.items[a]?.others){const n=JSON.parse(i.items[a]?.others??"");if(n[0]){let r=Array.from(n[0].accessPermission).map(l=>Number(l));this.grid.data[a+1][24]=r[0],this.grid.data[a+1][25]=r[1],this.grid.data[a+1][26]=r[2],this.grid.data[a+1][27]=r[3],this.grid.data[a+1][28]=r[4],this.grid.data[a+1][29]=r[5],this.grid.data[a+1][30]=r[6],this.grid.data[a+1][31]=r[7]}}else this.grid.data[a+1][24]=1,this.grid.data[a+1][25]=1,this.grid.data[a+1][26]=1,this.grid.data[a+1][27]=1,this.grid.data[a+1][28]=1,this.grid.data[a+1][29]=1,this.grid.data[a+1][30]=1,this.grid.data[a+1][31]=1;if(this.grid.data=this.grid.data,this.previewData=this.grid.data,this.currentPage=0,this.updatePagedData(),this.grid.addEventListener("afteredit",a=>{this.previewData[this.currentPage*this.pageSize+a.rowIndex][a.cellIndex]=a.value,console.log("this.previewData ",this.previewData)}),this.grid.data)return this.toast.open("User Fetched","Check",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}).catch(i=>{console.log("No User configuration for this device",i)})}createUserConfig(e){let i="true",a="false";if(this.tempMultiData=[],console.log("The Actual data from the file is :",this.previewData),0===this.previewData[0].length)return this.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.previewData||this.previewData.length<2||!this.previewData[1][1])return this.toast.open(" Error :Empty File should not be added","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let t=1;t<=this.previewData.length-1;t++){if(this.ADD_finalData={},null==this.previewData[t][1]||void 0===this.previewData[t][1]||""===this.previewData[t][1])return this.toast.open("Column:B  Row: "+t+" User ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][1])&&32===this.previewData[t][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+t+" User ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(1==this.listofUserID.includes(this.previewData[t][9]))return this.toast.open("Column:J  Row: "+t+" User Name already exists!!","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][2]||void 0===this.previewData[t][2]||""===this.previewData[t][2])return this.toast.open("Column:C  Row: "+t+" Password is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][2])&&32===this.previewData[t][2].charCodeAt(0))return this.toast.open("Column:C  Row: "+t+" Password doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[^\w\s]).{6,}$/.test(this.grid.data[t][2]))return this.toast.open("Column:C  Row: "+t+" Password must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 6 of length","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.other_client=this.previewData[t][3],null!=this.other_client&&""!==this.other_client){let o="";if("boolean"==typeof this.other_client?o=JSON.stringify(this.other_client).trim().toLowerCase():0==isNaN(this.other_client)||(o=this.other_client.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:D  Row: "+t+" Allow Other Clients must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.other_client=o)}else this.other_client=a;if(this.new_client=this.previewData[t][4],null!=this.new_client&&""!==this.new_client){let o="";if("boolean"==typeof this.new_client?o=JSON.stringify(this.new_client).trim().toLowerCase():0==isNaN(this.new_client)||(o=this.new_client.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:E  Row: "+t+" Allow New Clients must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.new_client=o)}else this.new_client=a;if(this.other_companyID=this.previewData[t][5],null!=this.other_companyID&&""!==this.other_companyID){let o="";if("boolean"==typeof this.other_companyID?o=JSON.stringify(this.other_companyID).trim().toLowerCase():0==isNaN(this.other_companyID)||(o=this.other_companyID.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:F  Row: "+t+" Allow Company ID must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.other_companyID=o)}else this.other_companyID=a;if(this.new_companyID=this.previewData[t][6],null!=this.new_companyID&&""!==this.new_companyID){let o="";if("boolean"==typeof this.new_companyID?o=JSON.stringify(this.new_companyID).trim().toLowerCase():0==isNaN(this.new_companyID)||(o=this.new_companyID.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:G  Row: "+t+" Allow New Company ID must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.new_companyID=o)}else this.new_companyID=a;if(null==this.previewData[t][7]||void 0===this.previewData[t][7]||""===this.previewData[t][7])return this.toast.open("Column:H  Row: "+t+" Client ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][7])&&32===this.previewData[t][7].charCodeAt(0))return this.toast.open("Column:H  Row: "+t+" Client ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][8]||void 0===this.previewData[t][8]||""===this.previewData[t][8])return this.toast.open("Column:I  Row: "+t+" Company ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][8])&&32===this.previewData[t][8].charCodeAt(0))return this.toast.open("Column:I  Row: "+t+" Company ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][9]||void 0===this.previewData[t][9]||""===this.previewData[t][9])return this.toast.open("Column:J  Row: "+t+" Username is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][9])&&32===this.previewData[t][9].charCodeAt(0))return this.toast.open("Column:J  Row: "+t+" Username doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let o=0;o<this.listofSK.length;o++)if(this.previewData[t][9]==this.listofSK[o])return this.toast.open("Column:J  Row: "+t+" Username already exists!!","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][10]||void 0===this.previewData[t][10]||""===this.previewData[t][10])return this.toast.open("Column:K  Row: "+t+" Description is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][10])&&32===this.previewData[t][10].charCodeAt(0))return this.toast.open("Column:K  Row: "+t+" Description doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.previewData[t][11]))return this.toast.open("Column:L  Row: "+t+" Mobile must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(10!==this.previewData[t][11].length)return this.toast.open("Column:L  Row: "+t+" Mobile number should be 10 digits","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][12]||void 0===this.previewData[t][12]||""===this.previewData[t][12])return this.toast.open("Column:M  Row: "+t+" Mobile Privacy is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][12])&&32===this.previewData[t][12].charCodeAt(0))return this.toast.open("Column:M  Row: "+t+" Mobile privacy doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][12])&&0==["Visible","Invisible"].includes(this.previewData[t][12]))return this.toast.open("Column:M  Row: "+t+" Mobile privacy should be either Visible or Invisible","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][13]||void 0===this.previewData[t][13]||""===this.previewData[t][13])return this.toast.open("Column:N  Row: "+t+" Email is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][13])&&32===this.previewData[t][13].charCodeAt(0))return this.toast.open("Column:N  Row: "+t+" Email doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(1!=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i.test(this.previewData[t][13]))return this.toast.open("Column:N  Row: "+t+" Invalid Email address","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let o=0;o<this.listofEmails.length;o++)if(this.grid.data[t][13]==this.listofEmails[o])return this.toast.open("Column:N  Row: "+t+" Email already exists!!","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.previewData[t][14]))return this.toast.open("Column:O  Row: "+t+" Telegram ID must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(-1===Math.sign(this.previewData[t][14]))return this.toast.open("Column:O  Row: "+t+" Telegram ID must not be in negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][15]||void 0===this.previewData[t][15]||""===this.previewData[t][15])return this.toast.open("Column:P  Row: "+t+" Location Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][15])&&32===this.previewData[t][15].charCodeAt(0))return this.toast.open("Column:P  Row: "+t+" Location Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==(0,A.HD)(this.previewData[t][15]))return this.toast.open("Column:P  Row: "+t+" Location Permission is not a string","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][16]||void 0===this.previewData[t][16]||""===this.previewData[t][16])return this.toast.open("Column:Q  Row: "+t+" Device Type Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][16])&&32===this.previewData[t][16].charCodeAt(0))return this.toast.open("Column:Q  Row: "+t+" Device Type Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==(0,A.HD)(this.previewData[t][16]))return this.toast.open("Column:Q  Row: "+t+" Device Type Permission is not a string","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][17]||void 0===this.previewData[t][17]||""===this.previewData[t][17])return this.toast.open("Column:R  Row: "+t+" Device Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][17])&&32===this.previewData[t][17].charCodeAt(0))return this.toast.open("Column:R  Row: "+t+" Device Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==(0,A.HD)(this.previewData[t][17]))return this.toast.open("Column:R  Row: "+t+" Device Permission is not a string","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][18]||void 0===this.previewData[t][18]||""===this.previewData[t][18])return this.toast.open("Column:S  Row: "+t+" Default Module is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][18])&&32===this.previewData[t][18].charCodeAt(0))return this.toast.open("Column:S  Row: "+t+" Default Module doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][18])&&0==["MagicBoard","PowerBoard","DreamBoard"].includes(this.previewData[t][18]))return this.toast.open("Column:S  Row: "+t+" Default Module can be either in  DreamBoard, MagicBoard or PowerBoard","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(console.log("Default location is ",this.previewData[t][19]),null==this.previewData[t][19]||void 0===this.previewData[t][19]||""===this.previewData[t][19])return this.toast.open("Column:T  Row: "+t+" Default Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][19])&&32===this.previewData[t][19].charCodeAt(0))return this.toast.open("Column:T  Row: "+t+" Default Type doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][20]||void 0===this.previewData[t][20]||""===this.previewData[t][20])return this.toast.open("Column:U  Row: "+t+" Start Node is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][20])&&32===this.previewData[t][20].charCodeAt(0))return this.toast.open("Column:U  Row: "+t+" Start Node doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][22]||void 0===this.previewData[t][22]||""===this.previewData[t][22])return this.toast.open("Column:W  Row: "+t+" Permission ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][22])&&32===this.previewData[t][22].charCodeAt(0))return this.toast.open("Column:W  Row: "+t+" Permission ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.alert_enable_email=this.previewData[t][24],null!=this.alert_enable_email&&""!==this.alert_enable_email){let o="";if("boolean"==typeof this.alert_enable_email?o=JSON.stringify(this.alert_enable_email).trim().toLowerCase():0==isNaN(this.alert_enable_email)||(o=this.alert_enable_email.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:Y  Row: "+t+" Enable Email must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_email=o)}else this.alert_enable_email=a;if(this.alert_enable_sms=this.previewData[t][25],null!=this.alert_enable_sms&&""!==this.alert_enable_sms){let o="";if("boolean"==typeof this.alert_enable_sms?o=JSON.stringify(this.alert_enable_sms).trim().toLowerCase():0==isNaN(this.alert_enable_sms)||(o=this.alert_enable_sms.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:Z  Row: "+t+" Enable SMS must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_sms=o)}else this.alert_enable_sms=a;if(this.alert_enable_telegram=this.previewData[t][26],null!=this.alert_enable_telegram&&""!==this.alert_enable_telegram){let o="";if("boolean"==typeof this.alert_enable_telegram?o=JSON.stringify(this.alert_enable_telegram).trim().toLowerCase():0==isNaN(this.alert_enable_telegram)||(o=this.alert_enable_telegram.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AA  Row: "+t+" Enable Telegram must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_telegram=o)}else this.alert_enable_telegram=a;if(this.escalation_enable_email=this.previewData[t][27],null!=this.escalation_enable_email&&""!==this.escalation_enable_email){let o="";if("boolean"==typeof this.escalation_enable_email?o=JSON.stringify(this.escalation_enable_email).trim().toLowerCase():0==isNaN(this.escalation_enable_email)||(o=this.escalation_enable_email.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AB  Row: "+t+" Enable Escalation Email must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_email=o)}else this.escalation_enable_email=a;if(this.escalation_enable_SMS=this.previewData[t][28],null!=this.escalation_enable_SMS&&""!==this.escalation_enable_SMS){let o="";if("boolean"==typeof this.escalation_enable_SMS?o=JSON.stringify(this.escalation_enable_SMS).trim().toLowerCase():0==isNaN(this.escalation_enable_SMS)||(o=this.escalation_enable_SMS.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AC  Row: "+t+" Enable Escalation SMS must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_SMS=o)}else this.escalation_enable_SMS=a;if(this.escalation_enable_telegram=this.previewData[t][29],null!=this.escalation_enable_telegram&&""!==this.escalation_enable_telegram){let o="";if("boolean"==typeof this.escalation_enable_telegram?o=JSON.stringify(this.escalation_enable_telegram).trim().toLowerCase():0==isNaN(this.escalation_enable_telegram)||(o=this.escalation_enable_telegram.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AD  Row: "+t+" Enable Escalation telegram must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_telegram=o)}else this.escalation_enable_telegram=a;if(this.health_check=this.previewData[t][30],null!=this.health_check&&""!==this.health_check){let o="";if("boolean"==typeof this.health_check?o=JSON.stringify(this.health_check).trim().toLowerCase():0==isNaN(this.health_check)||(o=this.health_check.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AE  Row: "+t+" Enable health check must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.health_check=o)}else this.health_check=a;if(this.device_timeout=this.previewData[t][31],null!=this.device_timeout&&""!==this.device_timeout){let o="";if("boolean"==typeof this.device_timeout?o=JSON.stringify(this.device_timeout).trim().toLowerCase():0==isNaN(this.device_timeout)||(o=this.device_timeout.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AF  Row: "+t+" Enable device timeout must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.device_timeout=o)}else this.device_timeout=a;if(this.alert_timeout=this.previewData[t][32],null!=this.alert_timeout&&""!==this.alert_timeout){let o="";if("boolean"==typeof this.alert_timeout?o=JSON.stringify(this.alert_timeout).trim().toLowerCase():0==isNaN(this.alert_timeout)||(o=this.alert_timeout.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AG  Row: "+t+" Enable alert timeout must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_timeout=o)}else this.alert_timeout=a;if(this.account=this.previewData[t][33],null!=this.account&&""!==this.account){let o="";if("boolean"==typeof this.account?o=JSON.stringify(this.account).trim().toLowerCase():0==isNaN(this.account)||(o=this.account.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AH  Row: "+t+" Enable account must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.account=o)}else this.account=a;if(this.cognito_update=this.previewData[t][34],null!=this.cognito_update&&""!==this.cognito_update){let o="";if("boolean"==typeof this.cognito_update?o=JSON.stringify(this.cognito_update).trim().toLowerCase():0==isNaN(this.cognito_update)||(o=this.cognito_update.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AI  Row: "+t+" Enable Cognito Update must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.cognito_update=o)}else this.cognito_update=a;if(this.previewData[t][35]){let o="",d=!1;for(let c=35;c<=42;c++){if(this.accessPermission=this.previewData[t][c],console.log("this.accessPermission value is :",this.accessPermission),null==this.accessPermission||null==this.accessPermission||""==this.accessPermission){d=!0,console.log("Else statement got executed btw :"),this.finalPermission={accessPermission:"11111111"};break}{let h="";if("boolean"==typeof this.accessPermission?h=JSON.stringify(this.accessPermission).trim().toLowerCase():0==isNaN(this.cognito_update)||(h=this.accessPermission.trim().toLowerCase()),h!==i&&h!==a)return this.toast.open("Column:AJ to AP  Row: 35 to 42Access permission must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(h==i||h==a)&&(o+=h===i?"1":"0")}}0==d&&(this.finalPermission={accessPermission:o})}else console.log("Else statement got executed btw :"),this.finalPermission={accessPermission:"11111111"};this.ADD_finalData.PK=this.previewData[t][9].trim(),this.ADD_finalData.SK=this.SK_clientID,this.renameKeys.push(Object.keys(this.ADD_finalData)),this.renameKeys[0]="profile_picture",this.renameKeys[1]="userID",this.renameKeys[2]="name",this.renameKeys[3]="allowOtherClient",this.renameKeys[4]="allowNewClient",this.renameKeys[5]="allowOtherCompanyID",this.renameKeys[6]="allowNewCompanyID",this.renameKeys[7]="clientID",this.renameKeys[8]="companyID",this.renameKeys[9]="username",this.renameKeys[10]="description",this.renameKeys[11]="mobile",this.renameKeys[12]="mobile_privacy",this.renameKeys[13]="email",this.renameKeys[14]="telegramID",this.renameKeys[15]="location_permission",this.renameKeys[16]="device_type_permission",this.renameKeys[17]="device_permission",this.renameKeys[18]="default_module",this.renameKeys[19]="default_type",this.renameKeys[20]="start_node",this.renameKeys[21]="alert_levels",this.renameKeys[22]="permission_ID",this.renameKeys[23]="report_to",this.renameKeys[24]="alert_email",this.renameKeys[25]="alert_sms",this.renameKeys[26]="alert_telegram",this.renameKeys[27]="escalation_email",this.renameKeys[28]="escalation_sms",this.renameKeys[29]="escalation_telegram",this.renameKeys[30]="health_check",this.renameKeys[31]="device_timeout",this.renameKeys[32]="alert_timeout",this.renameKeys[33]="enable_user",this.renameKeys[34]="cognito_update",this.renameKeys[35]="others";for(var n=0;n<this.grid.data[0].length;n++)null==this.grid.data[t][n]?this.grid.data[t][n]=null:this.ADD_finalData[this.renameKeys[n]]=this.grid.data[t][n];console.log("Rename keys data is here :",this.ADD_finalData),delete this.ADD_finalData.undefined,delete this.ADD_finalData["PK,SK"],this.ADD_finalData.updated=new Date,this.ADD_finalData.allowOtherClient=this.other_client,this.ADD_finalData.allowNewClient=this.new_client,this.ADD_finalData.allowOtherCompanyID=this.other_companyID,this.ADD_finalData.allowNewCompanyID=this.new_companyID,this.ADD_finalData.alert_email=this.alert_enable_email,this.ADD_finalData.alert_sms=this.alert_enable_sms,this.ADD_finalData.alert_telegram=this.alert_enable_telegram,this.ADD_finalData.escalation_email=this.escalation_enable_email,this.ADD_finalData.escalation_sms=this.escalation_enable_SMS,this.ADD_finalData.escalation_telegram=this.escalation_enable_telegram,this.ADD_finalData.health_check=this.health_check,this.ADD_finalData.device_timeout=this.device_timeout,this.ADD_finalData.alert_timeout=this.alert_timeout,this.ADD_finalData.enable_user=this.account,this.ADD_finalData.cognito_update=this.cognito_update,this.ADD_finalData.others=JSON.stringify([this.finalPermission]),this.tempMultiData.push(this.ADD_finalData)}this.sendMultiUserDB(0)}sendMultiUserDB(e){var i=this;return(0,S.Z)(function*(){if(console.log("All the xlsx data is here :",i.tempMultiData),e<i.tempMultiData.length){if(yield i.checkUsernameExists(i.tempMultiData[e].username))return Z().fire({position:"center",icon:"error",title:`Username: ${i.tempMultiData[e].username} already exist`,showConfirmButton:!1,timer:1500});let n=i.tempMultiData[e].device_permission.split(" "),t="";const r=new Set;n=n.filter(D=>{const m=r.has(D.value);return r.add(D.value),!m}),t=n?1===n.length?n[0]:n.length>1?n[0]+"...("+n.length+")":"...(0)":"...(0)";let l=i.tempMultiData[e].location_permission.split(" "),o="";o=l?1===l.length?l[0]:l.length>1?l[0]+"...("+l.length+")":"...(0)":"...(0)";let h,d=i.tempMultiData[e].device_type_permission.split(" "),c="";c=d?1===d.length?d[0]:d.length>1?d[0]+"...("+d.length+")":"...(0)":"...(0)",h=i.SK_clientID!=i.tempMultiData[e].clientID?i.tempMultiData[e].clientID:i.SK_clientID;const f=Math.ceil((new Date).getTime()/1e3),y={P1:i.tempMultiData[e].username,P2:i.tempMultiData[e].mobile,P3:i.tempMultiData[e].email,P4:i.tempMultiData[e].permission_ID,P5:o,P6:c,P7:t,P8:f};console.log("Lookup data to be added is",y),console.log("User will be created as",i.tempMultiData[e]),i.api.CreateUserManagement(i.tempMultiData[e]).then(function(){var D=(0,S.Z)(function*(m){i.addToCognito(i.tempMultiData[e]),m?(console.log("The fianl value",m),yield i.createLookUpRdt(y,1,h+"#user"),i.sendMultiUserDB(e+1)):alert("Error in adding User")});return function(m){return D.apply(this,arguments)}}()).catch(D=>{console.log("err for Creating new user",D),i.toast.open("Error in creating new user","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}else i.checkUniqueFields(1),i.toast.open(e+" User added successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})})()}checkUsernameExists(e){return(0,S.Z)(function*(){try{yield ee.g.signUp({username:e,password:"dummyPassword123",attributes:{email:"dummy_email@example.com"}})}catch(i){return"UsernameExistsException"===i.code?(console.log("Username exists "),!0):(console.error("Unexpected error during username check:",i),!1)}return!1})()}createLookUpRdt(e,i,a){var n=this;return(0,S.Z)(function*(){try{console.log("iam a calleddd dude",e,i);const t=yield n.api.GetLookupMasterTable(a,i);let r=[];if(null!=t&&t.items&&"string"==typeof t.items&&(r=JSON.parse(t.items)),null!=t&&r.length<n.maxlength){let l=[];t.items&&"string"==typeof t.items&&JSON.parse(t.items).forEach(h=>{for(const f in h)Object.prototype.hasOwnProperty.call(h,f)&&l.push(h[f])}),l.unshift(e),l=l.map((c,h)=>({[`L${h+1}`]:c})),console.log("newdata 11111111 :>> ",l);let o={PK:a,SK:t.SK,createdTime:"",updatedTime:"",items:JSON.stringify(l)};const d=yield n.api.UpdateLookupMasterTable(o);console.log("createResponse :>> ",d)}else if(null==t){let l=[];l.push(e),l=l.map((c,h)=>({[`L${h+1}`]:c}));let o={SK:i,PK:a,items:JSON.stringify(l)};console.log(o);const d=yield n.api.CreateLookupMasterTable(o);console.log(d)}else yield n.createLookUpRdt(e,i+1,a)}catch(t){console.log("err :>> ",t)}})()}updateUserxlsx(e){let i="true",a="false";if(this.tempMultiData=[],0===this.previewData[0].length)return this.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.previewData||this.previewData.length<2||!this.previewData[1][1])return this.toast.open(" Error :Empty File should not be updated","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let t=1;t<=this.previewData.length-1;t++){if(this.ADD_finalData={},null==this.previewData[t][1]||void 0===this.previewData[t][1]||""===this.previewData[t][1])return this.toast.open("Column:B  Row: "+t+" User ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+t+" User ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][2]||void 0===this.previewData[t][2]||""===this.previewData[t][2])return this.toast.open("Column:C  Row: "+t+" Name is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][2].charCodeAt(0))return this.toast.open("Column:C  Row: "+t+" Name doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1===/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[^\w\s]).{6,}$/.test(this.grid.data[t][2]))return this.toast.open("Column:C  Row: "+t+" Name must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 6 of length","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.other_client=this.previewData[t][3],null!=this.other_client&&""!==this.other_client){let o="";if("boolean"==typeof this.other_client?o=JSON.stringify(this.other_client).trim().toLowerCase():0==isNaN(this.other_client)||(o=this.other_client.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:D  Row: "+t+" Allow Other Clients must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.other_client=o)}else this.other_client=a;if(this.new_client=this.previewData[t][4],null!=this.new_client&&""!==this.new_client){let o="";if("boolean"==typeof this.new_client?o=JSON.stringify(this.new_client).trim().toLowerCase():0==isNaN(this.new_client)||(o=this.new_client.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:E  Row: "+t+" Allow New Clients must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.new_client=o)}else this.new_client=a;if(this.other_companyID=this.previewData[t][5],null!=this.other_companyID&&""!==this.other_companyID){let o="";if("boolean"==typeof this.other_companyID?o=JSON.stringify(this.other_companyID).trim().toLowerCase():0==isNaN(this.other_companyID)||(o=this.other_companyID.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:F  Row: "+t+" Allow Company ID must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.other_companyID=o)}else this.other_companyID=a;if(this.new_companyID=this.previewData[t][6],null!=this.new_companyID&&""!==this.new_companyID){let o="";if("boolean"==typeof this.new_companyID?o=JSON.stringify(this.new_companyID).trim().toLowerCase():0==isNaN(this.new_companyID)||(o=this.new_companyID.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:G  Row: "+t+" Allow New Company ID must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.new_companyID=o)}else this.new_companyID=a;if(null==this.previewData[t][7]||void 0===this.previewData[t][7]||""===this.previewData[t][7])return this.toast.open("Column:H  Row: "+t+" Client ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][7].charCodeAt(0))return this.toast.open("Column:H  Row: "+t+" Client ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][8]||void 0===this.previewData[t][8]||""===this.previewData[t][8])return this.toast.open("Column:I  Row: "+t+" Company ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][8].charCodeAt(0))return this.toast.open("Column:I  Row: "+t+" Company ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][9]||void 0===this.previewData[t][9]||""===this.previewData[t][9])return this.toast.open("Column:J  Row: "+t+" Username is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][9].charCodeAt(0))return this.toast.open("Column:J  Row: "+t+" Username doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][10]||void 0===this.previewData[t][10]||""===this.previewData[t][10])return this.toast.open("Column:K  Row: "+t+" Description is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][10].charCodeAt(0))return this.toast.open("Column:K  Row: "+t+" Description doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.previewData[t][11]))return this.toast.open("Column:L  Row: "+t+" Mobile must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(10!==this.previewData[t][11].length)return this.toast.open("Column:L  Row: "+t+" Mobile number should be 10 digits","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][12]||void 0===this.previewData[t][12]||""===this.previewData[t][12])return this.toast.open("Column:M  Row: "+t+" Mobile Privacy is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][12].charCodeAt(0))return this.toast.open("Column:M  Row: "+t+" Mobile privacy doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][13]||void 0===this.previewData[t][13]||""===this.previewData[t][13])return this.toast.open("Column:N  Row: "+t+" Email is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][13].charCodeAt(0))return this.toast.open("Column:N  Row: "+t+" Email doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(1!=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i.test(this.grid.data[t][13]))return this.toast.open("Column:N  Row: "+t+" Invalid Email address","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.previewData[t][14]))return this.toast.open("Column:O  Row: "+t+" Telegram ID must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(-1===Math.sign(this.previewData[t][14]))return this.toast.open("Column:O  Row: "+t+" Telegram ID must not be in negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][15]||void 0===this.previewData[t][15]||""===this.previewData[t][15])return this.toast.open("Column:P  Row: "+t+" Location Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][15].charCodeAt(0))return this.toast.open("Column:P  Row: "+t+" Location Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][16]||void 0===this.previewData[t][16]||""===this.previewData[t][16])return this.toast.open("Column:Q  Row: "+t+" Device Type Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][16].charCodeAt(0))return this.toast.open("Column:Q  Row: "+t+" Device Type Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][17]||void 0===this.previewData[t][17]||""===this.previewData[t][17])return this.toast.open("Column:R  Row: "+t+" Device Permission is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][17].charCodeAt(0))return this.toast.open("Column:R  Row: "+t+" Device Permission doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][18]||void 0===this.previewData[t][18]||""===this.previewData[t][18])return this.toast.open("Column:S  Row: "+t+" Default Module is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][18].charCodeAt(0))return this.toast.open("Column:S  Row: "+t+" Default Module doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((0,A.HD)(this.previewData[t][18])&&0==["MagicBoard","PowerBoard","DreamBoard"].includes(this.previewData[t][18]))return this.toast.open("Column:S  Row: "+t+" Default Module can be either in  DreamBoard, MagicBoard or PowerBoard","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(console.log("Default Loaction is :",this.previewData[t][19]),null==this.previewData[t][19]||void 0===this.previewData[t][19]||""===this.previewData[t][19])return this.toast.open("Column:T  Row: "+t+" Default Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][19].charCodeAt(0))return this.toast.open("Column:T  Row: "+t+" Default Type doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][20]||void 0===this.previewData[t][20]||""===this.previewData[t][20])return this.toast.open("Column:U  Row: "+t+" Start Node is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][20].charCodeAt(0))return this.toast.open("Column:U  Row: "+t+" Start Node doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.previewData[t][22]||void 0===this.previewData[t][22]||""===this.previewData[t][22])return this.toast.open("Column:V  Row: "+t+" Permission ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.previewData[t][22].charCodeAt(0))return this.toast.open("Column:V  Row: "+t+" Permission ID doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.alert_enable_email=this.previewData[t][24],null!=this.alert_enable_email&&""!==this.alert_enable_email){let o="";if("boolean"==typeof this.alert_enable_email?o=JSON.stringify(this.alert_enable_email).trim().toLowerCase():0==isNaN(this.alert_enable_email)||(o=this.alert_enable_email.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:Z  Row: "+t+" Enable Email must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_email=o)}else this.alert_enable_email=a;if(this.alert_enable_sms=this.previewData[t][25],null!=this.alert_enable_sms&&""!==this.alert_enable_sms){let o="";if("boolean"==typeof this.alert_enable_sms?o=JSON.stringify(this.alert_enable_sms).trim().toLowerCase():0==isNaN(this.alert_enable_sms)||(o=this.alert_enable_sms.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AA  Row: "+t+" Enable Email must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_sms=o)}else this.alert_enable_sms=a;if(this.alert_enable_telegram=this.previewData[t][26],null!=this.alert_enable_telegram&&""!==this.alert_enable_telegram){let o="";if("boolean"==typeof this.alert_enable_telegram?o=JSON.stringify(this.alert_enable_telegram).trim().toLowerCase():0==isNaN(this.alert_enable_telegram)||(o=this.alert_enable_telegram.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AB  Row: "+t+" Enable Telegram must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_enable_telegram=o)}else this.alert_enable_telegram=a;if(this.escalation_enable_email=this.previewData[t][27],null!=this.escalation_enable_email&&""!==this.escalation_enable_email){let o="";if("boolean"==typeof this.escalation_enable_email?o=JSON.stringify(this.escalation_enable_email).trim().toLowerCase():0==isNaN(this.escalation_enable_email)||(o=this.escalation_enable_email.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AC  Row: "+t+" Enable Escalation Email must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_email=o)}else this.escalation_enable_email=a;if(this.escalation_enable_SMS=this.previewData[t][28],null!=this.escalation_enable_SMS&&""!==this.escalation_enable_SMS){let o="";if("boolean"==typeof this.escalation_enable_SMS?o=JSON.stringify(this.escalation_enable_SMS).trim().toLowerCase():0==isNaN(this.escalation_enable_SMS)||(o=this.escalation_enable_SMS.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AD  Row: "+t+" Enable Escalation SMS must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_SMS=o)}else this.escalation_enable_SMS=a;if(this.escalation_enable_telegram=this.previewData[t][29],null!=this.escalation_enable_telegram&&""!==this.escalation_enable_telegram){let o="";if("boolean"==typeof this.escalation_enable_telegram?o=JSON.stringify(this.escalation_enable_telegram).trim().toLowerCase():0==isNaN(this.escalation_enable_telegram)||(o=this.escalation_enable_telegram.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AE  Row: "+t+" Enable Escalation telegram must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.escalation_enable_telegram=o)}else this.escalation_enable_telegram=a;if(this.health_check=this.previewData[t][30],null!=this.health_check&&""!==this.health_check){let o="";if("boolean"==typeof this.health_check?o=JSON.stringify(this.health_check).trim().toLowerCase():0==isNaN(this.health_check)||(o=this.health_check.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AF  Row: "+t+" Enable health check must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.health_check=o)}else this.health_check=a;if(this.device_timeout=this.previewData[t][31],null!=this.device_timeout&&""!==this.device_timeout){let o="";if("boolean"==typeof this.device_timeout?o=JSON.stringify(this.device_timeout).trim().toLowerCase():0==isNaN(this.device_timeout)||(o=this.device_timeout.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AG  Row: "+t+" Enable device timeout must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.device_timeout=o)}else this.device_timeout=a;if(this.alert_timeout=this.previewData[t][32],null!=this.alert_timeout&&""!==this.alert_timeout){let o="";if("boolean"==typeof this.alert_timeout?o=JSON.stringify(this.alert_timeout).trim().toLowerCase():0==isNaN(this.alert_timeout)||(o=this.alert_timeout.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AH  Row: "+t+" Enable alert timeout must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.alert_timeout=o)}else this.alert_timeout=a;if(this.account=this.previewData[t][33],null!=this.account&&""!==this.account){let o="";if("boolean"==typeof this.account?o=JSON.stringify(this.account).trim().toLowerCase():0==isNaN(this.account)||(o=this.account.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AI  Row: "+t+" Enable account must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.account=o)}else this.account=a;if(this.cognito_update=this.previewData[t][34],null!=this.cognito_update&&""!==this.cognito_update){let o="";if("boolean"==typeof this.cognito_update?o=JSON.stringify(this.cognito_update).trim().toLowerCase():0==isNaN(this.cognito_update)||(o=this.cognito_update.trim().toLowerCase()),o!==i&&o!==a)return this.toast.open("Column:AJ  Row: "+t+" Enable Cognito Update must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(o==i||o==a)&&(this.cognito_update=o)}else this.cognito_update=a;if(this.previewData[t][35]){let o="",d=!1;for(let c=35;c<=42;c++){if(this.accessPermission=this.previewData[t][c],console.log("this.accessPermission value is :",this.accessPermission),null==this.accessPermission||null==this.accessPermission||""==this.accessPermission){d=!0,console.log("Else statement got executed btw :"),this.finalPermission={accessPermission:"11111111"};break}{let h="";if("boolean"==typeof this.accessPermission?h=JSON.stringify(this.accessPermission).trim().toLowerCase():0==isNaN(this.cognito_update)||(h=this.accessPermission.trim().toLowerCase()),h!==i&&h!==a)return this.toast.open("Column:AJ to AP  Row: 35 to 42Access permission must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(h==i||h==a)&&(o+=h===i?"1":"0")}}0==d&&(this.finalPermission={accessPermission:o})}else console.log("Else statement got executed btw :"),this.finalPermission={accessPermission:"11111111"};this.ADD_finalData.PK=this.previewData[t][9].trim(),this.ADD_finalData.SK=this.SK_clientID,this.renameKeys.push(Object.keys(this.ADD_finalData)),this.renameKeys[0]="profile_picture",this.renameKeys[1]="userID",this.renameKeys[2]="name",this.renameKeys[3]="allowOtherClient",this.renameKeys[4]="allowNewClient",this.renameKeys[5]="allowOtherCompanyID",this.renameKeys[6]="allowNewCompanyID",this.renameKeys[7]="clientID",this.renameKeys[8]="companyID",this.renameKeys[9]="username",this.renameKeys[10]="description",this.renameKeys[11]="mobile",this.renameKeys[12]="mobile_privacy",this.renameKeys[13]="email",this.renameKeys[14]="telegramID",this.renameKeys[15]="location_permission",this.renameKeys[16]="device_type_permission",this.renameKeys[17]="device_permission",this.renameKeys[18]="default_module",this.renameKeys[19]="default_type",this.renameKeys[20]="start_node",this.renameKeys[21]="alert_levels",this.renameKeys[22]="permission_ID",this.renameKeys[23]="report_to",this.renameKeys[24]="alert_email",this.renameKeys[25]="alert_sms",this.renameKeys[26]="alert_telegram",this.renameKeys[27]="escalation_email",this.renameKeys[28]="escalation_sms",this.renameKeys[29]="escalation_telegram",this.renameKeys[30]="health_check",this.renameKeys[31]="device_timeout",this.renameKeys[32]="alert_timeout",this.renameKeys[33]="enable_user",this.renameKeys[34]="cognito_update",this.renameKeys[35]="others";for(var n=0;n<this.grid.data[0].length;n++)null==this.grid.data[t][n]?this.grid.data[t][n]=null:this.ADD_finalData[this.renameKeys[n]]=this.grid.data[t][n];delete this.ADD_finalData.undefined,delete this.ADD_finalData["PK,SK"],this.ADD_finalData.updated=new Date,this.ADD_finalData.allowOtherClient=this.other_client,this.ADD_finalData.allowNewClient=this.new_client,this.ADD_finalData.allowOtherCompanyID=this.other_companyID,this.ADD_finalData.allowNewCompanyID=this.new_companyID,this.ADD_finalData.alert_email=this.alert_enable_email,this.ADD_finalData.alert_sms=this.alert_enable_sms,this.ADD_finalData.alert_telegram=this.alert_enable_telegram,this.ADD_finalData.escalation_email=this.escalation_enable_email,this.ADD_finalData.escalation_sms=this.escalation_enable_SMS,this.ADD_finalData.escalation_telegram=this.escalation_enable_telegram,this.ADD_finalData.health_check=this.health_check,this.ADD_finalData.device_timeout=this.device_timeout,this.ADD_finalData.alert_timeout=this.alert_timeout,this.ADD_finalData.enable_user=this.account,this.ADD_finalData.cognito_update=this.cognito_update,this.ADD_finalData.others=JSON.stringify([this.finalPermission]),this.tempMultiData.push(this.ADD_finalData)}this.updateMultiUserxlsx(0)}updateMultiUserxlsx(e){var i=this;return(0,S.Z)(function*(){if(e<i.tempMultiData.length){let a=i.tempMultiData[e].device_permission.split(" "),n="";const t=new Set;a=a.filter(y=>{const D=t.has(y.value);return t.add(y.value),!D}),n=a?1===a.length?a[0]:a.length>1?a[0]+"...("+a.length+")":"...(0)":"...(0)";let r=i.tempMultiData[e].location_permission.split(" "),l="";l=r?1===r.length?r[0]:r.length>1?r[0]+"...("+r.length+")":"...(0)":"...(0)";let c,o=i.tempMultiData[e].device_type_permission.split(" "),d="";d=o?1===o.length?o[0]:o.length>1?o[0]+"...("+o.length+")":"...(0)":"...(0)",c=i.SK_clientID!=i.tempMultiData[e].clientID?i.tempMultiData[e].clientID:i.SK_clientID;const h=Math.ceil((new Date).getTime()/1e3),f={P1:i.tempMultiData[e].username,P2:i.tempMultiData[e].mobile,P3:i.tempMultiData[e].email,P4:i.tempMultiData[e].permission_ID,P5:l,P6:d,P7:n,P8:h};console.log("Lookup data to be added is",f),console.log("User will be created as",i.tempMultiData[e]),i.api.UpdateUserManagement(i.tempMultiData[e]).then(y=>{i.updateCognito(i.tempMultiData[e]),y?(i.fetchTimeMachineById(1,f.P1,"update",f),i.updateMultiUserxlsx(e+1)):alert("Error in updating User")}).catch(y=>{i.toast.open("Error in updating new user","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}else i.toast.open(e+" User updated successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})})()}fetchTimeMachineById(e,i,a,n){var t=this;return(0,S.Z)(function*(){try{const r=yield t.api.GetLookupMasterTable(t.SK_clientID+"#user",e);if(r&&r.items){let l=yield JSON.parse(r.items),o=l.findIndex(d=>d[Object.keys(d)[0]].P1===i);if(-1!==o){if("update"===a){l[o][`L${o+1}`]=n;const c=[];for(let h=0;h<l.length;h++){const f=Object.keys(l[h])[0],y=`L${h+1}`;if(f){const D={[y]:l[h][f]},m=c.findIndex(U=>Object.keys(U)[0]===y);-1!==m?Object.assign(c[m][y],l[h][f]):c.push(D)}else console.error(`Original key not found for renaming in data[${h}].`)}l=c}else"delete"===a&&l.splice(o,1);let d={PK:t.SK_clientID+"#user",SK:r.SK,items:JSON.stringify(l)};yield t.api.UpdateLookupMasterTable(d)}else yield new Promise(d=>setTimeout(d,500)),yield t.fetchTimeMachineById(e+1,i,a,n)}else Z().fire({position:"top-right",icon:"error",title:`ID ${i} not found`,showConfirmButton:!1,timer:1500})}catch(r){console.error("Error:",r)}})()}addToCognito(e){if(e){let a=new E.AM({UserPoolId:K.N.cognito.cognitoUserPoolId,ClientId:K.N.cognito.cognitoAppClientId}),n=[],t={email:e.email,"custom:userID":e.userID,"custom:name":e.name,"custom:clientID":e.clientID,"custom:companyID":e.companyID,"custom:username":e.username,"custom:description":e.description,"custom:mobile":JSON.stringify(e.mobile),"custom:mobile_privacy":e.mobile_privacy,"custom:user_type":JSON.stringify(e.user_type),"custom:enable_user":JSON.stringify(e.enable_user),"custom:disable_user":JSON.stringify(e.disable_user),"custom:alert_email":JSON.stringify(e.alert_email),"custom:alert_sms":JSON.stringify(e.alert_sms),"custom:alert_telegram":JSON.stringify(e.alert_telegram),"custom:escalation_email":JSON.stringify(e.escalation_email),"custom:escalation_sms":JSON.stringify(e.escalation_sms),"custom:escalation_telegram":JSON.stringify(e.escalation_telegram),"custom:telegramID":JSON.stringify(e.telegramID),"custom:location_permission":e.location_permission,"custom:device_type_permi":e.device_type_permission,"custom:device_permission":e.device_permission,"custom:defaultdevloc":e.default_dev_loc,"custom:start_node":e.start_node,"custom:health_check":JSON.stringify(e.health_check),"custom:device_timeout":JSON.stringify(e.device_timeout),"custom:alert_timeout":JSON.stringify(e.alert_timeout)};for(let r in t){let o=new E.KC({Name:r,Value:t[r]});n.push(o)}a.signUp(e.username,e.name,n,[],(r,l)=>{r?alert(r.message||JSON.stringify(r)):Z().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"User added to Cognito table",showCancelButton:!0,allowOutsideClick:!1})})}else Z().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Error in adding to Cognito Configuration",showCancelButton:!0,allowOutsideClick:!1})}updateCognito(e){let i={Username:e.username,Password:e.name},n=new E.AM({UserPoolId:K.N.cognito.cognitoUserPoolId,ClientId:K.N.cognito.cognitoAppClientId});console.log("user pool",n);let t={Username:e.username,Pool:n},r={email:e.email,"custom:userID":e.userID,"custom:name":e.name,"custom:clientID":e.clientID,"custom:companyID":e.companyID,"custom:username":e.username,"custom:description":e.description,"custom:mobile":JSON.stringify(e.mobile),"custom:mobile_privacy":e.mobile_privacy,"custom:enable_user":JSON.stringify(e.enable_user),"custom:disable_user":JSON.stringify(e.disable_user),"custom:alert_email":JSON.stringify(e.alert_email),"custom:alert_sms":JSON.stringify(e.alert_sms),"custom:alert_telegram":JSON.stringify(e.alert_telegram),"custom:escalation_email":JSON.stringify(e.escalation_email),"custom:escalation_sms":JSON.stringify(e.escalation_sms),"custom:escalation_telegram":JSON.stringify(e.escalation_telegram),"custom:telegramID":JSON.stringify(e.telegramID),"custom:location_permission":e.location_permission,"custom:device_type_permi":e.device_type_permission,"custom:device_permission":e.device_permission,"custom:defaultdevloc":e.default_dev_loc,"custom:start_node":e.start_node,"custom:health_check":JSON.stringify(e.health_check),"custom:device_timeout":JSON.stringify(e.device_timeout),"custom:alert_timeout":JSON.stringify(e.alert_timeout)},l=new E.ws(t),o=new E.sD(i);l.authenticateUser(o,{onSuccess:function(d){d.getAccessToken().getJwtToken();let h=[];for(let f in r){let D=new E.KC({Name:f,Value:r[f]});h.push(D)}l.updateAttributes(h,(f,y)=>{f?console.log("\n\nUpdate Error: ",f,"\n\n"):Z().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"User updated to Cognito table",showCancelButton:!0,allowOutsideClick:!1})})},onFailure:function(d){alert(d)}})}updatePagedData(){const e=this.currentPage*this.pageSize;this.pagedPreviewData=this.previewData.slice(e,e+this.pageSize),this.totalPages=Math.ceil(this.previewData.length/this.pageSize),this.grid.data=this.pagedPreviewData,this.cd.detectChanges()}loadGridData(e){this.previewData=e,this.currentPage=0,this.updatePagedData()}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.updatePagedData())}prevPage(){this.currentPage>0&&(this.currentPage--,this.updatePagedData())}}return w=P,(0,u.Z)(P,"\u0275fac",function(e){return new(e||w)(s.Y36(M.QS),s.Y36(X.ux),s.Y36(ie.t),s.Y36(oe),s.Y36(ae.FF),s.Y36(se.F),s.Y36(j.F0),s.Y36(ne.G),s.Y36(re.y),s.Y36(q.t2),s.Y36(s.sBO))}),(0,u.Z)(P,"\u0275cmp",s.Xpm({type:w,selectors:[["app-user-xlsx"]],viewQuery:function(e,i){if(1&e&&(s.Gf(le,7),s.Gf(ce,5)),2&e){let a;s.iGM(a=s.CRH())&&(i.fileUpload=a.first),s.iGM(a=s.CRH())&&(i.container=a.first)}},decls:33,vars:10,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],[1,"card","p-5","modern-card","shadow",3,"formGroup"],[1,"mb-4","text-primary","fw-bold"],[1,"row","g-4","align-items-end"],[1,"col-md-6"],[1,"form-label","fw-semibold","text-dark"],[1,"text-danger"],["formControlName","type","required","",1,"form-select"],["value","","disabled","","selected",""],["value","user_xlsx"],["class","text-danger",4,"ngIf"],["class","col-md-6",4,"ngIf"],[1,"col-12"],[1,"d-flex","flex-wrap","gap-2"],[1,"btn","btn-warning","text-dark",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-info text-white",3,"disabled","click",4,"ngIf"],["class","btn btn-success",3,"disabled","click",4,"ngIf"],["class","btn btn-dark",3,"disabled","click",4,"ngIf"],[1,"col-12","mt-4"],["id","grid",1,"modern-grid",2,"width","100%"],["container",""],["class","pagination-controls d-flex justify-content-between align-items-center mt-3",4,"ngIf"],["fileUpload",""],["for","fileInput",1,"form-label","fw-semibold","text-dark"],["type","file","id","fileInput","accept",".xlsx",1,"form-control",3,"change"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-info","text-white",3,"disabled","click"],[1,"btn","btn-success",3,"disabled","click"],[1,"btn","btn-dark",3,"disabled","click"],[1,"bi","bi-download","fs-5"],[1,"pagination-controls","d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-outline-secondary","btn-sm",3,"disabled","click"],[1,"modal-header","bg-danger","text-white"],[1,"modal-title"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],["class","alert alert-danger",4,"ngIf"],["class","validation-errors mt-3",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"alert","alert-danger"],[1,"validation-errors","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"badge","bg-danger"],[1,"validation-list","mt-2",2,"max-height","200px","overflow-y","auto"],[1,"table","table-sm","table-bordered","mb-0"],[1,"table-light","sticky-top"],[4,"ngFor","ngForOf"],[1,"text-center",2,"width","60px"]],template:function(e,i){if(1&e&&(s.TgZ(0,"ngx-spinner",0)(1,"p",1),s._uU(2,"Please wait Loading... "),s.qZA()(),s.TgZ(3,"div",2)(4,"h4",3),s._uU(5,"User"),s.qZA(),s.TgZ(6,"div",4)(7,"div",5)(8,"label",6),s._uU(9,"Type "),s.TgZ(10,"span",7),s._uU(11,"*"),s.qZA()(),s.TgZ(12,"select",8)(13,"option",9),s._uU(14,"Select Type"),s.qZA(),s.TgZ(15,"option",10),s._uU(16,"User"),s.qZA()(),s.YNc(17,he,2,0,"small",11),s.qZA(),s.YNc(18,ue,4,0,"div",12),s.TgZ(19,"div",13)(20,"div",14)(21,"button",15),s.NdJ("click",function(){let n;return i.exportTemplate(null==(n=i.createUserXlsx.get("type"))?null:n.value)}),s._uU(22," \u2b07 Export Template "),s.qZA(),s.YNc(23,de,2,1,"button",16),s.YNc(24,me,2,1,"button",17),s.YNc(25,pe,2,1,"button",18),s.YNc(26,fe,3,1,"button",19),s.qZA()(),s.TgZ(27,"div",20),s._UZ(28,"div",21,22),s.YNc(30,ge,7,4,"div",23),s.qZA()(),s.YNc(31,ve,10,2,"ng-template",null,24,s.W1O),s.qZA()),2&e){let a,n,t;s.Q6J("fullScreen",!0),s.xp6(3),s.Q6J("formGroup",i.createUserXlsx),s.xp6(14),s.Q6J("ngIf",(null==(a=i.createUserXlsx.get("type"))?null:a.hasError("required"))&&(null==(a=i.createUserXlsx.get("type"))?null:a.touched)),s.xp6(1),s.Q6J("ngIf","user_xlsx"===(null==(n=i.createUserXlsx.get("type"))?null:n.value)),s.xp6(3),s.Q6J("disabled",!(null!=(t=i.createUserXlsx.get("type"))&&t.value)),s.xp6(2),s.Q6J("ngIf",i.hideUpdateButton&&i.savedFileEvent),s.xp6(1),s.Q6J("ngIf",i.hideGetButton&&i.savedFileEvent),s.xp6(1),s.Q6J("ngIf",i.hideUpdateButton&&i.savedFileEvent),s.xp6(1),s.Q6J("ngIf",i.hideUpdateButton&&i.savedFileEvent),s.xp6(4),s.Q6J("ngIf",i.totalPages)}},dependencies:[$.sg,$.O5,q.Ro,M.YN,M.Kr,M.EJ,M.JJ,M.JL,M.Q7,M.sg,M.u],styles:[".spinner-text[_ngcontent-%COMP%]{color:#fff;font-size:1rem;text-align:center}.modern-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;border:none}.custom-select[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:6px;background-color:#f8f9fa;transition:all .3s ease}.custom-select[_ngcontent-%COMP%]:focus{border-color:#4c6ef5;box-shadow:0 0 0 .2rem #4c6ef540}.modern-file[_ngcontent-%COMP%]{border-radius:6px;border:1px solid #ced4da;background-color:#f8f9fa;transition:all .3s}.modern-file[_ngcontent-%COMP%]:focus{border-color:#4c6ef5;box-shadow:0 0 0 .2rem #4c6ef540}button[_ngcontent-%COMP%]{transition:.3s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:scale(1.03)}.modern-grid[_ngcontent-%COMP%]{background-color:#f1f3f5;padding:1rem;border:1px solid #dee2e6;border-radius:8px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff}.table-danger[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#ffa8a8}.scroll-grid-container[_ngcontent-%COMP%]{position:relative;height:500px;overflow-y:auto;border:1px solid #dee2e6;border-radius:10px;background:#f9f9f9}.sticky-toolbar[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:#fff;border-radius:10px 10px 0 0}"]})),P})(),be=(()=>{var w;class P{}return w=P,(0,u.Z)(P,"\u0275fac",function(e){return new(e||w)}),(0,u.Z)(P,"\u0275mod",s.oAB({type:w})),(0,u.Z)(P,"\u0275inj",s.cJS({imports:[$.ez,X.ZX,q.ef,M.UX,j.Bz.forChild([{path:"",component:ye}])]})),P})()}}]);