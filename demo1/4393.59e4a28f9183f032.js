"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[4393],{54393:(Nt,me,Z)=>{Z.r(me),Z.d(me,{UserModule:()=>At});var n=Z(86656),P=Z(96814),Q=Z(22939),pe=Z(64190),D=Z(15861),v=Z(56223),F=Z(5816),Ue=Z(13519),C=Z.n(Ue),j=Z(77874),e=Z(65879),_e=Z(36624),R=Z(14934),fe=Z(16519),A=Z(5588);function ye(r,u){1&r&&(e.TgZ(0,"div",10)(1,"p"),e._uU(2,"No unconfirmed users found."),e.qZA()())}function De(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"a",19),e.NdJ("click",function(){e.CHM(a);const l=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.resendVerification(l.username))}),e._uU(1,"Resend"),e.qZA()}}function Ce(r,u){1&r&&(e.TgZ(0,"a",20),e._uU(1,"Sent"),e.qZA())}function Ie(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"a",21),e.NdJ("click",function(){e.CHM(a);const l=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.resendCredentials(l.username))}),e._uU(1,"Resend"),e.qZA()}}function Ze(r,u){1&r&&(e.TgZ(0,"a",20),e._uU(1,"Sent"),e.qZA())}function we(r,u){if(1&r&&(e.TgZ(0,"tr",13)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",14)(6,"span",15),e._uU(7,"Unconfirmed"),e.qZA()(),e.TgZ(8,"td",14),e.YNc(9,De,2,0,"a",16),e.YNc(10,Ce,2,0,"a",17),e.qZA(),e.TgZ(11,"td",14),e.YNc(12,Ie,2,0,"a",18),e.YNc(13,Ze,2,0,"a",17),e.qZA()()),2&r){const a=u.$implicit;e.xp6(2),e.Oqu(a.username),e.xp6(2),e.Oqu(a.email),e.xp6(5),e.Q6J("ngIf",a&&null==a.sentMail),e.xp6(1),e.Q6J("ngIf",a&&a.sentMail),e.xp6(2),e.Q6J("ngIf",a&&null==a.sentCredentialMail),e.xp6(1),e.Q6J("ngIf",a&&a.sentCredentialMail)}}function Te(r,u){if(1&r&&(e.TgZ(0,"table",11)(1,"thead")(2,"tr")(3,"th"),e._uU(4,"Username"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Email"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Status"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Verification"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Credentials"),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,we,14,6,"tr",12),e.qZA()()),2&r){const a=e.oxw();e.xp6(14),e.Q6J("ngForOf",a.paginatedUsers)}}function Fe(r,u){1&r&&(e.TgZ(0,"div",10)(1,"p"),e._uU(2,"No user found with the entered value."),e.qZA()())}function xe(r,u){if(1&r&&(e.TgZ(0,"div",22)(1,"p"),e._uU(2),e.qZA()()),2&r){const a=e.oxw();e.xp6(2),e.hij("Total Unconfirmed Users: ",""!=a.searchText?a.filteredUsers.length+" of "+a.unverifiedUsers.length:a.unverifiedUsers.length,"")}}function ke(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"div",23)(1,"button",24),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.previousPage())}),e._uU(2," \u2190 "),e.qZA(),e.TgZ(3,"span",25),e._uU(4),e.qZA(),e.TgZ(5,"button",24),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.nextPage())}),e._uU(6," \u2192 "),e.qZA()()}if(2&r){const a=e.oxw();e.xp6(1),e.Q6J("disabled",1===a.page),e.xp6(3),e.AsE("Page ",a.page," of ",a.totalPages,""),e.xp6(1),e.Q6J("disabled",a.page===a.totalPages)}}let he=(()=>{var r;class u{constructor(t,l,i,o,s,d){(0,n.Z)(this,"DynamicApi",void 0),(0,n.Z)(this,"modal",void 0),(0,n.Z)(this,"toast",void 0),(0,n.Z)(this,"cd",void 0),(0,n.Z)(this,"auditTrialServices",void 0),(0,n.Z)(this,"permissionConfiguration",void 0),(0,n.Z)(this,"unverifiedUsers",[]),(0,n.Z)(this,"isModalOpen",!0),(0,n.Z)(this,"username",void 0),(0,n.Z)(this,"SK_clientID",void 0),(0,n.Z)(this,"getLoggedUser",void 0),(0,n.Z)(this,"loggedUserName",void 0),(0,n.Z)(this,"page",1),(0,n.Z)(this,"pageSize",10),(0,n.Z)(this,"searchText",""),(0,n.Z)(this,"filteredUsers",[]),this.DynamicApi=t,this.modal=l,this.toast=i,this.cd=o,this.auditTrialServices=s,this.permissionConfiguration=d}ngOnInit(){this.getLoggedUser=this.permissionConfiguration.getLoggedUserDetails(),this.loggedUserName=this.getLoggedUser.attributes["custom:username"],console.log("Unverified users are here",this.unverifiedUsers),this.auditTrialServices.audit_trail("2.1","User","View","Unconfirmed users table was viewed","1"),this.filteredUsers=[...this.unverifiedUsers]}resendCredentials(t){var l=this;return(0,D.Z)(function*(){const i=l.unverifiedUsers.find(s=>s.username==t);l.DynamicApi.sendData({type:"userVerify",username:i.username,name:i.password,email:i.email}).subscribe(s=>{console.log("Response from Lambda:",s),s&&(C().fire({position:"top-right",icon:"success",title:"Credentails mail sent successfully ",showConfirmButton:!1,timer:1500}),l.auditTrialServices.audit_trail("2.1","User","Mail Sent",`${l.loggedUserName} resended credential mail to ${t}`,"1"),l.unverifiedUsers=l.unverifiedUsers.map(d=>t===d.username?{...d,sentCredentialMail:!0}:d),l.filterUsers())},s=>{console.error("Error calling dynamic lambda:",s)})})()}resendVerification(t){var l=this;return(0,D.Z)(function*(){const i={type:"cognitoServices",event:{path:"/resendVerification",queryStringParameters:{email:"dummy@wimate.in"},username:t}};try{const o=yield l.DynamicApi.getData(i);o&&(200==o.statusCode?(C().fire({position:"top-right",icon:"success",title:"Verification mail sent successfully ",showConfirmButton:!1,timer:1500}),l.auditTrialServices.audit_trail("2.1","User","Mail Sent",`${l.loggedUserName} resended verification mail to ${t}`,"1")):C().fire({position:"top-right",icon:"error",title:"Error sending mail",showConfirmButton:!1,timer:1500}))}catch(o){console.error("Error calling dynamic lambda:",o)}l.unverifiedUsers&&(l.unverifiedUsers=l.unverifiedUsers.map(o=>t===o.username?{...o,sentMail:!0}:o),l.filterUsers(),l.cd.detectChanges())})()}filterUsers(){const t=this.searchText.toLowerCase();this.filteredUsers=this.unverifiedUsers.filter(l=>l.username.toLowerCase().includes(t)||l.email.toLowerCase().includes(t)),this.page=1}nextPage(){this.page<this.totalPages&&this.page++}previousPage(){this.page>1&&this.page--}get paginatedUsers(){const t=(this.page-1)*this.pageSize;return this.filteredUsers.slice(t,t+this.pageSize)}get totalPages(){return Math.ceil(this.filteredUsers.length/this.pageSize)}}return r=u,(0,n.Z)(u,"\u0275fac",function(t){return new(t||r)(e.Y36(_e.y),e.Y36(R.Kz),e.Y36(Q.ux),e.Y36(e.sBO),e.Y36(fe.C),e.Y36(A.F))}),(0,n.Z)(u,"\u0275cmp",e.Xpm({type:r,selectors:[["app-user-verified-table"]],inputs:{username:"username",SK_clientID:"SK_clientID"},decls:14,vars:6,consts:[[1,"approval-history-container"],[1,"approval-history-header",3,"click"],[1,"close-btn"],[1,"approval-history-list"],["class","error-message",4,"ngIf"],[1,"search-bar"],["type","text","placeholder","Search",1,"search-input",3,"ngModel","ngModelChange"],["class","approval-table",4,"ngIf"],["class","user-count",4,"ngIf"],["class","pagination-controls",4,"ngIf"],[1,"error-message"],[1,"approval-table"],["class","approval-row",4,"ngFor","ngForOf"],[1,"approval-row"],[1,"status"],[1,"badge","badge-danger",2,"cursor","not-allowed"],["class","btn btn-sm custom-primary fw-bolder ms-2 fs-7 py-2 px-5","type","submit",3,"click",4,"ngIf"],["class","btn btn-sm btn-success fw-bolder ms-2 fs-7 py-2 px-5","style","cursor: not-allowed;","type","submit",4,"ngIf"],["class","btn btn-sm btn-dark fw-bolder ms-2 fs-7 py-2 px-5","type","submit",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-sm","custom-primary","fw-bolder","ms-2","fs-7","py-2","px-5",3,"click"],["type","submit",1,"btn","btn-sm","btn-success","fw-bolder","ms-2","fs-7","py-2","px-5",2,"cursor","not-allowed"],["type","submit",1,"btn","btn-sm","btn-dark","fw-bolder","ms-2","fs-7","py-2","px-5",3,"click"],[1,"user-count"],[1,"pagination-controls"],[1,"arrow-btn",3,"disabled","click"],[1,"page-label"]],template:function(t,l){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return l.modal.close()}),e.TgZ(2,"h3"),e._uU(3,"Unconfirmed Users"),e.qZA(),e.TgZ(4,"button",2),e._uU(5,"\xd7"),e.qZA()(),e.TgZ(6,"div",3),e.YNc(7,ye,3,0,"div",4),e.TgZ(8,"div",5)(9,"input",6),e.NdJ("ngModelChange",function(o){return l.searchText=o})("ngModelChange",function(){return l.filterUsers()}),e.qZA()(),e.YNc(10,Te,15,1,"table",7),e.YNc(11,Fe,3,0,"div",4),e.YNc(12,xe,3,1,"div",8),e.YNc(13,ke,7,4,"div",9),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("ngIf",0===l.unverifiedUsers.length),e.xp6(2),e.Q6J("ngModel",l.searchText),e.xp6(1),e.Q6J("ngIf",l.unverifiedUsers.length>0),e.xp6(1),e.Q6J("ngIf",""!=l.searchText&&0==l.filteredUsers.length),e.xp6(1),e.Q6J("ngIf",l.unverifiedUsers.length>0),e.xp6(1),e.Q6J("ngIf",l.totalPages>1))},dependencies:[P.sg,P.O5,v.Fj,v.JJ,v.On],styles:[".approval-history-container[_ngcontent-%COMP%]{max-width:100%;padding:20px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a}.approval-history-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#333;text-align:center;margin-bottom:20px;font-weight:600}.approval-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:0 auto}.approval-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .approval-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #ddd}.approval-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#1b84ff;color:#fff;font-weight:700;font-size:1.1rem}.approval-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff;color:#555;font-size:1rem}.approval-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.status[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:8px 12px;font-size:.875rem;font-weight:700;color:#fff;background-color:#f8285a;border-radius:4px}.status[_ngcontent-%COMP%]   .badge-danger[_ngcontent-%COMP%]{background-color:#f8285a}.status[_ngcontent-%COMP%]   .badge-success[_ngcontent-%COMP%]{background-color:#15d61f}.status[_ngcontent-%COMP%]   .custom-primary[_ngcontent-%COMP%]{background-color:#ff6f1e;color:#fff}@media (max-width: 768px){.approval-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .approval-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px}.approval-history-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem}}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:2.5em;color:#000;position:absolute;top:10px;right:20px;cursor:pointer}.close-btn[_ngcontent-%COMP%]:hover{color:red}.error-message[_ngcontent-%COMP%]{color:green;font-weight:700;text-align:center;padding:10px;border:1px solid green;margin-top:20px}.pagination-controls[_ngcontent-%COMP%]{margin-top:15px;text-align:center}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px}.pagination-controls[_ngcontent-%COMP%]{margin-top:15px;text-align:center;display:flex;justify-content:center;align-items:center;gap:15px}.arrow-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 14px;border-radius:50%;font-size:15px;cursor:pointer;transition:background-color .2s ease}.arrow-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.arrow-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.page-label[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.search-bar[_ngcontent-%COMP%]{margin:20px 0;display:flex;justify-content:end}.search-input[_ngcontent-%COMP%]{width:25%;max-width:500px;padding:10px 15px;font-size:1rem;border:1px solid #ccc;border-radius:6px;transition:border-color .3s ease}.search-input[_ngcontent-%COMP%]:focus{border-color:#1b84ff;outline:none;box-shadow:0 0 5px #1b84ff4d}.user-count[_ngcontent-%COMP%]{text-align:right;font-weight:700;color:#333;margin-bottom:10px}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.8 ms}"]})),u})();var Pe=Z(31552),Ae=Z(74260),z=Z(88672),ge=Z(60540);const Se=["closeUser"];function Ne(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"button",110),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.showUnverifiedUsers())}),e._UZ(1,"i",111),e.qZA()}2&r&&e.Q6J("ngbTooltip","View all unverified users.")}function qe(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"button",112),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.openModal("",""))}),e._uU(1," New "),e.qZA()}}function Oe(r,u){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"User Name"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Permission ID"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Location Permission"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Device Type Permission"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Device Permission"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Updated"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Edit"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Delete"),e.qZA()())}function Me(r,u){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"User Name"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Permission ID"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Location Permission"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Device Type Permission"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Device Permission"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Updated"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Edit"),e.qZA()())}function Je(r,u){1&r&&(e.TgZ(0,"h2",113),e._uU(1,"Add User Configuration"),e.qZA())}function Le(r,u){1&r&&(e.TgZ(0,"h2",113),e._uU(1,"Edit User Configuration"),e.qZA())}function Ee(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"button",114),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.onCloneUser())}),e.TgZ(1,"span",115),e._UZ(2,"i",116),e.qZA(),e.TgZ(3,"span",117),e._uU(4," Clone User"),e.qZA()()}if(2&r){const a=e.oxw();e.Q6J("disabled",a.cloneUserOperation)("hidden",a.hideUpdateButton)}}function Ke(r,u){if(1&r&&e._UZ(0,"img",118),2&r){const a=e.oxw();e.s9C("src",a.base64textString_temp,e.LSH)}}function Ye(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Username is required "),e.qZA())}function Be(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Password is required "),e.qZA())}function Qe(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}function je(r,u){if(1&r&&(e.TgZ(0,"select",120),e.YNc(1,Qe,2,2,"option",67),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("ngForOf",a.listofClientIDs)}}function Re(r,u){1&r&&e._UZ(0,"input",122)}function $e(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}function ze(r,u){if(1&r&&(e.TgZ(0,"select",123),e.YNc(1,$e,2,2,"option",67),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("ngForOf",a.listofCompanyIDs)}}function Ge(r,u){1&r&&e._UZ(0,"input",124)}function He(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Company ID is required "),e.qZA())}function We(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}function Xe(r,u){if(1&r&&(e.TgZ(0,"div",30)(1,"label",31),e._uU(2,"Permission ID"),e.qZA(),e.TgZ(3,"select",125),e.YNc(4,We,2,2,"option",67),e.qZA()()),2&r){const a=e.oxw();e.xp6(4),e.Q6J("ngForOf",a.listofPermissionIDs)}}function Ve(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," User ID is required "),e.qZA())}function et(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Description is required "),e.qZA())}function tt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Mobile Number is required "),e.qZA())}function it(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Mobile Privacy is required "),e.qZA())}function lt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Email is required "),e.qZA())}function ot(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Location Permission is required "),e.qZA())}function st(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"div",30)(1,"label",31),e._uU(2," Location Permission"),e.qZA(),e.TgZ(3,"div",126)(4,"ng-multiselect-dropdown",127),e.NdJ("onSelect",function(l){e.CHM(a);const i=e.oxw(2);return e.KtG(i.onLocationSelect(l))}),e.qZA()(),e.YNc(5,ot,2,0,"div",34),e.qZA()}if(2&r){const a=e.oxw(2);let t;e.xp6(4),e.Q6J("placeholder","select devicetype permission")("settings",a.dropdownSettings)("data",a.locationPermissionArray)("formControl",a.createUserField.controls.location_permission),e.xp6(1),e.Q6J("ngIf",(null==(t=a.createUserField.get("location_permission"))?null:t.hasError("required"))&&(null==(t=a.createUserField.get("location_permission"))?null:t.touched))}}function rt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Device Type Permission is required "),e.qZA())}function at(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"div",30)(1,"label",31),e._uU(2,"Reading Device Type Permission"),e.qZA(),e.TgZ(3,"div",126)(4,"ng-multiselect-dropdown",128),e.NdJ("onSelect",function(l){e.CHM(a);const i=e.oxw(2);return e.KtG(i.onDeviceTypeSelect(l))})("onSelectAll",function(l){e.CHM(a);const i=e.oxw(2);return e.KtG(i.onSelectAll(l))}),e.qZA()(),e.YNc(5,rt,2,0,"div",34),e.qZA()}if(2&r){const a=e.oxw(2);let t;e.xp6(4),e.Q6J("placeholder","select devicetype permission")("settings",a.dropdownSettings)("data",a.rdtListWorkAround)("formControl",a.createUserField.controls.device_type_permission),e.xp6(1),e.Q6J("ngIf",(null==(t=a.createUserField.get("device_type_permission"))?null:t.hasError("required"))&&(null==(t=a.createUserField.get("device_type_permission"))?null:t.touched))}}function nt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Device Permission is required "),e.qZA())}function ct(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"div",30)(1,"label",31),e._uU(2,"Device Permission"),e.qZA(),e.TgZ(3,"div",126)(4,"ng-multiselect-dropdown",128),e.NdJ("onSelect",function(l){e.CHM(a);const i=e.oxw(2);return e.KtG(i.onDeviceSelect(l))})("onSelectAll",function(l){e.CHM(a);const i=e.oxw(2);return e.KtG(i.onSelectAllDevices(l))}),e.qZA()(),e.YNc(5,nt,2,0,"div",34),e.qZA()}if(2&r){const a=e.oxw(2);let t;e.xp6(4),e.Q6J("placeholder","select device permission")("settings",a.dropdownSettings)("data",a.deviceListWorkAround)("formControl",a.createUserField.controls.device_permission),e.xp6(1),e.Q6J("ngIf",(null==(t=a.createUserField.get("device_permission"))?null:t.hasError("required"))&&(null==(t=a.createUserField.get("device_permission"))?null:t.touched))}}function dt(r,u){if(1&r&&(e.TgZ(0,"div",22)(1,"div",44),e.YNc(2,st,6,5,"div",49),e.YNc(3,at,6,5,"div",49),e.YNc(4,ct,6,5,"div",49),e.qZA()()),2&r){const a=e.oxw();e.xp6(2),e.Q6J("ngIf",a.locationPermissionArray.length>0),e.xp6(1),e.Q6J("ngIf",a.rdtListWorkAround.length>0),e.xp6(1),e.Q6J("ngIf",a.deviceListWorkAround.length>0)}}function ut(r,u){if(1&r&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.xp6(1),e.hij(" ",a.text," ")}}function mt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Default Device is required "),e.qZA())}function pt(r,u){if(1&r&&(e.TgZ(0,"div",68)(1,"label",57),e._uU(2," Default Device"),e.qZA(),e.TgZ(3,"select",129),e.YNc(4,ut,2,1,"option",130),e.qZA(),e.YNc(5,mt,2,0,"div",34),e.qZA()),2&r){const a=e.oxw();let t;e.xp6(4),e.Q6J("ngForOf",a.deviceListWorkAround),e.xp6(1),e.Q6J("ngIf",(null==(t=a.createUserField.get("default_dev"))?null:t.hasError("required"))&&(null==(t=a.createUserField.get("default_dev"))?null:t.touched))}}function _t(r,u){if(1&r&&(e.TgZ(0,"a",131),e._uU(1),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Oqu(a.idSelected)}}function ft(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}function ht(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a,"")}}function gt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Default Location is required "),e.qZA())}function vt(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Default Type is required "),e.qZA())}function bt(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a,"")}}function Ut(r,u){1&r&&(e.TgZ(0,"div",119),e._uU(1," Start Node is required "),e.qZA())}function yt(r,u){if(1&r&&(e.TgZ(0,"option",121),e._uU(1),e.qZA()),2&r){const a=u.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}function Dt(r,u){1&r&&(e.TgZ(0,"div",132),e._uU(1," You'll only receive alert notifications if:"),e._UZ(2,"br"),e._uU(3," \u2022 Alert escalation is turned on"),e._UZ(4,"br"),e._uU(5," \u2022 Your user account is confirmed and enabled"),e._UZ(6,"br"),e._uU(7," \u2022 You've selected at least one preferred alert notification below"),e._UZ(8,"br")(9,"br"),e.TgZ(10,"strong"),e._uU(11,"Note:"),e.qZA(),e._uU(12," Your alert preferences must also align with client settings and the notification matrix. "),e.qZA())}function Ct(r,u){1&r&&(e.TgZ(0,"div",133),e._UZ(1,"input",134),e.TgZ(2,"label",99)(3,"b"),e._uU(4,"Enable User"),e.qZA()()())}const It=function(r,u){return{"bg-red":r,"bg-green":u}};function Zt(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"div",135),e.NdJ("click",function(l){const o=e.CHM(a).$implicit,s=e.oxw();return e.KtG(s.checkedBitPermission(l,"parent",o))}),e.TgZ(1,"label",136),e.NdJ("click",function(l){const o=e.CHM(a).$implicit,s=e.oxw();return e.KtG(s.checkedBitPermission(l,"",o))}),e._uU(2),e.qZA(),e.TgZ(3,"input",137),e.NdJ("change",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.updateBinaryCode())}),e.qZA()()}if(2&r){const a=u.$implicit,t=e.oxw();let l;e.xp6(1),e.Q6J("ngClass",e.WLB(3,It,!(null!=(l=t.createUserField.get("bit"+a))&&l.value),null==(l=t.createUserField.get("bit"+a))?null:l.value)),e.xp6(1),e.hij(" L",a+1," "),e.xp6(1),e.Q6J("formControlName","bit"+a)}}function wt(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"button",138),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.updateUser(l.createUserField.value,"editUser"))}),e._uU(1," Update "),e.qZA()}if(2&r){const a=e.oxw();e.Q6J("hidden",a.hideUpdateButton)("disabled",a.createUserField.invalid||""!=a.errorForUniqueID||"Email already exists"==a.errorForUniqueEmail||"Invalid Email Address"==a.errorForInvalidEmail||"Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 6 of length"==a.errorForInvalidName)}}function Tt(r,u){if(1&r){const a=e.EpF();e.TgZ(0,"button",139),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.createNewUser("","html"))}),e._uU(1,"Save"),e.qZA()}if(2&r){const a=e.oxw();e.Q6J("hidden",a.hideUpdateButton)("disabled",a.createUserField.invalid||"User ID already exists"==a.errorForUniqueUserID||""!=a.errorForUniqueID||"Email already exists"==a.errorForUniqueEmail||"Invalid Email Address"==a.errorForInvalidEmail||"Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 6 of length"==a.errorForInvalidName)}}const Ft=function(r){return{"d-none":r}},xt=function(r){return{"-webkit-text-security":r}},kt=function(){return["MagicBoard","PowerBoard","DreamBoard"]};let Pt=(()=>{var r;class u{constructor(t,l,i,o,s,d,c,p,g,_,m,h,b,w,y,f,I,T){var U=this;(0,n.Z)(this,"fb",void 0),(0,n.Z)(this,"userConfiguration",void 0),(0,n.Z)(this,"permissionConfiguration",void 0),(0,n.Z)(this,"companyConfiguration",void 0),(0,n.Z)(this,"clientConfiguration",void 0),(0,n.Z)(this,"getReadingDeviceType",void 0),(0,n.Z)(this,"devicesList",void 0),(0,n.Z)(this,"api",void 0),(0,n.Z)(this,"toast",void 0),(0,n.Z)(this,"ref",void 0),(0,n.Z)(this,"renderer",void 0),(0,n.Z)(this,"router",void 0),(0,n.Z)(this,"locationPermissionService",void 0),(0,n.Z)(this,"cd",void 0),(0,n.Z)(this,"DynamicApi",void 0),(0,n.Z)(this,"spinner",void 0),(0,n.Z)(this,"modalService",void 0),(0,n.Z)(this,"auditTrialServices",void 0),(0,n.Z)(this,"binaryCode","11111111"),(0,n.Z)(this,"createUserField",void 0),(0,n.Z)(this,"data_temp",[]),(0,n.Z)(this,"allUserDetails",{}),(0,n.Z)(this,"userSK",void 0),(0,n.Z)(this,"showModal",!1),(0,n.Z)(this,"somelist",[0,1,2,3,4,5,6,7]),(0,n.Z)(this,"showHeading",!1),(0,n.Z)(this,"showMobileNumber",void 0),(0,n.Z)(this,"rdtListWorkAround",[]),(0,n.Z)(this,"errorForUniqueID",void 0),(0,n.Z)(this,"errorForUniqueEmail",void 0),(0,n.Z)(this,"locationPermissionArray",[{text:"All",value:"All"}]),(0,n.Z)(this,"privacyVisibility",!1),(0,n.Z)(this,"errorForInvalidName",void 0),(0,n.Z)(this,"errorForInvalidEmail",void 0),(0,n.Z)(this,"errorForUniqueUserID",void 0),(0,n.Z)(this,"listofSK",[]),(0,n.Z)(this,"listofUserID",[]),(0,n.Z)(this,"listofReportingUsers",[]),(0,n.Z)(this,"listofEmails",[]),(0,n.Z)(this,"data_temp_permissionIDs",[]),(0,n.Z)(this,"listofPermissionIDs",[]),(0,n.Z)(this,"listofCompanyIDs",[]),(0,n.Z)(this,"listofClientIDs",[]),(0,n.Z)(this,"listofdevices",[]),(0,n.Z)(this,"getLoggedUser",void 0),(0,n.Z)(this,"SK_clientID",void 0),(0,n.Z)(this,"loggedUserName",void 0),(0,n.Z)(this,"user",void 0),(0,n.Z)(this,"signedIn",void 0),(0,n.Z)(this,"checkUserPermission",void 0),(0,n.Z)(this,"giveUserAccess",void 0),(0,n.Z)(this,"switchBetweenDropdown_textField",!1),(0,n.Z)(this,"disabled_CLientID_textField",!0),(0,n.Z)(this,"showDisabledClientID",void 0),(0,n.Z)(this,"showDisabledCompanyID",void 0),(0,n.Z)(this,"base64textString",void 0),(0,n.Z)(this,"base64textString_temp",void 0),(0,n.Z)(this,"listofRDT",[]),(0,n.Z)(this,"user_PK",void 0),(0,n.Z)(this,"user_SK",void 0),(0,n.Z)(this,"dropdownSettings",{}),(0,n.Z)(this,"dropdownSingleSelection",{}),(0,n.Z)(this,"maskedNumber",""),(0,n.Z)(this,"closeUser",void 0),(0,n.Z)(this,"cognitoUSER",void 0),(0,n.Z)(this,"userPool",void 0),(0,n.Z)(this,"allPermissions_user",void 0),(0,n.Z)(this,"hideUpdateButton",!1),(0,n.Z)(this,"hideDeleteButton",!1),(0,n.Z)(this,"columnDatatable",[]),(0,n.Z)(this,"multiselectDeviceType_permission",[]),(0,n.Z)(this,"multiselectDevice_permission",[]),(0,n.Z)(this,"allDeviceTypeValues",[]),(0,n.Z)(this,"allDeviceValues",[]),(0,n.Z)(this,"enableLocationButton",void 0),(0,n.Z)(this,"final_list",void 0),(0,n.Z)(this,"parentID_selected_node",void 0),(0,n.Z)(this,"treeMagicBoardPK",void 0),(0,n.Z)(this,"user_companyID",void 0),(0,n.Z)(this,"finalBinary",void 0),(0,n.Z)(this,"lookup_data_temp1",[]),(0,n.Z)(this,"lookup_data",[]),(0,n.Z)(this,"deviceListWorkAround",[]),(0,n.Z)(this,"startNode",[]),(0,n.Z)(this,"dataform",[]),(0,n.Z)(this,"columnTableData",[]),(0,n.Z)(this,"deviceTableData",void 0),(0,n.Z)(this,"clientID",void 0),(0,n.Z)(this,"lookup_data_user",[]),(0,n.Z)(this,"maxlength",500),(0,n.Z)(this,"multiselectDevice_dev",[]),(0,n.Z)(this,"multiselectLocation",[]),(0,n.Z)(this,"multiDefaultdevice",[]),(0,n.Z)(this,"defaultlocation",[]),(0,n.Z)(this,"lookupdatapermission",[]),(0,n.Z)(this,"switchBetweenDropdown_company_id",!1),(0,n.Z)(this,"disabled_companyID_textField",!0),(0,n.Z)(this,"lookup_data_company",[]),(0,n.Z)(this,"editOperation",!1),(0,n.Z)(this,"dataUser",void 0),(0,n.Z)(this,"lookup_client",[]),(0,n.Z)(this,"adminLogin",!1),(0,n.Z)(this,"locationAdmin",!1),(0,n.Z)(this,"idSelected",""),(0,n.Z)(this,"errorForUniqueMobileID",""),(0,n.Z)(this,"childComponent",void 0),(0,n.Z)(this,"currentUserSelected",void 0),(0,n.Z)(this,"temp",[]),(0,n.Z)(this,"cloneUserOperation",!1),(0,n.Z)(this,"deleteCognitoUser",function(){var x=(0,D.Z)(function*(q){console.log("current user",q);try{console.log("User deleted successfully in Cognito");const S=Math.ceil((new Date).getTime()/1e3),N={P1:U.userSK.user_name,P2:U.userSK.Mobile,P3:U.userSK.Email,P4:U.userSK.PermissionID,P5:U.userSK.Location_Permission,P6:U.userSK.Device_Type_Permission,P7:U.userSK.Device_Permission,P8:S,P9:U.userSK.userID,P10:U.userSK.health_check,P11:U.userSK.device_timeout};if(yield U.api.DeleteUserManagement(U.allUserDetails)){yield U.fetchTimeMachineById(1,N.P1,"delete",N),yield U.loading(),U.addFromService(),U.spinner.hide();const O={type:"cognitoServices",event:{path:"/deleteUser",queryStringParameters:{username:N.P1}}};try{const k=yield U.DynamicApi.getData(O);console.log("Response is here ",JSON.parse(k.body).message),U.toast.open(`${JSON.parse(k.body).message}`," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})}catch(k){console.error("Error calling dynamic lambda:",k)}C().fire("Removed!","User configuration successfully.","success")}}catch(S){U.spinner.hide(),console.log("Error during deletion",S),C().fire("User configuration not removed")}});return function(q){return x.apply(this,arguments)}}()),(0,n.Z)(this,"selectedLocationObject",void 0),this.fb=t,this.userConfiguration=l,this.permissionConfiguration=i,this.companyConfiguration=o,this.clientConfiguration=s,this.getReadingDeviceType=d,this.devicesList=c,this.api=p,this.toast=g,this.ref=_,this.renderer=m,this.router=h,this.locationPermissionService=b,this.cd=w,this.DynamicApi=y,this.spinner=f,this.modalService=I,this.auditTrialServices=T}ngOnInit(){this.getLoggedUser=this.permissionConfiguration.getLoggedUserDetails(),this.dropdownSettings=this.userConfiguration.getSettings(),this.dropdownSettings.enableCheckAll=!1,this.dropdownSingleSelection=this.userConfiguration.showClientID(),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.loggedUserName=this.getLoggedUser.attributes["custom:username"],this.user_companyID=this.getLoggedUser.attributes["custom:companyID"],console.log("Location permission array ",this.locationPermissionArray),console.log("Current Client Loged in is",this.SK_clientID),"WIMATE_ADMIN"==this.SK_clientID?(this.adminLogin=!0,this.locationAdmin=!0):this.locationAdmin="All"==this.getLoggedUser.attributes["custom:permission_id"],this.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),this.auditTrialServices.audit_trail("2.1","User","Page Load","User Page Loaded","1"),this.addFromService(),this.initializeUserFields(),console.log("Location Admin is here ",this.locationAdmin),this.data_temp=this.userConfiguration.getClientAllDatas(),this.clientID=this.getLoggedUser.attributes["custom:clientID"]+"#user",this.getTreeData(),this.loading(),this.fetchTMData(1),this.fetchDataConfig(1)}loading(){$("#datatables").DataTable().destroy(),this.dataform=[],this.lookup_data_user=[],this.fetchTMLookupData(1)}fetchTMLookupData(t){var l=this;return(0,D.Z)(function*(){console.log("Iam called Bro");try{const i=yield l.api.GetLookupMasterTable(l.clientID,t);if(i&&i.items)if("string"==typeof i.items){let o=JSON.parse(i.items);if(console.log("d1 =",o),Array.isArray(o)){for(let s=0;s<o.length;s++){const d=o[s];if(null==d)break;{const c=Object.keys(d)[0],{P1:p,P2:g,P3:_,P4:m,P5:h,P6:b,P7:w,P8:y,P9:f,P10:I,P11:T}=d[c];l.lookup_data_user.push({P1:p,P2:g,P3:_,P4:m,P5:h,P6:b,P7:w,P8:y,P9:f,P10:I,P11:T})}}l.lookup_data_user.sort((s,d)=>d.P8-s.P8),console.log("Lookup sorting",l.lookup_data_user),yield l.fetchTMLookupData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Permissions to be displayed",l.lookup_data_user),l.getTableUser(l.lookup_data_user),l.auditTrialServices.audit_trail("2.1","User","View","User Table was viewed","1")}catch(i){console.error("Error:",i)}})()}updateBinaryCode(){console.log("Iam called here :");const t=[this.createUserField.get("bit7")?.value||!1,this.createUserField.get("bit6")?.value||!1,this.createUserField.get("bit5")?.value||!1,this.createUserField.get("bit4")?.value||!1,this.createUserField.get("bit3")?.value||!1,this.createUserField.get("bit2")?.value||!1,this.createUserField.get("bit1")?.value||!1,this.createUserField.get("bit0")?.value||!1];this.binaryCode=t.map(l=>l?"1":"0").reverse().join("")}getTreeData(){this.locationPermissionService.fetchGlobalLocationTree().then(t=>{if(!t)throw C().fire({title:"Tree is not Defined"}),new Error("No data returned");this.temp=t,0!=this.temp.length&&(this.locationPermissionArray=[]);for(let l=0;l<this.temp.length;l++)"location"==this.temp[l].node_type?(0==l&&this.locationPermissionArray.push({text:"All",value:"All"}),this.locationPermissionArray.push({text:this.temp[l].text,value:this.temp[l].text}),this.startNode.push(this.temp[l].text),this.defaultlocation.push(this.temp[l].text+"-"+this.temp[l].node_type)):"device"==this.temp[l].node_type&&(this.startNode.push(this.temp[l].text+"-"+this.temp[l].node_type),this.defaultlocation.push(this.temp[l].text+"-"+this.temp[l].node_type));console.log("Data given to the array Location Array Permission",this.locationPermissionArray),this.ref.detectChanges(),console.log("Data from location:",t),this.temp&&this.temp.length>0&&this.createJSTree(this.temp)})}initializeUserFields(){this.createUserField=this.fb.group({userID:["",v.kI.required],name:["",v.kI.required],allowOtherClient:[""],allowNewClient:[""],allowOtherCompanyID:[""],allowNewCompanyID:[""],clientID:["",v.kI.required],disabled_CLientID:[this.SK_clientID],companyID:["",v.kI.required],username:["",v.kI.required],description:["",v.kI.required],mobile:["",v.kI.compose([v.kI.required])],mobile_privacy:["",v.kI.required],key:[""],location_object:[null],default_module:[""],alert_email:["",v.kI.required],alert_sms:["",v.kI.required],alert_telegram:["",v.kI.required],escalation_email:["",v.kI.required],escalation_sms:["",v.kI.required],escalation_telegram:["",v.kI.required],email:["",v.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")],telegramID:["",v.kI.required],location_permission:["",v.kI.required],device_type_permission:[[""],v.kI.required],device_permission:[[""],v.kI.required],default_dev:[""],default_loc:[""],default_type:["",v.kI.required],start_node:["",v.kI.required],alert_levels:["",v.kI.required],permission_ID:["",v.kI.required],report_to:["",v.kI.required],enable_user:[""],disable_user:[""],cognito_update:["",v.kI.required],profile_picture:[""],health_check:[""],device_timeout:[""],alert_timeout:[""],disabled_companyid:[!1],bit7:[!1],bit6:[!1],bit5:[!1],bit4:[!1],bit3:[!1],bit2:[!1],bit1:[!1],bit0:[!1]})}fetchDataConfig(t){var l=this;return(0,D.Z)(function*(){console.log("iam trying to fetch",l.SK_clientID);try{const i=yield l.api.GetLookupMasterTable(l.SK_clientID+"#device",t);if(i&&i.items)if("string"==typeof i.items){let o=JSON.parse(i.items);if(console.log("d1 =",o),Array.isArray(o)){for(let s=0;s<o.length;s++){const d=o[s];if(null==d)break;{const c=Object.keys(d)[0],{P1:p,P2:g,P3:_,P4:m,P5:h}=d[c];l.lookup_data.push({P1:p,P2:g,P3:_,P4:m,P5:h})}}l.lookup_data.sort((s,d)=>d.P5-s.P5),console.log("Lookup sorting Device",l.lookup_data),yield l.fetchDataConfig(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log("Iam executing"),console.log("Data to be displayed",l.lookup_data),l.lookup_data.unshift({text:"None",value:"None"});for(let o=0;o<l.lookup_data.length;o++)0==o&&l.deviceListWorkAround.push({text:"All",value:"All"}),0!==o&&l.deviceListWorkAround.push({text:l.lookup_data[o].P2,value:l.lookup_data[o].P2}),console.log("Device List given to the drop down",l.deviceListWorkAround)}}catch(i){console.error("Error:",i)}})()}fetchTMData(t){var l=this;return(0,D.Z)(function*(){console.log("iam trying to fetch",l.SK_clientID);try{const i=yield l.api.GetLookupMasterTable(l.SK_clientID+"#rdt",t);if(i&&i.items)if("string"==typeof i.items){let o=JSON.parse(i.items);if(console.log("d1 =",o),Array.isArray(o)){for(let s=0;s<o.length;s++){const d=o[s];if(null==d)break;{const c=Object.keys(d)[0],{P1:p,P2:g,P3:_,P4:m}=d[c];l.lookup_data_temp1.push({P1:p,P2:g,P3:_,P4:m})}}l.lookup_data_temp1.sort((s,d)=>d.P4-s.P4),console.log("Lookup sorting",l.lookup_data_temp1),yield l.fetchTMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{if(console.log("All RDTS",l.lookup_data_temp1),0==l.lookup_data_temp1.length)l.rdtListWorkAround.push({text:"All",value:"All"});else for(let o=0;o<l.lookup_data_temp1.length;o++)0==o&&l.rdtListWorkAround.push({text:"All",value:"All"}),l.rdtListWorkAround.push({text:l.lookup_data_temp1[o].P2,value:l.lookup_data_temp1[o].P1});console.log("Data given to the list ",l.rdtListWorkAround),l.ref.detectChanges()}}catch(i){console.error("Error:",i)}})()}openModal(t,l){this.cloneUserOperation=!1,this.currentUserSelected={},this.privacyVisibility=!0,this.switchBetweenDropdown_textField=!1,this.disabled_CLientID_textField=!0,this.multiDefaultdevice=[],this.multiselectLocation=[],this.multiselectDevice_dev=[],this.dataUser=t;try{$("#SimpleJSTree").jstree(!0).deselect_all()}catch{console.log("Tree is not defined here ")}if(this.editOperation=!1,this.multiselectDeviceType_permission=[],this.multiselectDevice_permission=[],this.multiselectDevice_dev=[],"edit"==l||""==l){let i="";if(""==t)this.idSelected="",this.showHeading=!0,this.showModal=!1,this.ref.detectChanges(),this.errorForUniqueID="",this.errorForUniqueEmail="",this.errorForInvalidName="",this.errorForInvalidEmail="",this.errorForUniqueUserID="",this.errorForUniqueMobileID="",this.showMobileNumber=t.mobile,this.switchBetweenDropdown_textField=!1,this.disabled_CLientID_textField=!0,this.switchBetweenDropdown_company_id=!1,this.disabled_companyID_textField=!0,this.base64textString_temp=i,this.createUserField.get("userID")?.enable(),this.createUserField=this.fb.group({userID:t.userID,name:t.name,key:t.key,clientID:this.SK_clientID,disabled_CLientID:this.SK_clientID,disabled_companyid:this.showDisabledCompanyID,allowOtherClient:[{value:t.allowOtherClient,disabled:!this.adminLogin}],allowNewClient:[{value:t.allowNewClient,disabled:!this.adminLogin}],allowOtherCompanyID:t.allowOtherCompanyID,allowNewCompanyID:t.allowNewCompanyID,companyID:this.user_companyID,username:t.username,description:t.description,mobile:t.mobile,mobile_privacy:t.mobile_privacy,location_object:t.location_object,default_module:t.default_module,alert_email:t.alert_email,alert_sms:t.alert_sms,alert_telegram:t.alert_telegram,escalation_email:t.escalation_email,escalation_sms:t.escalation_sms,escalation_telegram:t.escalation_telegram,email:t.email,telegramID:t.telegramID,location_permission:t.location_permission,device_type_permission:t.device_type_permission,device_permission:t.device_permission,default_dev:t.default_dev,default_loc:t.default_loc,default_type:t.default_type,start_node:t.start_node,alert_levels:t.alert_levels,permission_ID:t.permission_ID,report_to:t.report_to,enable_user:!0,disable_user:t.disable_user,cognito_update:t.cognito_update,profile_picture:t.profile,health_check:t.health_check,device_timeout:t.device_timeout,alert_timeout:t.alert_timeout,bit0:[!0],bit1:[!0],bit2:[!0],bit3:[!0],bit4:[!0],bit5:[!0],bit6:[!0],bit7:[!0]}),this.showDisabledClientID=this.createUserField.get("disabled_CLientID")?.setValue(this.SK_clientID,{emitEvent:!1}),this.createUserField.get("disabled_CLientID")?.disable({emitEvent:!1}),this.showDisabledCompanyID=this.createUserField.get("disabled_companyid")?.setValue(this.user_companyID,{emitEvent:!1}),this.createUserField.get("disabled_companyid")?.disable({emitEvent:!1});else if(t){if(this.currentUserSelected=JSON.parse(JSON.stringify(t)),null!=JSON.parse(t.others)){console.log(JSON.parse(t.others));let o=JSON.parse(t.others)[0].accessPermission;console.log("Actual Data :",o);let s=o.split("");this.finalBinary=s.map(d=>"1"==d)}else this.finalBinary=null;console.log("edit of user",t),this.showHeading=!1,this.showModal=!0,this.base64textString_temp=t.profile,this.errorForUniqueID="",this.errorForUniqueEmail="",this.errorForInvalidName="",this.errorForInvalidEmail="",this.errorForUniqueUserID="",this.errorForUniqueMobileID="",this.showMobileNumber=t.mobile,this.createUserField.get("userID")?.disable(),this.switchInputs(t.allowOtherClient),this.editOperation=!0;for(let o=0;o<this.allPermissions_user.length;o++){if("User - Update"===this.allPermissions_user[o]){this.hideUpdateButton=!1;break}"User - View"===this.allPermissions_user[o]&&(this.hideUpdateButton=!0)}this.createUserField=this.fb.group(null!=this.finalBinary?{userID:t.userID,name:{value:t.name,disabled:this.editOperation},clientID:t.clientID,disabled_CLientID:[{value:t.clientID,disabled:!0}],disabled_companyid:[{value:t.companyID,disabled:!this.locationAdmin}],key:t.key,allowOtherClient:[{value:t.allowOtherClient,disabled:!this.adminLogin}],allowNewClient:[{value:t.allowNewClient,disabled:!this.adminLogin}],allowOtherCompanyID:t.allowOtherCompanyID,allowNewCompanyID:t.allowNewCompanyID,companyID:t.companyID,username:{value:t.username,disabled:this.editOperation},description:t.description,mobile:t.testMobile,mobile_privacy:t.mobile_privacy,alert_email:t.alert_email,alert_sms:t.alert_sms,alert_telegram:t.alert_telegram,escalation_email:t.escalation_email,escalation_sms:t.escalation_sms,escalation_telegram:t.escalation_telegram,location_object:t.location_object,default_module:t.default_module,email:{value:t.email,disabled:this.editOperation},telegramID:t.telegramID,location_permission:[t.location_permission],device_type_permission:[t.device_type_permission],device_permission:[t.device_permission],default_loc:t.default_loc,default_dev:t.default_dev,default_type:t.default_type,start_node:t.start_node,alert_levels:t.alert_levels,permission_ID:t.permission_ID,report_to:t.report_to,enable_user:t.enable_user,disable_user:t.disable_user,cognito_update:t.cognito_update,profile_picture:t.profile,health_check:t.health_check,device_timeout:t.device_timeout,alert_timeout:t.alert_timeout,bit0:[this.finalBinary[0]],bit1:[this.finalBinary[1]],bit2:[this.finalBinary[2]],bit3:[this.finalBinary[3]],bit4:[this.finalBinary[4]],bit5:[this.finalBinary[5]],bit6:[this.finalBinary[6]],bit7:[this.finalBinary[7]]}:{userID:t.userID,name:t.name,clientID:t.clientID,disabled_CLientID:this.showDisabledClientID,disabled_companyid:t.companyID,key:t.key,allowOtherClient:t.allowOtherClient,allowNewClient:t.allowNewClient,allowOtherCompanyID:t.allowOtherCompanyID,allowNewCompanyID:t.allowNewCompanyID,companyID:t.companyID,username:t.username,description:t.description,mobile:t.testMobile,mobile_privacy:t.mobile_privacy,alert_email:t.alert_email,alert_sms:t.alert_sms,alert_telegram:t.alert_telegram,escalation_email:t.escalation_email,escalation_sms:t.escalation_sms,escalation_telegram:t.escalation_telegram,location_object:t.location_object,default_module:t.default_module,email:t.email,telegramID:t.telegramID,location_permission:[t.location_permission],device_type_permission:[t.device_type_permission],device_permission:[t.device_permission],default_loc:t.default_loc,default_dev:t.default_dev,default_type:t.default_type,start_node:t.start_node,alert_levels:t.alert_levels,permission_ID:t.permission_ID,report_to:t.report_to,enable_user:t.enable_user,disable_user:t.disable_user,cognito_update:t.cognito_update,profile_picture:t.profile,health_check:t.health_check,device_timeout:t.device_timeout,alert_timeout:t.alert_timeout,bit0:[!1],bit1:[!1],bit2:[!1],bit3:[!1],bit4:[!1],bit5:[!1],bit6:[!1],bit7:[!1]}),this.privacyVisibility="Invisible"!=t.mobile_privacy,""!=t&&this.createUserField.controls.device_type_permission.setValue(t.device_type_permission.map(o=>this.rdtListWorkAround.find(s=>s.value===o))),console.log("Final thing on openModal :",this.createUserField.value),this.idSelected=t.location_object&&JSON.parse(t.location_object).id?JSON.parse(t.location_object).id.split("#")[0]:"",console.log("ID selected is ",this.idSelected),console.log("Location Show modal is here ",this.showModal),this.auditTrialServices.audit_trail("2.1","User","View",`${t.username} User was viewed`,"1"),this.ref.detectChanges()}}}switchInputs(t){t&&null!==t&&t.target&&1==t.target.checked?(this.switchBetweenDropdown_textField=!0,this.disabled_CLientID_textField=!1):t&&null!==t&&t.target&&0==t.target.checked?(this.switchBetweenDropdown_textField=!1,this.disabled_CLientID_textField=!0):(this.switchBetweenDropdown_textField=!0,this.disabled_CLientID_textField=!1,this.showDisabledClientID=this.createUserField.get("disabled_CLientID")?.setValue(this.SK_clientID,{emitEvent:!1}),this.createUserField.get("disabled_CLientID")?.disable({emitEvent:!1}))}switchCompanyID(t){console.log("Iam triggered in seitch :"),t&&null!==t&&t.target&&1==t.target.checked?(this.switchBetweenDropdown_company_id=!0,this.disabled_companyID_textField=!1):t&&null!==t&&t.target&&0==t.target.checked?(this.switchBetweenDropdown_company_id=!1,this.disabled_companyID_textField=!0):(this.switchBetweenDropdown_company_id=!0,this.disabled_companyID_textField=!1,this.showDisabledCompanyID=this.createUserField.get("disabled_companyid")?.setValue(this.user_companyID,{emitEvent:!1}),this.createUserField.get("disabled_companyid")?.disable({emitEvent:!1}))}onFileChange(t){console.log("image",t),this.base64textString_temp=t;let l=t.target.files,i=l[0],o=i.type;if("image/gif"==o||"image/png"==o||"image/bmp"==o||"image/jpeg"==o||"image/jpg"==o){if(l&&i){let s=new FileReader;s.onload=this.handleKBconversion.bind(this),s.readAsBinaryString(i)}}else C().fire({customClass:{container:"swal2-container"},position:"center",text:"Image type should be only of GIF, PNG, JPG, JPEG and BMP",icon:"warning",showCancelButton:!0,allowOutsideClick:!1})}onMobileInput(t){const l=t.target.value;t.target.value=l.replace(/[^0-9]/g,""),this.errorForUniqueMobileID=l.length>0&&10!==l.length?"Enter a valid mobile number with exactly 10 digits":""}onCloneUser(){var t=this;return(0,D.Z)(function*(){t.cloneUserOperation=!0,t.createUserField.get("username")?.reset(),t.createUserField.get("username")?.enable(),t.createUserField.get("name")?.reset(),t.createUserField.get("name")?.enable(),t.createUserField.get("userID")?.reset(),t.createUserField.get("email")?.reset(),t.createUserField.get("email")?.enable(),t.createUserField.get("mobile")?.reset(),console.log("this.currentUserSelected ",t.currentUserSelected),t.multiselectDeviceType_permission=t.currentUserSelected.device_type_permission,t.multiselectDevice_permission=t.currentUserSelected.device_permission,t.multiselectLocation=t.currentUserSelected.location_permission,t.editOperation=!1,t.showModal=!1,C().fire({toast:!0,position:"center",icon:"success",title:"User Configuration Cloned Successfully",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})})()}checkName_asPassword(t){console.log("getPassword",t),this.errorForInvalidName="",!1===/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[A-Za-z0-9_]).{8,}$/.test(t.target.value)&&(this.errorForInvalidName="Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 8 of length")}checkMail(t){console.log("event",t),this.errorForInvalidEmail="",0==/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i.test(t.target.value)&&(this.errorForInvalidEmail="Invalid Email Address")}checkUniqueIdentifier(t){console.log("getID",t),this.errorForUniqueID="",1==t.target.value.includes(" ")&&(this.errorForUniqueID="Space not allowed");for(let l=0;l<this.listofSK.length;l++)this.dataUser.username==t.target.value&&this.editOperation||t.target.value.toLowerCase()==this.listofSK[l].toLowerCase()&&(this.errorForUniqueID="User Name already exists")}checkUniqueEmail(t){console.log("getMail",t),this.errorForUniqueEmail="";for(let l=0;l<this.listofEmails.length;l++)t.target.value==this.listofEmails[l]&&(this.errorForUniqueEmail="Email already exists")}checkUniqueUserID(t){this.errorForUniqueUserID="";for(let l=0;l<this.listofUserID.length;l++)this.dataUser.userID==t.target.value&&this.editOperation||t.target.value==this.listofUserID[l]&&(this.errorForUniqueUserID="User ID already exists")}generateToken(t,l){const s=j.AES.encrypt(`${t}:${l}`,"wimate_trust").toString();return console.log("My_key",s),s}decryptData(t,l){try{return j.AES.decrypt(t,l).toString(j.enc.Utf8)}catch(i){return console.error("Error during decryption",i),""}}handleKBconversion(t){this.base64textString=btoa(t.target.result),this.base64textString_temp="data:"+this.base64textString_temp.target.files[0].type+";base64,"+this.base64textString;let c=1;"="==this.base64textString[this.base64textString.length-1]&&"="==this.base64textString[this.base64textString.length-2]&&(c=2);let p=this.base64textString.length*(3/4)-c;if(p/=1e3,!(p<400))return C().fire({customClass:{container:"swal2-container"},position:"center",text:"Image should be less than 400KB",icon:"warning",showCancelButton:!0,allowOutsideClick:!1});this.cd.detectChanges()}addFromService(){this.lookupdatapermission=[],this.columnDatatable=[],this.lookup_data_company=[],this.columnTableData=[],this.columnDatatable=[{data:"userid"},{data:"username"},{data:"description"},{data:"mobile"},{data:"email"},{data:"add_updateTime"}],this.columnTableData=[{data:"user_name"},{data:"Email"},{data:"PermissionID"},{data:"Location_Permission"},{data:"Device_Type_Permission"},{data:"Device_Permission"},{data:"updatedTime"}],this.checkPermission(),this.userConfiguration.getUserConfiguration(this.SK_clientID).then(t=>{if(t&&void 0!==t){this.data_temp=t,this.listofSK=[],this.listofReportingUsers=[],this.listofEmails=[],this.listofUserID=[];for(let l=0;l<t.length;l++)this.listofSK.push(t[l]?.PK),this.listofReportingUsers.push(t[l]?.username),this.listofEmails.push(t[l]?.email),this.listofUserID.push(t[l]?.userID);console.log("resultresultresult",t)}(null==t||null==t)&&(this.data_temp=t)}).catch(t=>{console.log("cant fetch",t)}),this.getPermissionID(1),this.lookup_data_company=[],this.getCompany(1),this.getClientID(),this.getRDT(),this.getDevices(),this.listAllCognitoUsers()}listAllCognitoUsers(){var t=this;return(0,D.Z)(function*(){let l;const i={type:"cognitoServices",event:{path:"/listAllUsers",queryStringParameters:{},clientID:t.SK_clientID}};try{t.listofSK=[],t.listofEmails=[],t.listofUserID=[];const o=yield t.DynamicApi.getData(i);console.log("Response is here ",JSON.parse(o.body)),l=JSON.parse(o.body).users.map(s=>({username:s.username,email:s.attributes.email,userID:s.attributes["custom:userID"]})).filter(s=>null!==s),console.log("All the cognito users list is here ",l),t.listofSK=l.map(s=>s.username),t.listofEmails=l.map(s=>s.email),t.listofUserID=l.map(s=>s.userID)}catch(o){console.error("Error calling dynamic lambda:",o)}})()}checkPermission(){let t=!1,l=!1;for(let i=0;i<this.allPermissions_user.length;i++)"User - Update"===this.allPermissions_user[i]?t=!0:"User - View"===this.allPermissions_user[i]&&(l=!0);t&&l||t?this.hideDeleteButton=!0:l?this.hideDeleteButton=!1:this.router.navigate(["/404"])}getPermissionID(t){var l=this;return(0,D.Z)(function*(){console.log("iam trying to fetch",l.clientID);try{const i=yield l.api.GetLookupMasterTable(l.SK_clientID+"#permission",t);if(i&&i.items)if("string"==typeof i.items){let o=JSON.parse(i.items);if(console.log("d1 =",o),Array.isArray(o)){for(let s=0;s<o.length;s++){const d=o[s];if(null==d)break;{const c=Object.keys(d)[0],{P1:p,P2:g,P3:_,P4:m}=d[c];l.lookupdatapermission.push({P1:p,P2:g,P3:_,P4:m})}}l.lookupdatapermission.sort((s,d)=>d.P4-s.P4),console.log("Lookup sorting",l.lookupdatapermission),yield l.getPermissionID(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",l.lookupdatapermission),l.listofPermissionIDs=[];for(let o=0;o<=l.lookupdatapermission.length;o++)0===o?l.listofPermissionIDs.push("All"):0!==o&&l.listofPermissionIDs.push(l.lookupdatapermission[o-1]?.P1)}}catch(i){console.error("Error:",i)}})()}getCompany(t){var l=this;return(0,D.Z)(function*(){console.log("Iam called Bro");try{const i=yield l.api.GetLookupMasterTable(l.SK_clientID+"#company",t);if(i&&i.items)if("string"==typeof i.items){let o=JSON.parse(i.items);if(console.log("d1 =",o),Array.isArray(o)){for(let s=0;s<o.length;s++){const d=o[s];if(null==d)break;{const c=Object.keys(d)[0],{P1:p,P2:g,P3:_}=d[c];l.lookup_data_company.push({P1:p,P2:g,P3:_})}}l.lookup_data_company.sort((s,d)=>d.P3-s.P3),console.log("Lookup sorting",l.lookup_data_company),yield l.getCompany(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Comapny to be displayed to be displayed",l.lookup_data_company),l.listofCompanyIDs=[];for(let o=0;o<l.lookup_data_company.length;o++)l.listofCompanyIDs.push(l.lookup_data_company[o]?.P1);l.listofCompanyIDs=Array.from(new Set(l.listofCompanyIDs))}}catch(i){console.error("Error:",i)}l.ref.detectChanges()})()}getClientID(){var t=this;return(0,D.Z)(function*(){try{let l,o=[];do{const s=yield t.api.ListLookupMasterTables({PK:{contains:"#client"}},500,l);if(s&&s.items)for(const d of s.items)yield t.filterListOfClients(d);o=[...o,...t.lookup_client],l=s.nextToken}while(l);console.log("All the clients data is here ",o),t.listofClientIDs=Array.from(new Set(o.map(s=>s.P1))).sort(),console.log("Unique client IDs: ",t.listofClientIDs)}catch(l){console.log("Error fetching all the clients ",l)}})()}filterListOfClients(t){var l=this;return(0,D.Z)(function*(){if(t&&t.items)if("string"==typeof t.items){let i=JSON.parse(t.items);if(console.log("d1 =",i),Array.isArray(i)){for(let o=0;o<i.length;o++){const s=i[o];if(null==s)break;{const d=Object.keys(s)[0],{P1:c,P2:p,P3:g,P4:_,P5:m,P6:h}=s[d];l.lookup_client.push({P1:c,P2:p,P3:g,P4:_,P5:m,P6:h})}}l.lookup_client.sort((o,s)=>s.P5-o.P5),console.log("Lookup sorting",l.lookup_client)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Lookup to be displayed",l.lookup_client)})()}catch(t){console.error("Error:",t)}onDeviceTypeSelect(t){this.multiselectDeviceType_permission.push(t.value.split("-")[0])}onDeviceDefaukt(t){this.multiDefaultdevice.push(t.value.split("-")[0])}onLocationSelect(t){this.multiselectLocation.push(t.value)}onDeviceType(t){this.multiselectDevice_dev.push(t.value)}onSelectAll(t){for(let l=0;l<t.length;l++)this.allDeviceTypeValues.push(t[l].value)}onDeviceSelect(t){this.multiselectDevice_permission.push(t.value.split("-")[0])}onSelectAllDevices(t){for(let l=0;l<t.length;l++)this.allDeviceValues.push(t[l].value)}getRDT(){this.getReadingDeviceType.getSpecificRDT(this.SK_clientID).then(t=>{if(t){console.log(" RDT result",t),this.data_temp=t,this.listofRDT=[];for(let l=0;l<t.length;l++)this.listofRDT.push({text:t[l]?.PK,value:t[l]?.PK})}}).catch(t=>{console.log("cant fetch",t)})}getDevices(){this.devicesList.getSpecificConfiguration(this.SK_clientID).then(t=>{if(t){this.data_temp=t,this.listofdevices=[];for(let l=0;l<t.length;l++)this.listofdevices.push({text:t[l]?.PK,value:t[l]?.PK})}}).catch(t=>{console.log("cant fetch",t)})}createNewUser(t,l){var i=this;return(0,D.Z)(function*(){const o=[{accessPermission:i.binaryCode}];console.log("Access Permission ",o);let s=i.generateToken(i.createUserField.value.username,i.createUserField.value.clientID);if(console.log("USER GENERTED ENCRIPTED KEY",s),console.log("clientID",i.createUserField.value.clientID),"update"==l){i.allUserDetails={PK:i.createUserField.get("username"),SK:i.createUserField.value.clientID,userID:i.createUserField.value.userID,name:i.createUserField.get("name"),key:s,allowOtherClient:i.createUserField.value.allowOtherClient,allowNewClient:i.createUserField.value.allowNewClient,allowOtherCompanyID:i.createUserField.value.allowOtherCompanyID,allowNewCompanyID:i.createUserField.value.allowNewCompanyID,clientID:i.createUserField.value.clientID,companyID:i.createUserField.value.companyID,username:i.createUserField.get("username"),description:i.createUserField.value.description,mobile:i.createUserField.value.mobile,mobile_privacy:i.createUserField.value.mobile_privacy,location_object:i.createUserField.value.location_object,alert_email:null!=i.createUserField.value.alert_email&&i.createUserField.value.alert_email,alert_sms:null!=i.createUserField.value.alert_sms&&i.createUserField.value.alert_sms,alert_telegram:null!=i.createUserField.value.alert_telegram&&i.createUserField.value.alert_telegram,escalation_email:null!=i.createUserField.value.escalation_email&&i.createUserField.value.escalation_email,escalation_sms:null!=i.createUserField.value.escalation_sms&&i.createUserField.value.escalation_sms,escalation_telegram:null!=i.createUserField.value.escalation_telegram&&i.createUserField.value.escalation_telegram,email:i.createUserField.get("email"),telegramID:i.createUserField.value.telegramID,location_permission:i.multiselectLocation,device_type_permission:i.multiselectDeviceType_permission,device_permission:i.multiselectDevice_permission,default_dev:i.multiDefaultdevice,default_loc:i.createUserField.value.default_loc,default_type:i.createUserField.value.default_type,start_node:i.createUserField.value.start_node,alert_levels:i.createUserField.value.alert_levels,permission_ID:i.createUserField.value.permission_ID,report_to:i.createUserField.value.report_to,enable_user:!0,disable_user:null!=i.createUserField.value.disable_user&&i.createUserField.value.disable_user,health_check:null!=i.createUserField.value.health_check&&i.createUserField.value.health_check,device_timeout:null!=i.createUserField.value.device_timeout&&i.createUserField.value.device_timeout,alert_timeout:null!=i.createUserField.value.alert_timeout&&i.createUserField.value.alert_timeout,profile_picture:i.base64textString_temp,cognito_update:null!=i.createUserField.value.cognito_update&&i.createUserField.value.cognito_update,others:JSON.stringify(o),updated:new Date},i.allDeviceTypeValues.length>0&&(i.allUserDetails.device_type_permission=i.allDeviceTypeValues),i.allDeviceValues.length>0&&(i.allUserDetails.device_permission=i.allDeviceValues),console.log("this.allUserDetails update_delete :",i.createUserField.value);let d=i.allUserDetails.device_permission,c="";const p=new Set;d=d.filter(y=>{const f=p.has(y.value);return p.add(y.value),!f}),c=d?1===d.length?d[0]:d.length>1?d[0]+"...("+d.length+")":"...(0)":"...(0)";let g=i.allUserDetails.location_permission,_="";_=g?1===g.length?g[0]:g.length>1?g[0]+"...("+g.length+")":"...(0)":"...(0)";let m="",h=i.allUserDetails.device_type_permission.map(y=>{let f=i.rdtListWorkAround.find(I=>I.value===y);return f?f.text:null}).filter(y=>null!==y);m=h?1===h.length?h[0]:h.length>1?h[0]+"...("+h.length+")":"...(0)":"...(0)";const b=Math.ceil((new Date).getTime()/1e3),w={P1:i.allUserDetails.PK,P2:i.allUserDetails.mobile,P3:i.allUserDetails.email,P4:i.allUserDetails.permission_ID,P5:_,P6:m,P7:c,P8:b,P9:i.allUserDetails.userID,P10:i.allUserDetails.health_check,P11:i.allUserDetails.device_timeout};i.api.CreateUserManagement(i.allUserDetails).then(function(){var y=(0,D.Z)(function*(f){i.addFromService(),f?(i.DynamicApi.sendData({type:"userVerify",username:i.allUserDetails.PK,name:i.allUserDetails.name,email:i.allUserDetails.email}).subscribe(T=>{console.log("Response from Lambda:",T),i.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},T=>{console.error("Error calling dynamic lambda:",T)}),yield i.createLookUpRdt(w,1,i.allUserDetails.SK+"#user"),yield i.loading(),i.toast.open("User configuration updated successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),i.closeUser.nativeElement.click(),i.updateCognitoAttributes()):C().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Error in adding User Configuration",showCancelButton:!0,allowOutsideClick:!1})});return function(f){return y.apply(this,arguments)}}()).catch(y=>{console.log("err for creation",y),i.toast.open("Error in adding new user Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}if("html"==l){console.log("user fields",i.createUserField);let d="";i.adminLogin&&i.locationAdmin?(console.log("Admin Login Here so Company ID from Dropwdown ",i.createUserField.value.companyID),d=i.createUserField.value.companyID):(console.log("Normal All permission user loged in :",i.createUserField.get("disabled_companyid")?.value),d=i.createUserField.get("disabled_companyid")?.value),i.allUserDetails={PK:i.createUserField.value.username.trim(),SK:i.adminLogin?i.createUserField.value.clientID:i.SK_clientID,key:s,userID:i.createUserField.value.userID,name:i.createUserField.value.name,allowOtherClient:i.createUserField.value.allowOtherClient,allowNewClient:i.createUserField.value.allowNewClient,allowOtherCompanyID:i.createUserField.value.allowOtherCompanyID,allowNewCompanyID:i.createUserField.value.allowNewCompanyID,clientID:i.adminLogin?i.createUserField.value.clientID:i.SK_clientID,companyID:d,username:i.createUserField.value.username.trim(),description:i.createUserField.value.description,mobile:i.createUserField.value.mobile,mobile_privacy:i.createUserField.value.mobile_privacy,alert_email:null!=i.createUserField.value.alert_email&&i.createUserField.value.alert_email,alert_sms:null!=i.createUserField.value.alert_sms&&i.createUserField.value.alert_sms,alert_telegram:null!=i.createUserField.value.alert_telegram&&i.createUserField.value.alert_telegram,escalation_email:null!=i.createUserField.value.escalation_email&&i.createUserField.value.escalation_email,escalation_sms:null!=i.createUserField.value.escalation_sms&&i.createUserField.value.escalation_sms,escalation_telegram:null!=i.createUserField.value.escalation_telegram&&i.createUserField.value.escalation_telegram,email:i.createUserField.value.email,telegramID:i.createUserField.value.telegramID,location_permission:i.multiselectLocation,default_module:i.createUserField.value.default_module,device_type_permission:i.multiselectDeviceType_permission,device_permission:i.multiselectDevice_permission,default_dev:i.multiselectDevice_dev,default_loc:i.createUserField.value.default_loc,default_type:i.createUserField.value.default_type,start_node:i.createUserField.value.start_node,alert_levels:i.createUserField.value.alert_levels,permission_ID:i.createUserField.value.permission_ID,report_to:i.createUserField.value.report_to,enable_user:!0,disable_user:null!=i.createUserField.value.disable_user&&i.createUserField.value.disable_user,health_check:null!=i.createUserField.value.health_check&&i.createUserField.value.health_check,device_timeout:null!=i.createUserField.value.device_timeout&&i.createUserField.value.device_timeout,alert_timeout:null!=i.createUserField.value.alert_timeout&&i.createUserField.value.alert_timeout,profile_picture:i.base64textString_temp,cognito_update:null!=i.createUserField.value.cognito_update&&i.createUserField.value.cognito_update,others:JSON.stringify(o),updated:new Date},i.allDeviceTypeValues.length>0&&(i.allUserDetails.device_type_permission=i.allDeviceTypeValues),i.allDeviceValues.length>0&&(i.allUserDetails.device_permission=i.allDeviceValues),console.log("this.multiselectDeviceType_permission ",i.multiselectDeviceType_permission),console.log("All USer Details :",i.allUserDetails);let c=i.allUserDetails.device_permission,p="";const g=new Set;c=c.filter(f=>{const I=g.has(f.value);return g.add(f.value),!I}),p=c?1===c.length?c[0]:c.length>1?c[0]+"...("+c.length+")":"...(0)":"...(0)";let _=i.allUserDetails.location_permission,m="";m=_?1===_.length?_[0]:_.length>1?_[0]+"...("+_.length+")":"...(0)":"...(0)";let h=i.allUserDetails.device_type_permission,b="";b=h?1===h.length?h[0]:h.length>1?h[0]+"...("+h.length+")":"...(0)":"...(0)";const w=Math.ceil((new Date).getTime()/1e3),y={P1:i.allUserDetails.PK,P2:i.allUserDetails.mobile,P3:i.allUserDetails.email,P4:i.allUserDetails.permission_ID,P5:m,P6:b,P7:p,P8:w,P9:i.allUserDetails.userID,P10:i.allUserDetails.health_check,P11:i.allUserDetails.device_timeout};console.log("newly added user",i.allUserDetails),i.spinner.show(),i.api.CreateUserManagement(i.allUserDetails).then(function(){var f=(0,D.Z)(function*(I){i.auditTrialServices.audit_trail("2.1","User","Create",`${i.allUserDetails.PK} User was created`,"1"),i.addFromService(),I?(i.DynamicApi.sendData({type:"userVerify",username:i.allUserDetails.PK,name:i.allUserDetails.name,email:i.allUserDetails.email}).subscribe(U=>{console.log("Response from Lambda:",U),i.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},U=>{console.error("Error calling dynamic lambda:",U)}),yield i.createLookUpRdt(y,1,i.allUserDetails.SK+"#user"),yield i.loading(),i.spinner.hide(),i.toast.open("New User configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),C().fire({position:"center",icon:"success",title:"User configuration created successfully ",showConfirmButton:!0,timer:2e3,customClass:{container:"swal2-container"}}),i.addtoCognitoTable(i.allUserDetails),i.closeUser.nativeElement.click()):(i.spinner.hide(),C().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Error in adding User Configuration",showCancelButton:!0,allowOutsideClick:!1}))});return function(I){return f.apply(this,arguments)}}()).catch(f=>{i.spinner.hide(),console.log("err for creation",f),i.toast.open("Error in adding new user Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}})()}showUnverifiedUsers(){var t=this;return(0,D.Z)(function*(){let l;t.spinner.show();const i={type:"cognitoServices",event:{path:"/listVerifiedUsers",queryStringParameters:{},clientID:t.SK_clientID}};try{const d=yield t.DynamicApi.getData(i);console.log("Response is here ",JSON.parse(d.body)),l=JSON.parse(d.body).users.map(c=>"true"!==c.attributes.email_verified?{username:c.username,email:c.attributes.email,password:c.attributes["custom:name"]}:null).filter(c=>null!==c),t.spinner.hide()}catch(d){console.error("Error calling dynamic lambda:",d),t.spinner.hide()}const s=t.modalService.open(he,{size:"lg",backdrop:"static",keyboard:!1});s.componentInstance.unverifiedUsers=l,s.componentInstance.username=t.loggedUserName,s.componentInstance.SK_clientID=t.SK_clientID})()}createLookUpRdt(t,l,i){var o=this;return(0,D.Z)(function*(){try{console.log("iam a calleddd dude",t,l);const s=yield o.api.GetLookupMasterTable(i,l);let d=[];if(null!=s&&s.items&&"string"==typeof s.items&&(d=JSON.parse(s.items)),null!=s&&d.length<o.maxlength){let c=[];s.items&&"string"==typeof s.items&&JSON.parse(s.items).forEach(m=>{for(const h in m)Object.prototype.hasOwnProperty.call(m,h)&&c.push(m[h])}),c.unshift(t),c=c.map((_,m)=>({[`L${m+1}`]:_})),console.log("newdata 11111111 :>> ",c);let p={PK:i,SK:s.SK,createdTime:"",updatedTime:"",items:JSON.stringify(c)};const g=yield o.api.UpdateLookupMasterTable(p);console.log("createResponse :>> ",g)}else if(null==s){let c=[];c.push(t),c=c.map((_,m)=>({[`L${m+1}`]:_}));let p={SK:l,PK:i,items:JSON.stringify(c)};console.log(p);const g=yield o.api.CreateLookupMasterTable(p);console.log(g)}else yield o.createLookUpRdt(t,l+1,i)}catch(s){console.log("err :>> ",s)}})()}addtoCognitoTable(t){if(console.log("cogntio table",t),this.createUserField.value){let l={UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"};console.log("poolData after user added to cognito",l),this.userPool=new F.AM(l);let i=[],o={email:this.createUserField.value.email,"custom:userID":this.createUserField.value.userID,"custom:name":this.createUserField.value.name,"custom:clientID":t.clientID,"custom:companyID":t.companyID,"custom:username":this.createUserField.value.username,"custom:description":this.createUserField.value.description,"custom:mobile":JSON.stringify(this.createUserField.value.mobile),"custom:mobile_privacy":this.createUserField.value.mobile_privacy,"custom:user_type":JSON.stringify(this.createUserField.value.user_type),"custom:enable_user":JSON.stringify(null!=this.createUserField.value.enable_user&&this.createUserField.value.enable_user),"custom:disable_user":JSON.stringify(null!=this.createUserField.value.disable_user&&this.createUserField.value.disable_user),"custom:alert_email":JSON.stringify(null!=this.createUserField.value.alert_email&&this.createUserField.value.alert_email),"custom:alert_sms":JSON.stringify(null!=this.createUserField.value.alert_sms&&this.createUserField.value.alert_sms),"custom:alert_telegram":JSON.stringify(null!=this.createUserField.value.alert_telegram&&this.createUserField.value.alert_telegram),"custom:escalation_email":JSON.stringify(null!=this.createUserField.value.escalation_email&&this.createUserField.value.escalation_email),"custom:escalation_sms":JSON.stringify(null!=this.createUserField.value.escalation_sms&&this.createUserField.value.escalation_sms),"custom:escalation_telegram":JSON.stringify(null!=this.createUserField.value.escalation_telegram&&this.createUserField.value.escalation_telegram),"custom:telegramID":JSON.stringify(this.createUserField.value.telegramID),"custom:location_permission":this.multiselectLocation.toString(),"custom:device_type_permi":this.allUserDetails.device_type_permission.toString(),"custom:device_permission":this.multiselectDevice_permission.toString(),"custom:permission_id":t.permission_ID,"custom:defaultdevloc":this.createUserField.value.default_dev_loc,"custom:start_node":this.createUserField.value.start_node,"custom:health_check":JSON.stringify(null!=this.createUserField.value.health_check&&this.createUserField.value.health_check),"custom:device_timeout":JSON.stringify(null!=this.createUserField.value.device_timeout&&this.createUserField.value.device_timeout),"custom:alert_timeout":JSON.stringify(null!=this.createUserField.value.alert_timeout&&this.createUserField.value.alert_timeout)};for(let s in o){let c=new F.KC({Name:s,Value:o[s]});i.push(c)}this.userPool.signUp(this.createUserField.value.username,this.createUserField.value.name,i,[],(s,d)=>{s&&alert(s.message||JSON.stringify(s)),console.log("result after user is added",d)})}else C().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Error in adding to Cognito Configuration",showCancelButton:!0,allowOutsideClick:!1})}getDatatable(t){console.log("inside get datatble",t);let l=[];if(typeof t<"u"){console.log(t);for(let c=0;c<t.length;c++){let g=t[c].alert_email,_=t[c].alert_levels,m=t[c].alert_sms,h=t[c].alert_telegram,b=t[c].clientID,w=t[c].allowOtherClient,y=t[c].allowNewClient,f=t[c].allowOtherCompanyID,I=t[c].allowNewCompanyID,T=t[c].cognito_update,U=t[c].companyID,x=t[c].default_dev,q=t[c].default_loc,S=t[c].default_type,N=t[c].description,M=t[c].device_permission,O=t[c].device_type_permission,k=t[c].disable_user,G=t[c].email,H=t[c].enable_user,W=t[c].escalation_email,X=t[c].escalation_sms,J=t[c].escalation_telegram,V=t[c].location_permission,ee=t[c].mobile,L=t[c].mobile_privacy,te=t[c].name,ie=t[c].permission_ID,le=t[c].health_check,oe=t[c].device_timeout,se=t[c].alert_timeout,E=t[c].report_to,re=t[c].start_node,ae=t[c].telegramID,K=t[c].userID,ne=t[c].user_type,ce=t[c].username,de=t[c].profile_picture,ue=t[c].location_object,Y=t[c].default_module,B=t[c].others,St=new Date(t[c].updated).toLocaleString();if("Visible"==L)this.maskedNumber=t[c].mobile;else{let ve="";for(let be=1;be<t[c].mobile.length;be++)ve+="x";this.maskedNumber=ve+t[c].mobile.slice(6,10)}l.push({userid:K,alert_email:g,alert_levels:_,alert_sms:m,alert_telegram:h,clientID:b,allowOtherClient:w,allowNewClient:y,allowOtherCompanyID:f,allowNewCompanyID:I,cognito_update:T,companyID:U,default_dev:x,default_loc:q,default_type:S,description:N,device_permission:M,device_type_permission:O,disable_user:k,email:G,enable_user:H,escalation_email:W,escalation_sms:X,escalation_telegram:J,location_permission:V,mobile:this.maskedNumber,mobile_privacy:L,name:te,permission_ID:ie,health_check:le,device_timeout:oe,alert_timeout:se,report_to:E,start_node:re,telegramID:ae,userID:K,user_type:ne,username:ce,profile:de,testMobile:ee,add_updateTime:St,location_object:ue,default_module:Y,others:B})}}else l=[];let i="btn btn-sm btn-primary editdelete ",o="btn btn-sm btn-danger editdelete ";$("#user_configuration").off("click"),$("#user_configuration").on("click",".editdelete",function(){try{let c=$(this).closest("tr"),p=s.row(c);this.className==o?d.deleteUser(p.data(),"delete"):this.className==i&&d.openModal(p.data(),"edit")}catch{console.log("Table Error data :")}}),!0===this.hideDeleteButton?this.columnDatatable.push({defaultContent:"<button class='"+i+"' data-bs-target='#userModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></button>"},{defaultContent:"<button class='"+o+"'><i class='fa fa-trash'></i></button>"}):this.columnDatatable.push({defaultContent:"<button class='"+i+"' data-bs-target='#userModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></button>"});let s=$("#user_configuration").DataTable({pagingType:"full_numbers",destroy:!0,lengthChange:!1,responsive:!0,data:l,columns:this.columnDatatable}),d=this}deleteUser(t,l){if(this.userSK=t,console.log("deleteuser is called",t),"delete"==l)this.allUserDetails={PK:this.userSK.user_name,SK:this.SK_clientID},C().fire({position:"center",title:"Are you sure?",text:"You wont get these details back again",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(i=>{i.dismiss!==C().DismissReason.cancel?this.deleteCognito(this.userSK):i.dismiss===C().DismissReason.cancel&&C().fire("Cancelled","User configuration not removed","error")});else if("update_delete"===l){this.allUserDetails={PK:this.userSK.PK,SK:this.SK_clientID};const i=Math.ceil((new Date).getTime()/1e3),o={P1:this.userSK.PK,P8:i};console.log("before deleting user on update_delete :",this.allUserDetails),console.log("Items to be deleted :",o)}}resendVerification(t){var l=this;return(0,D.Z)(function*(){const i={type:"cognitoServices",event:{path:"/resendVerification",queryStringParameters:{email:"dummy@wimate.in"},username:t}};try{const o=yield l.DynamicApi.getData(i);o&&(200==o.statusCode?C().fire({position:"top-right",icon:"success",title:"Verification mail sent successfully ",showConfirmButton:!1,timer:1500}):C().fire({position:"top-right",icon:"error",title:"Error sending mail",showConfirmButton:!1,timer:1500}))}catch(o){console.error("Error calling dynamic lambda:",o)}})()}updateUser(t,l){var i=this;return(0,D.Z)(function*(){try{if(0==(yield i.checkUserConfirmed()))return C().fire({title:"Account Not Confirmed",text:"Please confirm your email before updating.",icon:"warning",position:"center",customClass:{container:"swal2-container"},showCancelButton:!0,confirmButtonText:"Resend Confirmation",cancelButtonText:"Cancel",allowOutsideClick:!1}).then(f=>{f.isConfirmed&&i.resendVerification(i.createUserField.get("username")?.value)});console.log("value",t);let o=[],s=[],d=[];if(t.device_type_permission.length<=0||t.device_permission.length<=0||t.location_permission.length<=0)return C().fire({title:"Fill all the Permission Required Fields"});try{for(let f=0;f<t.device_type_permission.length;f++)o.push(t.device_type_permission&&t.device_type_permission[f].value?t.device_type_permission[f].value.split("-")[0]:t.device_type_permission[f].split("-")[0])}catch(f){console.log("Error populating device_type_permission",f)}for(let f=0;f<t.device_permission.length;f++)s.push(t.device_permission&&t.device_permission[f].value?t.device_permission[f].value.split("-")[0]:t.device_permission[f].split("-")[0]);for(let f=0;f<t.location_permission.length;f++)d.push(t.location_permission&&t.location_permission[f].value?t.location_permission[f].value.split("-")[0]:t.location_permission[f]);let c="";if(i.adminLogin||i.locationAdmin?(console.log("Admin Login Here so Company ID from Dropwdown ",i.createUserField.value.companyID),c=i.createUserField.value.companyID):(console.log("Normal All permission user loged in :",i.createUserField.get("disabled_companyid")?.value),c=i.createUserField.get("disabled_companyid")?.value),"editUser"==l){const f=[{accessPermission:i.binaryCode}];i.allUserDetails={PK:i.createUserField.get("username")?.value,SK:i.adminLogin?i.createUserField.value.clientID:i.SK_clientID,userID:i.createUserField.value.userID,name:i.createUserField.get("name")?.value,clientID:i.adminLogin?i.createUserField.value.clientID:i.SK_clientID,allowOtherClient:i.createUserField.value.allowOtherClient,allowNewClient:i.createUserField.value.allowNewClient,allowOtherCompanyID:i.createUserField.value.allowOtherCompanyID,allowNewCompanyID:i.createUserField.value.allowNewCompanyID,companyID:c,username:i.createUserField.get("username")?.value,description:i.createUserField.value.description,mobile:i.createUserField.value.mobile,mobile_privacy:i.createUserField.value.mobile_privacy,alert_email:null!=i.createUserField.value.alert_email&&i.createUserField.value.alert_email,alert_sms:null!=i.createUserField.value.alert_sms&&i.createUserField.value.alert_sms,alert_telegram:null!=i.createUserField.value.alert_telegram&&i.createUserField.value.alert_telegram,escalation_email:null!=i.createUserField.value.escalation_email&&i.createUserField.value.escalation_email,escalation_sms:null!=i.createUserField.value.escalation_sms&&i.createUserField.value.escalation_sms,escalation_telegram:null!=i.createUserField.value.escalation_telegram&&i.createUserField.value.escalation_telegram,email:i.createUserField.get("email")?.value,telegramID:i.createUserField.value.telegramID,location_permission:d,device_type_permission:o,device_permission:s,default_dev:i.createUserField.value.default_dev,default_loc:i.createUserField.value.default_loc,default_type:i.createUserField.value.default_type,start_node:i.createUserField.value.start_node,alert_levels:i.createUserField.value.alert_levels,permission_ID:i.createUserField.value.permission_ID,report_to:i.createUserField.value.report_to,enable_user:null!=i.createUserField.value.enable_user&&i.createUserField.value.enable_user,disable_user:null!=i.createUserField.value.disable_user&&i.createUserField.value.disable_user,health_check:null!=i.createUserField.value.health_check&&i.createUserField.value.health_check,device_timeout:null!=i.createUserField.value.device_timeout&&i.createUserField.value.device_timeout,alert_timeout:null!=i.createUserField.value.alert_timeout&&i.createUserField.value.alert_timeout,profile_picture:i.base64textString_temp,location_object:i.createUserField.value.location_object,default_module:i.createUserField.value.default_module,others:JSON.stringify(f),updated:new Date}}let p=i.allUserDetails.device_permission,g="";g=p?1===p.length?p[0]:p.length>1?p[0]+"...("+p.length+")":"...(0)":"...(0)";let _=i.allUserDetails.location_permission,m="";m=_?1===_.length?_[0]:_.length>1?_[0]+"...("+_.length+")":"...(0)":"...(0)";let h=i.allUserDetails.device_type_permission.map(f=>{let I=i.rdtListWorkAround.find(T=>T.value===f);return I?I.text:null}).filter(f=>null!==f),b="";b=h?1===h.length?h[0]:h.length>1?h[0]+"...("+h.length+")":"...(0)":"...(0)";const w=Math.ceil((new Date).getTime()/1e3),y={P1:i.allUserDetails.PK,P2:i.allUserDetails.mobile,P3:i.allUserDetails.email,P4:i.allUserDetails.permission_ID,P5:m,P6:b,P7:g,P8:w,P9:i.allUserDetails.userID,P10:i.allUserDetails.health_check,P11:i.allUserDetails.device_timeout};console.log("object :>> ",i.allUserDetails),console.log("Items to be pushed into database :",y),i.api.GetUserManagement(i.allUserDetails.PK,i.SK_clientID).then(f=>{f&&void 0!==f&&(i.data_temp.push(f),console.log("User Manangement details",i.data_temp))}).catch(f=>{console.log("cant fetch",f)}),i.createUserField.value.clientID===i.SK_clientID?(i.spinner.show(),i.api.UpdateUserManagement(i.allUserDetails).then(function(){var f=(0,D.Z)(function*(I){if(I){yield i.fetchTimeMachineById(1,i.allUserDetails.PK,"update",y),i.auditTrialServices.audit_trail("2.1","User","Update",`${i.allUserDetails.PK} User was updated`,"1"),yield i.loading(),1!=i.allUserDetails.enable_user&&(yield i.updateCognitoAttributesV2());let T={};T=1==i.allUserDetails.enable_user?{path:"/enableUser",queryStringParameters:{username:y.P1}}:{path:"/disableUser",queryStringParameters:{username:y.P1}};const U={type:"cognitoServices",event:T};try{const x=yield i.DynamicApi.getData(U);console.log("Response is here ",JSON.parse(x.body))}catch(x){console.error("Error calling dynamic lambda:",x)}i.toast.open("User Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),i.addFromService(),i.closeUser.nativeElement.click(),1==i.allUserDetails.enable_user&&(yield i.updateCognitoAttributesV2()),i.spinner.hide()}else i.spinner.hide(),console.log("Error in updating user Configuration")});return function(I){return f.apply(this,arguments)}}()).catch(f=>{i.spinner.hide(),console.log("error for updating",f)})):console.log("inside else")}catch(o){i.spinner.hide(),console.log("Error updating user ",o)}})()}updateCognitoAttributesV2(){var t=this;return(0,D.Z)(function*(){const l=t.createUserField.get("username")?.value,i=t.createUserField.get("name")?.value,o={Username:l,Password:i},d=new F.AM({UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"}),p=new F.ws({Username:l,Pool:d}),g=new F.sD(o),_={email:t.createUserField.get("email")?.value,"custom:userID":t.createUserField.value.userID,"custom:name":t.createUserField.get("name")?.value,"custom:clientID":t.allUserDetails.clientID,"custom:companyID":t.allUserDetails.companyID,"custom:username":l,"custom:description":t.createUserField.value.description,"custom:mobile":JSON.stringify(t.createUserField.value.mobile),"custom:mobile_privacy":t.createUserField.value.mobile_privacy,"custom:user_type":JSON.stringify(t.createUserField.value.user_type),"custom:enable_user":JSON.stringify(t.createUserField.value.enable_user??!1),"custom:disable_user":JSON.stringify(t.createUserField.value.disable_user??!1),"custom:alert_email":JSON.stringify(t.createUserField.value.alert_email??!1),"custom:alert_sms":JSON.stringify(t.createUserField.value.alert_sms??!1),"custom:alert_telegram":JSON.stringify(t.createUserField.value.alert_telegram??!1),"custom:escalation_email":JSON.stringify(t.createUserField.value.escalation_email??!1),"custom:escalation_sms":JSON.stringify(t.createUserField.value.escalation_sms??!1),"custom:escalation_telegram":JSON.stringify(t.createUserField.value.escalation_telegram??!1),"custom:telegramID":JSON.stringify(t.createUserField.value.telegramID),"custom:location_permission":t.createUserField.value.location_permission.toString(),"custom:device_type_permi":t.allUserDetails.device_type_permission.toString(),"custom:device_permission":t.multiselectDevice_permission.toString(),"custom:permission_id":t.allUserDetails.permission_ID,"custom:defaultdevloc":t.createUserField.value.default_dev_loc,"custom:start_node":t.createUserField.value.start_node,"custom:health_check":JSON.stringify(t.createUserField.value.health_check??!1),"custom:device_timeout":JSON.stringify(t.createUserField.value.device_timeout??!1),"custom:alert_timeout":JSON.stringify(t.createUserField.value.alert_timeout??!1)},m=Object.entries(_).map(([h,b])=>new F.KC({Name:h,Value:b}));try{const h=yield t.authenticateUserAsync(p,g);console.log("Authenticated successfully",h);const b=yield t.updateAttributesAsync(p,m);console.log("Attributes updated successfully",b)}catch(h){console.error("Error during Cognito update:",h)}})()}authenticateUserAsync(t,l){return new Promise((i,o)=>{t.authenticateUser(l,{onSuccess:i,onFailure:o})})}updateAttributesAsync(t,l){return new Promise((i,o)=>{t.updateAttributes(l,(s,d)=>{if(s)return o(s);i(d)})})}fetchTimeMachineById(t,l,i,o){var s=this;return(0,D.Z)(function*(){try{const d=yield s.api.GetLookupMasterTable(s.clientID,t);if(d&&d.items){let c=yield JSON.parse(d.items),p=c.findIndex(g=>g[Object.keys(g)[0]].P1===l);if(-1!==p){if("update"===i){c[p][`L${p+1}`]=o;const _=[];for(let m=0;m<c.length;m++){const h=Object.keys(c[m])[0],b=`L${m+1}`;if(h){const w={[b]:c[m][h]},y=_.findIndex(f=>Object.keys(f)[0]===b);-1!==y?Object.assign(_[y][b],c[m][h]):_.push(w)}else console.error(`Original key not found for renaming in data[${m}].`)}c=_}else"delete"===i&&c.splice(p,1);let g={PK:s.clientID,SK:d.SK,items:JSON.stringify(c)};yield s.api.UpdateLookupMasterTable(g)}else yield new Promise(g=>setTimeout(g,500)),yield s.fetchTimeMachineById(t+1,l,i,o)}else C().fire({position:"top-right",icon:"error",title:`ID ${l} not found`,showConfirmButton:!1,timer:1500})}catch(d){console.error("Error:",d)}})()}checkUserConfirmed(){var t=this;return(0,D.Z)(function*(){const l={Username:t.createUserField.get("username")?.value,Password:t.createUserField.get("name")?.value},o=new F.AM({UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"}),s={Username:t.createUserField.get("username")?.value,Pool:o},d=new F.ws(s),c=new F.sD(l);return new Promise((p,g)=>{d.authenticateUser(c,{onSuccess:_=>{const m=_.getAccessToken().getJwtToken();console.log("Authentication success, token:",m),p(!0)},onFailure:_=>{console.log("Error updating cognito:",_),_&&"User is not confirmed."!=_.message&&p(!0),p(!1)}})})})()}updateCognitoAttributes(){let t={Username:this.createUserField.get("username")?.value,Password:this.createUserField.get("name")?.value},i=new F.AM({UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"}),o={Username:this.createUserField.get("username")?.value,Pool:i},s={email:this.createUserField.get("email")?.value,"custom:userID":this.createUserField.value.userID,"custom:name":this.createUserField.get("name")?.value,"custom:clientID":this.allUserDetails.clientID,"custom:companyID":this.allUserDetails.companyID,"custom:username":this.createUserField.get("username")?.value,"custom:description":this.createUserField.value.description,"custom:mobile":JSON.stringify(this.createUserField.value.mobile),"custom:mobile_privacy":this.createUserField.value.mobile_privacy,"custom:user_type":JSON.stringify(this.createUserField.value.user_type),"custom:enable_user":JSON.stringify(null!=this.createUserField.value.enable_user&&this.createUserField.value.enable_user),"custom:disable_user":JSON.stringify(null!=this.createUserField.value.disable_user&&this.createUserField.value.disable_user),"custom:alert_email":JSON.stringify(null!=this.createUserField.value.alert_email&&this.createUserField.value.alert_email),"custom:alert_sms":JSON.stringify(null!=this.createUserField.value.alert_sms&&this.createUserField.value.alert_sms),"custom:alert_telegram":JSON.stringify(null!=this.createUserField.value.alert_telegram&&this.createUserField.value.alert_telegram),"custom:escalation_email":JSON.stringify(null!=this.createUserField.value.escalation_email&&this.createUserField.value.escalation_email),"custom:escalation_sms":JSON.stringify(null!=this.createUserField.value.escalation_sms&&this.createUserField.value.escalation_sms),"custom:escalation_telegram":JSON.stringify(null!=this.createUserField.value.escalation_telegram&&this.createUserField.value.escalation_telegram),"custom:telegramID":JSON.stringify(this.createUserField.value.telegramID),"custom:location_permission":this.createUserField.value.location_permission.toString(),"custom:device_type_permi":this.allUserDetails.device_type_permission.toString(),"custom:device_permission":this.multiselectDevice_permission.toString(),"custom:permission_id":this.allUserDetails.permission_ID,"custom:defaultdevloc":this.createUserField.value.default_dev_loc,"custom:start_node":this.createUserField.value.start_node,"custom:health_check":JSON.stringify(null!=this.createUserField.value.health_check&&this.createUserField.value.health_check),"custom:device_timeout":JSON.stringify(null!=this.createUserField.value.device_timeout&&this.createUserField.value.device_timeout),"custom:alert_timeout":JSON.stringify(null!=this.createUserField.value.alert_timeout&&this.createUserField.value.alert_timeout)},d=new F.ws(o),c=new F.sD(t);d.authenticateUser(c,{onSuccess:function(p){p.getAccessToken().getJwtToken();let _=[];for(let m in s){let b=new F.KC({Name:m,Value:s[m]});_.push(b)}d.updateAttributes(_,(m,h)=>{m?console.log("\n\nUpdate Error: ",m,"\n\n"):console.log("after updating",h)})},onFailure:function(p){console.log("Error updating cognito ",p)}})}deleteCognito(t){var l=this;console.log("for field",t),this.spinner.show(),this.api.GetUserManagement(t.user_name,this.SK_clientID).then(function(){var i=(0,D.Z)(function*(o){o&&(l.auditTrialServices.audit_trail("2.1","User","Delete",`${t.user_name} User was Deleted`,"1"),yield l.deleteCognitoUser(o))});return function(o){return i.apply(this,arguments)}}()).catch(i=>{console.log("cant fetch",i),this.spinner.hide()})}createJSTree(t){$("#SimpleJSTree").jstree({core:{check_callback:!0,data:t,multiple:!1},search:{show_only_matches:!0},plugins:["contextmenu","dnd","search"],contextmenu:{items:function(i){console.log("selected node",i.selected);let o=$("#SimpleJSTree").jstree(!0);return{Create:{separator_before:!1,separator_after:!0,label:"Add Location",action:!1,submenu:{Child:{seperator_before:!1,seperator_after:!1,label:"Child",action:function(s){i=o.create_node(i,{text:"New Child",type:"file",icon:"glyphicon glyphicon-file"}),o.deselect_all(),o.select_node(i)}},Parent:{seperator_before:!1,seperator_after:!1,label:"Parent",action:function(s){i=o.create_node(i,{text:"New Parent",type:"default"}),o.deselect_all(),o.select_node(i)}}}},Rename:{separator_before:!1,separator_after:!1,label:"Edit Location",action:function(s){o.edit(i)}},Remove:{separator_before:!1,separator_after:!1,label:"Remove Location",action:function(s){o.delete_node(i)}}}}}}).on("changed.jstree",(i,o)=>{console.log("tree change",o),o&&o.node&&o.node.text&&(console.log(o.node),console.log(o.node),this.selectedLocationObject=JSON.stringify(o.node),this.idSelected=o.node.id.split("#")[0],console.log("Tree ID selected is ",this.idSelected),o.node.text&&this.createUserField.get("location_object")?.setValue(this.selectedLocationObject),this.cd.detectChanges())}),$("#search").keyup(()=>{var i=$("#search").val();$("#SimpleJSTree").jstree(!0).search(i)})}treeDrawOpen(){}getTableUser(t){let l="btn btn-sm btn-primary editclassuser ",i="btn btn-sm btn-danger editclassuser ";if(typeof t<"u")for(let d=0;d<t.length;d++)this.dataform.push({user_name:t[d].P1,Email:t[d].P3,PermissionID:t[d].P4,Location_Permission:t[d].P5,Device_Type_Permission:t[d].P6,Device_Permission:t[d].P7,updatedTime:new Date(1e3*t[d].P8).toDateString()+" "+new Date(1e3*t[d].P8).toLocaleTimeString()});else this.dataform=[];let o=[];if(typeof t<"u")for(let d=0;d<t.length;d++)o[d]=new Date(t[d].updatedTime).toLocaleString(),t[d].updatedTime=o[d];else t=[];!0===this.hideDeleteButton?this.columnTableData.push(this.adminLogin||this.locationAdmin?{defaultContent:"<button class='"+l+"' data-bs-target='#userModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></i></button>"}:{defaultContent:"<button class='"+l+"' data-bs-target='#userModal' data-bs-toggle='modal'><i class='fa-solid fa-eye'></i></button>"},{defaultContent:"<button class='"+i+"'><i class='fa fa-trash'></i></button>"}):this.columnTableData.push({defaultContent:"<button class='"+l+"' data-bs-target='#userModal' data-bs-toggle='modal''><i class='fa-solid fa-eye'></i></button>"}),console.log("columnDatatable",this.columnTableData),console.log("dataform",this.dataform),$("#user_lookup_table").off("click"),$("#user_lookup_table").on("click",".editclassuser",function(){let d=$(this).closest("tr"),c=s.deviceTableData.row(d);this.className==i&&s.deleteUser(c.data(),"delete"),this.className==l&&s.openModalHelpher(c.data())}),this.getLookupTableData(this.dataform,this.columnTableData),this.addFromService();let s=this}getLookupTableData(t,l){var i=this;return(0,D.Z)(function*(){console.log("chk1 tm",t),console.log("chk2 tm",l);try{i.deviceTableData&&$.fn.DataTable.isDataTable("#user_lookup_table")&&i.deviceTableData.destroy(),i.deviceTableData=$("#user_lookup_table").DataTable({pagingType:"full_numbers",destroy:!0,lengthChange:!0,responsive:!0,data:t,ordering:!0,order:[[4,"asc"]],columnDefs:[{type:"date",targets:4}],columns:l})}catch(o){console.error("Error initializing DataTable:",o)}})()}openModalHelpher(t){console.log("Data from llokup :",t),this.data_temp=[],this.api.GetUserManagement(t.user_name,this.SK_clientID).then(l=>{if(l&&void 0!==l&&(this.data_temp.push(l),console.log("User Manangement details",this.data_temp),l)){let i=[];if(typeof this.data_temp<"u"){console.log(this.data_temp);for(let o=0;o<this.data_temp.length;o++){let d=this.data_temp[o].alert_email,c=this.data_temp[o].alert_levels,p=this.data_temp[o].alert_sms,g=this.data_temp[o].alert_telegram,_=this.data_temp[o].clientID,m=this.data_temp[o].allowOtherClient,h=this.data_temp[o].allowNewClient,b=this.data_temp[o].allowOtherCompanyID,w=this.data_temp[o].allowNewCompanyID,y=this.data_temp[o].cognito_update,f=this.data_temp[o].companyID,I=this.data_temp[o].default_dev,T=this.data_temp[o].default_loc,U=this.data_temp[o].default_type,x=this.data_temp[o].description,q=this.data_temp[o].device_permission,S=this.data_temp[o].device_type_permission,N=this.data_temp[o].disable_user,M=this.data_temp[o].email,O=this.data_temp[o].enable_user,k=this.data_temp[o].escalation_email,G=this.data_temp[o].escalation_sms,H=this.data_temp[o].escalation_telegram,W=this.data_temp[o].location_permission,X=this.data_temp[o].mobile,J=this.data_temp[o].mobile_privacy,V=this.data_temp[o].name,ee=this.data_temp[o].permission_ID,L=this.data_temp[o].health_check,te=this.data_temp[o].device_timeout,ie=this.data_temp[o].alert_timeout,le=this.data_temp[o].report_to,oe=this.data_temp[o].start_node,se=this.data_temp[o].telegramID,E=this.data_temp[o].userID,re=this.data_temp[o].user_type,ae=this.data_temp[o].username,K=this.data_temp[o].profile_picture,ne=this.data_temp[o].location_object,ce=this.data_temp[o].default_module,de=this.data_temp[o].others,ue=new Date(this.data_temp[o].updated).toLocaleString();if("Visible"==J)this.maskedNumber=this.data_temp[o].mobile;else{let Y="";for(let B=1;B<this.data_temp[o].mobile.length;B++)Y+="x";this.maskedNumber=Y+this.data_temp[o].mobile.slice(6,10)}i.push({userid:E,alert_email:d,alert_levels:c,alert_sms:p,alert_telegram:g,clientID:_,allowOtherClient:m,allowNewClient:h,allowOtherCompanyID:b,allowNewCompanyID:w,cognito_update:y,companyID:f,default_dev:I,default_loc:T,default_type:U,description:x,device_permission:q,device_type_permission:S,disable_user:N,email:M,enable_user:O,escalation_email:k,escalation_sms:G,escalation_telegram:H,location_permission:W,mobile:this.maskedNumber,mobile_privacy:J,name:V,permission_ID:ee,health_check:L,device_timeout:te,alert_timeout:ie,report_to:le,start_node:oe,telegramID:se,userID:E,user_type:re,username:ae,profile:K,testMobile:X,add_updateTime:ue,location_object:ne,default_module:ce,others:de})}}else i=[];console.log("Edited User Will be ,",i);for(let o=0;o<i.length;o++)if(console.log(i[o].username+"=="+t.user_name),i[o].username==t.user_name){console.log("Iam called :"),this.openModal(i[o],"edit");break}}}).catch(l=>{console.log("cant fetch",l)})}checkedBitPermission(t,l,i){const o=t.target;if("parent"===l){const s=o.children[1];if(s&&"checkbox"===s.type){const d=!s.checked;s.checked=d,this.createUserField.get("bit"+i)?.setValue(d),s.dispatchEvent(new Event("change")),console.log(s.checked?"Checkbox is checked.":"Checkbox is not checked.")}}else{const s=o.nextElementSibling;if(s&&"checkbox"===s.type){const d=!s.checked;s.checked=d,this.createUserField.get("bit"+i)?.setValue(d),s.dispatchEvent(new Event("change"))}}}getTextCheck(){return console.log("chec22",this.createUserField),`${this.createUserField.invalid} || ${"User ID already exists"==this.errorForUniqueUserID}|| ${"User Name already exists"==this.errorForUniqueID} || ${"Email already exists"==this.errorForUniqueEmail} || ${"Invalid Email Address"==this.errorForInvalidEmail} ||\n  ${"Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 8 of length"==this.errorForInvalidName} || ${!this.createUserField.dirty} || ${this.createUserField.invalid} \n  check obj ${JSON.stringify(this.createUserField.value,null,2)}`}}return r=u,(0,n.Z)(u,"\u0275fac",function(t){return new(t||r)(e.Y36(v.QS),e.Y36(A.F),e.Y36(A.F),e.Y36(A.F),e.Y36(A.F),e.Y36(A.F),e.Y36(A.F),e.Y36(Pe.t),e.Y36(Q.ux),e.Y36(e.sBO),e.Y36(e.Qsj),e.Y36(pe.F0),e.Y36(Ae.G),e.Y36(e.sBO),e.Y36(_e.y),e.Y36(z.t2),e.Y36(R.FF),e.Y36(fe.C))}),(0,n.Z)(u,"\u0275cmp",e.Xpm({type:r,selectors:[["app-user"]],viewQuery:function(t,l){if(1&t&&(e.Gf(Se,5),e.Gf(he,5)),2&t){let i;e.iGM(i=e.CRH())&&(l.closeUser=i.first),e.iGM(i=e.CRH())&&(l.childComponent=i.first)}},decls:267,vars:55,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],[1,"card","mb-5","mb-xl-8"],[1,"card-header","border-0","pt-5"],[1,"card-title","align-items-start","flex-column"],[1,"card-label","fw-bolder","fs-3","mb-1"],[1,"card-toolbar"],["class","btn btn-sm fw-bold btn-danger me-2",3,"ngbTooltip","click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary","data-bs-toggle","modal","data-bs-target","#userModal",3,"click",4,"ngIf"],[1,"card-body","py-3"],[1,"table-responsive"],["id","user_lookup_table",1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],[4,"ngIf"],["id","userModal","tabindex","-1","aria-labelledby","userModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content",2,"width","1200px","transform","translate(-27%, 0px)"],[1,"modal-header"],["class","modal-title","id","osLabel",4,"ngIf"],["type","button","placement","bottom","class","btn btn-sm btn-warning copy-btn ms-1",3,"disabled","hidden","click",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"fv-row",3,"formGroup"],[1,"card-body","border-top","p-9"],[1,"container"],[1,"row"],[1,"col-lg-4"],[1,"col-lg-12","form-group","image-input","image-input-outline"],["for","imageInput",1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","file","id","imageInput","title","Click to add/update image",1,"form-control","visually-hidden",3,"change"],["for","imageInput",1,"form-control","form-control-lg","form-control-solid",2,"padding-left","115px"],["class","btn btn-icon btn-box image-input-wrapper w-125px h-125px btn-active-color-primary w-25px h-25px bg-body shadow",3,"src",4,"ngIf"],[1,"col-md-4"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","required"],["type","text","placeholder","Enter User Name","name","username","formControlName","username","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],[2,"color","#fc1900"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[1,"col-md-4",3,"ngClass"],["type","text","placeholder","Enter Password","name","name","formControlName","name","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],[1,"col-md-4","form-check","form-switch","d-none"],[1,"col-lg-12"],["formControlName","allowOtherClient","type","checkbox",1,"col-lg-6","form-check-input",3,"change"],[1,"col-lg-12","col-form-label","fw-bold","fs-6",2,"padding-top","0px"],["formControlName","allowNewCompanyID","type","checkbox",1,"col-lg-6","form-check-input",3,"change"],["formControlName","allowNewClient","type","checkbox",1,"col-lg-6","form-check-input"],["formControlName","allowOtherCompanyID","type","checkbox",1,"col-lg-6","form-check-input"],[1,"row","mb-7"],["class","form-select form-select-solid form-select-lg fw-bold","placeholder","select client ID","name","client_ID","formControlName","clientID",4,"ngIf"],["type","text","class","\n                                form-control form-control-lg form-control-solid\n                                mb-3 mb-lg-0\n                              ","name","name","formControlName","disabled_CLientID",4,"ngIf"],["class","form-select form-select-solid form-select-lg fw-bold","placeholder","select company ID","name","company_ID","formControlName","companyID",4,"ngIf"],["type","text","class","\n                                form-control form-control-lg form-control-solid\n                                mb-3 mb-lg-0 \n                              ","name","name","formControlName","disabled_companyid",4,"ngIf"],["class","col-md-4",4,"ngIf"],["type","text","placeholder","Enter User ID","name","userID","formControlName","userID","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],["type","text","placeholder","Enter Description","name","description","formControlName","description","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","Enter mobile number","name","mobile","formControlName","mobile","minlength","10","maxlength","10","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"ngStyle","input"],["placeholder","Enter mobile_privacy","name","mobile_privacy","formControlName","mobile_privacy","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","Visible"],["value","Invisible"],["type","email","placeholder","Enter email","name","email","formControlName","email","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],[1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","number","placeholder","Enter Telegram ID","name","telegramID","formControlName","telegramID",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["class","container",4,"ngIf"],[1,"row","mb-8"],["class","col-md-4","style","display: none;",4,"ngIf"],["type","search","id","search","value","","placeholder","Search For Devices",1,"col-md-12","input",2,"border","px solid silver","margin","2px"],["id","SimpleJSTree",1,"container"],["class","btn btn-sm btn-success fw-bolder ms-2 fs-8 py-1 px-3 ",4,"ngIf"],["type","text","name","location_object","formControlName","location_object",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","select default module","name","default_module","formControlName","default_module",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4",2,"display","none"],["placeholder","select default device","name","default_loc","formControlName","default_loc",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[1,"col-md-4","d-none"],["placeholder","select default device","name","default_type","formControlName","default_type",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","Device"],["value","Location"],["placeholder","select start node","name","start_node","formControlName","start_node",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["placeholder","select alert levels","name","alert_levels","formControlName","alert_levels",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","NONE"],["value","THC DCH2"],["placeholder","select report to","name","report_to","formControlName","report_to",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[1,"form-check","form-check-inline","form-check-solid","me-5"],["name","email","type","checkbox","formControlName","alert_email",1,"form-check-input"],[1,"fw-bold","ps-2","fs-6"],["name","sms","type","checkbox","formControlName","alert_sms",1,"form-check-input"],["name","telegram","type","checkbox","formControlName","alert_telegram",1,"form-check-input"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","mb-3","d-flex","align-items-center"],["placement","top","triggers","hover","container","body",1,"sampTooltip",3,"tooltipClass","ngbTooltip"],[1,"fas","fa-exclamation-circle","ms-2","fs-7","tooltip-icon"],["name","email","type","checkbox","formControlName","escalation_email",1,"form-check-input"],["name","sms","type","checkbox","formControlName","escalation_sms",1,"form-check-input"],["name","telegram","type","checkbox","formControlName","escalation_telegram",1,"form-check-input"],["tooltipContent",""],["name","health_check","type","checkbox","formControlName","health_check",1,"form-check-input"],["name","device_timeout","type","checkbox","formControlName","device_timeout",1,"form-check-input"],[1,"form-check","form-check-inline","form-check-solid","me-5","mt-4"],["name","alert_timeout","type","checkbox","formControlName","alert_timeout",1,"form-check-input"],[1,"col-md-4","form-check","form-switch",2,"padding-top","35px"],["class","col-lg-12 ms-4",4,"ngIf"],[1,"col-lg-12","d-none"],["formControlName","cognito_update","type","checkbox",1,"col-lg-6","form-check-input"],[1,"col-lg-6","col-form-label","fw-bold","fs-6",2,"padding-top","0px"],[1,"col-lg-4","form-check","form-switch",2,"padding-top","43px"],[1,"row","binary-generator","mt-5"],[1,"col-lg-12","col-form-label","fw-bold","fs-4","text-center","mb-4"],[1,"d-flex","justify-content-center","flex-wrap"],["class","m-2 p-2 border rounded text-center bit-container",3,"click",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-danger"],["closeUser",""],["type","submit","class","btn btn-sm btn-primary",3,"hidden","disabled","click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary not-allowed",3,"hidden","disabled","click",4,"ngIf"],[1,"btn","btn-sm","fw-bold","btn-danger","me-2",3,"ngbTooltip","click"],[1,"bi","bi-person-fill-exclamation","fs-2"],["type","button","data-bs-toggle","modal","data-bs-target","#userModal",1,"btn","btn-sm","btn-primary",3,"click"],["id","osLabel",1,"modal-title"],["type","button","placement","bottom",1,"btn","btn-sm","btn-warning","copy-btn","ms-1",3,"disabled","hidden","click"],[1,"copy-icon"],[1,"fa-regular","fa-copy","fs-6","text-white","pt-1"],[1,"copy-text"],[1,"btn","btn-icon","btn-box","image-input-wrapper","w-125px","h-125px","btn-active-color-primary","w-25px","h-25px","bg-body","shadow",3,"src"],[1,"fv-plugins-message-container","invalid-feedback"],["placeholder","select client ID","name","client_ID","formControlName","clientID",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[3,"value"],["type","text","name","name","formControlName","disabled_CLientID",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","select company ID","name","company_ID","formControlName","companyID",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["type","text","name","name","formControlName","disabled_companyid",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","select permission ID","name","permission_ID","formControlName","permission_ID","required","",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[1,"custom-multiselect"],[1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl","onSelect"],[1,"form-select","form-select-solid","form-select-lg","fw-bold",2,"display","inline-block","width","100%","padding","0px","margin-bottom","0","font-weight","0px","line-height","1.52857143","text-align","left","vertical-align","middle","cursor","pointer","background-image","none","border-radius","4px",3,"placeholder","settings","data","formControl","onSelect","onSelectAll"],["name","default_dev","formControlName","default_dev",1,"form-select","form-select-solid","form-select-lg","fw-bold"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-success","fw-bolder","ms-2","fs-8","py-1","px-3"],[1,"tooltip-left-aligned"],[1,"col-lg-12","ms-4"],["formControlName","enable_user","type","checkbox",1,"col-lg-6","form-check-input"],[1,"m-2","p-2","border","rounded","text-center","bit-container",3,"click"],[1,"fw-bold","fs-5","mb-2",3,"ngClass","click"],["type","checkbox",1,"form-check-input",3,"formControlName","change"],["type","submit",1,"btn","btn-sm","btn-primary",3,"hidden","disabled","click"],["type","button",1,"btn","btn-sm","btn-primary","not-allowed",3,"hidden","disabled","click"]],template:function(t,l){if(1&t&&(e.TgZ(0,"ngx-spinner",0)(1,"p",1),e._uU(2,"Hang tight! We're brewing up something good. "),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"h3",4)(6,"span",5),e._uU(7," User Configuration"),e.qZA()(),e.TgZ(8,"div",6),e.YNc(9,Ne,2,1,"button",7),e.YNc(10,qe,2,0,"button",8),e.qZA()(),e.TgZ(11,"div",2)(12,"div",9)(13,"div",10)(14,"table",11)(15,"thead"),e.YNc(16,Oe,19,0,"tr",12),e.YNc(17,Me,17,0,"tr",12),e.qZA()()()()()(),e.TgZ(18,"div",13)(19,"div",14)(20,"div",15)(21,"div",16),e.YNc(22,Je,2,0,"h2",17),e.YNc(23,Le,2,0,"h2",17),e.YNc(24,Ee,5,2,"button",18),e._UZ(25,"button",19),e.qZA(),e.TgZ(26,"div",20)(27,"div",21)(28,"div",22)(29,"div",23)(30,"div",24)(31,"div",25)(32,"label",26),e._uU(33,"Profile picture"),e.qZA(),e.TgZ(34,"input",27),e.NdJ("change",function(o){return l.onFileChange(o)}),e.qZA(),e.TgZ(35,"label",28),e._uU(36,"Upload Image"),e.qZA(),e._UZ(37,"br"),e.YNc(38,Ke,1,1,"img",29),e.qZA()(),e.TgZ(39,"div",30)(40,"label",31),e._uU(41," User Name "),e.qZA(),e.TgZ(42,"input",32),e.NdJ("keyup",function(o){return l.checkUniqueIdentifier(o)}),e.qZA(),e.TgZ(43,"span",33),e._uU(44),e.qZA(),e.YNc(45,Ye,2,0,"div",34),e.qZA(),e.TgZ(46,"div",35)(47,"label",31),e._uU(48," Password "),e.qZA(),e.TgZ(49,"input",36),e.NdJ("keyup",function(o){return l.checkName_asPassword(o)}),e.qZA(),e.TgZ(50,"span",33),e._uU(51),e.qZA(),e.YNc(52,Be,2,0,"div",34),e.qZA()()(),e.TgZ(53,"div",22)(54,"div",23)(55,"div",37)(56,"div",38)(57,"input",39),e.NdJ("change",function(o){return l.switchInputs(o)}),e.qZA(),e.TgZ(58,"label",40)(59,"b"),e._uU(60,"Allow User to add other Clients"),e.qZA()()()(),e.TgZ(61,"div",37)(62,"div",38)(63,"input",41),e.NdJ("change",function(o){return l.switchCompanyID(o)}),e.qZA(),e.TgZ(64,"label",40)(65,"b"),e._uU(66,"Allow User to add new Company ID"),e.qZA()()()(),e.TgZ(67,"div",37)(68,"div",38),e._UZ(69,"input",42),e.TgZ(70,"label",40)(71,"b"),e._uU(72,"Allow User to add New Clients"),e.qZA()()()(),e.TgZ(73,"div",37)(74,"div",38),e._UZ(75,"input",43),e.TgZ(76,"label",40)(77,"b"),e._uU(78,"Allow User to add other Company ID"),e.qZA()()()()()(),e.TgZ(79,"div",22)(80,"div",44)(81,"div",30)(82,"label",31),e._uU(83," Client ID"),e.qZA(),e.YNc(84,je,2,1,"select",45),e.YNc(85,Re,1,0,"input",46),e.qZA(),e.TgZ(86,"div",30)(87,"label",31),e._uU(88," Company ID"),e.qZA(),e.YNc(89,ze,2,1,"select",47),e.YNc(90,Ge,1,0,"input",48),e.YNc(91,He,2,0,"div",34),e.qZA(),e.YNc(92,Xe,5,1,"div",49),e.qZA()(),e.TgZ(93,"div",22)(94,"div",44)(95,"div",30)(96,"label",31),e._uU(97," User ID"),e.qZA(),e.TgZ(98,"input",50),e.NdJ("keyup",function(o){return l.checkUniqueUserID(o)}),e.qZA(),e.TgZ(99,"span",33),e._uU(100),e.qZA(),e.YNc(101,Ve,2,0,"div",34),e.qZA(),e.TgZ(102,"div",30)(103,"label",31),e._uU(104," Description"),e.qZA(),e._UZ(105,"input",51),e.YNc(106,et,2,0,"div",34),e.qZA(),e.TgZ(107,"div",30)(108,"label",31),e._uU(109," Mobile"),e.qZA(),e.TgZ(110,"input",52),e.NdJ("input",function(o){return l.onMobileInput(o)}),e.qZA(),e.TgZ(111,"span",33),e._uU(112),e.qZA(),e.YNc(113,tt,2,0,"div",34),e.qZA()()(),e.TgZ(114,"div",22)(115,"div",44)(116,"div",30)(117,"label",31),e._uU(118," Mobile Privacy"),e.qZA(),e.TgZ(119,"select",53)(120,"option",54),e._uU(121,"Visible"),e.qZA(),e.TgZ(122,"option",55),e._uU(123,"Invisible"),e.qZA()(),e.YNc(124,it,2,0,"div",34),e.qZA(),e.TgZ(125,"div",30)(126,"label",31),e._uU(127," Email "),e.qZA(),e.TgZ(128,"input",56),e.NdJ("keyup",function(o){return l.checkUniqueEmail(o),l.checkMail(o)}),e.qZA(),e.TgZ(129,"span",33),e._uU(130),e.qZA(),e.TgZ(131,"span",33),e._uU(132),e.qZA(),e.YNc(133,lt,2,0,"div",34),e.qZA(),e.TgZ(134,"div",30)(135,"label",57),e._uU(136," Telegram Channel ID "),e.qZA(),e._UZ(137,"input",58),e.qZA()()(),e.YNc(138,dt,5,3,"div",59),e.TgZ(139,"div",22)(140,"div",60),e.YNc(141,pt,6,2,"div",61),e.TgZ(142,"div",30)(143,"label",57),e._uU(144," Tree"),e.qZA(),e._UZ(145,"input",62)(146,"div",63),e.qZA(),e.TgZ(147,"div",30)(148,"label",57),e._uU(149," Redirection "),e.YNc(150,_t,2,1,"a",64),e.qZA(),e._UZ(151,"input",65),e.qZA(),e.TgZ(152,"div",30)(153,"label",57),e._uU(154," Default Module"),e.qZA(),e.TgZ(155,"select",66),e.YNc(156,ft,2,2,"option",67),e.qZA()(),e.TgZ(157,"div",68)(158,"label",57),e._uU(159," Default Location/Device"),e.qZA(),e.TgZ(160,"select",69)(161,"option"),e._uU(162,"Default"),e.qZA(),e.YNc(163,ht,2,2,"option",67),e.qZA(),e.YNc(164,gt,2,0,"div",34),e.qZA(),e.TgZ(165,"div",70)(166,"label",57),e._uU(167," Default Type"),e.qZA(),e.TgZ(168,"select",71)(169,"option",72),e._uU(170,"Device"),e.qZA(),e.TgZ(171,"option",73),e._uU(172,"Location"),e.qZA()(),e.YNc(173,vt,2,0,"div",34),e.qZA(),e.TgZ(174,"div",70)(175,"label",57),e._uU(176,"Start Node"),e.qZA(),e.TgZ(177,"select",74)(178,"option"),e._uU(179,"Default"),e.qZA(),e.YNc(180,bt,2,2,"option",67),e.qZA(),e.YNc(181,Ut,2,0,"div",34),e.qZA(),e.TgZ(182,"div",70)(183,"label",57),e._uU(184,"Alert Levels"),e.qZA(),e.TgZ(185,"select",75)(186,"option",76),e._uU(187,"NONE"),e.qZA(),e.TgZ(188,"option",77),e._uU(189,"THC DCH2"),e.qZA()()()()(),e.TgZ(190,"div",22)(191,"div",44)(192,"div",70)(193,"label",57),e._uU(194,"Reporting To"),e.qZA(),e.TgZ(195,"select",78),e.YNc(196,yt,2,2,"option",67),e.qZA()(),e.TgZ(197,"div",70)(198,"label",57),e._uU(199," Alert Enable"),e.qZA(),e.TgZ(200,"label",79),e._UZ(201,"input",80),e.TgZ(202,"span",81),e._uU(203,"Email "),e.qZA()(),e.TgZ(204,"label",79),e._UZ(205,"input",82),e.TgZ(206,"span",81),e._uU(207,"SMS "),e.qZA()(),e.TgZ(208,"label",79),e._UZ(209,"input",83),e.TgZ(210,"span",81),e._uU(211,"Telegram "),e.qZA()()(),e.TgZ(212,"div",30)(213,"label",84),e._uU(214," Alert Escalation Enable "),e.TgZ(215,"button",85),e._UZ(216,"i",86),e.qZA()(),e.TgZ(217,"label",79),e._UZ(218,"input",87),e.TgZ(219,"span",81),e._uU(220,"Email "),e.qZA()(),e.TgZ(221,"label",79),e._UZ(222,"input",88),e.TgZ(223,"span",81),e._uU(224,"SMS "),e.qZA()(),e.TgZ(225,"label",79),e._UZ(226,"input",89),e.TgZ(227,"span",81),e._uU(228,"Telegram "),e.qZA()()(),e.YNc(229,Dt,13,0,"ng-template",null,90,e.W1O),e.TgZ(231,"div",30)(232,"label",57),e._uU(233," Notification"),e.qZA(),e.TgZ(234,"label",79),e._UZ(235,"input",91),e.TgZ(236,"span",81),e._uU(237,"Health Check "),e.qZA()(),e.TgZ(238,"label",79),e._UZ(239,"input",92),e.TgZ(240,"span",81),e._uU(241,"Device Timeout "),e.qZA()(),e.TgZ(242,"label",93),e._UZ(243,"input",94),e.TgZ(244,"span",81),e._uU(245,"Alert Timeout "),e.qZA()()(),e.TgZ(246,"div",95),e.YNc(247,Ct,5,0,"div",96),e.TgZ(248,"div",97),e._UZ(249,"input",98),e.TgZ(250,"label",99)(251,"b"),e._uU(252,"Cognito Update"),e.qZA()()()()()(),e.TgZ(253,"div",22)(254,"div",44),e._UZ(255,"div",100),e.qZA()(),e.TgZ(256,"div",101)(257,"label",102),e._uU(258,"Access Permission"),e.qZA(),e.TgZ(259,"div",103),e.YNc(260,Zt,4,6,"div",104),e.qZA()(),e.TgZ(261,"div",105)(262,"button",106,107),e._uU(264,"Cancel"),e.qZA(),e.YNc(265,wt,2,2,"button",108),e.YNc(266,Tt,2,2,"button",109),e.qZA()()()()()()),2&t){const i=e.MAs(230);let o,s,d,c,p,g,_,m,h,b,w;e.Q6J("fullScreen",!0),e.xp6(9),e.Q6J("ngIf",l.adminLogin||l.locationAdmin),e.xp6(1),e.Q6J("ngIf",l.hideDeleteButton&&l.locationAdmin),e.xp6(6),e.Q6J("ngIf",!0===l.hideDeleteButton),e.xp6(1),e.Q6J("ngIf",!1===l.hideDeleteButton),e.xp6(5),e.Q6J("ngIf",l.showHeading),e.xp6(1),e.Q6J("ngIf",!l.showHeading),e.xp6(1),e.Q6J("ngIf",l.editOperation),e.xp6(2),e.Q6J("formGroup",l.createUserField),e.xp6(12),e.Q6J("ngIf",l.base64textString_temp),e.xp6(6),e.Oqu(l.errorForUniqueID),e.xp6(1),e.Q6J("ngIf",(null==(o=l.createUserField.get("username"))?null:o.hasError("required"))&&(null==(o=l.createUserField.get("username"))?null:o.touched)),e.xp6(1),e.Q6J("ngClass",e.VKq(50,Ft,l.editOperation)),e.xp6(5),e.Oqu(l.errorForInvalidName),e.xp6(1),e.Q6J("ngIf",(null==(s=l.createUserField.get("name"))?null:s.hasError("required"))&&(null==(s=l.createUserField.get("name"))?null:s.touched)),e.xp6(32),e.Q6J("ngIf",l.adminLogin),e.xp6(1),e.Q6J("ngIf",!l.adminLogin),e.xp6(4),e.Q6J("ngIf",l.adminLogin||l.locationAdmin),e.xp6(1),e.Q6J("ngIf",!l.locationAdmin),e.xp6(1),e.Q6J("ngIf",(null==(d=l.createUserField.get("companyID"))?null:d.hasError("required"))&&(null==(d=l.createUserField.get("companyID"))?null:d.touched)),e.xp6(1),e.Q6J("ngIf",l.locationAdmin),e.xp6(8),e.Oqu(l.errorForUniqueUserID),e.xp6(1),e.Q6J("ngIf",(null==(c=l.createUserField.get("userID"))?null:c.hasError("required"))&&(null==(c=l.createUserField.get("userID"))?null:c.touched)),e.xp6(5),e.Q6J("ngIf",(null==(p=l.createUserField.get("description"))?null:p.hasError("required"))&&(null==(p=l.createUserField.get("description"))?null:p.touched)),e.xp6(4),e.Q6J("ngStyle",e.VKq(52,xt,l.privacyVisibility?"none":"disc")),e.uIk("type","text")("inputmode","numeric")("autocomplete","off"),e.xp6(2),e.Oqu(l.errorForUniqueMobileID),e.xp6(1),e.Q6J("ngIf",(null==(g=l.createUserField.get("mobile"))?null:g.hasError("required"))&&(null==(g=l.createUserField.get("mobile"))?null:g.touched)),e.xp6(11),e.Q6J("ngIf",(null==(_=l.createUserField.get("mobile_privacy"))?null:_.hasError("required"))&&(null==(_=l.createUserField.get("mobile_privacy"))?null:_.touched)),e.xp6(6),e.Oqu(l.errorForUniqueEmail),e.xp6(2),e.Oqu(l.errorForInvalidEmail),e.xp6(1),e.Q6J("ngIf",(null==(m=l.createUserField.get("email"))?null:m.hasError("required"))&&(null==(m=l.createUserField.get("email"))?null:m.touched)&&(null==(m=l.createUserField.get("email"))||null==m.errors?null:m.errors.pattern)),e.xp6(5),e.Q6J("ngIf",l.locationAdmin),e.xp6(3),e.Q6J("ngIf",l.deviceListWorkAround.length>0),e.xp6(9),e.Q6J("ngIf",l.idSelected),e.xp6(6),e.Q6J("ngForOf",e.DdM(54,kt)),e.xp6(7),e.Q6J("ngForOf",l.defaultlocation),e.xp6(1),e.Q6J("ngIf",(null==(h=l.createUserField.get("default_loc"))?null:h.hasError("required"))&&(null==(h=l.createUserField.get("default_loc"))?null:h.touched)),e.xp6(9),e.Q6J("ngIf",(null==(b=l.createUserField.get("default_type"))?null:b.hasError("required"))&&(null==(b=l.createUserField.get("default_type"))?null:b.touched)),e.xp6(7),e.Q6J("ngForOf",l.startNode),e.xp6(1),e.Q6J("ngIf",(null==(w=l.createUserField.get("start_node"))?null:w.hasError("required"))&&(null==(w=l.createUserField.get("start_node"))?null:w.touched)),e.xp6(15),e.Q6J("ngForOf",l.listofReportingUsers),e.xp6(19),e.Q6J("tooltipClass","custom-tooltip")("ngbTooltip",i),e.xp6(32),e.Q6J("ngIf",l.editOperation),e.xp6(13),e.Q6J("ngForOf",l.somelist),e.xp6(5),e.Q6J("ngIf",l.showModal&&l.locationAdmin),e.xp6(1),e.Q6J("ngIf",!l.showModal)}},dependencies:[P.mk,P.sg,P.O5,P.PC,z.Ro,v.YN,v.Kr,v.Fj,v.wV,v.Wl,v.EJ,v.JJ,v.JL,v.Q7,v.wO,v.nD,v.oH,v.sg,v.u,R._L,ge.O],styles:["input[type=checkbox][_ngcontent-%COMP%]{background-color:#c5e0f3;border-color:#f5f8fa;color:#2b2b2c;margin-top:0;transition:color .2s ease,background-color .2s ease}.swal2-container[_ngcontent-%COMP%]{z-index:20}.btn-close[_ngcontent-%COMP%]{background-color:#f1416c}.visually-hidden[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.binary-generator[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:20px;border-radius:10px;box-shadow:0 4px 8px #0000001a}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}.bit-container[_ngcontent-%COMP%]{width:70px;background-color:#fff;box-shadow:0 2px 4px #0000001a}.bit-container[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.bit-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block}.bit-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-top:10px}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.invalid-feedback[_ngcontent-%COMP%]{display:block;color:#dc3545;margin-top:.25rem;font-size:.875em}.bg-red[_ngcontent-%COMP%]{background-color:red;color:#fff}.bg-green[_ngcontent-%COMP%]{background-color:green;color:#fff}[_nghost-%COMP%]     .custom-multiselect .form-select .multiselect-dropdown .dropdown-btn{border:none!important;font-weight:400;font-size:15px}.sampTooltip[_ngcontent-%COMP%]{border:none;border-radius:11px;background-color:#0000;margin-left:2px}.bi-info-circle[_ngcontent-%COMP%]:hover{color:#1da1f2}.sampTooltip[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10px}.custom-tooltip[_ngcontent-%COMP%]{text-align:left!important;white-space:normal;max-width:300px;background-color:#dc3545;font-size:.875rem;line-height:1.4}.tooltip-left-aligned[_ngcontent-%COMP%], .tooltip-custom[_ngcontent-%COMP%]   .tooltip-inner[_ngcontent-%COMP%]{text-align:left!important}.copy-btn[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .3s ease-in-out}.copy-icon[_ngcontent-%COMP%]{display:inline-block}.copy-text[_ngcontent-%COMP%]{display:none}.copy-btn[_ngcontent-%COMP%]:hover   .copy-text[_ngcontent-%COMP%]{display:inline-block}.copy-btn[_ngcontent-%COMP%]:hover   .copy-icon[_ngcontent-%COMP%]{margin-right:5px;transition:.4s}.copy-btn[_ngcontent-%COMP%]:hover{background-color:#d9534f}"]})),u})(),At=(()=>{var r;class u{}return r=u,(0,n.Z)(u,"\u0275fac",function(t){return new(t||r)}),(0,n.Z)(u,"\u0275mod",e.oAB({type:r})),(0,n.Z)(u,"\u0275inj",e.cJS({imports:[P.ez,Q.ZX,z.ef,v.u5,v.UX,ge.Z,pe.Bz.forChild([{path:"",component:Pt}])]})),u})()}}]);