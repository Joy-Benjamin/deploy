"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[5051],{45051:(E,O,d)=>{d.r(O),d.d(O,{FusionModule:()=>ae});var i=d(86656),y=d(15861),f=d(56223),S=d(13519),b=d.n(S),Z=d(24036),e=d(65879),M=d(30175),P=d(5588),w=d(69862);let v=(()=>{var s;class a{constructor(t){(0,i.Z)(this,"http",void 0),(0,i.Z)(this,"apiUrl","https://37iltjrp70.execute-api.ap-south-1.amazonaws.com/test/triggerSchedule"),this.http=t}callSchedule_24(t,o,r,c){const n={deviceID:t,clientID:o,startTime:r,type:c};return console.log(n),this.http.post(this.apiUrl,n)}callscheduleDay(t,o,r,c){const n={deviceID:t,clientID:o,startTime:r,type:c};return console.log(n),this.http.post(this.apiUrl,n)}callMonthly(t,o,r,c){const n={deviceID:t,clientID:o,startTime:r+"T15:22:20.803Z",type:c};return console.log(n),this.http.post(this.apiUrl,n)}callscheduleHour_1(t,o,r,c){const n={deviceID:t,clientID:o,startTime:r+":00.000Z",type:c};return console.log(n),this.http.post(this.apiUrl,n)}}return s=a,(0,i.Z)(a,"\u0275fac",function(t){return new(t||s)(e.LFG(w.eN))}),(0,i.Z)(a,"\u0275prov",e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})),a})();var D=d(2425),T=d(6593),A=d(64190),L=d(31552),C=d(88672),U=d(74260),I=d(16519),F=d(96814),k=d(14934);let J=(()=>{var s;class a{constructor(){}onWheel(t){t.preventDefault()}}return s=a,(0,i.Z)(a,"\u0275fac",function(t){return new(t||s)}),(0,i.Z)(a,"\u0275dir",e.lG2({type:s,selectors:[["","appPreventScroll",""]],hostBindings:function(t,o){1&t&&e.NdJ("wheel",function(c){return o.onWheel(c)})}})),a})();const G=function(s){return{visible:s}};function j(s,a){if(1&s&&(e.TgZ(0,"div",61),e._uU(1),e.qZA()),2&s){const l=a.$implicit,t=a.index,o=e.oxw(2);e.Q6J("ngClass",e.VKq(2,G,o.loadingProgress>=(t+1)*(100/o.letters.length))),e.xp6(1),e.hij(" ",l," ")}}function q(s,a){if(1&s){const l=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(l);const o=e.oxw(2);return e.KtG(o.onOkClick())}),e._uU(1,"OK"),e.qZA()}}function B(s,a){if(1&s&&(e.TgZ(0,"div",53)(1,"div",54)(2,"div",55)(3,"div",56),e._uU(4),e.qZA(),e.TgZ(5,"div",57),e.YNc(6,j,2,4,"div",58),e.qZA(),e.TgZ(7,"p",59),e._uU(8),e.qZA(),e.YNc(9,q,2,0,"button",60),e.qZA()()()),2&s){const l=e.oxw();e.xp6(4),e.hij(" ",l.loadingProgress,"% \u23f3 "),e.xp6(2),e.Q6J("ngForOf",l.letters),e.xp6(2),e.hij(" ",l.loadingMessage," "),e.xp6(1),e.Q6J("ngIf",l.showOKButton)}}function K(s,a){if(1&s&&(e.TgZ(0,"option",63),e._uU(1),e.qZA()),2&s){const l=a.$implicit;e.Q6J("value",l),e.xp6(1),e.hij(" ",l," ")}}function Y(s,a){if(1&s&&(e.TgZ(0,"div",70)(1,"div",71),e._uU(2),e.qZA(),e._UZ(3,"input",72),e.qZA()),2&s){const l=a.$implicit,t=a.index,o=e.oxw().$implicit;e.xp6(2),e.AsE("",t+1+") ","",l,""),e.xp6(1),e.Q6J("formControlName","param_"+o.deviceName+"_"+t)}}function H(s,a){if(1&s&&(e.TgZ(0,"div",65)(1,"div",66)(2,"span",9),e._uU(3),e.qZA()(),e.TgZ(4,"div",67)(5,"div",68),e.YNc(6,Y,4,3,"div",69),e.qZA()()()),2&s){const l=a.$implicit;e.xp6(3),e.Oqu(l.mn_label),e.xp6(3),e.Q6J("ngForOf",l.parameters)}}function Q(s,a){if(1&s&&(e.TgZ(0,"form",26),e.YNc(1,H,7,2,"div",64),e.qZA()),2&s){const l=e.oxw();e.Q6J("formGroup",l.dataForm),e.xp6(1),e.Q6J("ngForOf",l.parametersList)}}function z(s,a){if(1&s){const l=e.EpF();e.TgZ(0,"li")(1,"span",75),e._uU(2),e.TgZ(3,"i",76),e.NdJ("click",function(){const r=e.CHM(l).$implicit,c=e.oxw(2);return e.KtG(c.removeItem(r.key))}),e.qZA()()()}if(2&s){const l=a.$implicit;e.xp6(2),e.Oqu(l.value)}}function R(s,a){if(1&s&&(e.TgZ(0,"div",27)(1,"label",9),e._uU(2,"Devices"),e.qZA(),e.TgZ(3,"div",73),e.YNc(4,z,4,1,"li",74),e.ALo(5,"keyvalue"),e.qZA()()),2&s){const l=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,1,l.combineMnDevList))}}function W(s,a){1&s&&e._UZ(0,"input",77)}function V(s,a){1&s&&e._UZ(0,"input",78)}function X(s,a){1&s&&(e.TgZ(0,"div",37)(1,"label",38),e._uU(2,"Mult. Factor(mx+c)"),e.qZA(),e.TgZ(3,"div",39),e._UZ(4,"input",79),e.qZA()())}function ee(s,a){1&s&&(e.TgZ(0,"div",37)(1,"label",38),e._uU(2,"Correction Factor(mx+c)"),e.qZA(),e.TgZ(3,"div",39),e._UZ(4,"input",80),e.qZA()())}function te(s,a){1&s&&(e.TgZ(0,"button",81),e._uU(1,"Select Type"),e.qZA())}function oe(s,a){1&s&&e._UZ(0,"i",84)}function ie(s,a){if(1&s){const l=e.EpF();e.TgZ(0,"button",82),e.NdJ("click",function(){e.CHM(l);const o=e.oxw();return e.KtG(o.onSub())}),e.YNc(1,oe,1,0,"i",83),e._uU(2),e.qZA()}if(2&s){const l=e.oxw();e.Q6J("disabled",l.loading),e.xp6(1),e.Q6J("ngIf",l.loading),e.xp6(1),e.hij(" ",l.selectedOption,"")}}function ne(s,a){1&s&&(e.TgZ(0,"strong"),e._uU(1,"1. Generate Hourly data for 1 Hour"),e.qZA(),e._uU(2,":"),e._UZ(3,"br"),e._uU(4," Ex: Generation Hour: 5 PM --\x3e Hourly Data will generate from 4 PM to 5 PM"),e._UZ(5,"br")(6,"br"),e.TgZ(7,"strong"),e._uU(8,"2. Generate Hourly data for 24 Hours"),e.qZA(),e._uU(9,":"),e._UZ(10,"br"),e._uU(11," Ex: Generation Date is: 28/02/24 --\x3e Hourly Data will generate for 28/02/24 for all 24 hrs"),e._UZ(12,"br")(13,"br"),e.TgZ(14,"strong"),e._uU(15,"3. Generate Daily data"),e.qZA(),e._uU(16,":"),e._UZ(17,"br"),e._uU(18," Ex: Generation Date is: 28/02/24 --\x3e Daily data will be generated for 27/02/24"),e._UZ(19,"br")(20,"br"),e.TgZ(21,"strong"),e._uU(22,"4. Generate Monthly Data"),e.qZA(),e._uU(23,":"),e._UZ(24,"br"),e._uU(25," Ex: Generation Date is: 28/02/24 --\x3e Monthly data will be generated for the First month 01/01/24 to 31/01/24 "))}let se=(()=>{var s;class a{constructor(t,o,r,c,n,h,p,m,g,u,x,_,N){(0,i.Z)(this,"lambdatapi",void 0),(0,i.Z)(this,"formBuilder",void 0),(0,i.Z)(this,"getFusionLocalStorage",void 0),(0,i.Z)(this,"location",void 0),(0,i.Z)(this,"serviceFusion",void 0),(0,i.Z)(this,"toastr",void 0),(0,i.Z)(this,"titleService",void 0),(0,i.Z)(this,"cdr",void 0),(0,i.Z)(this,"router",void 0),(0,i.Z)(this,"api",void 0),(0,i.Z)(this,"spinner",void 0),(0,i.Z)(this,"locationPermissionService",void 0),(0,i.Z)(this,"auditTrialServices",void 0),(0,i.Z)(this,"myForm",void 0),(0,i.Z)(this,"dataForm",void 0),(0,i.Z)(this,"myForm2",void 0),(0,i.Z)(this,"compareList",void 0),(0,i.Z)(this,"mnList",void 0),(0,i.Z)(this,"getLoggedUser",void 0),(0,i.Z)(this,"SK_clientID",void 0),(0,i.Z)(this,"user_companyID",void 0),(0,i.Z)(this,"selectedOption",""),(0,i.Z)(this,"date",""),(0,i.Z)(this,"resArray",[]),(0,i.Z)(this,"request$",void 0),(0,i.Z)(this,"options",["Send Data","Generate Hourly Data of 1 Hour","Generate Hourly Data of 24 Hours","Generate Daily Data","Generate Monthly Data"]),(0,i.Z)(this,"devStatus",!0),(0,i.Z)(this,"delay",0),(0,i.Z)(this,"devices",[]),(0,i.Z)(this,"combineMnDevList",{}),(0,i.Z)(this,"loading",!1),(0,i.Z)(this,"parentID_selected_node",void 0),(0,i.Z)(this,"final_list",void 0),(0,i.Z)(this,"enableLocationButton",!1),(0,i.Z)(this,"selectedNodes",void 0),(0,i.Z)(this,"temp",void 0),(0,i.Z)(this,"extractDevices",[]),(0,i.Z)(this,"chk",!1),(0,i.Z)(this,"tooltipService",void 0),(0,i.Z)(this,"responseData",[]),(0,i.Z)(this,"tempArr",[]),(0,i.Z)(this,"tempArr2",[]),(0,i.Z)(this,"allPermissions_user",void 0),(0,i.Z)(this,"hidingLink",void 0),(0,i.Z)(this,"hideDeleteButton",void 0),(0,i.Z)(this,"parametersList",[]),(0,i.Z)(this,"confirmedDevice",!1),(0,i.Z)(this,"showOKButton",!1),(0,i.Z)(this,"recordAuditMultiple",!1),(0,i.Z)(this,"loadingProgress",0),(0,i.Z)(this,"loadingMessage","Initializing..."),(0,i.Z)(this,"currentDevice",1),(0,i.Z)(this,"totalDevices",2),(0,i.Z)(this,"deviceProgress",0),(0,i.Z)(this,"showProgressbar",!1),(0,i.Z)(this,"letters",["W","I","M","A","T","E"]),this.lambdatapi=t,this.formBuilder=o,this.getFusionLocalStorage=r,this.location=c,this.serviceFusion=n,this.toastr=h,this.titleService=p,this.cdr=m,this.router=g,this.api=u,this.spinner=x,this.locationPermissionService=_,this.auditTrialServices=N,this.titleService.setTitle("Fusion")}ngOnInit(){this.getLoggedUser=this.getFusionLocalStorage.getLoggedUserDetails(),this.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.user_companyID=this.getLoggedUser.attributes["custom:companyID"],console.log("check client ",this.SK_clientID),this.myForm=this.formBuilder.group({Type:[null]}),this.auditTrialServices.audit_trail("2.1","Fusion","Page Load","Fusion Page Loaded","1"),this.getLocationTree(),this.myForm2=this.formBuilder.group({deviceName:[null],dateParameter:[null],multiplier:[1],addition:[0]}),this.myForm.get("Type").valueChanges.subscribe(t=>{if(this.selectedOption=t,"Send Data"==t&&0==this.confirmedDevice)return this.clearDevices(),b().fire({title:"No Confirmed Devices",icon:"warning",text:"Please select the devices from the location and click OK."});console.log(t)}),this.myForm2.get("dateParameter").valueChanges.subscribe(t=>{this.date=t,console.log(t)}),this.checkPermission()}getLocationTree(){this.locationPermissionService.fetchGlobalLocationTree().then(t=>{if(!t)throw new Error("No data returned");this.temp=t,console.log("Data from location:",t),this.createJSTree(this.temp),console.log("this.tempthis.temp",this.temp);for(let o=0;o<this.temp.length;o++)"device"===this.temp[o].node_type&&(Array.isArray(this.temp[o].text)&&(this.temp[o].text=this.temp[o].text[0]),this.extractDevices.push({mn:this.temp[o].mn,label:this.temp[o].text+"-"+this.temp[o].mn}));console.log("ExtractDevice",this.extractDevices)}).catch(t=>{console.log("cant fetch",t)})}checkPermission(){let t=!1,o=!1;for(let r=0;r<this.allPermissions_user.length;r++)"Fusion - Update"===this.allPermissions_user[r]?(t=!0,this.hidingLink=t,console.log("CHECK PERMISSION hasDeviceUpdate",t)):"Fusions - View"===this.allPermissions_user[r]&&(o=!0,console.log("CHECK PERMISSION hasDeviceViewhasDeviceView",o));t&&o||t?this.hideDeleteButton=!0:o?this.hideDeleteButton=!1:(console.log("CHECK PERMISSION hasDeviceUpdate",t),this.router.navigate(["/404"]))}clearDevices(){this.combineMnDevList={},this.myForm.reset(),this.myForm2.reset(),this.devStatus=!1}onSub(){this.showOKButton=!1,console.log(this.myForm.get("dateParameter")?.value),console.log(this.selectedOption),console.log(this.date),this.resArray=[],this.responseData=[];for(let o of Object.keys(this.combineMnDevList))this.resArray.push(this.combineMnDevList[o]);(""!=this.selectedOption&&0!=Object.keys(this.combineMnDevList).length&&""!=this.date&&null!=this.date||"Send Data"==this.selectedOption)&&("Send Data"!=this.selectedOption||0!=Object.keys(this.combineMnDevList).length&&""!=this.date&&null!=this.date&&null!=this.myForm2.value.multiplier&&null!=this.myForm2.value.addition)?this.submitHelper():b().fire("Please fill all required fields before submitting.")}submitHelper(){var t=this;return(0,y.Z)(function*(){t.recordAuditMultiple=!1;try{console.log("Value are not changed :",t.parametersList);let o=0;const r=Object.keys(t.combineMnDevList);if("Generate Hourly Data of 24 Hours"==t.selectedOption){t.loading=!0;for(let c of r){try{const n=yield(0,Z.z)(t.serviceFusion.callSchedule_24(c,t.SK_clientID,t.date,"scheduleHour_24"));console.log("API Response",n),null!=n?(1==r.length?t.auditTrialServices.audit_trail("2.1","Fusion","Generate Schedule",`Fusion Generate Hourly Data of 24 Hours for ${t.combineMnDevList[c][0]}`,"1"):t.recordAuditMultiple=!0,t.responseData.push(n.statusCode)):t.responseData.push("null")}catch(n){console.log("API Error:",n),t.responseData.push("null")}o++,t.cdr.detectChanges()}o==r.length&&t.display()}else if("Generate Daily Data"==t.selectedOption){t.loading=!0;for(let c of r){try{const n=yield(0,Z.z)(t.serviceFusion.callscheduleDay(c,t.SK_clientID,t.date,"scheduleDay"));null!=n?(1==r.length?t.auditTrialServices.audit_trail("2.1","Fusion","Generate Schedule",`Fusion Generate Daily Data for ${t.combineMnDevList[c][0]}`,"1"):t.recordAuditMultiple=!0,console.log("API Response",n),t.responseData.push(n.statusCode)):t.responseData.push("null")}catch(n){console.log("API Error:",n),t.responseData.push("null")}o++,t.cdr.detectChanges()}o==r.length&&t.display()}else if("Generate Monthly Data"==t.selectedOption){t.loading=!0;for(let c of r){try{const n=yield(0,Z.z)(t.serviceFusion.callMonthly(c,t.SK_clientID,t.date,"scheduleMonth"));console.log("API Response",n),null!=n?(1==r.length?t.auditTrialServices.audit_trail("2.1","Fusion","Generate Schedule",`Fusion Generate Monthly Data for ${t.combineMnDevList[c][0]}`,"1"):t.recordAuditMultiple=!0,t.responseData.push(n.statusCode)):t.responseData.push("null")}catch(n){console.log("API Error:",n),t.responseData.push("null")}o++,t.cdr.detectChanges()}o==r.length&&t.display()}else if("Generate Hourly Data of 1 Hour"==t.selectedOption){t.loading=!0;for(let c of r){try{const n=yield(0,Z.z)(t.serviceFusion.callscheduleHour_1(c,t.SK_clientID,t.date,"scheduleHour_1"));console.log("API Response",n),null!=n?(1==r.length?t.auditTrialServices.audit_trail("2.1","Fusion","Generate Schedule",`Fusion Generate Hourly Data of 1 Hour for ${t.combineMnDevList[c][0]}`,"1"):t.recordAuditMultiple=!0,t.responseData.push(n.statusCode)):t.responseData.push("null")}catch(n){console.log("API Error:",n),t.responseData.push("null")}o++,t.cdr.detectChanges()}o==r.length&&t.display()}else if("Send Data"==t.selectedOption){t.loadingProgress=0,t.loadingMessage="Initializing...",t.currentDevice=0,t.totalDevices=t.devices.length,t.deviceProgress=0,t.showProgressbar=!0;const c=t.myForm2.value.multiplier,n=t.myForm2.value.addition;if(t.dataForm.valid){console.log("form values are :",t.dataForm.value);const h=t.dataForm.value;for(let p of t.devices){const m=Object.entries(h).filter(([_])=>_.includes(p)).map(([_,N])=>N);let g={},u=1;for(let _ of m)g[`P${u}`]=_*c+n,u++;const x=t.parametersList.find(_=>_.deviceName===p);try{const _=yield t.api.GetMqtt(x.response.reserved,t.SK_clientID);_&&(1==t.devices.length?t.auditTrialServices.audit_trail("2.1","Fusion","Send Data",`Fusion Sended Data for ${t.combineMnDevList[p][0]}`,"1"):t.recordAuditMultiple=!0,yield t.sendToMqtt(g,p,_,x.response,u))}catch(_){console.log("Cant fetch MQTT:",_),b().fire({title:"MQTT not found",icon:"error",text:`Please add MQTT to ${p}`,position:"top-right",toast:!0,showConfirmButton:!1,timer:2e3})}t.currentDevice++,yield t.startDeviceUpdate()}}else console.error("Form is invalid");console.log("Data sent"),t.showOKButton=!0,t.cdr.detectChanges()}}catch(o){console.log("Something went wrong requesting API",o)}finally{t.recordAuditMultiple&&t.auditTrialServices.audit_trail("2.1","Fusion",t.selectedOption.startsWith("Generate")?"Generate Schedule":"Send Data",t.selectedOption.startsWith("Generate")?`Fusion ${t.selectedOption} for ${Object.values(t.combineMnDevList).join()} device(s)`:`Fusion Sended Data for ${Object.values(t.combineMnDevList).join()} device(s)`,Object.keys(t.combineMnDevList).length)}})()}onOkClick(){this.showProgressbar=!1}sendToMqtt(t,o,r,c,n){var h=this;return(0,y.Z)(function*(){let p={mqtt:{},device_configuration:{},val:{}},u={MI:3371244,UD:"1111",UI:"70B3D525331B",DT:new Date(h.myForm2.value.dateParameter).getTime()/1e3+19800,SD:0,NSS:77,PS:27,MM:{P1:113,P2:179,P3:78,P4:47,P5:148},PK:"MN#NewDevice#TD",MN:"NewDevice",client:"Google",DL:n-1,DOW:5,PY:2024,PM:1,PD:4,PH:16,PMI:36,OED:2,OEH:2};u.MM=t,u.PK=`MN#${o}#TD`,u.MN=o,u.client=h.SK_clientID,console.log("Final Payload to be send :",u),p.device_configuration=c,p.mqtt=r,p.val=u,console.log("Final Payload Data is ",p),h.lambdatapi.mqtt(p).subscribe(x=>{console.log(x)})})()}display(){this.tempArr=[],this.tempArr2=[];for(let t=0;t<this.responseData.length;t++)this.loading=!1,this.cdr.detectChanges(),200!=this.responseData[t]?this.tempArr.push(this.resArray[t]):this.tempArr2.push(this.resArray[t]);0==this.tempArr.length?b().fire({title:"Process has been Initiated for "+this.tempArr2,icon:"success"}):b().fire({title:"Error to  Initiate for "+this.tempArr2+" devices",icon:"error"})}AddAllnodes(){this.confirmedDevice=!0,this.getDeviceConfig(this.devices),console.log(this.combineMnDevList)}createJSTree(t){$("#MultiJSTree_fusion").jstree({core:{check_callback:!0,data:t,multiple:!0},search:{show_only_matches:!0},plugins:["contextmenu","dnd","search","checkbox"],contextmenu:{items:function(c){let n=$("#MultiJSTree_fusion").jstree(!0);return{submenu:{Child:{seperator_before:!1,seperator_after:!1,label:"Child",action:function(h){n.get_selected().forEach(m=>{let g=n.create_node(m,{text:"New Child",type:"file",icon:"glyphicon glyphicon-file"});n.deselect_node(m),n.select_node(g)})}},Parent:{seperator_before:!1,seperator_after:!1,label:"Parent",action:function(h){n.get_selected().forEach(m=>{let g=n.create_node(m,{text:"New Parent",type:"default"});n.deselect_node(m),n.select_node(g)})}}},Rename:{separator_before:!1,separator_after:!1,label:"Edit Location",action:function(h){n.get_selected().forEach(m=>{n.edit(m)})}},Remove:{separator_before:!1,separator_after:!1,label:"Remove Location",action:function(h){n.get_selected().forEach(m=>{n.delete_node(m)})}}}}}}).on("changed.jstree",(c,n)=>{let h=n.instance.get_selected();if(h.length>0){let p=n.instance.get_node(h[0]);if(p&&p.text){this.parentID_selected_node=p.parent,this.final_list=h.map(u=>n.instance.get_node(u)),console.log("chk this.final_list",this.final_list);const m=this.final_list.filter(u=>u.original&&"device"===u.original.node_type).map(u=>u.original.mn),g=this.final_list.filter(u=>u.original&&"device"===u.original.node_type).map(u=>u.original.text);this.combineMnDevList={},m.forEach((u,x)=>{this.combineMnDevList[u]=g[x]}),console.log("this.combineMnDevList ",this.combineMnDevList),console.log(Object.keys(this.combineMnDevList).length),this.delay=Object.keys(this.combineMnDevList).length,this.devices=m,this.devices=Array.from(new Set(this.devices)),this.enableLocationButton=this.final_list.some(u=>void 0!==u.original)}else this.enableLocationButton=!1}else this.enableLocationButton=!1;this.cdr.detectChanges()}),$("#search").keyup(()=>{var c=$("#search").val();$("#MultiJSTree_fusion").jstree(!0).search(c)})}deselectAllNodes(){this.confirmedDevice=!1}removeAllThecache(){$("#MultiJSTree_fusion").jstree(!0).deselect_all()}removeItem(t){this.devices=this.devices&&this.devices.filter(o=>o!=t),this.parametersList=this.parametersList&&this.parametersList.filter(o=>o.deviceName!=t),delete this.combineMnDevList[t],console.log("this.devices ",this.devices),console.log("this.parametersList ",this.parametersList),this.delay=Object.keys(this.combineMnDevList).length,console.log(this.combineMnDevList)}getDeviceConfig(t){var o=this;return(0,y.Z)(function*(){if(o.parametersList=[],!Array.isArray(t)||!o.confirmedDevice)return b().fire({title:"No Confirmed Devices",icon:"warning",text:"Please select the devices from the location and click OK."});if(!(o.devices.length>0))return b().fire({title:"No Device Selected",icon:"warning",text:"Please select to devices from location"});for(let r of t)try{yield o.api.GetDeviceConfiguration(r,o.SK_clientID).then(function(){var c=(0,y.Z)(function*(n){n&&(console.log("Data that is being coming from db",n),yield o.api.GetReadingDeviceType(n.reading_device_type,o.SK_clientID).then(function(){var h=(0,y.Z)(function*(p){if(!p)return b().fire({title:"RDT not found",icon:"warning",text:`Please add RDT to ${r} device`});{console.log("Given RDT is ",p);const m=JSON.parse(p.parameters);let g=[];for(let u of m)g.push(u.parameterLabel);o.parametersList.push({deviceName:n.PK,parameters:g,response:n,mn_label:n.mn_label}),console.log("All the Actual parameters are ",o.parametersList),o.buildForm(),o.cdr.detectChanges()}});return function(p){return h.apply(this,arguments)}}()))});return function(n){return c.apply(this,arguments)}}())}catch(c){console.log("Cannot fetch Device :",c)}})()}buildForm(){const t={};this.parametersList.forEach(o=>{o.parameters.forEach((r,c)=>{t[`param_${o.deviceName}_${c}`]=new f.NI(0,f.kI.required)})}),this.dataForm=this.formBuilder.group(t)}startDeviceUpdate(){var t=this;return(0,y.Z)(function*(){t.deviceProgress=Math.floor(100/t.totalDevices),t.loadingMessage=`Sending Device Data ${t.currentDevice} of ${t.totalDevices}...`,t.loadingProgress+=t.deviceProgress,t.currentDevice==t.totalDevices&&(t.loadingProgress=100),console.log("Updating Device:",t.currentDevice),console.log("Current Progress:",t.loadingProgress),t.currentDevice===t.totalDevices&&(t.loadingMessage="Data Sending completed!",console.log("Loading Message is here:",t.loadingMessage)),t.cdr.detectChanges()})()}}return s=a,(0,i.Z)(a,"\u0275fac",function(t){return new(t||s)(e.Y36(M.i),e.Y36(f.qu),e.Y36(P.F),e.Y36(P.F),e.Y36(v),e.Y36(D._W),e.Y36(T.Dx),e.Y36(e.sBO),e.Y36(A.F0),e.Y36(L.t),e.Y36(C.t2),e.Y36(U.G),e.Y36(I.C))}),(0,i.Z)(a,"\u0275cmp",e.Xpm({type:s,selectors:[["app-fusion"]],decls:71,vars:18,consts:[["class","progress-overlay",4,"ngIf"],[1,"d-flex","flex-column","flex-column-fluid"],[1,"app-toolbar","py-3","py-lg-6"],[1,"app-container","container-fluid","d-flex","flex-stack"],[1,"page-title","d-flex","flex-wrap","me-3","flex-column","justify-content-center"],[1,"page-heading","d-flex","text-gray-900","fw-bold","fs-3","my-0","flex-column","justify-content-center"],[1,"card","card-custom"],[1,"card-body"],[1,"form-group","row",2,"margin-top","10px","margin-bottom","10px"],[1,"col-form-label","text-right","col-lg-3","col-sm-12","required","fw-bold"],[1,"col-lg-4","col-md-9","col-sm-12"],["type","button","title","Select Devices","data-bs-toggle","modal","placement","right","data-bs-target","#myLoca",1,"btn","fw-bold","btn-primary","translatey",3,"click"],["id","myLoca",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content",2,"width","400px","transform","translate(30%, 0px)"],[1,"modal-header",2,"padding-bottom","15px"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"container"],["type","search","id","search","value","","placeholder","Search For Devices",1,"col-md-12","input",2,"margin","0em auto 1em auto","padding","4px","border-radius","4px","border","1px solid silver"],["id","MultiJSTree_fusion",1,"container","scroll-y","h-300px"],[1,"modal-footer"],[1,"row"],[1,"col-md-6"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-primary",3,"disabled","click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-danger",3,"click"],[3,"formGroup"],[1,"form-group","row"],[1,"col-lg-3","col-form-label","col-sm-12","text-right","col-form-label-sm","required","fw-bold"],[1,"typelist"],["formControlName","Type",1,"form-select","form-select-solid","form-select-lg","gridster-item-content"],["disabled","",3,"value","selected"],[3,"value",4,"ngFor","ngForOf"],["placement","right","ngbTooltipRef","tooltipContent",1,"sampTooltip",3,"ngbTooltip"],[1,"fas","fa-exclamation-circle","ms-2","fs-7","tooltip-icon"],[3,"formGroup",4,"ngIf"],["class","form-group row",4,"ngIf"],[1,"form-group","row",2,"margin-bottom","20px","margin-top","6px"],["for","dateParameter",1,"col-form-label","text-right","col-lg-3","col-sm-12","required","fw-bold"],[1,"col-4"],["class","form-control","max","9999-12-31","min","0001-01-01","type","date","id","dateParameter","formControlName","dateParameter",4,"ngIf","ngIfElse"],["other_content",""],["class","form-group row","style","margin-bottom: 20px;margin-top: 6px;",4,"ngIf"],[1,"form-group","row",2,"margin-bottom","10px"],[1,"col-form-label","text-right","col-lg-3","col-sm-12","fw-bold"],[1,"col-8"],["type","submit","class","btn fw-bold custom-success translatey","disabled","",4,"ngIf","ngIfElse"],["other",""],[1,"btn","fw-bold","custom-primary",2,"margin-left","10px",3,"disabled","click"],["class","tootipData"],["tooltipContent",""],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],[1,"progress-overlay"],[1,"progress-container"],[1,"progress-text"],[2,"text-align","center","color","white","font-size","24px","font-weight","bold"],[1,"word-container"],["class","card1",3,"ngClass",4,"ngFor","ngForOf"],[1,"text-white","text-center","mt-5"],["class","ok-button",3,"click",4,"ngIf"],[1,"card1",3,"ngClass"],[1,"ok-button",3,"click"],[3,"value"],["class","device-container row",4,"ngFor","ngForOf"],[1,"device-container","row"],[1,"device-header","col-lg-3",2,"margin-right","10px"],[1,"parameter-container","col"],[1,"parameter-row"],["class","parameter-item",4,"ngFor","ngForOf"],[1,"parameter-item"],[1,"parameter-label"],["type","text",1,"parameter-input",3,"formControlName"],[1,"col-8","orderlst"],[4,"ngFor","ngForOf"],[1,"badge","badge-light-primary"],["title","Remove Device",1,"fa-solid","fa-xmark",2,"margin-left","1px","cursor","pointer",3,"click"],["max","9999-12-31","min","0001-01-01","type","date","id","dateParameter","formControlName","dateParameter",1,"form-control"],["max","9999-12-31T23:59","min","0001-01-01T00:00","type","datetime-local","id","dateParameter","formControlName","dateParameter",1,"form-control"],["appPreventScroll","","type","number","formControlName","multiplier",1,"form-control"],["appPreventScroll","","type","number","formControlName","addition",1,"form-control"],["type","submit","disabled","",1,"btn","fw-bold","custom-success","translatey"],["type","submit",1,"btn","fw-bold","custom-success","translatey",3,"disabled","click"],["class","fa fa-spinner fa-spin","style","color: white;",4,"ngIf"],[1,"fa","fa-spinner","fa-spin",2,"color","white"]],template:function(t,o){if(1&t&&(e.YNc(0,B,10,4,"div",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),e._uU(6,"Fusion"),e.qZA()()()()(),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"label",9),e._uU(11,"Select Device"),e.qZA(),e.TgZ(12,"div",10)(13,"button",11),e.NdJ("click",function(){return o.deselectAllNodes()}),e._uU(14,"Location"),e.qZA()()(),e.TgZ(15,"div",12)(16,"div",13)(17,"div",14)(18,"div",15)(19,"h2",16),e._uU(20," Location "),e.qZA(),e._UZ(21,"button",17),e.qZA(),e._UZ(22,"br"),e.TgZ(23,"div",18),e._UZ(24,"input",19),e.qZA(),e._UZ(25,"div",20),e.TgZ(26,"div",21)(27,"div",18)(28,"div",22)(29,"div",23)(30,"button",24),e.NdJ("click",function(){return o.AddAllnodes()}),e._uU(31," Ok "),e.qZA(),e._uU(32," \xa0 "),e.TgZ(33,"button",25),e.NdJ("click",function(){return o.removeAllThecache()}),e._uU(34," Cancel "),e.qZA()()()()()()()(),e.TgZ(35,"form",26)(36,"div",27)(37,"label",28),e._uU(38,"Type"),e.qZA(),e.TgZ(39,"div",29)(40,"select",30)(41,"option",31),e._uU(42,"Select Type"),e.qZA(),e.YNc(43,K,2,2,"option",32),e.qZA(),e.TgZ(44,"button",33),e._UZ(45,"i",34),e.qZA()()(),e.TgZ(46,"form",26),e.YNc(47,Q,2,2,"form",35),e.YNc(48,R,6,3,"div",36),e.TgZ(49,"div",37)(50,"label",38),e._uU(51,"Date"),e.qZA(),e.TgZ(52,"div",39),e.YNc(53,W,1,0,"input",40),e.YNc(54,V,1,0,"ng-template",null,41,e.W1O),e.qZA()(),e.YNc(56,X,5,0,"div",42),e.YNc(57,ee,5,0,"div",42),e.qZA(),e.TgZ(58,"div",43),e._UZ(59,"label",44),e.TgZ(60,"div",45),e.YNc(61,te,2,0,"button",46),e.YNc(62,ie,3,3,"ng-template",null,47,e.W1O),e.TgZ(64,"button",48),e.NdJ("click",function(){return o.clearDevices()}),e._uU(65,"Clear"),e.qZA(),e.YNc(66,ne,26,0,"ng-template",49,50,e.W1O),e.qZA()()()(),e.TgZ(68,"ngx-spinner",51)(69,"p",52),e._uU(70,"Please wait Table is Loading... "),e.qZA()()()),2&t){const r=e.MAs(55),c=e.MAs(63),n=e.MAs(67);e.Q6J("ngIf",o.showProgressbar),e.xp6(30),e.Q6J("disabled",!o.enableLocationButton),e.xp6(5),e.Q6J("formGroup",o.myForm),e.xp6(6),e.Q6J("value",null)("selected",!0),e.xp6(2),e.Q6J("ngForOf",o.options),e.xp6(1),e.Q6J("ngbTooltip",n),e.xp6(2),e.Q6J("formGroup",o.myForm2),e.xp6(1),e.Q6J("ngIf","Send Data"==o.selectedOption&&o.confirmedDevice),e.xp6(1),e.Q6J("ngIf","Send Data"!=o.selectedOption),e.xp6(5),e.Q6J("ngIf","Generate Hourly Data of 1 Hour"!=o.selectedOption&&"Send Data"!=o.selectedOption)("ngIfElse",r),e.xp6(3),e.Q6J("ngIf","Send Data"==o.selectedOption),e.xp6(1),e.Q6J("ngIf","Send Data"==o.selectedOption),e.xp6(4),e.Q6J("ngIf",""==o.selectedOption||"null"==o.selectedOption||null==o.selectedOption)("ngIfElse",c),e.xp6(3),e.Q6J("disabled",o.loading),e.xp6(4),e.Q6J("fullScreen",!0)}},dependencies:[f._Y,f.YN,f.Kr,f.Fj,f.wV,f.EJ,f.JJ,f.JL,f.sg,f.u,F.mk,F.sg,F.O5,k._L,C.Ro,J,F.Nd],styles:[".sampTooltip[_ngcontent-%COMP%]{border:none;border-radius:11px;background-color:#0000;margin-left:2px}.bi-info-circle[_ngcontent-%COMP%]:hover{color:#1da1f2}.sampTooltip[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10px}button[title][_ngcontent-%COMP%]:hover:after{background-color:red}.typelist[_ngcontent-%COMP%]{display:flex;width:35%}.translatey[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.4s}.orderlst[_ngcontent-%COMP%]{display:flex;list-style:none;margin-top:13px;gap:10px;flex-wrap:wrap}.custom-primary[_ngcontent-%COMP%]{background-color:#ff6f1e;color:#fff}.custom-primary[_ngcontent-%COMP%]:hover{background-color:#ff6f1e;color:#fff;opacity:1;transform:translateY(-2px);transition:.5s}.custom-success[_ngcontent-%COMP%]{background-color:#17c653;color:#fff}.badge-light-primary[_ngcontent-%COMP%]{font-size:15px}.tooltip-inner[_ngcontent-%COMP%]{max-width:50%;width:auto;font-size:14px;text-align:justify}.card-custom[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:10px;margin:30px}.tooltip[_ngcontent-%COMP%]{font-size:30px;width:20px}.device-header[_ngcontent-%COMP%]{margin-bottom:10px;font-size:18px;color:#333;padding-top:5%}.parameter-container[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:5px;padding:15px;margin-top:10px;margin-bottom:10px;box-shadow:0 2px 4px #0000001a;background-color:#fff}.parameter-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:flex-start}.parameter-flex-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.parameter-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;flex-direction:column;margin-right:20px;margin-bottom:10px}.parameter-label[_ngcontent-%COMP%]{margin-right:10px;font-weight:700;color:#766a6a}.parameter-input[_ngcontent-%COMP%]{padding:8px;border:1px solid #ddd;border-radius:3px;font-size:14px;transition:border-color .2s ease-in-out;flex:1;max-width:200px}@media (max-width: 768px){.parameter-item[_ngcontent-%COMP%]{flex-basis:100%}}.progress-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:9999}.progress-container[_ngcontent-%COMP%]{background-color:#0000004d;border-radius:10px;padding:30px;text-align:center;max-width:90%;min-width:350px;color:#fff;box-shadow:0 4px 20px #0006;font-family:Arial,sans-serif}.word-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.card1[_ngcontent-%COMP%]{width:50px;height:60px;background-color:#1da1f2;color:#fff;display:flex;justify-content:center;align-items:center;font-size:36px;font-weight:700;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform-style:preserve-3d;opacity:0;transition:opacity .5s ease-out}.card1.visible[_ngcontent-%COMP%]{opacity:1}.ok-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px;font-size:12px;border-radius:5px;cursor:pointer;margin-top:10px;transition:background-color .3s ease,transform .2s ease}.ok-button[_ngcontent-%COMP%]:hover{background-color:#45a049;transform:translateY(-3px)}.ok-button[_ngcontent-%COMP%]:active{transform:translateY(1px)}"]})),a})();var re=d(30617);let ae=(()=>{var s;class a{}return s=a,(0,i.Z)(a,"\u0275fac",function(t){return new(t||s)}),(0,i.Z)(a,"\u0275mod",e.oAB({type:s})),(0,i.Z)(a,"\u0275inj",e.cJS({imports:[f.UX,f.u5,F.ez,re.Ps,k.IJ,C.ef,A.Bz.forChild([{path:"",component:se}])]})),a})()},30175:(E,O,d)=>{d.d(O,{i:()=>e});var i=d(86656),y=d(69862),f=d(57337),S=d(26306),b=d(22096),Z=d(65879);let e=(()=>{var M;class P{constructor(v){(0,i.Z)(this,"http",void 0),this.http=v}mqtt(v){return console.log("environment.lambdaUrl :>> ",f.N.lambdaUrl),this.http.post(`${f.N.lambdaUrl}`,v)}getLatestData2(v){return console.log(new Date),console.log("getLatestData2"),this.http.post("https://37iltjrp70.execute-api.ap-south-1.amazonaws.com/test/?doAuth=secretKey",v).pipe((0,S.K)(T=>(console.error(T),(0,b.of)({error:T}))))}getDeviceList(v){const D=v?.filter((L,C,U)=>C===U?.findIndex(I=>I?.PK===L?.PK));console.log(D);const T={type:"batchGet",table_name:"device_configuration",keys:D};console.log("postData postDatapostDatapostData",T);const A=(new y.WM).set("Content-Type","application/json");return this.http.post("https://fy1sd9sosb.execute-api.ap-south-1.amazonaws.com/firststage/dynamic_dynamoDB_crud",T,{headers:A})}getRDT(v){const D=(new y.WM).set("Content-Type","application/json");return this.http.post("https://fy1sd9sosb.execute-api.ap-south-1.amazonaws.com/firststage/dynamic_dynamoDB_crud",v,{headers:D})}}return M=P,(0,i.Z)(P,"\u0275fac",function(v){return new(v||M)(Z.LFG(y.eN))}),(0,i.Z)(P,"\u0275prov",Z.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"})),P})()}}]);