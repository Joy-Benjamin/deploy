"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[8122],{78122:(Y,M,h)=>{h.r(M),h.d(M,{Diagnostics2Module:()=>Ae});var d=h(86656),N=h(64190),x=h(56223),T=h(96814),O=h(30617),L=h(14934),D=h(15861),U=h(16676),y=h.n(U),I=h(69025),b=h(13519),C=h.n(b),e=h(65879),P=h(88672),q=h(5588),S=h(31552),k=h(30175),J=h(74260),Q=h(16519);const F=["gmap"];function B(r,g){if(1&r){const n=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return i.AddAllnodes(),e.KtG(i.showSpinner())}),e._UZ(1,"i",44),e.qZA()}if(2&r){const n=e.oxw();e.Q6J("disabled",0==n.deviceLength)}}function z(r,g){if(1&r&&(e.TgZ(0,"div")(1,"p",47),e._uU(2),e.qZA()()),2&r){const n=g.$implicit;e.xp6(2),e.hij("",n,",")}}function R(r,g){if(1&r&&(e.TgZ(0,"div",45),e.YNc(1,z,3,1,"div",46),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.TotalDevice)}}function V(r,g){if(1&r&&(e.TgZ(0,"div")(1,"p",47),e._uU(2),e.qZA()()),2&r){const n=g.$implicit;e.xp6(2),e.hij("",n,",")}}function H(r,g){if(1&r&&(e.TgZ(0,"div",45),e.YNc(1,V,3,1,"div",46),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.ComOkDevice)}}function G(r,g){if(1&r&&(e.TgZ(0,"div")(1,"p",47),e._uU(2),e.qZA()()),2&r){const n=g.$implicit;e.xp6(2),e.hij("",n,",")}}function j(r,g){if(1&r&&(e.TgZ(0,"div",45),e.YNc(1,G,3,1,"div",46),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.TimeoutDevice)}}const w=function(r){return{active:r}};function W(r,g){if(1&r){const n=e.EpF();e.TgZ(0,"div",48)(1,"div")(2,"div",49),e._UZ(3,"table",50),e.qZA()(),e.TgZ(4,"div",51)(5,"ul",52)(6,"li",53)(7,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("communication"))}),e._uU(8,"Communication"),e._UZ(9,"i",55),e.qZA()(),e.TgZ(10,"li",53)(11,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("configuration"))}),e._uU(12,"Configuration"),e._UZ(13,"i",56),e.qZA()(),e.TgZ(14,"li",53)(15,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("other-settings-1"))}),e._uU(16,"Other Settings"),e._UZ(17,"i",57),e.qZA()(),e.TgZ(18,"li",53)(19,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("other-settings-2"))}),e._uU(20,"Schedule"),e._UZ(21,"i",58),e.qZA()(),e.TgZ(22,"li",53)(23,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("other-settings-3"))}),e._uU(24,"Alert Configuration"),e._UZ(25,"i",59),e.qZA()(),e.TgZ(26,"li",53)(27,"a",54),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.showContent("location-maps"))}),e._uU(28,"Maps"),e._UZ(29,"i",60),e.qZA()()()()()}if(2&r){const n=e.oxw();e.xp6(7),e.Q6J("ngClass",e.VKq(6,w,"communication"===n.selectedContent)),e.xp6(4),e.Q6J("ngClass",e.VKq(8,w,"configuration"===n.selectedContent)),e.xp6(4),e.Q6J("ngClass",e.VKq(10,w,"other-settings-1"===n.selectedContent)),e.xp6(4),e.Q6J("ngClass",e.VKq(12,w,"other-settings-2"===n.selectedContent)),e.xp6(4),e.Q6J("ngClass",e.VKq(14,w,"other-settings-3"===n.selectedContent)),e.xp6(4),e.Q6J("ngClass",e.VKq(16,w,"location-maps"===n.selectedContent))}}function X(r,g){1&r&&e._UZ(0,"div",61,62)}const K=function(r){return{color:r}};function ee(r,g){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td",67),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA()()),2&r){const n=g.$implicit;let t;e.xp6(2),e.Oqu(n.No),e.xp6(2),e.Oqu(n.MN),e.xp6(2),e.Oqu(n.Label),e.xp6(2),e.Oqu(n.CS),e.xp6(2),e.Oqu(n.UI),e.xp6(2),e.Oqu(n.UD),e.xp6(2),e.Oqu(n.DT),e.xp6(1),e.Q6J("ngStyle",e.VKq(11,K,"0:No Error"!==n.errorCode?"red":"green")),e.xp6(1),e.hij(" ",n.errorCode," "),e.xp6(2),e.Oqu(n.LC||"No Data"),e.xp6(2),e.Oqu(null!==(t=n.PT)&&void 0!==t?t:"0s")}}function te(r,g){if(1&r&&(e.TgZ(0,"div",49)(1,"table",66)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"No."),e.qZA(),e.TgZ(6,"th"),e._uU(7,"MN"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Label"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"CS/SD/NSS/MI"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"UI"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"UD"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Date"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Error Code"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Last Communicated"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"Publish Frequency"),e.qZA()()(),e.TgZ(24,"tbody"),e.YNc(25,ee,21,13,"tr",46),e.qZA()()()),2&r){const n=e.oxw(2);e.xp6(25),e.Q6J("ngForOf",n.coummArray)}}function ie(r,g){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",67),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA()()),2&r){const n=g.$implicit,t=g.index;e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Oqu(n.MN),e.xp6(2),e.Oqu(n.rdt),e.xp6(1),e.Q6J("ngStyle",e.VKq(8,K,n.minLength.split("/")[0]==n.minLength.split("/")[1]?"green":"red")),e.xp6(1),e.hij(" ",n.minLength," "),e.xp6(2),e.Oqu(n.wdt),e.xp6(2),e.Oqu(n.dashboard),e.xp6(2),e.Oqu(n.created)}}function oe(r,g){if(1&r&&(e.TgZ(0,"div")(1,"div",49)(2,"table",68)(3,"thead")(4,"tr")(5,"th"),e._uU(6,"No."),e.qZA(),e.TgZ(7,"th"),e._uU(8,"MN/Label"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Reading Device Type"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Length Conf/Recv"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Writing Device Type"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Dashboard Type"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Data Created/Updated"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,ie,15,10,"tr",46),e.qZA()()()()),2&r){const n=e.oxw(2);e.xp6(20),e.Q6J("ngForOf",n.configArray)}}function ne(r,g){1&r&&(e.TgZ(0,"span",72),e._UZ(1,"i",73),e.qZA())}function ae(r,g){1&r&&(e.TgZ(0,"span",74),e._UZ(1,"i",75),e.qZA())}function se(r,g){1&r&&(e.TgZ(0,"span",72),e._UZ(1,"i",73),e.qZA())}function re(r,g){1&r&&(e.TgZ(0,"span",74),e._UZ(1,"i",75),e.qZA())}function le(r,g){1&r&&(e.TgZ(0,"span",72),e._UZ(1,"i",73),e.qZA())}function ce(r,g){1&r&&(e.TgZ(0,"span",74),e._UZ(1,"i",75),e.qZA())}function de(r,g){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.YNc(4,ne,2,0,"span",70),e.YNc(5,ae,2,0,"span",71),e.qZA(),e.TgZ(6,"td"),e.YNc(7,se,2,0,"span",70),e.YNc(8,re,2,0,"span",71),e.qZA(),e.TgZ(9,"td"),e.YNc(10,le,2,0,"span",70),e.YNc(11,ce,2,0,"span",71),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.qZA()()),2&r){const n=g.$implicit,t=g.index;e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Q6J("ngIf",n.scaling),e.xp6(1),e.Q6J("ngIf",!n.scaling),e.xp6(2),e.Q6J("ngIf",n.mxC),e.xp6(1),e.Q6J("ngIf",!n.mxC),e.xp6(2),e.Q6J("ngIf",n.alerts),e.xp6(1),e.Q6J("ngIf",!n.alerts),e.xp6(2),e.Oqu(n.latitude),e.xp6(2),e.Oqu(n.longitude),e.xp6(2),e.Oqu(n.companyID),e.xp6(2),e.Oqu(n.mqtt)}}function me(r,g){if(1&r&&(e.TgZ(0,"div")(1,"div",49)(2,"table",69)(3,"thead")(4,"tr")(5,"th"),e._uU(6,"No."),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Schedule Type"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"mX+c"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Alerts"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Latitude"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Longitude"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Company ID"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"MQTT Ch"),e.qZA()()(),e.TgZ(21,"tbody"),e.YNc(22,de,20,11,"tr",46),e.qZA()()()()),2&r){const n=e.oxw(2);e.xp6(22),e.Q6J("ngForOf",n.othersett1)}}function pe(r,g){1&r&&(e.TgZ(0,"span",72),e._UZ(1,"i",73),e.qZA())}function ge(r,g){1&r&&(e.TgZ(0,"span",74),e._UZ(1,"i",75),e.qZA())}function ue(r,g){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,pe,2,0,"span",70),e.YNc(7,ge,2,0,"span",71),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()()),2&r){const n=g.$implicit,t=g.index;e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Oqu(n.desc),e.xp6(2),e.Q6J("ngIf",n.enable),e.xp6(1),e.Q6J("ngIf",!n.enable),e.xp6(2),e.Oqu(n.schedule_id),e.xp6(2),e.Oqu(n.schedule_month),e.xp6(2),e.Oqu(n.updated)}}function _e(r,g){if(1&r&&(e.TgZ(0,"div")(1,"div",49)(2,"table",76)(3,"thead")(4,"tr")(5,"th"),e._uU(6,"No"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Unifier MAC ID"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Device Enable"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Operation Schedule ID"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Schedule Month Generation Day"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Configuration Updated"),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,ue,14,7,"tr",46),e.qZA()()()()),2&r){const n=e.oxw(2);e.xp6(18),e.Q6J("ngForOf",n.othersett2)}}function he(r,g){if(1&r&&(e.TgZ(0,"h6"),e._uU(1),e.qZA()),2&r){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.MN)}}function fe(r,g){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA()()),2&r){const n=g.$implicit,t=g.index;e.xp6(2),e.Oqu(t+1),e.xp6(2),e.Oqu(n.alert_variabletype),e.xp6(2),e.Oqu(n.parameterID1),e.xp6(2),e.Oqu(n.parameterID2?n.parameterID2:"N/A"),e.xp6(2),e.Oqu(n.equTextarea),e.xp6(2),e.Oqu(n.alert_datatype),e.xp6(2),e.Oqu(n.operator),e.xp6(2),e.Oqu(n.operator_value),e.xp6(2),e.Oqu(n.severity)}}function ve(r,g){if(1&r&&(e.TgZ(0,"table",78)(1,"thead")(2,"tr")(3,"th"),e._uU(4,"No"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Variable Type"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Parameter ID1"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Parameter ID2"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Equation Text"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Data Type"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Operator"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Operator Value"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Severity"),e.qZA()()(),e.TgZ(21,"tbody"),e.YNc(22,fe,19,9,"tr",46),e.qZA()()),2&r){const n=e.oxw().$implicit;e.xp6(22),e.Q6J("ngForOf",n.alerts)}}function be(r,g){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,he,2,1,"h6",64),e.YNc(2,ve,23,1,"table",77),e.qZA()),2&r){const n=g.$implicit;e.xp6(1),e.Q6J("ngIf",null!=n.alerts||null!=n.alerts),e.xp6(1),e.Q6J("ngIf",null!=n.alerts||null!=n.alerts)}}function Ze(r,g){if(1&r&&(e.TgZ(0,"div")(1,"div",49),e.YNc(2,be,3,2,"div",46),e.qZA()()),2&r){const n=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",n.othersett3)}}function xe(r,g){1&r&&e._UZ(0,"div",79)}function De(r,g){if(1&r&&(e.TgZ(0,"div",6),e.YNc(1,te,26,1,"div",63),e.YNc(2,oe,21,1,"div",64),e.YNc(3,me,23,1,"div",64),e.YNc(4,_e,19,1,"div",64),e.YNc(5,Ze,3,1,"div",64),e.YNc(6,xe,1,0,"div",65),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf","communication"===n.selectedContent),e.xp6(1),e.Q6J("ngIf","configuration"===n.selectedContent),e.xp6(1),e.Q6J("ngIf","other-settings-1"===n.selectedContent),e.xp6(1),e.Q6J("ngIf","other-settings-2"===n.selectedContent),e.xp6(1),e.Q6J("ngIf","other-settings-3"===n.selectedContent),e.xp6(1),e.Q6J("ngIf","location-maps"===n.selectedContent)}}let Te=(()=>{var r;class g{constructor(t,i,c,o,m,a,s,l,u,p,f,v,Z){(0,d.Z)(this,"spinner",void 0),(0,d.Z)(this,"datePipe",void 0),(0,d.Z)(this,"getdiagnostics",void 0),(0,d.Z)(this,"router",void 0),(0,d.Z)(this,"location",void 0),(0,d.Z)(this,"cdr",void 0),(0,d.Z)(this,"formBuilder",void 0),(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"lambdatapi",void 0),(0,d.Z)(this,"getPowerBoard",void 0),(0,d.Z)(this,"rdtConfig",void 0),(0,d.Z)(this,"locationPermissionService",void 0),(0,d.Z)(this,"auditTrialServices",void 0),(0,d.Z)(this,"gmap",void 0),(0,d.Z)(this,"infoWindow",void 0),(0,d.Z)(this,"myForm",void 0),(0,d.Z)(this,"enableLocationButton",!1),(0,d.Z)(this,"getLoggedUser",void 0),(0,d.Z)(this,"allPermissions_user",void 0),(0,d.Z)(this,"SK_clientID",void 0),(0,d.Z)(this,"hidingLink",void 0),(0,d.Z)(this,"hideDeleteButton",void 0),(0,d.Z)(this,"user_companyID",void 0),(0,d.Z)(this,"temp",void 0),(0,d.Z)(this,"extractDevices",[]),(0,d.Z)(this,"confirmedDevice",void 0),(0,d.Z)(this,"parentID_selected_node",void 0),(0,d.Z)(this,"final_list",void 0),(0,d.Z)(this,"combineMnDevList",void 0),(0,d.Z)(this,"delay",void 0),(0,d.Z)(this,"devices",void 0),(0,d.Z)(this,"deviceLength",0),(0,d.Z)(this,"parametersList",[]),(0,d.Z)(this,"userName",void 0),(0,d.Z)(this,"Live_Data",void 0),(0,d.Z)(this,"deviceTimeout",0),(0,d.Z)(this,"deviceComOK",0),(0,d.Z)(this,"currentInfoWindow",null),(0,d.Z)(this,"multiselect",!1),(0,d.Z)(this,"live_result_data",void 0),(0,d.Z)(this,"final_live_device_data",[]),(0,d.Z)(this,"All_RDTS_Configration",[]),(0,d.Z)(this,"tempParameterLabel",void 0),(0,d.Z)(this,"table",void 0),(0,d.Z)(this,"maxDevice",void 0),(0,d.Z)(this,"dataTableInstances",[]),(0,d.Z)(this,"coummArray",[]),(0,d.Z)(this,"Historial_data",void 0),(0,d.Z)(this,"configArray",[]),(0,d.Z)(this,"temp_total_live_parameters",[]),(0,d.Z)(this,"othersett1",[]),(0,d.Z)(this,"othersett2",[]),(0,d.Z)(this,"othersett3",[]),(0,d.Z)(this,"intervalId",void 0),(0,d.Z)(this,"relativeDifference",void 0),(0,d.Z)(this,"previousArrayLength",void 0),(0,d.Z)(this,"observer",void 0),(0,d.Z)(this,"saveState",void 0),(0,d.Z)(this,"map",void 0),(0,d.Z)(this,"markers",[]),(0,d.Z)(this,"TimeoutDevice",[]),(0,d.Z)(this,"ComOkDevice",[]),(0,d.Z)(this,"rowArray",[]),(0,d.Z)(this,"TotalDevice",[]),(0,d.Z)(this,"All_Devices_Configuration",[]),(0,d.Z)(this,"parametersTempList",[]),(0,d.Z)(this,"selectedContent",null),this.spinner=t,this.datePipe=i,this.getdiagnostics=c,this.router=o,this.location=m,this.cdr=a,this.formBuilder=s,this.api=l,this.lambdatapi=u,this.getPowerBoard=p,this.rdtConfig=f,this.locationPermissionService=v,this.auditTrialServices=Z}ngDoCheck(){this.coummArray.length!==this.previousArrayLength&&(console.log("Array length changed:",this.coummArray.length),this.startInterval(),this.previousArrayLength=this.coummArray.length)}ngOnInit(){this.getLoggedUser=this.getdiagnostics.getLoggedUserDetails(),this.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.user_companyID=this.getLoggedUser.attributes["custom:companyID"],this.userName=this.getLoggedUser.attributes["custom:username"],this.getLocationTree(),this.myForm=this.formBuilder.group({enablemultiselect:[!1]}),this.auditTrialServices.audit_trail("2.1","Diagnostics","Page Load","Diagnostics Page Loaded","1"),this.cdr.detectChanges()}showContent(t){this.selectedContent=t,this.cdr.detectChanges(),"location-maps"==this.selectedContent&&this.confirmedDevice&&(this.initMap(),this.addMarkers())}getLocationTree(){var t=this;return(0,D.Z)(function*(){const i=yield t.locationPermissionService.fetchGlobalLocationTree();if(!i)throw new Error("No data returned");t.temp=i,console.log("Data from location:",i),console.log("Data from location",t.temp),t.createJSTree(t.temp),console.log("this.tempthis.temp",t.temp);for(let c=0;c<t.temp.length;c++)"device"===t.temp[c].node_type&&(Array.isArray(t.temp[c].text)&&(t.temp[c].text=t.temp[c].text[0]),t.extractDevices.push({mn:t.temp[c].mn,label:t.temp[c].text+"-"+t.temp[c].mn}));console.log("ExtractDevice",t.extractDevices)})()}checkPermission(){let t=!1,i=!1;for(let c=0;c<this.allPermissions_user.length;c++)"Diagnostics - Update"===this.allPermissions_user[c]?(t=!0,this.hidingLink=t,console.log("CHECK PERMISSION hasDeviceUpdate",t)):"Diagnostics - View"===this.allPermissions_user[c]&&(i=!0,console.log("CHECK PERMISSION hasDeviceViewhasDeviceView",i));t&&i||t?this.hideDeleteButton=!0:i?this.hideDeleteButton=!1:(console.log("CHECK PERMISSION hasDeviceUpdate",t),this.router.navigate(["/404"]))}toggleMultiSelect(t){this.multiselect=t.target.checked,$("#MultiJSTree_diagnostics").jstree(!0).settings.core.multiple=this.multiselect,$("#MultiJSTree_diagnostics").jstree(!0).refresh()}createJSTree(t){$("#MultiJSTree_diagnostics").jstree({core:{check_callback:!0,data:t,multiple:!0},search:{show_only_matches:!0},plugins:["contextmenu","dnd","search","checkbox"],contextmenu:{items:function(o){let m=$("#MultiJSTree_diagnostics").jstree(!0);return{submenu:{Child:{seperator_before:!1,seperator_after:!1,label:"Child",action:function(a){m.get_selected().forEach(l=>{let u=m.create_node(l,{text:"New Child",type:"file",icon:"glyphicon glyphicon-file"});m.deselect_node(l),m.select_node(u)})}},Parent:{seperator_before:!1,seperator_after:!1,label:"Parent",action:function(a){m.get_selected().forEach(l=>{let u=m.create_node(l,{text:"New Parent",type:"default"});m.deselect_node(l),m.select_node(u)})}}},Rename:{separator_before:!1,separator_after:!1,label:"Edit Location",action:function(a){m.get_selected().forEach(l=>{m.edit(l)})}},Remove:{separator_before:!1,separator_after:!1,label:"Remove Location",action:function(a){m.get_selected().forEach(l=>{m.delete_node(l)})}}}}}}).on("changed.jstree",(o,m)=>{let a=m.instance.get_selected();if(a.length>0){let s=m.instance.get_node(a[0]);if(s&&s.text){this.parentID_selected_node=s.parent,this.final_list=a.map(p=>m.instance.get_node(p)),console.log("chk this.final_list",this.final_list);const l=this.final_list.filter(p=>p.original&&"device"===p.original.node_type).map(p=>p.original.mn),u=this.final_list.filter(p=>p.original&&"device"===p.original.node_type).map(p=>p.original.text);this.combineMnDevList={},l.forEach((p,f)=>{this.combineMnDevList[p]=u[f]}),console.log(this.combineMnDevList),console.log(Object.keys(this.combineMnDevList).length),this.delay=Object.keys(this.combineMnDevList).length,this.devices=l,this.devices=Array.from(new Set(this.devices)),this.enableLocationButton=this.final_list.some(p=>void 0!==p.original)}else this.enableLocationButton=!1}else this.enableLocationButton=!1;this.cdr.detectChanges()}),$("#search").keyup(()=>{var o=$("#search").val();$("#MultiJSTree_diagnostics").jstree(!0).search(o)})}getLivePackets(t){var i=this;return(0,D.Z)(function*(){return new Promise((c,o)=>{let m=[];for(let s of t)m.push("MN#"+s+"#TD");console.log("All devices Data :",m),i.lambdatapi.getLatestData2({messageID:12345,type:"deviceDataLatestTable",MN:m,username:i.userName,clientID:i.SK_clientID,key:"sampleKeyExample"}).subscribe({next:s=>{let l=JSON.parse(JSON.stringify(s));if(console.log("data live data1232 :>> ",l),i.Live_Data=l?.data,!i.Live_Data)return i.spinner.hide(),C().fire({title:"No Data Found",text:`It seems that there is no data available for the selected devices ${t}.`,icon:"info",confirmButtonText:"Okay",background:"#f9f9f9"});i.Live_Data=i.Live_Data.filter(u=>u.client.trim()==i.SK_clientID.trim()),c(i.Live_Data)},error:s=>{console.error("getLatestData2 error",s),o(s)}})})})()}getPublishTime(t){var i=this;return(0,D.Z)(function*(){return new Promise((c,o)=>{const m=new Date,a=i.datePipe.transform(new Date,"yyyy-MM-dd'T'HH:mm"),s=i.datePipe.transform(m,"yyyy-MM-dd'T'00:00");let l={messageID:12345,type:"historicalDeviceLatest",MN:["MN#"+t+"#TD"],username:i.userName,clientID:i.SK_clientID,key:"sampleKeyExample",limit:2,end_time:a,start_time:s};console.log("Historical Data request packet is ",l),i.lambdatapi.getLatestData2(l).subscribe({next:u=>{let p=JSON.parse(JSON.stringify(u));console.log("Historical data is :>> ",p),i.Historial_data=p?.data,c(i.Historial_data)},error:u=>{console.error("getLatestData2 error",u),o(u)}})})})()}filterPackets(t){var i=this;return(0,D.Z)(function*(){console.log("Live data is",JSON.parse(JSON.stringify(i.Live_Data))),console.log("Parameters List is ",t),i.live_result_data=[],i.final_live_device_data=[];let c=0;i.maxDevice="";const o=[],m=i.parametersList.findIndex(s=>s.deviceName===i.maxDevice);console.log("Max index is ",m);for(let s=0;s<i.parametersList.length;s++){const l=i.parametersList[s];console.log("Parameters are here ",l);const u=[];l.parameters.length>c&&(c=l.parameters.length,i.maxDevice=l.deviceName);const f=l.parameters.map(function(){var v=(0,D.Z)(function*(Z,_){let A=yield i.fetchLiveData(l.deviceName,_,"processDisplayValue");console.log("Live number is here ",A),A=A??"No Data",u.push({parameterName:Z,values:A,parameterID:l.parametersIDs[_]}),i.rowArray.push({deviceName:l.deviceName,parameterName:Z,values:A})});return function(Z,_){return v.apply(this,arguments)}}());o.push(Promise.all(f).then(()=>{const v=i.Live_Data&&i.Live_Data.find(Z=>Z.MN==l.deviceName);i.coummArray.push({No:s+1,MN:l.deviceName,Label:l.response.mn_label}),i.final_live_device_data.push({deviceName:l.deviceName,Label:l.Label,parameters:u,packetsRec:v&&v.MM?Object.keys(v.MM).length:0,index:s})}))}yield Promise.all(o);const a=i.coummArray.map(function(){var s=(0,D.Z)(function*(l){const u=i.Live_Data.findIndex(p=>p.MN===l.MN);if(-1!==u){const p=i.Live_Data[u];if(l.CS=`${p.CS??""}/${p.SD}/${p.NSS??""}/${p.MI}`,l.UI=p.UI,l.UD=p.UD,l.epoch=p.DT,l.DT=i.datePipe.transform(new Date(1e3*p.DT-198e5),"dd.MM.yyyy HH:mm:ss"),l.errorCode=0===p.errorCode?p.errorCode+":No Error":1===p.errorCode?p.errorCode+":Unconfigured Device":2===p.errorCode?p.errorCode+":Unconfigured RDT":3===p.errorCode?p.errorCode+":DL Mismatch":"",l.numberPackets=Object.keys(p.MM).length,yield i.getPublishTime(l.MN),i.Historial_data&&2===i.Historial_data.length){const f=Math.abs(i.Historial_data[0].SK-i.Historial_data[1].SK);if(f<60)l.PT=`${f} s`;else{const v=Math.round(f/60);l.PT=`${v} m`}}l.LC=i.getTimeDifference(p.DT)}});return function(l){return s.apply(this,arguments)}}());yield Promise.all(a),i.coummArray.forEach(s=>{const l=i.othersett1.find(u=>u.MN===s.MN);l&&(s.latitude=parseFloat(l.latitude),s.longitude=parseFloat(l.longitude))}),i.coummArray=i.coummArray.filter((s,l,u)=>l===u.findIndex(p=>p.No===s.No&&p.MN===s.MN&&p.Label===s.Label&&p.CS===s.CS&&p.UI===s.UI&&p.UD===s.UD&&p.DT===s.DT&&p.PT===s.PT&&p.LC===s.LC&&p.epoch===s.epoch)),i.configArray.sort((s,l)=>i.devices.indexOf(s.MN)-i.devices.indexOf(l.MN)),i.final_live_device_data.sort((s,l)=>i.devices.indexOf(s.deviceName)-i.devices.indexOf(l.deviceName)),console.log("configuration array is",i.configArray),console.log("Communication array is",i.coummArray),console.log("Final data to be displayed :",i.final_live_device_data),console.log("Final row data to be added ",i.rowArray),i.cdr.detectChanges()})()}calculateTimediff(t,i){if("epoch"==i){const c=1e3*t,o=y()(),m=y()(c),a=y().duration(o.diff(m)),s=this.formatDuration(a);return console.log("Relative Difference:",s),s}}formatDuration(t){const i=t.days(),c=t.hours(),o=t.minutes();console.log("days",i),console.log("hours",c),console.log("minutes",o);let m="";return i>0?m+=`${i} days ago`:c>0?m+=`${c} hours ago`:o>0&&(m+=`${o} minutes ago`),""===m&&(m="Just now"),m.trim()}initializeDataTable(){const i=this.preprocessData().data;console.log("Data is here:",i);let o=[{title:"Sl. No",data:"S/N",className:"text-center"}];const m=this.sortSecondArrayByFirst(this.parametersList,this.coummArray);console.log("After sort packet array is:",m);for(let a=0;a<m.length;a++)this.coummArray[a]&&this.coummArray[a].LC&&"minutes"==this.coummArray[a].LC.split(" ")[1]?(o.push({title:`${this.coummArray[a].Label}<i class="text-navy fa fa-rss m-1" style="color:green"></i>`,data:this.coummArray[a].MN,className:"text-start"}),o.push({title:'<span style="color:#777;font-weight:bolder;">Values</span>',data:`Values${a}`,render:function(s,l,u){return'<span style="color:#777;font-weight:bolder;">'+s+"</span>"},className:"text-end"})):this.coummArray[a]&&null==this.coummArray[a].LC?(o.push({title:this.coummArray[a].Label,data:this.coummArray[a].MN,className:"text-start"}),o.push({title:'<span style="color:#777;font-weight:bolder;">Values</span>',data:`Values${a}`,render:function(s,l,u){return'<span style="color:#777;font-weight:bolder;">'+s+"</span>"},className:"text-end"})):(o.push({title:`${this.coummArray[a].Label}<i class="bi bi-exclamation-triangle-fill m-1 animation-blink" style="color:red"></i>`,data:this.coummArray[a].MN,className:"text-right"}),o.push({title:'<span style="color:#777;font-weight:bolder;">Values</span>',data:`Values${a}`,render:function(s,l,u){return'<span style="color:#777;font-weight:bolder;">'+s+"</span>"},className:"text-end"}));console.log("Columns row is ",o),console.log("Data is ",i),console.log("table heading is :",o),this.reinitializeDataTable(o,i),this.spinner.hide()}sortSecondArrayByFirst(t,i){const c={};return t.forEach((o,m)=>{c[o.deviceName]=m}),i.sort((o,m)=>c[o.MN]-c[m.MN])}startInterval(){console.log("Inverval started bro:"),this.intervalId=setInterval(()=>{this.coummArray.forEach(t=>{t.LC=this.getTimeDifference(t.epoch),this.cdr.detectChanges(),console.log(this.coummArray)})},6e4)}getTimeDifference(t){if(isNaN(t))return"No Data";const c=Math.floor(Date.now()/1e3)+19800-t,o=Math.abs(Math.floor(c/60)),m=Math.floor(o/60),a=Math.floor(m/24),s=m%24,l=o%60;return a>0?`${a} days, ${s} hours, and ${l} minutes ago`:s>0?`${s} hours and ${l} minutes ago`:`${l} minutes ago`}ngOnDestroy(){this.clearInterval()}clearInterval(){this.intervalId&&(console.log("Interval Ended :"),clearInterval(this.intervalId))}preprocessData(){const i=new Set;this.final_live_device_data&&Array.isArray(this.final_live_device_data)&&this.final_live_device_data.forEach(a=>{a.deviceName&&a.parameters&&Array.isArray(a.parameters)&&i.add(a.deviceName)});let o=[];const m=this.final_live_device_data.findIndex(a=>a.deviceName===this.maxDevice);if(console.log("Max index is ",m),console.log("Final All the data is here ",this.final_live_device_data),this.final_live_device_data&&this.final_live_device_data[m]&&this.final_live_device_data[m].parameters)for(let a=0;a<this.final_live_device_data[m].parameters.length;a++){const s={};this.final_live_device_data.forEach(l=>{try{if(l&&l.parameters&&l.parameters[a]&&l.parameters[a].parameterName){const f=`\n          <span style="font-size: 14px; font-weight: bold;">${l.parameters[a].parameterName}</span>\n          <span style="font-size: 10px; color: #666;">${l.parameters[a].parameterID}</span>\n        `;s["S/N"]=a+1,s[l.deviceName]=f,s[`Values${l.index}`]=l.parameters[a].values}else s["S/N"]=a+1,s[l.deviceName]="",s[`Values${l.index}`]=""}catch(u){console.log(u)}}),o.push(s)}return console.log("Final Array Data ",o),{data:o,deviceNames:Array.from(i)}}reinitializeDataTable(t,i){console.log("Columns are :",t),console.log("Rows are :",i);const c={pagingType:"full_numbers",lengthChange:!1,responsive:!0,destroy:!0,dom:"Blfrtip",buttons:[{extend:"colvis",text:'<i class="bi bi-layout-text-sidebar-reverse"></i> Column Visibility',className:"btn-primary"},{extend:"copy",text:'<i class="bi bi-files"></i> Copy',className:"btn-primary",filename:"Diagnostics_Copy"},{extend:"print",text:'<i class="bi bi-printer"></i> Print',className:"btn-primary",filename:"Diagnostics_Print"},{extend:"excel",text:'<i class="bi bi-file-earmark-excel"></i> Excel',className:"btn-primary",filename:"Diagnostics_Excel"},{extend:"pdf",text:'<i class="bi bi-file-earmark-pdf"></i> PDF',className:"btn-primary",filename:"Diagnostics_PDF"},{extend:"csv",text:'<i class="bi bi-file-earmark-spreadsheet"></i> CSV',className:"btn-primary",filename:"Diagnostics_CSV"}],processing:!0,data:i,fixedHeader:!0,searching:!0,columns:t,scrollXinner:!0,columnDefs:[{targets:"_all",createdCell:function(m,a,s,l,u){$(m).css("min-width","200px")}},{targets:[0,1,2],createdCell:function(m,a,s,l,u){$(m).css("min-width","200px")}}],initComplete:function(m,a){$("#table_diagonis").wrap("<div style='overflow:auto; width:100%;position:relative;'></div>")}};this.dataTableInstances&&this.dataTableInstances[0]&&(console.log("Before Destroyed : ",this.dataTableInstances[0]),this.dataTableInstances[0].destroy(),console.log("Iam destroyed bro ",this.dataTableInstances[0]),$("#table_diagonis").empty());let o=this;$(document).ready(function(){o.dataTableInstances[0]=$("#table_diagonis").DataTable(c)}),console.log("Data table destroy ",this.dataTableInstances[0]),this.spinner.hide(),this.cdr.detectChanges()}refreshTable(){var t=this;return(0,D.Z)(function*(){t.deviceLength=t.devices.length;const i=performance.now();t.selectedContent="",t.confirmedDevice=!0,t.deviceComOK=0,t.deviceTimeout=0,t.coummArray=[],t.TotalDevice=[],t.othersett1=[],t.othersett2=[],t.othersett3=[],t.configArray=[],t.TimeoutDevice=[],t.ComOkDevice=[];try{t.spinner.show(),console.log("Starting getLivePackets()");const c=performance.now();yield t.getLivePackets(t.devices);const o=performance.now();console.log(`getLivePackets() took ${o-c} milliseconds`),console.log("Starting getDeviceConfig()");const m=performance.now();yield t.getDeviceConfig(t.devices),yield t.filterPackets(t.parametersList);const a=performance.now();console.log(`getDeviceConfig() took ${a-m} milliseconds`);const s=performance.now();for(let _ of t.coummArray)_&&_.LC&&("minutes"==_.LC.split(" ")[1]?(t.ComOkDevice.push(_.Label),t.TotalDevice.push(_.Label),t.deviceComOK+=1):(t.TimeoutDevice.push(_.Label),t.TotalDevice.push(_.Label),t.deviceTimeout+=1));const l=performance.now();console.log(`Processing coummArray took ${l-s} milliseconds`);const u=performance.now();for(let _=0;_<t.final_live_device_data.length;_++)t.configArray[_].minLength=t.final_live_device_data[_].parameters.length+"/"+t.final_live_device_data[_].packetsRec;const p=performance.now();console.log(`Processing configArray took ${p-u} milliseconds`),console.log("Initializing data table");const f=performance.now();t.initializeDataTable();const v=performance.now();console.log(`Initializing data table took ${v-f} milliseconds`),console.log(t.combineMnDevList),console.log("The devices Selected are:",t.devices),t.selectedContent="communication",t.cdr.detectChanges();const Z=performance.now();console.log(`Total execution time for AddAllnodes: ${(Z-i)/1e3} seconds`)}catch(c){console.error("Error in processing:",c)}finally{t.spinner.hide()}})()}showSpinner(){this.spinner.show()}AddAllnodes(){var t=this;return(0,D.Z)(function*(){t.deviceLength=t.devices.length;const i=performance.now();t.selectedContent="",t.confirmedDevice=!0,t.deviceComOK=0,t.deviceTimeout=0,t.coummArray=[],t.TotalDevice=[],t.othersett1=[],t.othersett2=[],t.othersett3=[],t.configArray=[],t.TimeoutDevice=[],t.ComOkDevice=[];try{t.auditTrialServices.audit_trail("2.1","Diagnostics","View",`Viewed diagnostics for ${Object.values(t.combineMnDevList).join()} device(s).`,t.devices.length),console.log("Starting getLivePackets()");const c=performance.now();t.getLivePackets(t.devices).then(()=>{const o=performance.now();console.log(`getLivePackets() took ${o-c} milliseconds`),console.log("Starting getDeviceConfig()");const m=performance.now();t.getDeviceConfig(t.devices).then(()=>{t.filterPackets(t.parametersList).then(()=>{const a=performance.now();console.log(`getDeviceConfig() took ${a-m} milliseconds`);const s=performance.now();for(let _ of t.coummArray)_&&_.LC&&("minutes"==_.LC.split(" ")[1]?(t.ComOkDevice.push(_.Label),t.TotalDevice.push(_.Label),t.deviceComOK=t.deviceComOK+1):(t.TimeoutDevice.push(_.Label),t.TotalDevice.push(_.Label),t.deviceTimeout=t.deviceTimeout+1));const l=performance.now();console.log(`Processing coummArray took ${l-s} milliseconds`);const u=performance.now();for(let _=0;_<t.final_live_device_data.length;_++)t.configArray[_].minLength=t.final_live_device_data[_].parameters.length+"/"+t.final_live_device_data[_].packetsRec;const p=performance.now();console.log(`Processing configArray took ${p-u} milliseconds`),console.log("Initializing data table");const f=performance.now();t.initializeDataTable();const v=performance.now();console.log(`Initializing data table took ${v-f} milliseconds`),console.log(t.combineMnDevList),console.log("The devices Selected are:",t.devices),t.selectedContent="communication",t.spinner.hide(),t.cdr.detectChanges();const Z=performance.now();console.log(`Total execution time for AddAllnodes: ${(Z-i)/1e3} seconds`)})}).catch(a=>{console.error("Error in getDeviceConfig:",a),t.spinner.hide()})}).catch(o=>{console.error("Error in getLivePackets:",o),t.spinner.hide()})}catch(c){console.error("Error in processing:",c),t.spinner.hide()}finally{t.spinner.hide()}})()}deselectAllNodes(){this.confirmedDevice=!1}fetchLiveData(t,i,c){console.warn(this.Live_Data);let o=null;for(let m=0;m<this.Live_Data?.length;m++){const a=this.Live_Data[m];let s="MN#"+t+"#TD",l=JSON.parse(JSON.stringify(a.MM));if(a&&a.PK===s){if(l&&null!=i){o=l["P"+(i+1)];break}o="No Data";break}}return o}getDeviceConfig(t){var i=this;return(0,D.Z)(function*(){i.parametersList=[],i.parametersTempList=[],i.othersett1=[],i.othersett2=[],i.othersett3=[],i.configArray=[];const c=[];if(console.log("Devices in sort are here ",t),Array.isArray(t)&&i.confirmedDevice&&i.devices.length>0){for(let o of i.devices)try{const m=performance.now(),a=yield i.api.GetDeviceConfiguration(o,i.SK_clientID);if(a){console.log("Data that is being coming from db",a);const s=yield i.api.GetReadingDeviceType(a.reading_device_type??"",i.SK_clientID);if(s){console.log("Given RDT is ",s);const l=JSON.parse(s.parameters);let u;null!=a.alerts_configured&&(u=JSON.parse(a.alerts_configured),u=i.manipulateAlerts(u));let p=[],f=[];console.log("All the parameters are parameterOBJ",l);for(let E of l)p.push(E.parameterLabel);for(let E of l)f.push(E.parameterID);i.parametersList.push({deviceName:a.PK,Label:a.mn_label,parameters:p,response:a,parametersIDs:f}),i.parametersTempList.push({deviceName:a.PK,Label:a.mn_label,parameters:p,response:a,parametersIDs:f}),c.push({deviceName:a.PK,parameters:p,response:a}),console.log("All the Actual parameters are ",i.parametersList);const Z=new Date(a.updatedTime??"").getTime()/1e3,_=i.calculateTimediff(Z,"epoch");i.configArray.push({MN:`${a.PK}/${a.mn_label}`,rdt:a.reading_device_type,wdt:a.writing_device_type,dashboard:s.dashboard_type,minLength:l.length+"/"+l.length,created:_}),i.othersett1.push({MN:a.PK,scaling:s.schedule_type,mxC:s.mxC,alerts:s.alerts,latitude:a.latitude,longitude:a.longitude,companyID:a.company_id,mqtt:a.reserved}),i.othersett2.push({desc:a.unifier_identifier,enable:a.enable_device,schedule_id:a.operational_hours,schedule_month:a.schedule_month_generation_day,updated:_}),i.othersett3.push({MN:`${a.mn_label}`,alerts:u,secondDevice:a.secondary_devices,primaryDevice:a.primary_devices});const A=performance.now();console.log(`Time for API call (GetReadingDeviceType): ${A-m} ms`),i.cdr.detectChanges()}}}catch(m){console.log("Cannot fetch Device:",m)}console.log("configuration array is ",i.configArray),console.log("Optional setting 1 are",i.othersett1),console.log("Additional Settings are",i.othersett2),console.log("Additional Settings2 are",i.othersett3)}})()}getDeviceBatch(){return new Promise((t,i)=>{let c=[...this.devices];const o=new Set,a={type:"batchGet",table_name:"device_configuration",keys:c.map(s=>o.has(s)?(console.warn(`Duplicate PK found: ${s}`),null):(o.add(s),{PK:s,SK:this.SK_clientID})).filter(s=>null!==s)};this.All_Devices_Configuration=[],this.rdtConfig.postData(a).subscribe({next:s=>{let l=s;for(let u=0;u<l.length;u++)this.All_Devices_Configuration.push({device:l[u].PK,others:l[u],rdt:l[u].reading_device_type});t()},error:s=>{console.error("Error rdt Batch:",s),i(s)}})})}manipulateAlerts(t){console.log("All the alerts are here :",t);let i=[],c="";for(let o=0;o<t.length;o++)"Constant"==t[o].alert_variabletype?(c=`${t[o].parameterID}:${t[o].operator}:${t[o].operator_value}:${t[o].alert_text_active}:${t[o].alert_text_closed}\n      ${t[o].alert_text_snoozed}:${t[o].severity}:${t[o].alert_variabletype}:${t[o].alert_datatype}`,i.push({parameterID1:t[o].parameterID,operator:t[o].operator,operator_value:t[o].operator_value,alert_text_active:t[o].alert_text_active,alert_text_closed:t[o].alert_text_closed,alert_text_snoozed:t[o].alert_text_snoozed,severity:t[o].severity,alert_variabletype:t[o].alert_variabletype,alert_datatype:t[o].alert_datatype})):"Parameter"==t[o].alert_variabletype?(c=`${t[o].parameterID1}:${t[o].parameterID2}:${t[o].operator}:${t[o].operator_value}:${t[o].alert_text_active}:${t[o].alert_text_closed}\n      ${t[o].alert_text_snoozed}:${t[o].severity}:${t[o].alert_variabletype}:${t[o].alert_datatype}`,i.push({parameterID1:t[o].parameterID1,parameterID2:t[o].parameterID2,operator:t[o].operator,operator_value:t[o].operator_value,alert_text_active:t[o].alert_text_active,alert_text_closed:t[o].alert_text_closed,alert_text_snoozed:t[o].alert_text_snoozed,severity:t[o].severity,alert_variabletype:t[o].alert_variabletype,alert_datatype:t[o].alert_datatype})):(c=`${t[o].equTextarea}:${t[o].operator}:${t[o].operator_value}:${t[o].alert_text_active}:${t[o].alert_text_closed}\n      ${t[o].alert_text_snoozed}:${t[o].severity}:${t[o].alert_variabletype}:${t[o].alert_datatype}`,i.push({equTextarea:t[o].equTextarea,operator:t[o].operator,operator_value:t[o].operator_value,alert_text_active:t[o].alert_text_active,alert_text_closed:t[o].alert_text_closed,alert_text_snoozed:t[o].alert_text_snoozed,severity:t[o].severity,alert_variabletype:t[o].alert_variabletype,alert_datatype:t[o].alert_datatype}));return i}initMap(){typeof google>"u"||typeof google.maps>"u"?console.error("Google Maps API not loaded."):(this.map=new google.maps.Map(this.gmap.nativeElement,{center:{lat:12.959227,lng:77.547899},zoom:10}),this.addMarkers())}addMarkers(){if(!this.map)return void console.error("Map not initialized.");this.markers.forEach(c=>c.setMap(null)),this.markers=[];const t=this.coummArray.map(c=>({lat:parseFloat(c.latitude),lng:parseFloat(c.longitude),deviceName:c.MN,lastCommunicated:c.LC}));console.log("The marker Datas are here :",t);const i=new google.maps.LatLngBounds;t.forEach((c,o)=>{let m="";m="string"==typeof c.lastCommunicated&&parseInt(c.lastCommunicated.split(" ")[0])<60?"https://maps.google.com/mapfiles/ms/icons/green-dot.png":"https://maps.google.com/mapfiles/ms/icons/red-dot.png";const a=new google.maps.Marker({position:{lat:c.lat,lng:c.lng},map:this.map,icon:{labelOrigin:new google.maps.Point(11,50),url:m}});a.addListener("click",()=>{this.openInfoWindow(a,c)}),this.markers.push(a),a.getPosition()&&i.extend(a.getPosition())}),this.markers.length>1?this.map.fitBounds(i):1===this.markers.length&&(this.map.setCenter(i.getCenter()),this.map.setZoom(10))}openInfoWindow(t,i){if(console.log("Opening info window for marker:",i),!i.deviceName||!i.lastCommunicated)return void console.error("Invalid marker info:",i);const c=`\n    <div style="padding:10px;">\n      <h4 style="color:#777;">${i.deviceName}</h4>\n      <p style="color:#777;">Last communicated: ${i.lastCommunicated}</p>\n    </div>\n  `,o=new google.maps.InfoWindow({content:c});this.currentInfoWindow&&this.currentInfoWindow.close(),this.currentInfoWindow=o,o.open(this.map,t),console.log("Info window content:",c)}}return r=g,(0,d.Z)(g,"\u0275fac",function(t){return new(t||r)(e.Y36(P.t2),e.Y36(T.uU),e.Y36(q.F),e.Y36(N.F0),e.Y36(q.F),e.Y36(e.sBO),e.Y36(x.qu),e.Y36(S.t),e.Y36(k.i),e.Y36(q.F),e.Y36(q.F),e.Y36(J.G),e.Y36(Q.C))}),(0,d.Z)(g,"\u0275cmp",e.Xpm({type:r,selectors:[["app-diagnostics2"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F,5),e.Gf(I.ch,5)),2&t){let c;e.iGM(c=e.CRH())&&(i.gmap=c.first),e.iGM(c=e.CRH())&&(i.infoWindow=c.first)}},features:[e._Bn([T.uU])],decls:69,vars:16,consts:[[1,"d-flex","flex-column","flex-column-fluid"],[1,"app-toolbar","py-3","py-lg-6"],[1,"app-container","container-fluid","d-flex","flex-stack"],[1,"page-title","d-flex","flex-wrap","me-3","flex-column","justify-content-center"],[1,"page-heading","d-flex","text-gray-900","fw-bold","fs-3","my-0","flex-column","justify-content-center"],[1,"card","card-custom"],[1,"card-body"],[3,"formGroup"],[1,"form-group","headercustom",2,"margin-top","10px","margin-bottom","10px"],[1,"status-date",2,"display","flex","align-items","center"],["type","button","title","Select Devices","data-bs-toggle","modal","placement","right","data-bs-target","#loactionDiagnostics",1,"btn","fw-bold","btn-primary","translatey",3,"click"],["type","button","class","btn-custom custom-button","ngbTooltip","Refresh",3,"disabled","click",4,"ngIf"],[1,"form-check","form-switch",2,"display","none"],["type","checkbox","formControlName","enablemultiselect","name","enablemultiselect",1,"form-check-input",3,"change"],["for","flexSwitchCheckDefault",1,"form-check-label"],[1,"customleftheader"],[2,"display","flex","flex-direction","column","align-items","center"],["type","button","popover-placement","bottom","triggers","click",1,"btn","btn-info","m-r-sm","ng-binding",2,"margin-left","5px","background-color","#23c6c8","cursor","pointer",3,"disabled","ngbPopover"],["p","ngbPopover"],["type","button","popover-placement","bottom","triggers","click",1,"btn","btn-info","m-r-sm","ng-binding",2,"margin-left","5px","background-color","#1ab394","cursor","pointer",3,"disabled","ngbPopover"],["type","button","popover-placement","bottom","triggers","click",1,"btn","btn-info","m-r-sm","ng-binding",2,"margin-left","5px","background-color","#ed5565","cursor","pointer",3,"disabled","ngbPopover"],["popoverTotal",""],["popoverComOK",""],["popoverTimeout",""],["class","card-body-custom pt-9 pb-0",4,"ngIf"],["class","card-body-map pt-9 pb-0",4,"ngIf"],["class","card-body",4,"ngIf"],["id","loactionDiagnostics",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content",2,"width","400px","transform","translate(30%, 0px)"],[1,"modal-header",2,"padding-bottom","15px"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"container"],["type","search","id","search","value","","placeholder","Search For Devices",1,"col-md-12","input",2,"margin","0em auto 1em auto","padding","4px","border-radius","4px","border","1px solid silver"],["id","MultiJSTree_diagnostics",1,"container","scroll-y","h-300px"],[1,"modal-footer"],[1,"row"],[1,"col-md-6"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-primary",3,"disabled","click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-danger"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],["type","button","ngbTooltip","Refresh",1,"btn-custom","custom-button",3,"disabled","click"],[1,"bi","bi-arrow-clockwise",2,"color","white","font-weight","bolder","font-size","large"],[2,"display","flex","flex-wrap","wrap"],[4,"ngFor","ngForOf"],[1,"form-check-label"],[1,"card-body-custom","pt-9","pb-0"],[1,"table-responsive"],["id","table_diagonis",1,"table","table-striped","table-bordered","table-hover",2,"width","100%"],[1,"d-flex","overflow-auto","h-55px"],[1,"nav","nav-stretch","nav-line-tabs","nav-line-tabs-2x","border-transparent","fs-5","fw-bolder","flex-nowrap"],[1,"nav-item"],[1,"nav-link","text-active-primary","me-6",2,"cursor","pointer",3,"ngClass","click"],[1,"bi","bi-reception-4","m-2"],[1,"fa","fa-gears","m-2"],[1,"bi","bi-gear-fill","m-1"],[1,"bi","bi-hourglass-split","fs-5","m-1"],[1,"bi","bi-bell-fill","m-1"],[1,"bi","bi-geo-alt-fill","m-1"],[1,"card-body-map","pt-9","pb-0"],["gmap",""],["class","table-responsive",4,"ngIf"],[4,"ngIf"],["class","maps-container",4,"ngIf"],["id","communication_table",1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],[3,"ngStyle"],["id","configuration_table",1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],["id","os_1_table",1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],["class","text-success",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-success"],[1,"fas","fa-check-circle",2,"color","green"],[1,"text-danger"],[1,"fas","fa-times-circle",2,"color","red"],["id","os_2_table",1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],["class","table table-striped table-bordered table-hover table-responsive-sm",4,"ngIf"],[1,"table","table-striped","table-bordered","table-hover","table-responsive-sm"],[1,"maps-container"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),e._uU(5,"Diagnostics"),e.qZA()()()()(),e.TgZ(6,"div",5)(7,"div",6)(8,"form",7)(9,"div",8)(10,"div",9)(11,"button",10),e.NdJ("click",function(){return i.deselectAllNodes()}),e._uU(12,"Location"),e.qZA(),e.YNc(13,B,2,1,"button",11),e.qZA(),e.TgZ(14,"div",12)(15,"input",13),e.NdJ("change",function(o){return i.toggleMultiSelect(o)}),e.qZA(),e.TgZ(16,"label",14),e._uU(17,"Multiselect Devices"),e.qZA()(),e.TgZ(18,"div",15)(19,"div",16)(20,"label",14),e._uU(21,"Total"),e.qZA(),e.TgZ(22,"button",17,18),e._uU(24),e.qZA()(),e.TgZ(25,"div",16)(26,"label",14),e._uU(27,"Com Ok"),e.qZA(),e.TgZ(28,"button",19,18),e._uU(30),e.qZA()(),e.TgZ(31,"div",16)(32,"label",14),e._uU(33,"Timeout"),e.qZA(),e.TgZ(34,"button",20,18),e._uU(36),e.qZA()()()(),e.YNc(37,R,2,1,"ng-template",null,21,e.W1O),e.YNc(39,H,2,1,"ng-template",null,22,e.W1O),e.YNc(41,j,2,1,"ng-template",null,23,e.W1O),e.YNc(43,W,30,18,"div",24),e.YNc(44,X,2,0,"div",25),e.YNc(45,De,7,6,"div",26),e.TgZ(46,"div",27)(47,"div",28)(48,"div",29)(49,"div",30)(50,"h2",31),e._uU(51," Location "),e.qZA(),e._UZ(52,"button",32),e.qZA(),e._UZ(53,"br"),e.TgZ(54,"div",33),e._UZ(55,"input",34),e.qZA(),e._UZ(56,"div",35),e.TgZ(57,"div",36)(58,"div",33)(59,"div",37)(60,"div",38)(61,"button",39),e.NdJ("click",function(){return i.AddAllnodes(),i.showSpinner()}),e._uU(62," Ok "),e.qZA(),e._uU(63," \xa0 "),e.TgZ(64,"button",40),e._uU(65," Cancel "),e.qZA()()()()()()()()()()(),e.TgZ(66,"ngx-spinner",41)(67,"p",42),e._uU(68,"Please wait Table is Loading... "),e.qZA()()),2&t){const c=e.MAs(38),o=e.MAs(40),m=e.MAs(42);e.xp6(8),e.Q6J("formGroup",i.myForm),e.xp6(5),e.Q6J("ngIf",i.deviceLength>0),e.xp6(9),e.Q6J("disabled",0==i.TotalDevice)("ngbPopover",c),e.xp6(2),e.Oqu(i.deviceLength),e.xp6(4),e.Q6J("disabled",0==i.ComOkDevice)("ngbPopover",o),e.xp6(2),e.Oqu(i.deviceComOK),e.xp6(4),e.Q6J("disabled",0==i.TimeoutDevice)("ngbPopover",m),e.xp6(2),e.Oqu(i.deviceTimeout),e.xp6(7),e.Q6J("ngIf",i.deviceLength>0),e.xp6(1),e.Q6J("ngIf","location-maps"==i.selectedContent),e.xp6(1),e.Q6J("ngIf",i.selectedContent),e.xp6(16),e.Q6J("disabled",!i.enableLocationButton),e.xp6(5),e.Q6J("fullScreen",!0)}},dependencies:[x._Y,x.Wl,x.JJ,x.JL,x.sg,x.u,T.mk,T.sg,T.O5,T.PC,L.o8,L._L,P.Ro],styles:[".card-custom[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:10px;margin:30px}.headercustom[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.customleftheader[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:4%}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.card-body-custom[_ngcontent-%COMP%]{padding:2%}.nav-link.active[_ngcontent-%COMP%]{font-weight:700;color:#333}.other-settings-3-container[_ngcontent-%COMP%]{margin-top:8px}.setting-item[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px;margin-bottom:10px;background-color:#f9f9f9;border-radius:5px}.setting-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:700;margin-bottom:5px}.setting-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:8px}#table_diagonis[_ngcontent-%COMP%]{width:100%;max-width:100%}.table-responsive[_ngcontent-%COMP%]{display:block;width:100%;overflow-x:auto}.maps-container[_ngcontent-%COMP%]{width:100%}.gmap[_ngcontent-%COMP%]{width:100%;border:1px solid #dee2e6;border-radius:10px;margin:30px}.card-body-map[_ngcontent-%COMP%]{margin-top:30px;border:1px solid white;border-radius:10px;height:500px}.status-date[_ngcontent-%COMP%]   .custom-button[_ngcontent-%COMP%]{margin-left:10px;border:none;background-color:#ffc107;color:#fff;border-radius:5px;font-weight:700;margin-top:2px;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;padding-top:5px;cursor:pointer;box-shadow:0 4px 8px #0000001a;transition:transform .3s,box-shadow .3s}.status-date[_ngcontent-%COMP%]   .custom-button[_ngcontent-%COMP%]:hover{color:#e0a800;transform:translateY(-2px);transform:translate(1px);transition:.8ms;box-shadow:0 6px 12px #000000e6}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.8ms}.status-date[_ngcontent-%COMP%]   .custom-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #0000001a}.nav-link[_ngcontent-%COMP%]:hover{color:var(--bs-primary)}@keyframes _ngcontent-%COMP%_blink{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.blink[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s infinite}.redColorText[_ngcontent-%COMP%]{color:red}"]})),g})();var ye=h(94955),Ce=h(40965);let Ae=(()=>{var r;class g{}return r=g,(0,d.Z)(g,"\u0275fac",function(t){return new(t||r)}),(0,d.Z)(g,"\u0275mod",e.oAB({type:r})),(0,d.Z)(g,"\u0275inj",e.cJS({imports:[x.UX,x.u5,T.ez,O.Ps,L.IJ,P.ef,N.Bz.forChild([{path:"",component:Te}]),ye.m,Ce.Q]})),g})()},30175:(Y,M,h)=>{h.d(M,{i:()=>D});var d=h(86656),N=h(69862),x=h(57337),T=h(26306),O=h(22096),L=h(65879);let D=(()=>{var U;class y{constructor(b){(0,d.Z)(this,"http",void 0),this.http=b}mqtt(b){return console.log("environment.lambdaUrl :>> ",x.N.lambdaUrl),this.http.post(`${x.N.lambdaUrl}`,b)}getLatestData2(b){return console.log(new Date),console.log("getLatestData2"),this.http.post("https://37iltjrp70.execute-api.ap-south-1.amazonaws.com/test/?doAuth=secretKey",b).pipe((0,T.K)(e=>(console.error(e),(0,O.of)({error:e}))))}getDeviceList(b){const C=b?.filter((q,S,k)=>S===k?.findIndex(J=>J?.PK===q?.PK));console.log(C);const e={type:"batchGet",table_name:"device_configuration",keys:C};console.log("postData postDatapostDatapostData",e);const P=(new N.WM).set("Content-Type","application/json");return this.http.post("https://fy1sd9sosb.execute-api.ap-south-1.amazonaws.com/firststage/dynamic_dynamoDB_crud",e,{headers:P})}getRDT(b){const C=(new N.WM).set("Content-Type","application/json");return this.http.post("https://fy1sd9sosb.execute-api.ap-south-1.amazonaws.com/firststage/dynamic_dynamoDB_crud",b,{headers:C})}}return U=y,(0,d.Z)(y,"\u0275fac",function(b){return new(b||U)(L.LFG(N.eN))}),(0,d.Z)(y,"\u0275prov",L.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"})),y})()}}]);