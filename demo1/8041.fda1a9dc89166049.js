"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[8041],{98041:(Lt,Q,x)=>{x.r(Q),x.d(Q,{ClientModule:()=>Pt});var d=x(86656),N=x(96814),B=x(22939),H=x(64190),y=x(15861),g=x(56223),ee=x(13519),T=x.n(ee),te=x(90775),Y=x.n(te),A=x(51333),M=x(22096),G=x(83620),R=x(37398),j=x(26306),ie=x(10708),O=x(69862),e=x(65879),L=x(14934);function ne(r,m){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.hij(" ",o.sortAsc?"\u25b2":"\u25bc"," ")}}function oe(r,m){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.hij(" ",o.sortAsc?"\u25b2":"\u25bc"," ")}}function le(r,m){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&r){const o=m.$implicit;e.xp6(2),e.Oqu(o.smsLimit),e.xp6(2),e.Oqu(o.updatedAt)}}function re(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",9)(1,"div",10),e._uU(2),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.prevPage())}),e._uU(4," \u2190 "),e.qZA(),e.TgZ(5,"span",12),e._uU(6),e.qZA(),e.TgZ(7,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.nextPage())}),e._uU(8," \u2192 "),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(2),e.AsE(" Showing ",o.paginatedData.length," of ",o.filteredUsers.length," records "),e.xp6(1),e.Q6J("disabled",1===o.currentPage),e.xp6(3),e.AsE("Page ",o.currentPage," of ",o.totalPages,""),e.xp6(1),e.Q6J("disabled",o.currentPage===o.totalPages)}}let ae=(()=>{var r;class m{constructor(i){(0,d.Z)(this,"modal",void 0),(0,d.Z)(this,"smsHistory",[]),(0,d.Z)(this,"clientID",void 0),(0,d.Z)(this,"searchText",""),(0,d.Z)(this,"filteredUsers",[]),(0,d.Z)(this,"paginatedData",[]),(0,d.Z)(this,"pageSize",10),(0,d.Z)(this,"currentPage",1),(0,d.Z)(this,"totalPages",1),(0,d.Z)(this,"sortField",""),(0,d.Z)(this,"sortAsc",!0),this.modal=i}ngOnInit(){this.smsHistory=this.smsHistory.map(i=>({smsLimit:i[0],updatedAt:i[1]})).reverse(),this.filteredUsers=[...this.smsHistory],this.updatePagination()}filterUsers(){const i=this.searchText.toLowerCase();this.filteredUsers=this.smsHistory.filter(t=>String(t.smsLimit).toLowerCase().includes(i)||String(t.updatedAt).toLowerCase().includes(i)),this.currentPage=1,this.updatePagination()}updatePagination(){this.totalPages=Math.max(Math.ceil(this.filteredUsers.length/this.pageSize),1);const i=(this.currentPage-1)*this.pageSize;this.paginatedData=this.filteredUsers.slice(i,i+this.pageSize)}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePagination())}prevPage(){this.currentPage>1&&(this.currentPage--,this.updatePagination())}sortData(i){this.sortField===i?this.sortAsc=!this.sortAsc:(this.sortField=i,this.sortAsc=!0),this.filteredUsers.sort((t,n)=>t[i]<n[i]?this.sortAsc?-1:1:t[i]>n[i]?this.sortAsc?1:-1:0),this.updatePagination()}}return r=m,(0,d.Z)(m,"\u0275fac",function(i){return new(i||r)(e.Y36(L.Kz))}),(0,d.Z)(m,"\u0275cmp",e.Xpm({type:r,selectors:[["app-sms-history"]],inputs:{smsHistory:"smsHistory",clientID:"clientID"},decls:19,vars:5,consts:[[1,"approval-history-header"],[1,"close-btn",3,"click"],[1,"card-body"],[1,"glass-card"],[1,"modern-table"],[3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","pagination-controls",4,"ngIf"],[1,"pagination-controls"],[1,"record-count"],[1,"arrow-btn",3,"disabled","click"],[1,"page-label"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return t.modal.close()}),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"div",2)(6,"div",3)(7,"table",4)(8,"thead")(9,"tr")(10,"th",5),e.NdJ("click",function(){return t.sortData("smsLimit")}),e._uU(11," SMS Limit "),e.YNc(12,ne,2,1,"span",6),e.qZA(),e.TgZ(13,"th",5),e.NdJ("click",function(){return t.sortData("updatedAt")}),e._uU(14," Updated Date and Time "),e.YNc(15,oe,2,1,"span",6),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,le,5,2,"tr",7),e.qZA()(),e.YNc(18,re,9,6,"div",8),e.qZA()()),2&i&&(e.xp6(2),e.hij("",t.clientID," SMS History"),e.xp6(10),e.Q6J("ngIf","smsLimit"===t.sortField),e.xp6(3),e.Q6J("ngIf","updatedAt"===t.sortField),e.xp6(2),e.Q6J("ngForOf",t.paginatedData),e.xp6(1),e.Q6J("ngIf",t.totalPages>1))},dependencies:[N.sg,N.O5],styles:[".approval-history-container[_ngcontent-%COMP%]{max-width:900px;margin:40px auto;padding:0 20px;font-family:Helvetica Neue,sans-serif}.approval-history-header[_ngcontent-%COMP%]{background:#2575fc;color:#fff;padding:16px 24px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;box-shadow:0 4px 8px #00000026}.approval-history-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:600;font-size:18px;color:#fff}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;color:#fff;cursor:pointer}.glass-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.8);border-radius:0 0 12px 12px;padding:0 0 10px;box-shadow:0 12px 24px #0000001a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);overflow-x:auto}.modern-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;text-align:center;color:#333}.modern-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f0f4ff}.modern-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px 16px;border-bottom:1px solid #e0e0e0;font-size:15px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#eef3ff;transition:background .2s ease-in-out}.pagination-controls[_ngcontent-%COMP%]{margin-top:15px;text-align:center}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px}.pagination-controls[_ngcontent-%COMP%]{margin-top:15px;text-align:center;display:flex;justify-content:center;align-items:center;gap:15px}.arrow-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 14px;border-radius:50%;font-size:15px;cursor:pointer;transition:background-color .2s ease}.arrow-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.arrow-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.page-label[_ngcontent-%COMP%]{font-weight:700;font-size:16px}th[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:5px;font-size:.8em}.search-bar[_ngcontent-%COMP%]{margin:20px 0;display:flex;justify-content:end}.search-input[_ngcontent-%COMP%]{width:25%;max-width:500px;padding:10px 15px;font-size:1rem;border:1px solid #ccc;border-radius:6px;transition:border-color .3s ease}.search-input[_ngcontent-%COMP%]:focus{border-color:#1b84ff;outline:none;box-shadow:0 0 5px #1b84ff4d}"]})),m})();var z=x(5588),se=x(31552),ce=x(6593),K=x(88672),de=x(16519),W=x(64170),V=x(98525),ue=x(23680),X=x(78325);let me=(()=>{var r;class m{constructor(){}onWheel(i){i.preventDefault()}}return r=m,(0,d.Z)(m,"\u0275fac",function(i){return new(i||r)}),(0,d.Z)(m,"\u0275dir",e.lG2({type:r,selectors:[["","appPreventScroll",""]],hostBindings:function(i,t){1&i&&e.NdJ("wheel",function(a){return t.onWheel(a)})}})),m})();const pe=["closeClient"],fe=["modalContent"],ge=["targetElement"];function he(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"button",104),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.openModal("",""))}),e._uU(1," New "),e.qZA()}if(2&r){const o=e.oxw();e.Q6J("disabled",!o.adminLogin)}}function _e(r,m){if(1&r&&(e.TgZ(0,"div",116),e._uU(1),e.qZA()),2&r){const o=e.oxw(2);e.xp6(1),e.hij(" ",o.smsCredits," ")}}function be(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",105)(1,"div",106)(2,"label",107),e._uU(3,"Filter Client Table:"),e.qZA(),e.TgZ(4,"select",108)(5,"option",98),e._uU(6,"All"),e.qZA(),e.TgZ(7,"option",99),e._uU(8,"Expired"),e.qZA(),e.TgZ(9,"option",109),e._uU(10,"Valid"),e.qZA(),e.TgZ(11,"option",110),e._uU(12,"Expiring Soon"),e.qZA()()(),e.TgZ(13,"button",111),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.applyFilters())}),e._uU(14,"Apply"),e.qZA(),e.TgZ(15,"div",112)(16,"button",113),e._uU(17,"Filter by MAC id"),e.qZA(),e.TgZ(18,"div",114),e.YNc(19,_e,2,1,"div",115),e.qZA()()()}if(2&r){const o=e.oxw();e.xp6(19),e.Q6J("ngIf",o.showSmsCredits)}}function ve(r,m){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Client ID"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Client Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Mobile"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Email"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Updated"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Edit"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Delete"),e.qZA()())}function Ce(r,m){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Client ID"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Client Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Mobile"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Email"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Updated"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Edit"),e.qZA()())}function ye(r,m){1&r&&(e.TgZ(0,"h2",117),e._uU(1,"Add Client Configuration"),e.qZA())}function Ze(r,m){1&r&&(e.TgZ(0,"h2",117),e._uU(1,"Edit Client Configuration"),e.qZA())}const J=function(r){return{"show-preview":r}};function De(r,m){if(1&r&&(e.TgZ(0,"div",118),e._UZ(1,"img",119),e.qZA()),2&r){const o=e.oxw();e.Q6J("ngClass",e.VKq(2,J,o.hover[0])),e.xp6(1),e.Q6J("src",o.imageUrls[0],e.LSH)}}function xe(r,m){1&r&&(e.TgZ(0,"a",120),e._uU(1,"Uploaded"),e.qZA())}function Ie(r,m){if(1&r&&(e.TgZ(0,"div",118),e._UZ(1,"img",119),e.qZA()),2&r){const o=e.oxw();e.Q6J("ngClass",e.VKq(2,J,o.hover[1])),e.xp6(1),e.Q6J("src",o.imageUrls[1],e.LSH)}}function Ue(r,m){1&r&&(e.TgZ(0,"a",120),e._uU(1,"Uploaded"),e.qZA())}function Te(r,m){if(1&r&&(e.TgZ(0,"div",121),e._UZ(1,"img",119),e.qZA()),2&r){const o=e.oxw();e.Q6J("ngClass",e.VKq(2,J,o.hover[2])),e.xp6(1),e.Q6J("src",o.imageUrls[2],e.LSH)}}function we(r,m){1&r&&(e.TgZ(0,"a",120),e._uU(1,"Uploaded"),e.qZA())}function Se(r,m){if(1&r&&(e.TgZ(0,"div",121),e._UZ(1,"img",119),e.qZA()),2&r){const o=e.oxw();e.Q6J("ngClass",e.VKq(2,J,o.hover[3])),e.xp6(1),e.Q6J("src",o.imageUrls[3],e.LSH)}}function Ae(r,m){1&r&&(e.TgZ(0,"a",120),e._uU(1,"Uploaded"),e.qZA())}function Fe(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," Client ID is required "),e.qZA())}function ke(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," Client Name is required "),e.qZA())}function qe(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," Client Desc is required "),e.qZA())}function Pe(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," Mobile number is required "),e.qZA())}function Ne(r,m){if(1&r&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.hij(" ",o.errorForInvalidEmail," ")}}function Me(r,m){if(1&r&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.hij(" ",o.errorForUniqueEmail," ")}}function Ee(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," Email is required "),e.qZA())}function Oe(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",123),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.showSmsHistoryModal())}),e.TgZ(1,"div",124)(2,"button",125),e._uU(3," SMS Limit History "),e.qZA()()()}}function Le(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Value must be at least 0. "),e.qZA())}function Je(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Value cannot exceed 999. "),e.qZA())}function Ke(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid number (up to 3 digits). "),e.qZA())}function $e(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"li",135),e._uU(1),e.TgZ(2,"div")(3,"button",136),e.NdJ("click",function(){const n=e.CHM(o).index,a=e.oxw(3);return e.KtG(a.setEditingIndexday(n))}),e._uU(4,"Edit"),e.qZA(),e.TgZ(5,"button",137),e.NdJ("click",function(){const n=e.CHM(o).index,a=e.oxw(3);return e.KtG(a.removeIndexday(n))}),e._uU(6,"Remove"),e.qZA()()()}if(2&r){const o=m.$implicit;e.xp6(1),e.hij(" ",o," ")}}function Qe(r,m){if(1&r&&(e.TgZ(0,"div")(1,"label",54),e._uU(2,"Added Remainder Days"),e.qZA(),e.TgZ(3,"ul",133),e.YNc(4,$e,7,1,"li",134),e.qZA()()),2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",o.custome_days)}}function Be(r,m){if(1&r&&(e.TgZ(0,"div",138),e._uU(1),e.qZA()),2&r){const o=e.oxw(2);e.xp6(1),e.Oqu(o.errorday)}}function He(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",126)(1,"div",29)(2,"div",42)(3,"div")(4,"label",54),e._uU(5,"Custom Remainder days"),e.qZA(),e.TgZ(6,"form",127),e._UZ(7,"input",128),e.TgZ(8,"button",129),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.addday())}),e._uU(9),e.qZA()(),e.YNc(10,Le,2,0,"div",130),e.YNc(11,Je,2,0,"div",130),e.YNc(12,Ke,2,0,"div",130),e.TgZ(13,"div",131),e._uU(14),e.qZA()()()(),e.TgZ(15,"div",29),e.YNc(16,Qe,5,1,"div",15),e.YNc(17,Be,2,1,"div",132),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(6),e.Q6J("formGroup",o.reminderForm),e.xp6(3),e.hij(" ",o.isEditingday()?"Update":"Add"," "),e.xp6(1),e.Q6J("ngIf",(null==o.reminderForm.controls.day.errors?null:o.reminderForm.controls.day.errors.min)&&o.reminderForm.controls.day.touched),e.xp6(1),e.Q6J("ngIf",(null==o.reminderForm.controls.day.errors?null:o.reminderForm.controls.day.errors.max)&&o.reminderForm.controls.day.touched),e.xp6(1),e.Q6J("ngIf",(null==o.reminderForm.controls.day.errors?null:o.reminderForm.controls.day.errors.pattern)&&o.reminderForm.controls.day.touched),e.xp6(2),e.Oqu(o.errorday),e.xp6(2),e.Q6J("ngIf",o.custome_days&&o.custome_days.length>0),e.xp6(1),e.Q6J("ngIf",o.error)}}function Ye(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",42)(1,"div")(2,"label",54),e._uU(3,"Email Manager"),e.qZA(),e.TgZ(4,"form",127),e._UZ(5,"input",140),e.TgZ(6,"button",129),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.addEmail())}),e._uU(7),e.qZA()()()()}if(2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("formGroup",o.emailForm),e.xp6(3),e.hij(" ",o.isEditing()?"Update":"Add"," ")}}function Ge(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"li",142),e._uU(1),e.TgZ(2,"div")(3,"button",136),e.NdJ("click",function(){const n=e.CHM(o).index,a=e.oxw(3);return e.KtG(a.setEditingIndex(n))}),e._uU(4,"Edit"),e.qZA(),e.TgZ(5,"button",137),e.NdJ("click",function(){const n=e.CHM(o).index,a=e.oxw(3);return e.KtG(a.removeIndex(n))}),e._uU(6,"Remove"),e.qZA()()()}if(2&r){const o=m.$implicit;e.xp6(1),e.hij(" ",o," ")}}function Re(r,m){if(1&r&&(e.TgZ(0,"div")(1,"label",54),e._uU(2,"CC Emails"),e.qZA(),e.TgZ(3,"ul",133),e.YNc(4,Ge,7,1,"li",141),e.qZA()()),2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",o.emailArray)}}function je(r,m){if(1&r&&(e.TgZ(0,"div",138),e._uU(1),e.qZA()),2&r){const o=e.oxw(2);e.xp6(1),e.Oqu(o.error)}}function ze(r,m){if(1&r&&(e.TgZ(0,"div",126)(1,"div",29),e.YNc(2,Ye,8,2,"div",139),e.qZA(),e.TgZ(3,"div",29),e.YNc(4,Re,5,1,"div",15),e.YNc(5,je,2,1,"div",132),e.qZA()()),2&r){const o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.adminLogin),e.xp6(2),e.Q6J("ngIf",o.emailArray&&o.emailArray.length>0&&o.adminLogin),e.xp6(1),e.Q6J("ngIf",o.error)}}function We(r,m){if(1&r){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",143),e._uU(2," \xa0 "),e._UZ(3,"input",144),e._uU(4," \xa0 "),e._UZ(5,"input",145),e._uU(6," \xa0 "),e.TgZ(7,"button",146),e.NdJ("click",function(){const n=e.CHM(o).index,a=e.oxw();return e.KtG(a.remove(n))}),e._UZ(8,"span",147),e.qZA(),e._uU(9," \xa0 "),e.qZA(),e.BQk()}if(2&r){const o=m.index;e.xp6(1),e.Q6J("formGroupName",o),e.xp6(7),e.Q6J("inlineSVG","./assets/media/icons/duotune/arrows/arr061.svg")}}function Ve(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"button",148),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.updateClient(t.createClientField.value,"editClient"))}),e._uU(1," Update "),e.qZA()}if(2&r){const o=e.oxw();e.Q6J("hidden",o.hideUpdateButton)("disabled",o.createClientField.invalid||0==o.validEmail)}}function Xe(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"button",149),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.createNewClient(""))}),e._uU(1,"Save"),e.qZA()}if(2&r){const o=e.oxw();e.Q6J("disabled",o.createClientField.invalid||""!=o.errorForUniqueID||0==o.validEmail)}}function et(r,m){if(1&r&&(e.TgZ(0,"option",165),e._uU(1),e.qZA()),2&r){const o=m.$implicit;e.Q6J("value",o.name),e.xp6(1),e.hij(" ",o.name," ")}}function tt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",162)(1,"label",56),e._uU(2,"Update MAC ID"),e.qZA(),e.TgZ(3,"select",163),e.NdJ("change",function(){e.CHM(o);const t=e.oxw(2);let n;return e.KtG(t.updatePopulate(null==(n=t.subscritionFields.get("update_mac"))?null:n.value))}),e.TgZ(4,"option",59),e._uU(5,"Select MAC ID"),e.qZA(),e.YNc(6,et,2,2,"option",164),e.qZA()()}if(2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.allSubscribed)}}function it(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",26)(1,"div",27)(2,"div",28)(3,"div",150)(4,"h2",151),e._uU(5," Subscription Details "),e.qZA()(),e.TgZ(6,"div",152)(7,"button",153),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.toggleAdvancedMac())}),e._uU(8," Show MAC ID's "),e._UZ(9,"i",154),e.qZA(),e.TgZ(10,"div",155)(11,"div",28)(12,"div",156)(13,"div",157)(14,"div",13)(15,"table",158)(16,"thead")(17,"tr")(18,"th"),e._uU(19,"Unifier ID"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Po No"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"Project No"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Number of Devices"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"Subscription Start Date"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Subscription End Date"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Actions"),e.qZA()()(),e._UZ(32,"tbody"),e.qZA()()()()()()(),e.TgZ(33,"div",159)(34,"div",42)(35,"button",160),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.selectOperation())}),e._uU(36,"Add MAC ID"),e.qZA()(),e.YNc(37,tt,7,2,"div",161),e.qZA()()()()}if(2&r){const o=e.oxw();e.Q6J("formGroup",o.subscritionFields),e.xp6(35),e.Q6J("disabled",!o.adminLogin),e.xp6(2),e.Q6J("ngIf",o.allSubscribed)}}function nt(r,m){if(1&r&&(e.TgZ(0,"div")(1,"span",131),e._uU(2),e.qZA()()),2&r){const o=e.oxw(2);e.xp6(2),e.Oqu(o.uniquemac)}}function ot(r,m){1&r&&(e.TgZ(0,"div",122),e._uU(1," No of Devices is required "),e.qZA())}function lt(r,m){if(1&r&&(e.TgZ(0,"option",165),e._uU(1),e.qZA()),2&r){const o=m.$implicit;e.Q6J("value",o.name),e.xp6(1),e.hij(" ",o.deviceName," ")}}function rt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",162)(1,"label",56),e._uU(2,"Update Device"),e.qZA(),e.TgZ(3,"select",197),e.NdJ("change",function(){e.CHM(o);const t=e.oxw(2);let n;return e.KtG(t.updatePopulate(null==(n=t.addUnifierID.get("update_device"))?null:n.value))}),e.TgZ(4,"option",59),e._uU(5,"Select Device"),e.qZA(),e.YNc(6,lt,2,2,"option",164),e.qZA()()}if(2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.selectedIdentifier.devices)}}function at(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",205)(1,"button",206),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(3);return e.KtG(t.updateDevice())}),e._uU(2,"Update"),e.qZA()()}if(2&r){const o=e.oxw(3);e.xp6(1),e.Q6J("disabled",!o.adminLogin)}}function st(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",205)(1,"button",206),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(3);return e.KtG(t.addDevice())}),e._uU(2,"Submit"),e.qZA()()}if(2&r){const o=e.oxw(3);e.xp6(1),e.Q6J("disabled",!o.adminLogin)}}function ct(r,m){if(1&r&&(e.TgZ(0,"div")(1,"form",198)(2,"div",29)(3,"div",162)(4,"label",54),e._uU(5,"SIM No."),e.qZA(),e._UZ(6,"input",199),e.qZA(),e.TgZ(7,"div",42)(8,"label",54),e._uU(9,"Publish Frequency"),e.qZA(),e._UZ(10,"input",200),e.qZA()(),e.TgZ(11,"div",29)(12,"div",162)(13,"label",54),e._uU(14,"IMEI"),e.qZA(),e._UZ(15,"input",201),e.qZA(),e.TgZ(16,"div",42)(17,"label",54),e._uU(18,"Subscription Start Date"),e.qZA(),e._UZ(19,"input",193),e.qZA(),e.TgZ(20,"div",42)(21,"label",54),e._uU(22,"Subscription End Date"),e.qZA(),e._UZ(23,"input",202),e.qZA(),e.TgZ(24,"div",42)(25,"label",54),e._uU(26,"Comments"),e.qZA(),e._UZ(27,"textarea",189),e.qZA()(),e.TgZ(28,"div",29)(29,"div",162)(30,"label",54),e._uU(31,"Subscription Type"),e.qZA(),e.TgZ(32,"select",203)(33,"option",185),e._uU(34,"Select Subscription Type"),e.qZA(),e.TgZ(35,"option",186),e._uU(36,"Gold"),e.qZA(),e.TgZ(37,"option",187),e._uU(38,"Silver"),e.qZA(),e.TgZ(39,"option",188),e._uU(40,"Platinum"),e.qZA()()()(),e.YNc(41,at,3,1,"div",204),e.YNc(42,st,3,1,"div",204),e.qZA()()),2&r){const o=e.oxw(2);e.xp6(1),e.Q6J("formGroup",o.deviceForm),e.xp6(40),e.Q6J("ngIf",o.deviceEdit),e.xp6(1),e.Q6J("ngIf",!o.deviceEdit)}}function dt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid invoice date. "),e.qZA())}function ut(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid invoice date. "),e.qZA())}function mt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid warranty start date. "),e.qZA())}function pt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid warranty start date. "),e.qZA())}function ft(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid warranty end date. "),e.qZA())}function gt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid warranty end date. "),e.qZA())}function ht(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid start date. "),e.qZA())}function _t(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid start date. "),e.qZA())}function bt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid date. "),e.qZA())}function vt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid date. "),e.qZA())}function Ct(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid update date. "),e.qZA())}function yt(r,m){1&r&&(e.TgZ(0,"div",131),e._uU(1," Please enter a valid update date. "),e.qZA())}function Zt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",42)(1,"label",54),e._uU(2,"File Upload"),e.qZA(),e.TgZ(3,"input",207),e.NdJ("change",function(t){e.CHM(o);const n=e.oxw(2);return e.KtG(n.onFileUpload(t))}),e.qZA()()}}function Dt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"li",211),e._uU(1),e.TgZ(2,"div")(3,"button",212),e.NdJ("click",function(){const n=e.CHM(o).$implicit,a=e.oxw(3);return e.KtG(a.downloadFile(n.name))}),e._uU(4,"Download"),e.qZA(),e.TgZ(5,"button",137),e.NdJ("click",function(){const n=e.CHM(o).$implicit,a=e.oxw(3);return e.KtG(a.removeFile(n.name))}),e._uU(6,"Remove"),e.qZA(),e.TgZ(7,"button",213),e.NdJ("click",function(){const n=e.CHM(o).$implicit,a=e.oxw(3);return e.KtG(a.viewFile(n.name))}),e._uU(8,"View"),e.qZA()()()}if(2&r){const o=m.$implicit;e.oxw();const i=e.MAs(6);e.xp6(1),e.hij(" ",o.name," "),e.xp6(6),e.Q6J("ngbTooltip",i)}}function xt(r,m){1&r&&e._uU(0," Supported Format Images ")}function It(r,m){if(1&r&&(e.TgZ(0,"div")(1,"label",54),e._uU(2,"Uploaded Files"),e.qZA(),e.TgZ(3,"ul",133),e.YNc(4,Dt,9,2,"li",208),e.qZA(),e.YNc(5,xt,1,0,"ng-template",209,210,e.W1O),e.qZA()),2&r){const o=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",o.files)}}function Ut(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",214)(1,"button",206),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.addunifier(!1))}),e._uU(2,"ADD MAC ID"),e.qZA()()}if(2&r){const o=e.oxw(2);e.xp6(1),e.Q6J("disabled",!o.addUnifierID.valid||""!=o.uniquemac)}}function Tt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",214)(1,"button",206),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.updateunifier(!1))}),e._uU(2,"Update MAC ID"),e.qZA()()}if(2&r){const o=e.oxw(2);e.xp6(1),e.Q6J("disabled",!o.addUnifierID.valid&&o.addUnifierID.dirty)}}function wt(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"div",26)(1,"div",29,166)(3,"div",42)(4,"label",43),e._uU(5,"Unifier ID"),e.qZA(),e.TgZ(6,"input",167),e.NdJ("keyup",function(t){e.CHM(o);const n=e.oxw();return e.KtG(n.checkUniqueMac(t))}),e.qZA(),e.YNc(7,nt,3,1,"div",15),e.qZA(),e.TgZ(8,"div",42)(9,"label",43),e._uU(10,"No of Devices"),e.qZA(),e._UZ(11,"input",168),e.YNc(12,ot,2,0,"div",46),e.qZA(),e.TgZ(13,"div",42)(14,"label",54),e._uU(15,"SIM No."),e.qZA(),e._UZ(16,"input",169),e.qZA(),e.TgZ(17,"div",42)(18,"label",54),e._uU(19,"SIM Service"),e.qZA(),e._UZ(20,"input",170),e.qZA(),e.TgZ(21,"div",42)(22,"label",54),e._uU(23,"IMEI"),e.qZA(),e._UZ(24,"input",171),e.qZA(),e.TgZ(25,"div",42)(26,"label",43),e._uU(27,"PO No."),e.qZA(),e._UZ(28,"input",172),e.qZA(),e.TgZ(29,"div",173)(30,"h4",174),e._uU(31,"Manage Devices"),e.qZA(),e.YNc(32,rt,7,2,"div",161),e.TgZ(33,"div",175)(34,"button",153),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.toggleAdvancedOptions())}),e._uU(35," Show Devices "),e._UZ(36,"i",154),e.qZA(),e.TgZ(37,"div",176)(38,"div",28)(39,"div",156)(40,"div",157)(41,"div",13)(42,"table",177)(43,"thead")(44,"tr")(45,"th"),e._uU(46,"Device Name"),e.qZA(),e.TgZ(47,"th"),e._uU(48,"MAC ID"),e.qZA(),e.TgZ(49,"th"),e._uU(50,"SIM No"),e.qZA(),e.TgZ(51,"th"),e._uU(52,"IMEI"),e.qZA(),e.TgZ(53,"th"),e._uU(54,"Subscription Start Date"),e.qZA(),e.TgZ(55,"th"),e._uU(56,"Subscription End Date"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Publish Frequency"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Subscription Type"),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Actions"),e.qZA()()(),e._UZ(63,"tbody"),e.qZA()()()()()()(),e.TgZ(64,"div",178)(65,"button",179),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.toggleDeviceForm())}),e._uU(66,"Add New Device"),e.qZA()(),e.YNc(67,ct,43,3,"div",15),e.qZA()(),e.TgZ(68,"div",29)(69,"div",42)(70,"label",43),e._uU(71,"Project Code"),e.qZA(),e._UZ(72,"input",180),e.qZA(),e.TgZ(73,"div",42)(74,"label",54),e._uU(75,"Invoice No."),e.qZA(),e._UZ(76,"input",181),e.qZA(),e.TgZ(77,"div",42)(78,"label",54),e._uU(79,"Invoice Amount"),e.qZA(),e._UZ(80,"input",182),e.qZA(),e.TgZ(81,"div",42)(82,"label",54),e._uU(83,"Product/Service"),e.qZA(),e._UZ(84,"input",183),e.qZA(),e.TgZ(85,"div",42)(86,"label",43),e._uU(87,"Subscription Type"),e.qZA(),e.TgZ(88,"select",184)(89,"option",185),e._uU(90,"Select Subscription Type"),e.qZA(),e.TgZ(91,"option",186),e._uU(92,"Gold"),e.qZA(),e.TgZ(93,"option",187),e._uU(94,"Silver"),e.qZA(),e.TgZ(95,"option",188),e._uU(96,"Platinum"),e.qZA()()(),e.TgZ(97,"div",42)(98,"label",54),e._uU(99,"Comments"),e.qZA(),e._UZ(100,"textarea",189),e.qZA(),e.TgZ(101,"div",42)(102,"label",43),e._uU(103,"Invoice Date"),e.qZA(),e._UZ(104,"input",190),e.YNc(105,dt,2,0,"div",130),e.YNc(106,ut,2,0,"div",130),e.qZA(),e.TgZ(107,"div",42)(108,"label",43),e._uU(109,"Warranty Start Date"),e.qZA(),e._UZ(110,"input",191),e.YNc(111,mt,2,0,"div",130),e.YNc(112,pt,2,0,"div",130),e.qZA(),e.TgZ(113,"div",42)(114,"label",43),e._uU(115,"Warranty End Date"),e.qZA(),e._UZ(116,"input",192),e.YNc(117,ft,2,0,"div",130),e.YNc(118,gt,2,0,"div",130),e.qZA()(),e.TgZ(119,"div",29)(120,"div",42)(121,"label",43),e._uU(122,"Subscription Start Date"),e.qZA(),e._UZ(123,"input",193),e.YNc(124,ht,2,0,"div",130),e.YNc(125,_t,2,0,"div",130),e.qZA(),e.TgZ(126,"div",42)(127,"label",43),e._uU(128,"Subscription End Date"),e.qZA(),e._UZ(129,"input",194),e.YNc(130,bt,2,0,"div",130),e.YNc(131,vt,2,0,"div",130),e.qZA(),e.TgZ(132,"div",42)(133,"label",43),e._uU(134,"Date Updated"),e.qZA(),e._UZ(135,"input",195),e.YNc(136,Ct,2,0,"div",130),e.YNc(137,yt,2,0,"div",130),e.qZA()(),e.TgZ(138,"div",29),e.YNc(139,Zt,4,0,"div",139),e.TgZ(140,"div",29),e.YNc(141,It,7,1,"div",15),e.YNc(142,Ut,3,1,"div",196),e.YNc(143,Tt,3,1,"div",196),e.qZA()()()}if(2&r){const o=e.oxw();let i;e.Q6J("formGroup",o.addUnifierID),e.xp6(7),e.Q6J("ngIf",""!=o.uniquemac),e.xp6(5),e.Q6J("ngIf",(null==(i=o.subscritionFields.get("no_of_devices"))?null:i.hasError("required"))&&(null==(i=o.subscritionFields.get("no_of_devices"))?null:i.touched)),e.xp6(20),e.Q6J("ngIf",o.selectedIdentifier&&o.selectedIdentifier.devices),e.xp6(33),e.Q6J("disabled",!o.adminLogin),e.xp6(2),e.Q6J("ngIf",o.showDeviceForm),e.xp6(38),e.Q6J("ngIf",(null==o.addUnifierID.controls.invoiceDate.errors?null:o.addUnifierID.controls.invoiceDate.errors.invalidDate)&&(o.addUnifierID.controls.invoiceDate.dirty||o.addUnifierID.controls.invoiceDate.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.invoiceDate.errors?null:o.addUnifierID.controls.invoiceDate.errors.required)&&(o.addUnifierID.controls.invoiceDate.dirty||o.addUnifierID.controls.invoiceDate.touched)),e.xp6(5),e.Q6J("ngIf",(null==o.addUnifierID.controls.warrantyStartDate.errors?null:o.addUnifierID.controls.warrantyStartDate.errors.invalidDate)&&(o.addUnifierID.controls.warrantyStartDate.dirty||o.addUnifierID.controls.warrantyStartDate.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.warrantyStartDate.errors?null:o.addUnifierID.controls.warrantyStartDate.errors.required)&&(o.addUnifierID.controls.warrantyStartDate.dirty||o.addUnifierID.controls.warrantyStartDate.touched)),e.xp6(5),e.Q6J("ngIf",(null==o.addUnifierID.controls.warrantyEndDate.errors?null:o.addUnifierID.controls.warrantyEndDate.errors.invalidDate)&&(o.addUnifierID.controls.warrantyEndDate.dirty||o.addUnifierID.controls.warrantyEndDate.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.warrantyEndDate.errors?null:o.addUnifierID.controls.warrantyEndDate.errors.required)&&(o.addUnifierID.controls.warrantyEndDate.dirty||o.addUnifierID.controls.warrantyEndDate.touched)),e.xp6(6),e.Q6J("ngIf",(null==o.addUnifierID.controls.subscriptionStartDate.errors?null:o.addUnifierID.controls.subscriptionStartDate.errors.invalidDate)&&(o.addUnifierID.controls.subscriptionStartDate.dirty||o.addUnifierID.controls.subscriptionStartDate.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.subscriptionStartDate.errors?null:o.addUnifierID.controls.subscriptionStartDate.errors.required)&&(o.addUnifierID.controls.subscriptionStartDate.dirty||o.addUnifierID.controls.subscriptionStartDate.touched)),e.xp6(5),e.Q6J("ngIf",(null==o.addUnifierID.controls.subscriptionEndDate.errors?null:o.addUnifierID.controls.subscriptionEndDate.errors.invalidDate)&&(o.addUnifierID.controls.subscriptionEndDate.dirty||o.addUnifierID.controls.subscriptionEndDate.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.subscriptionEndDate.errors?null:o.addUnifierID.controls.subscriptionEndDate.errors.required)&&(o.addUnifierID.controls.subscriptionEndDate.dirty||o.addUnifierID.controls.subscriptionEndDate.touched)),e.xp6(5),e.Q6J("ngIf",(null==o.addUnifierID.controls.dateUpdated.errors?null:o.addUnifierID.controls.dateUpdated.errors.invalidDate)&&(o.addUnifierID.controls.dateUpdated.dirty||o.addUnifierID.controls.dateUpdated.touched)),e.xp6(1),e.Q6J("ngIf",(null==o.addUnifierID.controls.dateUpdated.errors?null:o.addUnifierID.controls.dateUpdated.errors.required)&&(o.addUnifierID.controls.dateUpdated.dirty||o.addUnifierID.controls.dateUpdated.touched)),e.xp6(2),e.Q6J("ngIf",o.addUnifierID.valid&&""==o.uniquemac),e.xp6(2),e.Q6J("ngIf",o.files&&o.files.length>0&&o.addUnifierID.valid&&""==o.uniquemac),e.xp6(1),e.Q6J("ngIf",!o.editOperation&&o.adminLogin&&!o.hideUpdateButton),e.xp6(1),e.Q6J("ngIf",o.editOperation&&o.adminLogin&&!o.hideUpdateButton)}}function St(r,m){if(1&r&&(e.TgZ(0,"mat-option",165),e._uU(1),e.qZA()),2&r){const o=m.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function At(r,m){if(1&r){const o=e.EpF();e.TgZ(0,"mat-form-field",215)(1,"mat-label"),e._uU(2,"Select Clients"),e.qZA(),e.TgZ(3,"mat-select",216),e.NdJ("ngModelChange",function(t){e.CHM(o);const n=e.oxw();return e.KtG(n.selectedClients=t)}),e.YNc(4,St,2,2,"mat-option",164),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(3),e.Q6J("ngModel",o.selectedClients),e.xp6(1),e.Q6J("ngForOf",o.showAllClientArray)}}let Ft=(()=>{var r;class m{constructor(i,t,n,a,l,u,s,c,p,h,b,v){(0,d.Z)(this,"fb",void 0),(0,d.Z)(this,"clientConfiguration",void 0),(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"toast",void 0),(0,d.Z)(this,"sanitizer",void 0),(0,d.Z)(this,"router",void 0),(0,d.Z)(this,"cd",void 0),(0,d.Z)(this,"spinner",void 0),(0,d.Z)(this,"rdtConfig",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"auditTrialServices",void 0),(0,d.Z)(this,"modal",void 0),(0,d.Z)(this,"createClientField",void 0),(0,d.Z)(this,"showModal",!1),(0,d.Z)(this,"showHeading",!1),(0,d.Z)(this,"errorForUniqueID",void 0),(0,d.Z)(this,"base64textString",void 0),(0,d.Z)(this,"base64textString_temp",void 0),(0,d.Z)(this,"base64textString_logo1",void 0),(0,d.Z)(this,"base64textString_temp_logo1",void 0),(0,d.Z)(this,"allClientDetails",{}),(0,d.Z)(this,"getLoggedUser",void 0),(0,d.Z)(this,"SK_clientID",void 0),(0,d.Z)(this,"loggedUser_Company",void 0),(0,d.Z)(this,"errorForInvalidEmail",void 0),(0,d.Z)(this,"dropdownSettings",{}),(0,d.Z)(this,"closeClient",void 0),(0,d.Z)(this,"data_temp",[]),(0,d.Z)(this,"listofSK",[]),(0,d.Z)(this,"clientSK",void 0),(0,d.Z)(this,"allPermissions_user",void 0),(0,d.Z)(this,"hideUpdateButton",!1),(0,d.Z)(this,"hideDeleteButton",!1),(0,d.Z)(this,"columnDatatable",[]),(0,d.Z)(this,"clientID",void 0),(0,d.Z)(this,"dataform",[]),(0,d.Z)(this,"lookup_data_user",[]),(0,d.Z)(this,"columnTableData",[]),(0,d.Z)(this,"deviceTableData",void 0),(0,d.Z)(this,"maxlength",500),(0,d.Z)(this,"addUnifierID",void 0),(0,d.Z)(this,"selectedFiles",{}),(0,d.Z)(this,"imageUrls",[]),(0,d.Z)(this,"hover",[!1,!1,!1,!1]),(0,d.Z)(this,"smsHistory",void 0),(0,d.Z)(this,"selectedCity",void 0),(0,d.Z)(this,"cities",[{name:"New York",code:"NY"},{name:"Rome",code:"RM"},{name:"London",code:"LDN"},{name:"Istanbul",code:"IST"},{name:"Paris",code:"PRS"}]),(0,d.Z)(this,"newMacId",""),(0,d.Z)(this,"activeTabIndex",0),(0,d.Z)(this,"subscritionFields",void 0),(0,d.Z)(this,"macIdForm",void 0),(0,d.Z)(this,"macIds",void 0),(0,d.Z)(this,"macIDs",[]),(0,d.Z)(this,"tabDataMap",new Map),(0,d.Z)(this,"addUnifier",!1),(0,d.Z)(this,"deviceForm",void 0),(0,d.Z)(this,"devices",[]),(0,d.Z)(this,"showDeviceForm",!1),(0,d.Z)(this,"allSubscribed",[]),(0,d.Z)(this,"selectedIdentifier",void 0),(0,d.Z)(this,"scalingtemp",void 0),(0,d.Z)(this,"devicesArray",[]),(0,d.Z)(this,"macdata",void 0),(0,d.Z)(this,"macTableData",void 0),(0,d.Z)(this,"editOperation",!1),(0,d.Z)(this,"deviceEdit",!1),(0,d.Z)(this,"adminLogin",!1),(0,d.Z)(this,"showSubscription",!0),(0,d.Z)(this,"uniqueEmail",[]),(0,d.Z)(this,"errorForUniqueEmail",void 0),(0,d.Z)(this,"tempValueHolder",void 0),(0,d.Z)(this,"validEmail",!0),(0,d.Z)(this,"emailForm",void 0),(0,d.Z)(this,"emailArray",[]),(0,d.Z)(this,"editingIndex",null),(0,d.Z)(this,"error",null),(0,d.Z)(this,"tempTableColor",void 0),(0,d.Z)(this,"reminderForm",void 0),(0,d.Z)(this,"custome_days",[]),(0,d.Z)(this,"editingIndexday",null),(0,d.Z)(this,"errorday",void 0),(0,d.Z)(this,"updatedDaycheck",!1),(0,d.Z)(this,"validUpdate",!1),(0,d.Z)(this,"uploadProgress",0),(0,d.Z)(this,"files",[]),(0,d.Z)(this,"allFiles",[]),(0,d.Z)(this,"selectedFileUrl",null),(0,d.Z)(this,"fileUrl",null),(0,d.Z)(this,"filename",null),(0,d.Z)(this,"isModalVisible",!1),(0,d.Z)(this,"uniquemac",""),(0,d.Z)(this,"filteredData",[]),(0,d.Z)(this,"filterFlag",!1),(0,d.Z)(this,"All_Client_Configuration",[]),(0,d.Z)(this,"selectedfilter",""),(0,d.Z)(this,"macIDArray",[]),(0,d.Z)(this,"currentMACSelected",""),(0,d.Z)(this,"tempUrl",""),(0,d.Z)(this,"temporderedUrls",[void 0,void 0,void 0,void 0]),(0,d.Z)(this,"showAllClientArray",[]),(0,d.Z)(this,"tempStoreFlags",void 0),(0,d.Z)(this,"tempClientHolder",void 0),(0,d.Z)(this,"smsHistoryStorage",[]),(0,d.Z)(this,"permission_ID",void 0),(0,d.Z)(this,"selectedMacFilter",[]),(0,d.Z)(this,"selectedClients",[]),(0,d.Z)(this,"smsCredits",0),(0,d.Z)(this,"showSmsCredits",!1),(0,d.Z)(this,"apiUrl","https://api.textlocal.in/balance/"),(0,d.Z)(this,"apiKey","0Of3QTqzPys-ycyRnDKtTKb3nyKoU53048vvkA01Md"),(0,d.Z)(this,"modalContent",void 0),(0,d.Z)(this,"targetElement",void 0),this.fb=i,this.clientConfiguration=t,this.api=n,this.toast=a,this.sanitizer=l,this.router=u,this.cd=s,this.spinner=c,this.rdtConfig=p,this.http=h,this.auditTrialServices=b,this.modal=v}ngOnInit(){this.getLoggedUser=this.clientConfiguration.getLoggedUserDetails(),this.dropdownSettings=this.clientConfiguration.getSettings(),delete this.dropdownSettings.selectAllText,delete this.dropdownSettings.unSelectAllText,this.SK_clientID=this.getLoggedUser.attributes["custom:clientID"],this.permission_ID=this.getLoggedUser.attributes["custom:permission_id"],this.clientID=this.getLoggedUser.attributes["custom:clientID"]+"#client",this.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),console.log(" this.allPermissions_user ",this.allPermissions_user),console.log("Client ID is ,"+this.clientID),this.addFromService(),this.deviceForm=this.fb.group({deviceName:[""],macID:[""],simNo:[""],imei:[""],subscriptionStartDate:[""],subscriptionEndDate:[""],comments:[""],publish_freq:[""],subs_type:[""]}),this.addUnifierID=this.fb.group({name:["",g.kI.required],poNo:["",g.kI.required],project_code:["",g.kI.required],invoiceNo:[""],invoiceAmount:[""],invoiceDate:["",g.kI.required],warrantyStartDate:["",g.kI.required],type_of_service:[""],mac_SimNo:[""],mac_Imei:[""],warrantyEndDate:[""],subscriptionStartDate:["",g.kI.required],subscriptionEndDate:["",g.kI.required],no_of_devices:["",g.kI.required],update_device:[""],mac_subs_type:["",g.kI.required],fileUpload:[null],comments:[""],dateUpdated:["",g.kI.required]}),this.emailForm=this.fb.group({email:["",[g.kI.required,g.kI.email]]}),this.reminderForm=this.fb.group({day:[0,[g.kI.required,g.kI.min(0),g.kI.max(999),g.kI.pattern(/^\d{1,3}$/)]]}),this.initializeClientFields(),this.loading(),this.auditTrialServices.audit_trail("2.1","Client","Page Load","Client Page Loaded","1")}onFileUploaded(i,t){const n=i.target.files;n.length>0&&(this.selectedFiles[t]=n[0],this.previewFiles()),console.log("ALl the selected files are here ",this.selectedFiles)}previewFiles(){for(let i in this.selectedFiles){console.log("Key is here ",i);const n=URL.createObjectURL(this.selectedFiles[i]);i?.includes("imageInput1")?this.temporderedUrls[0]=n:i?.includes("imageInput2")?this.temporderedUrls[1]=n:i?.includes("imageInput3")?this.temporderedUrls[2]=n:i?.includes("imageInput4")&&(this.temporderedUrls[3]=n),this.imageUrls=this.temporderedUrls}}uploadFiles(){var i=this;return(0,y.Z)(function*(){if(0===Object.keys(i.selectedFiles).length)return;const t=`clientLogos/${i.createClientField.get("clientID")?.value}/`;let n=[];const a=["jpg","jpeg","png","gif","svg","bmp"];for(let l in i.selectedFiles){const u=i.selectedFiles[l],c=`${l}.${u.name.split(".").pop()}`,p=`${t}${c}`;console.log("Path is here: ",p),console.log("FileName is here: ",c);try{const h=l;for(let v of a){const I=`${t}${h}.${v}`;try{yield A.Ke.get(I,{expires:60}),console.log(`File exists, deleting old .${v} file:`,I),yield A.Ke.remove(I)}catch{console.log(`No .${v} file found for deletion:`,I)}}const b=yield A.Ke.put(p,u,{contentType:u.type});n.push(b.key),n.length===Object.keys(i.selectedFiles).length&&(i.imageUrls=n,console.log("All files uploaded successfully:",n))}catch(h){console.error("Error uploading file:",h)}}})()}getFilesFromFolder(i){var t=this;return(0,y.Z)(function*(){try{const n=`clientLogos/${i}`,a=yield A.Ke.list(n,{level:"public"});let l=[void 0,void 0,void 0,void 0];yield Promise.all(a.map(function(){var u=(0,y.Z)(function*(s){const c=s.key,p=yield A.Ke.get(c),h=s.key?.split("/").pop();console.log("Filename is here ",h),h?.includes("imageInput1")?l[0]=p:h?.includes("imageInput2")?l[1]=p:h?.includes("imageInput3")?l[2]=p:h?.includes("imageInput4")&&(l[3]=p)});return function(s){return u.apply(this,arguments)}}())),t.imageUrls=l,t.temporderedUrls=l,console.log("Ordered File URLs:",t.imageUrls),t.cd.detectChanges()}catch(n){console.error("Error fetching files:",n)}})()}dateRangeValidator(i){const t=i.get("warrantyStartDate")?.value,n=i.get("warrantyEndDate")?.value;return t&&n&&new Date(t)>new Date(n)?{dateRange:!0}:null}loading(){var i=this;return(0,y.Z)(function*(){if(i.macIDArray=[],i.fetchMacIDs(1),$("#datatables").DataTable().destroy(),i.dataform=[],i.lookup_data_user=[],"WIMATE_ADMIN"===i.SK_clientID){let n;i.adminLogin=!0;const a=500;try{do{const l=yield i.api.ListLookupMasterTables({PK:{contains:"#client"}},a,n);if(console.log("Fetched data:",l),l&&l.items&&Array.isArray(l.items)){for(const u of l.items)yield i.filterListOfClients(u);n=l.nextToken}else console.warn("No items found or result.items is not an array"),n=null}while(n);console.log("All the clients are here BTW",i.lookup_data_user),i.listofSK=i.lookup_data_user.map(l=>l.P1),i.showAllClientArray=JSON.parse(JSON.stringify(i.listofSK)).sort(),i.showAllClientArray.unshift("All"),console.log("All the client are ",i.listofSK),i.cd.detectChanges(),i.getTableUser(i.lookup_data_user,"main")}catch(l){console.error("Error fetching all the clients",l)}}else i.fetchTMLookupData(1)})()}filterListOfClients(i){var t=this;return(0,y.Z)(function*(){if(i&&i.items)if("string"==typeof i.items){let n=JSON.parse(i.items);if(console.log("d1 =",n),Array.isArray(n)){for(let a=0;a<n.length;a++){const l=n[a];if(null==l)break;{const u=Object.keys(l)[0],{P1:s,P2:c,P3:p,P4:h,P5:b,P6:v}=l[u];t.lookup_data_user.push({P1:s,P2:c,P3:p,P4:h,P5:b,P6:v}),console.log("d2 =",t.lookup_data_user)}}t.lookup_data_user.sort((a,l)=>l.P5-a.P5),console.log("Lookup sorting",t.lookup_data_user)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Lookup to be displayed",t.lookup_data_user)})()}catch(i){console.error("Error:",i)}fetchTMLookupData(i){var t=this;return(0,y.Z)(function*(){console.log("Iam called Bro");try{const n=yield t.api.GetLookupMasterTable(t.clientID,i);if(n&&n.items)if("string"==typeof n.items){let a=JSON.parse(n.items);if(console.log("d1 =",a),Array.isArray(a)){for(let l=0;l<a.length;l++){const u=a[l];if(null==u)break;{const s=Object.keys(u)[0],{P1:c,P2:p,P3:h,P4:b,P5:v,P6:I}=u[s];t.lookup_data_user.push({P1:c,P2:p,P3:h,P4:b,P5:v,P6:I}),console.log("d2 =",t.lookup_data_user)}}t.lookup_data_user.sort((l,u)=>u.P5-l.P5),console.log("Lookup sorting",t.lookup_data_user),yield t.fetchTMLookupData(i+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("Lookup to be displayed",t.lookup_data_user),t.getTableUser(t.lookup_data_user,"main"),yield t.auditTrialServices.audit_trail("2.1","Client","View","Client Table was viewed","1")}catch(n){console.error("Error:",n)}})()}getTableUser(i,t){"main"==t&&(this.uniqueEmail=i.map(u=>u.P4)),console.log("All the unique emails are here",this.uniqueEmail);let n="btn btn-sm btn-primary editclassclient ",a="btn btn-sm btn-danger editclassclient ";if(typeof i<"u")for(let u=0;u<i.length;u++)this.dataform.push({clientID:i[u].P1,clientName:i[u].P2,mobile:i[u].P3,emailID:i[u].P4,updated:new Date(1e3*i[u].P5).toDateString()+" "+new Date(1e3*i[u].P5).toLocaleTimeString(),P6:!!i[u].P6&&i[u].P6});else this.dataform=[];!0===this.hideDeleteButton||this.adminLogin&&this.allPermissions_user.includes("Client - Update")||this.adminLogin&&"All"==this.permission_ID?this.columnTableData.push({defaultContent:"<button class='"+n+"' data-bs-target='#clientModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></i></button>"},{defaultContent:"<button class='"+a+"'><i class='fa fa-trash'></i></button>"}):this.columnTableData.push({defaultContent:"<button class='"+n+"' data-bs-target='#clientModal' data-bs-toggle='modal''><i class='fa fa-edit'></i></i></button>"}),console.log("columnDatatable",this.columnTableData),console.log("dataform",this.dataform),$("#client_lookup_table").off("click"),$("#client_lookup_table").on("click",".editclassclient",function(){let u=$(this).closest("tr"),s=l.deviceTableData.row(u);this.className==a&&l.deleteClient(s.data()),this.className==n&&l.openModalHelpher(s.data())}),this.getLookupTableData(this.dataform,this.columnTableData),this.addFromService();let l=this}getLookupTableData(i,t){var n=this;return(0,y.Z)(function*(){console.log("chk1 tm",i),console.log("chk2 tm",t);try{n.deviceTableData&&$.fn.DataTable.isDataTable("#client_lookup_table")&&$("#client_lookup_table").DataTable().destroy(),n.deviceTableData=$("#client_lookup_table").DataTable({pagingType:"full_numbers",destroy:!0,lengthChange:!0,responsive:!0,data:i,ordering:!0,order:[[5,"asc"]],columnDefs:[{type:"date",targets:5}],columns:t,rowCallback:(a,l)=>{l&&"expired"==l.P6?$(a).find("td:eq(0)").css({"background-color":"#dc3545",color:"white"}):!l||0!=l.P6&&""!=l.P6?$(a).find("td:eq(0)").css({"background-color":"#FFB534",color:"black"}):$(a).find("td:eq(0)").css({"background-color":"#9BEC00",color:"black"}),l&&"WIMATE_ADMIN"==l.clientID&&$(a).find("td:eq(0)").css({"background-color":"#21209C",color:"white"})}})}catch(a){console.error("Error initializing DataTable:",a)}})()}openModalHelpher(i){console.log("Data from llokup :",i),this.tempTableColor=!!i.P6&&i.P6,this.tempClientHolder=i.clientID,this.api.GetClient(i.clientID,i.clientID).then(t=>{t&&void 0!==t&&(console.log("User Manangement details",t),t&&this.openModal(t,"edit"))}).catch(t=>{console.log("cant fetch",t)})}addFromService(){this.columnDatatable=[],this.columnTableData=[],this.columnDatatable=[{data:"clientID"},{data:"clientDesc"},{data:"mobile"},{data:"emailID"},{data:"updated"}],this.columnTableData=[{data:"clientID"},{data:"clientName"},{data:"mobile"},{data:"emailID"},{data:"updated"}],this.checkPermission()}checkPermission(){let i=!1,t=!1;for(let n=0;n<this.allPermissions_user.length;n++)"Client - Update"===this.allPermissions_user[n]?i=!0:"Client - View"===this.allPermissions_user[n]&&(t=!0);i&&t||i?this.hideDeleteButton=!0:t?this.hideDeleteButton=!1:this.router.navigate(["/404"])}initializeClientFields(){this.createClientField=this.fb.group({logo1:[""],logo2:[""],clientID:["",g.kI.required],clientName:["",g.kI.required],customUrl:["",g.kI.required],smsGateway:[""],smsLimit:[""],pollingTime:["",g.kI.required],clientdesc:["",g.kI.required],mobile:["",g.kI.required],email_permission:["",g.kI.required],sms_permission:["",g.kI.required],telegram_permission:["",g.kI.required],health_permission:["",g.kI.required],device_permission:["",g.kI.required],alert_permission:["",g.kI.required],email:["",g.kI.required],telegramID:["",g.kI.required],enableClient:["",g.kI.required],metadata:this.fb.array([this.createItem()])}),this.subscritionFields=this.fb.group({update_mac:[""]})}checkUniqueIdentifier(i){console.log("getID",i),this.errorForUniqueID="";for(let t=0;t<this.listofSK.length;t++)if(i.target.value.toLowerCase()===this.listofSK[t].toLowerCase())return void(this.errorForUniqueID="Client ID already exists");"wimate_admin"!==i.target.value.toLowerCase()||(this.errorForUniqueID="Client ID is reserved")}createItem(){return this.fb.group({key:new g.p4("",[g.kI.required]),value:new g.p4("",[g.kI.required])})}metadata(){return this.createClientField.get("metadata")}add(){this.metadata().push(this.createItem())}remove(i){console.log("remove",i),this.createClientField.get("metadata").removeAt(i)}getDatatable(i){console.log("inside get datatble",i);let t=[],n=[];if(typeof i<"u")for(let c=0;c<i.length;c++){for(let E=0;E<i.length;E++)n[E]=new Date(i[E].updated).toLocaleString(),i[E].updated=n[E];t.push({clientID:i[c].clientID,clientDesc:i[c].clientDesc,clientName:i[c].clientName,customUrl:i[c].customUrl,smsGateway:i[c].smsGateway,smsLimit:i[c].smsLimit,pollingTime:i[c].pollingTime,deviceTimeout:i[c].deviceTimeout,email:i[c].email,emailID:i[c].emailID,enableClient:i[c].enableClient,healthCheck:i[c].healthCheck,mobile:i[c].mobile,sms:i[c].sms,telegram:i[c].telegram,alert_permission:i[c].alertTimeout,telegramID:i[c].telegramID,logo1:i[c].clientLogo1,logo2:i[c].clientLogo2,metadata:i[c].metadata,updated:i[c].updated})}else t=[];console.log("user table",t.length);let a="btn btn-sm btn-primary editdelete ",l="btn btn-sm btn-danger editdelete ";$("#client_configuration").off("click"),$("#client_configuration").on("click",".editdelete",function(){let c=$(this).closest("tr"),p=u.row(c);this.className==l?s.deleteClient(p.data()):this.className==a&&s.openModal(p.data(),"edit")}),!0===this.hideDeleteButton?this.columnDatatable.push({defaultContent:"<button class='"+a+"' data-bs-target='#clientModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></button>"},{defaultContent:"<button class='"+l+"'><i class='fa fa-trash'></i></button>"}):this.columnDatatable.push({defaultContent:"<button class='"+a+"' data-bs-target='#clientModal' data-bs-toggle='modal'><i class='fa fa-edit'></i></button>"});let u=$("#client_configuration").DataTable({pagingType:"full_numbers",destroy:!0,lengthChange:!1,responsive:!0,data:t,columns:this.columnDatatable}),s=this}createNewClient(i){var t=this;this.createClientField.get("smsGateway"),this.createClientField.get("smsLimit"),this.createClientField.get("pollingTime"),this.uploadFiles(),console.log("allUserDetails",this.createClientField.value);let n="";""!=this.createClientField.value.customUrl&&null!=this.createClientField.value.customUrl&&null!=this.createClientField.value.customUrl&&(n=this.createClientField.value.customUrl);let a=[];if(this.createClientField.value.smsLimit&&""!=this.createClientField.value.smsLimit){a.push([this.createClientField.value.smsLimit,(new Date).toLocaleString()]);try{let c,s="",p=this.createClientField.value.smsLimit;s=null==c?`SMS balance assigned to Client ID: ${this.createClientField.value.clientID.trim()}. Assigned: ${p}.`:`SMS balance updated for Client ID: ${this.createClientField.value.clientID.trim()}. From: ${c} \u2192 To: ${p}.`,this.auditTrialServices.audit_trail("2.1","Client","SMS History",s,"1")}catch(s){console.error("Error logging audit trail for SMS credit change",s)}}this.allClientDetails={PK:this.createClientField.value.clientID.trim(),SK:this.createClientField.value.clientID.trim(),clientID:this.createClientField.value.clientID.trim(),clientName:this.createClientField.value.clientName.trim(),clientDesc:this.createClientField.value.clientdesc,enableClient:this.createClientField.value.enableClient,mobile:this.createClientField.value.mobile,emailID:this.createClientField.value.email,email:this.createClientField.value.email_permission,sms:this.createClientField.value.sms_permission,telegram:this.createClientField.value.telegram_permission,healthCheck:this.createClientField.value.health_permission,deviceTimeout:this.createClientField.value.device_permission,alertTimeout:this.createClientField.value.alert_permission,telegramID:this.createClientField.value.telegramID,clientLogo1:this.base64textString_temp,clientLogo2:this.base64textString_temp_logo1,metadata:JSON.stringify([{remainder_days:this.custome_days},{cc_emails:this.emailArray},{customUrl:n},{pollingTime:this.createClientField.value.pollingTime},{smsGateway:this.createClientField.value.smsGateway,smsLimit:this.createClientField.value.smsLimit,smsHistory:a}]),updated:new Date};const l=Math.ceil((new Date).getTime()/1e3),u={P1:this.allClientDetails.PK.trim(),P2:this.allClientDetails.clientName.trim(),P3:this.allClientDetails.mobile,P4:this.allClientDetails.emailID,P5:l,P6:!1};this.spinner.show(),console.log("newly added Operational Schedule",this.allClientDetails),this.api.CreateClient(this.allClientDetails).then(function(){var s=(0,y.Z)(function*(c){if(t.addFromService(),c){if(yield t.createLookUpRdt(u,1,t.allClientDetails.PK+"#client"),""!=n){const p={PK:n,SK:1,items:JSON.stringify({clientID:t.allClientDetails.PK,clientLogo1:t.base64textString_temp,clientLogo2:t.base64textString_temp_logo1})};yield t.api.CreateLookupMasterTable(p)}t.auditTrialServices.audit_trail("2.1","Client","Create",`"${t.allClientDetails.PK}" Client was Created`,"1"),yield t.loading(),t.toast.open("New Client Configuration created successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),t.closeClient.nativeElement.click(),t.spinner.hide()}else t.spinner.hide(),T().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Error in adding Client Configuration",showCancelButton:!0,allowOutsideClick:!1})});return function(c){return s.apply(this,arguments)}}()).catch(s=>{this.spinner.hide(),console.log("err for creation",s),this.toast.open("Error in adding new client Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}createLookUpRdt(i,t,n){var a=this;return(0,y.Z)(function*(){try{console.log("iam a calleddd dude",i,t);const l=yield a.api.GetLookupMasterTable(n,t);let u=[];if(null!=l&&l.items&&"string"==typeof l.items&&(u=JSON.parse(l.items)),null!=l&&u.length<a.maxlength){let s=[];l.items&&"string"==typeof l.items&&JSON.parse(l.items).forEach(b=>{for(const v in b)Object.prototype.hasOwnProperty.call(b,v)&&s.push(b[v])}),s.unshift(i),s=s.map((h,b)=>({[`L${b+1}`]:h})),console.log("newdata 11111111 :>> ",s);let c={PK:n,SK:l.SK,createdTime:"",updatedTime:"",items:JSON.stringify(s)};const p=yield a.api.UpdateLookupMasterTable(c);console.log("createResponse :>> ",p)}else if(null==l){let s=[];s.push(i),s=s.map((h,b)=>({[`L${b+1}`]:h}));let c={SK:t,PK:n,items:JSON.stringify(s)};console.log(c);const p=yield a.api.CreateLookupMasterTable(c);console.log(p)}else yield a.createLookUpRdt(i,t+1,n)}catch(l){console.log("err :>> ",l)}})()}createLookUpMAC(i,t){var n=this;return(0,y.Z)(function*(){try{console.log("iam a calleddd dude",i,t);const a=yield n.api.GetLookupMasterTable("DeviceMacs",t);let l=[];if(null!=a&&a.items&&"string"==typeof a.items&&(l=JSON.parse(a.items)),null!=a&&l.length<n.maxlength){let u=[];a.items&&"string"==typeof a.items&&JSON.parse(a.items).forEach(h=>{for(const b in h)Object.prototype.hasOwnProperty.call(h,b)&&u.push(h[b])}),u.unshift(i),u=u.map((p,h)=>({[`L${h+1}`]:p})),console.log("newdata 11111111 :>> ",u);let s={PK:"DeviceMacs",SK:a.SK,createdTime:"",updatedTime:"",items:JSON.stringify(u)};const c=yield n.api.UpdateLookupMasterTable(s);console.log("createResponse :>> ",c)}else if(null==a){let u=[];u.push(i),u=u.map((p,h)=>({[`L${h+1}`]:p}));let s={SK:t,PK:"DeviceMacs",items:JSON.stringify(u)};console.log(s);const c=yield n.api.CreateLookupMasterTable(s);console.log(c)}else yield n.createLookUpMAC(i,t+1)}catch(a){console.log("err :>> ",a)}})()}updateClient(i,t){var n=this;this.createClientField.get("smsGateway"),this.createClientField.get("smsLimit"),this.createClientField.get("pollingTime"),console.log("passing value on update",i);let a="";if(""!=this.createClientField.value.customUrl&&null!=this.createClientField.value.customUrl&&null!=this.createClientField.value.customUrl&&(a=this.createClientField.value.customUrl),console.log("updating User fields",this.createClientField.value),"editClient"==t){let s=this.tempStoreFlags?JSON.parse(JSON.stringify(this.tempStoreFlags)):{};s.smsGateway=this.createClientField.get("smsGateway")?.value;const c=this.createClientField.get("smsLimit")?.value,p=s.smsLimit;if(c!==p){const h=(new Date).toLocaleString();Array.isArray(s.smsHistory)||(s.smsHistory=[]);try{let b="",v=this.createClientField.get("smsLimit")?.value;b=null==p?`SMS balance assigned to Client ID: ${this.createClientField.get("clientID")?.value}. Assigned: ${v}.`:`SMS balance updated for Client ID: ${this.createClientField.get("clientID")?.value}. From: ${p} \u2192 To: ${v}.`,this.auditTrialServices.audit_trail("2.1","Client","SMS History",b,"1")}catch(b){console.error("Error logging audit trail for SMS credit change",b)}s.smsHistory.push([c,h])}s.smsLimit=c,this.tempStoreFlags=s,console.log("Updated this.tempStoreFlags:",this.tempStoreFlags),this.uploadFiles(),this.allClientDetails={PK:this.createClientField.get("clientID")?.value,SK:this.createClientField.get("clientID")?.value,clientID:this.createClientField.get("clientID")?.value,clientName:this.createClientField.value.clientName,clientDesc:this.createClientField.value.clientdesc,enableClient:this.createClientField.value.enableClient,mobile:this.createClientField.value.mobile,emailID:this.createClientField.value.email,email:this.createClientField.value.email_permission,sms:this.createClientField.value.sms_permission,telegram:this.createClientField.value.telegram_permission,healthCheck:this.createClientField.value.health_permission,deviceTimeout:this.createClientField.value.device_permission,alertTimeout:this.createClientField.value.alert_permission,telegramID:this.createClientField.value.telegramID,clientLogo1:this.base64textString_temp,clientLogo2:this.base64textString_temp_logo1,metadata:JSON.stringify([{remainder_days:this.custome_days},{cc_emails:this.emailArray},{customUrl:a},{pollingTime:this.createClientField.value.pollingTime},this.tempStoreFlags?{...this.tempStoreFlags}:{}]),updated:new Date}}console.log("after updating",this.allClientDetails);const l=Math.ceil((new Date).getTime()/1e3),u={P1:this.allClientDetails.PK,P2:this.allClientDetails.clientName,P3:this.allClientDetails.mobile,P4:this.allClientDetails.emailID,P5:l,P6:this.tempTableColor};this.spinner.show(),this.api.UpdateClient(this.allClientDetails).then(function(){var s=(0,y.Z)(function*(c){if(c){if(yield n.fetchTimeMachineById(1,u.P1,"update",u),yield n.auditTrialServices.audit_trail("2.1","Client","Update",`"${n.allClientDetails.PK}" Client was Updated`,"1"),n.tempUrl!=a){const p={PK:n.tempUrl,SK:1};if(n.tempUrl&&(yield n.api.DeleteLookupMasterTable(p)),""!=a){const h={PK:a,SK:1,items:JSON.stringify({clientID:n.allClientDetails.PK,clientLogo1:n.base64textString_temp,clientLogo2:n.base64textString_temp_logo1})};yield n.api.CreateLookupMasterTable(h)}}else if(""!=a){const p={PK:a,SK:1,items:JSON.stringify({clientID:n.allClientDetails.PK,clientLogo1:n.base64textString_temp,clientLogo2:n.base64textString_temp_logo1})};yield n.api.UpdateLookupMasterTable(p)}yield n.loading(),n.toast.open("Client Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),n.addFromService(),n.closeClient.nativeElement.click(),n.spinner.hide()}else n.spinner.hide(),alert("Error in updating Client Configuration")});return function(c){return s.apply(this,arguments)}}()).catch(s=>{this.spinner.hide(),console.log("error for updating",s)})}deleteWholeclient(i,t,n,a){var l=this;return(0,y.Z)(function*(){try{const u={PK:t+"#client",SK:i};yield l.api.DeleteLookupMasterTable(u),l.auditTrialServices.audit_trail("2.1","Client","Delete",`"${t.split("#")[0]}" Client was Deleted`,"1"),console.log("Item deleted successfully.")}catch(u){console.error("Error:",u)}})()}deleteMacLookup(i,t,n,a){var l=this;return(0,y.Z)(function*(){const u="DeviceMacs";try{const s=yield l.api.GetLookupMasterTable(u,i);if(s&&s.items){let c=yield JSON.parse(s.items),p=c.findIndex(h=>h[Object.keys(h)[0]].P1===t);if(-1!==p){if("update"===n){c[p][`L${p+1}`]=a;const b=[];for(let v=0;v<c.length;v++){const I=Object.keys(c[v])[0],F=`L${v+1}`;if(I){const q={[F]:c[v][I]},k=b.findIndex(P=>Object.keys(P)[0]===F);-1!==k?Object.assign(b[k][F],c[v][I]):b.push(q)}else console.error(`Original key not found for renaming in data[${v}].`)}c=b}else"delete"===n&&c.splice(p,1);let h={PK:u,SK:s.SK,items:JSON.stringify(c)};yield l.api.UpdateLookupMasterTable(h)}else yield new Promise(h=>setTimeout(h,500)),yield l.deleteMacLookup(i+1,t,n,a)}else T().fire({position:"top-right",icon:"error",title:`ID ${t} not found`,showConfirmButton:!1,timer:1500})}catch(s){console.error("Error:",s)}})()}fetchTimeMachineById(i,t,n,a){var l=this;return(0,y.Z)(function*(){const u=t+"#client";console.log("Temp client is ",u),console.log("Type of client",typeof u);try{const s=yield l.api.GetLookupMasterTable(u,i);if(s&&s.items){let c=yield JSON.parse(s.items),p=c.findIndex(h=>h[Object.keys(h)[0]].P1===t);if(-1!==p){if("update"===n){c[p][`L${p+1}`]=a;const b=[];for(let v=0;v<c.length;v++){const I=Object.keys(c[v])[0],F=`L${v+1}`;if(I){const q={[F]:c[v][I]},k=b.findIndex(P=>Object.keys(P)[0]===F);-1!==k?Object.assign(b[k][F],c[v][I]):b.push(q)}else console.error(`Original key not found for renaming in data[${v}].`)}c=b}else"delete"===n&&c.splice(p,1);let h={PK:u,SK:s.SK,items:JSON.stringify(c)};yield l.api.UpdateLookupMasterTable(h)}else yield new Promise(h=>setTimeout(h,500)),yield l.fetchTimeMachineById(i+1,t,n,a)}else T().fire({position:"top-right",icon:"error",title:`ID ${t} not found`,showConfirmButton:!1,timer:1500})}catch(s){console.error("Error:",s)}})()}deleteS3Folder(i){var t=this;return(0,y.Z)(function*(){const n=`clientLogos/${i}/`;try{yield A.Ke.remove(n).then(a=>{console.log("Delete the folder ")}),t.cd.detectChanges()}catch(a){console.error("Error removing files from folder:",a)}})()}deleteClient(i){var t=this;return(0,y.Z)(function*(){if(t.clientSK=i,console.log("deleteuser is called",i),t.clientSK&&t.clientSK.clientID){t.allClientDetails={PK:t.clientSK.clientID,SK:t.clientSK.clientID};const n=yield t.api.GetClient(t.allClientDetails.PK,t.allClientDetails.SK),a=n.subscription&&"string"==typeof n.subscription?JSON.parse(n.subscription).length:[];if(console.log("DB Request result is here ",n),n&&n.subscription&&a>0)return T().fire({position:"center",title:`${a} MAC ID found!`,text:"In order to delete the client completely, please ensure all associated MAC IDs for the respective client are removed first. After doing so, please try again.",icon:"warning",allowOutsideClick:!1,confirmButtonText:"OK"});console.log("before deleting user",t.allClientDetails),T().fire({position:"center",title:"Are you sure?",text:"You wont get these details back again",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Yes, go ahead.",cancelButtonText:"No, let me think"}).then(l=>{console.log("inside sweetalert",l),Math.ceil((new Date).getTime()/1e3);const s={P1:t.allClientDetails.PK,P2:t.allClientDetails.SK};l.dismiss!==T().DismissReason.cancel?t.api.DeleteClient(t.allClientDetails).then(function(){var c=(0,y.Z)(function*(p){t.addFromService(),p&&(t.removeFolder(`clientLogos/${t.allClientDetails.PK}`),yield t.deleteWholeclient(1,s.P1,"delete",s),yield t.loading(),T().fire("Removed!","Client configuration successfully.","success"))});return function(p){return c.apply(this,arguments)}}()).catch(c=>{console.log("error for deleting",c)}):l.dismiss===T().DismissReason.cancel&&T().fire("Cancelled","Client configuration not removed","error")})}})()}resetFileInput(i){const t=document.getElementById(i);t&&(t.value="")}openModal(i,t){if(this.smsHistoryStorage=[],this.tempStoreFlags={},console.log("Values are here getvales ",i),this.resetFileInput("imageInput1"),this.resetFileInput("imageInput2"),this.resetFileInput("imageInput3"),this.resetFileInput("imageInput4"),this.selectedFiles={},this.imageUrls=[],this.temporderedUrls=[void 0,void 0,void 0,void 0],this.tempUrl="",this.showSubscription=!1,this.validEmail=!0,this.showDeviceForm=!1,this.allSubscribed=[],this.addUnifierID.reset(),this.deviceForm.reset(),this.deviceEdit=!1,this.addUnifier=!1,this.uniquemac="",this.files=[],this.allFiles=[],this.devicesArray=[],this.errorForUniqueEmail="",this.tempValueHolder={},this.emailArray=[],this.custome_days=[],this.reminderForm.reset(),this.updatedDaycheck=!1,document.getElementById("advancedmacid")?.classList.remove("show"),"edit"==t||""==t){let a="";if(""==i)this.showHeading=!0,this.showModal=!1,this.errorForUniqueID="",this.errorForInvalidEmail="",this.errorForUniqueEmail="",this.base64textString_temp=a,this.createClientField.get("clientID")?.enable(),this.createClientField=this.fb.group({logo1:i.logo1,logo2:i.logo2,clientID:i.clientID,clientName:i.clientName,customUrl:i.customUrl,smsGateway:{value:i.smsGateway,disabled:!this.adminLogin},smsLimit:{value:i.smsLimit,disabled:!this.adminLogin},pollingTime:{value:60,disabled:!this.adminLogin},clientdesc:i.clientDesc,mobile:i.mobile,email_permission:i.email,sms_permission:i.sms,telegram_permission:i.telegram,health_permission:i.healthCheck,alert_permission:i.alert_permission,device_permission:i.device_permission,enableClient:i.enableClient,email:i.email,telegramID:i.telegramID,metadata:this.fb.array([])});else if(i){const l=JSON.parse(i.metadata);console.log("Parsed data is here ",l),this.custome_days=l&&l[0]&&l[0].remainder_days?l[0].remainder_days:[],this.emailArray=l&&l[1]&&l[1].cc_emails?l[1].cc_emails:[],this.tempUrl=l&&l[2]&&l[2].customUrl;const u=l&&l[3]&&l[3].pollingTime;this.tempStoreFlags=l&&l[4]?JSON.parse(JSON.stringify(l[4])):[];const s=l&&l[4]&&l[4].smsGateway,c=l&&l[4]&&l[4].smsLimit;this.smsHistory=l&&l[4]&&l[4].smsLimit,this.smsHistoryStorage=l&&l[4]&&l[4].smsHistory,c&&!this.smsHistoryStorage&&(this.smsHistoryStorage=[[c,(new Date).toLocaleString()]]),console.log("this.tempStoreFlags ",this.tempStoreFlags),console.log("this.smsHistoryStorage ",this.smsHistoryStorage),console.log("tempUrl are here ",this.tempUrl),this.tempValueHolder=i,this.showSubscription=!0;for(let h=0;h<this.allPermissions_user.length;h++){if("Client - Update"===this.allPermissions_user[h]){this.hideUpdateButton=!1;break}"Client - View"===this.allPermissions_user[h]&&(this.hideUpdateButton=!0)}this.showHeading=!1,this.showModal=!0,this.base64textString_temp=i.clientLogo1,this.base64textString_temp_logo1=i.clientLogo2,this.errorForUniqueID="",this.errorForInvalidEmail="";let p="";if(this.createClientField.get("clientID")?.disable(),i.metadata&&(p=JSON.parse(i.metadata)),i.subscription){const h=JSON.parse(i.subscription);this.allSubscribed=h,console.log("Get values subscription:",this.allSubscribed)}this.createClientField=this.fb.group({logo1:i.logo1,logo2:i.logo2,clientID:{value:i.clientID,disabled:!0},clientName:i.clientName,customUrl:this.tempUrl,smsGateway:{value:s,disabled:!this.adminLogin},smsLimit:{value:c,disabled:!this.adminLogin},pollingTime:{value:u??60,disabled:!this.adminLogin},clientdesc:i.clientDesc,mobile:i.mobile,email_permission:i.email,sms_permission:i.sms,telegram_permission:i.telegram,health_permission:i.healthCheck,alert_permission:i.alert_permission,device_permission:i.deviceTimeout,email:i.emailID,telegramID:i.telegramID,enableClient:i.enableClient,metadata:this.updateItem(p)}),this.auditTrialServices.audit_trail("2.1","Client","View",`"${i.clientID}" Client was Viewed`,"1"),this.getFilesFromFolder(i.clientID)}}this.cd.detectChanges()}updateItem(i){this.metadata().clear();for(let t=0;t<i.length;t++)this.metadata().push(this.fb.group({key:i[t].key,value:i[t].value}));return this.metadata()}onFileChange(i){console.log("image",i),this.base64textString_temp=i;let t=i.target.files,n=t[0],a=n.type;if("image/gif"==a||"image/png"==a||"image/bmp"==a||"image/jpeg"==a||"image/jpg"==a){if(t&&n){let l=new FileReader;l.onload=this.handleKBconversion.bind(this),l.readAsBinaryString(n)}}else T().fire({customClass:{container:"swal2-container"},position:"center",text:"Image type should be only of GIF, PNG, JPG, JPEG and BMP",icon:"warning",showCancelButton:!0,allowOutsideClick:!1})}onFileChange1(i){console.log("image",i),this.base64textString_temp_logo1=i;let t=i.target.files,n=t[0],a=n.type;if("image/gif"==a||"image/png"==a||"image/bmp"==a||"image/jpeg"==a||"image/jpg"==a){if(t&&n){let l=new FileReader;l.onload=this.handleKBconversion1.bind(this),l.readAsBinaryString(n)}}else T().fire({customClass:{container:"swal2-container"},position:"center",text:"Image type should be only of GIF, PNG, JPG, JPEG and BMP",icon:"warning",showCancelButton:!0,allowOutsideClick:!1})}handleKBconversion(i){this.base64textString=btoa(i.target.result);let l=this.base64textString_temp.target.files[0].type,s=1;"="==this.base64textString[this.base64textString.length-1]&&"="==this.base64textString[this.base64textString.length-2]&&(s=2);let c=this.base64textString.length*(3/4)-s;if(c/=1e3,!(c<200))return T().fire({customClass:{container:"swal2-container"},position:"center",text:"Image should be less than 200KB",icon:"warning",showCancelButton:!0,allowOutsideClick:!1});this.base64textString_temp="data:"+l+";base64,"+this.base64textString}handleKBconversion1(i){this.base64textString_logo1=btoa(i.target.result);let l=this.base64textString_temp_logo1.target.files[0].type,s=1;"="==this.base64textString_logo1[this.base64textString_logo1.length-1]&&"="==this.base64textString_logo1[this.base64textString_logo1.length-2]&&(s=2);let c=this.base64textString_logo1.length*(3/4)-s;if(c/=1e3,!(c<200))return T().fire({customClass:{container:"swal2-container"},position:"center",text:"Image should be less than 200KB",icon:"warning",showCancelButton:!0,allowOutsideClick:!1});this.base64textString_temp_logo1="data:"+l+";base64,"+this.base64textString_logo1}keyPress(i){let n=String.fromCharCode(i.charCode);8!=i.keyCode&&!/[0-9\+\-\ ]/.test(n)&&i.preventDefault()}checkMail(i){console.log("event",i),this.errorForInvalidEmail="",this.validEmail=!1,console.log("Values of tempholder is",this.tempValueHolder),this.errorForUniqueEmail="",0!=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i.test(i.target.value)?1!=this.uniqueEmail.includes(i.target.value)||this.tempValueHolder.emailID==i.target.value?this.validEmail=!0:this.errorForUniqueEmail="Duplicate Email Address Found":this.errorForInvalidEmail="Invalid Email Address"}selectOperation(){this.devicesArray=[],this.addUnifier=!0,this.editOperation=!1,this.uniquemac="",this.currentMACSelected="",this.files=[],this.deviceForm=this.fb.group({deviceName:[""],macID:[""],simNo:[""],imei:[""],subscriptionStartDate:[""],subscriptionEndDate:[""],comments:[""],publish_freq:[""],subs_type:[""]}),this.addUnifierID=this.fb.group({name:["",g.kI.required],poNo:["",g.kI.required],project_code:["",g.kI.required],invoiceNo:[""],invoiceAmount:[""],invoiceDate:["",[g.kI.required],[this.asyncDateValidator()]],warrantyStartDate:["",[g.kI.required],[this.asyncDateValidator()]],type_of_service:[""],mac_SimNo:[""],mac_Imei:[""],warrantyEndDate:["",[g.kI.required],[this.asyncDateValidator()]],subscriptionStartDate:["",[g.kI.required],[this.asyncDateValidator()]],simService:[""],subscriptionEndDate:["",[g.kI.required],[this.asyncDateValidator()]],no_of_devices:["",g.kI.required],update_device:[""],mac_subs_type:["",g.kI.required],fileUpload:[null],comments:[""],dateUpdated:["",[g.kI.required],[this.asyncDateValidator()]]}),this.scrollToBottom(),this.cd.detectChanges()}toggleDeviceForm(){this.showDeviceForm=!0,this.deviceEdit=!1,this.deviceForm=this.fb.group({deviceName:[""],macID:[""],simNo:[""],imei:[""],subscriptionStartDate:[""],subscriptionEndDate:[""],comments:[""],publish_freq:[""],subs_type:[""]}),this.deviceForm.get("macID")?.setValue(this.addUnifierID.get("name")?.value)}addDevice(){this.deviceForm.valid&&(this.devicesArray.push(this.deviceForm.value),console.log("Added devices are ",this.devicesArray),this.devicesTable(),this.deviceForm.reset(),this.showDeviceForm=!1,T().fire({customClass:{container:"my-swal"},position:"center",title:"Device is Successfully Added",text:"Confirm Changes by Clicking Submit/Update",icon:"success"}))}addunifier(i){var t=this;return(0,y.Z)(function*(){if(t.spinner.show(),t.addUnifierID.valid){let n=t.addUnifierID.value;n.devices=t.devicesArray,n.fileUpload=t.files,console.log("The final data to be added is",n),t.devices.push(t.deviceForm.value),console.log("Added devices are ",t.devices),t.deviceForm.reset(),t.showDeviceForm=!1,t.allSubscribed.push(n);const a=yield t.preprocess(t.allSubscribed);console.log("Resukt to change color is here ",a),t.allClientDetails={PK:t.createClientField.get("clientID")?.value,SK:t.createClientField.get("clientID")?.value,clientName:t.createClientField.value.clientName,mobile:t.createClientField.value.mobile,emailID:t.createClientField.value.email,subscription:JSON.stringify(t.allSubscribed)},console.log("after updating",t.allClientDetails);const l=Math.ceil((new Date).getTime()/1e3),u={P1:t.allClientDetails.PK,P2:t.allClientDetails.clientName,P3:t.allClientDetails.mobile,P4:t.allClientDetails.emailID,P5:l,P6:a},s={P1:t.addUnifierID.value.name,P2:t.allClientDetails.PK};t.api.UpdateClient(t.allClientDetails).then(function(){var c=(0,y.Z)(function*(p){p?(yield t.fetchTimeMachineById(1,t.allClientDetails.PK,"update",u),t.macTable(),yield t.createLookUpMAC(s,1),yield t.loading(),t.auditTrialServices.audit_trail("2.1","Client","Create",`"${t.allClientDetails.PK}" Client (${t.addUnifierID.value.name}) Unifier Mac was Created`,"1"),t.spinner.hide(),t.toast.open("Client Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),t.addFromService(),t.addUnifier=!1,t.cd.detectChanges()):alert("Error in updating Client Configuration")});return function(p){return c.apply(this,arguments)}}()).catch(c=>{t.spinner.hide(),console.log("error for updating",c)})}})()}updateunifier(i){var t=this;return(0,y.Z)(function*(){if(t.spinner.show(),t.addUnifierID.valid){t.addUnifierID.value.name=""==t.currentMACSelected?t.addUnifierID.get("name")?.value:t.currentMACSelected;let n=JSON.parse(JSON.stringify(t.addUnifierID.value));n.devices=t.devicesArray,n.fileUpload=t.files,console.log("The final data to be edited is here ",n);let a="";for(let c=0;c<t.allSubscribed.length;c++)if(console.log(`for loop ${t.allSubscribed[c].name} === ${n.name}`),t.allSubscribed[c].name==t.addUnifierID.value.name){a=t.addUnifierID.value.name,t.allSubscribed[c]=n;break}t.deviceForm.reset(),t.showDeviceForm=!1,console.log("After update of mac id data is here ",t.allSubscribed);const l=yield t.preprocess(t.allSubscribed);console.log("Resukt to change color is here ",l),t.allClientDetails={PK:t.createClientField.get("clientID")?.value,SK:t.createClientField.get("clientID")?.value,clientName:t.createClientField.value.clientName,mobile:t.createClientField.value.mobile,emailID:t.createClientField.value.email,subscription:JSON.stringify(t.allSubscribed)},console.log("after updating",t.allClientDetails);const u=Math.ceil((new Date).getTime()/1e3),s={P1:t.allClientDetails.PK,P2:t.allClientDetails.clientName,P3:t.allClientDetails.mobile,P4:t.allClientDetails.emailID,P5:u,P6:l};console.log("Lookup data to be added is",s),t.api.UpdateClient(t.allClientDetails).then(function(){var c=(0,y.Z)(function*(p){p?(yield t.fetchTimeMachineById(1,t.allClientDetails.PK,"update",s),t.macTable(),yield t.loading(),t.auditTrialServices.audit_trail("2.1","Client","Update",`"${t.allClientDetails.PK}" Client (${a}) Unifier Mac was Updated`,"1"),t.spinner.hide(),t.toast.open("Client Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),t.addFromService(),i||(t.addUnifier=!1),t.cd.detectChanges()):alert("Error in updating Client Configuration")});return function(p){return c.apply(this,arguments)}}()).catch(c=>{t.spinner.hide(),console.log("error for updating",c)})}})()}preprocess(i){var t=this;return(0,y.Z)(function*(){try{let n=!1,a="";for(const l of i){const u=l.subscriptionEndDate;console.log("Subscription end date is here",u);const s=t.toEpoch(u),c=(new Date).getTime(),v=Math.ceil((s-(c+198e5))/864e5);console.log("Diff days for MAC ID",l.macID,"is",v),v<=0&&(a="expired"),v<=60&&(n=!0,"expired"!=a&&(a="yet_to_expire"),[1,7,29,30,59,60].includes(v)&&(n=!0))}return a}catch(n){throw console.error("Error in preprocess function:",n),n}})()}toEpoch(i){return new Date(i).getTime()}updatePopulate(i){console.log("The changed value is here ",i);for(let t of this.allSubscribed)t&&t.name==i&&(this.selectedIdentifier=t,this.addUnifier=!0,this.addUnifierID=this.fb.group({name:t.name,poNo:t.poNo,invoiceNo:t.invoiceNo,invoiceAmount:t.invoiceAmount,invoiceDate:t.invoiceDate,warrantyStartDate:t.warrantyStartDate,warrantyEndDate:t.warrantyEndDate,subscriptionStartDate:t.subscriptionStartDate,simService:t.simService,type_of_service:t.type_of_service,mac_SimNo:t.mac_SimNo,mac_Imei:t.mac_Imei,project_code:t.project_code,subscriptionEndDate:t.subscriptionEndDate,update_device:t.update_device,no_of_devices:t.no_of_devices,mac_subs_type:t.mac_subs_type,comments:t.comments,dateUpdated:t.dateUpdated}));console.log("Values ot be populated on form are ",this.addUnifierID.value),this.selectedIdentifier&&this.selectedIdentifier.devices&&(this.devicesArray=this.selectedIdentifier.devices,console.log("This are the set of devices ",this.selectedIdentifier.devices))}toggleAdvancedOptions(){const i=document.getElementById("advancedOptions");i&&(i.classList.contains("show")?i.classList.remove("show"):(i.classList.add("show"),this.devicesTable())),this.cd.detectChanges()}toggleAdvancedMac(){const i=document.getElementById("advancedmacid");i&&(i.classList.contains("show")?i.classList.remove("show"):(i.classList.add("show"),this.macTable(),this.auditTrialServices.audit_trail("2.1","Client","View",`"${this.createClientField.get("clientID")?.value}" Client Mac Table was viewed`,"1")))}devicesTable(){const i=this.adminLogin?'\n  <div class="btn-group" role="group">\n    <button class="btn btn-sm btn-primary editscalepopin" title="Edit Parameter"><i class="fa fa-edit"></i></button>\n    <button class="btn btn-sm btn-danger deletescalepopin" title="Delete Parameter"><i class="fa fa-trash"></i></button>\n  </div>':'\n  <div class="btn-group" role="group">\n    <button class="btn btn-sm btn-primary editscalepopin" title="Edit Parameter"><i class="bi bi-eye-fill"></i></button>\n  </div>';$("#temp_device_tabel").off("click"),$("#temp_device_tabel").on("click",".editscalepopin, .deletescalepopin",function(){const a=$(this).closest("tr"),l=n.scalingtemp.row(a);l.index(),$(this).hasClass("editscalepopin")?(console.log("Data that is in row:",l.data()),n.editDeviceTable(l.data(),"sub_table")):$(this).hasClass("deletescalepopin")&&n.deleteDeviceTable(l.data(),"")});const t={pagingType:"full_numbers",destroy:!0,lengthChange:!0,ordering:!0,responsive:!0,data:this.devicesArray,columns:[{data:"deviceName"},{data:"macID"},{data:"simNo"},{data:"imei"},{data:"subscriptionStartDate"},{data:"subscriptionEndDate"},{data:"publish_freq"},{data:"subs_type"},{defaultContent:i}]};this.scalingtemp=$("#temp_device_tabel").DataTable(t);const n=this}macTable(){const i=this.adminLogin?'\n  <div class="btn-group" role="group"" >\n    <button class="btn btn-sm btn-primary editmacid" title="Edit Parameter"><i class="fa fa-edit"></i></button>\n    <button class="btn btn-sm btn-danger deletemacid" title="Delete Parameter"><i class="fa fa-trash"></i></button>\n  </div>':'<div class="btn-group" role="group">\n  <button class="btn btn-sm btn-primary editmacid" title="Edit Parameter"><i class="bi bi-eye-fill"></i></button>\n</div>';$("#temp_mac_table").off("click"),$("#temp_mac_table").on("click",".editmacid, .deletemacid",function(){const a=$(this).closest("tr"),l=n.macdata.row(a);l.index(),$(this).hasClass("editmacid")?(console.log("Data that is in row:",l.data()),n.editmacidTable(l.data())):$(this).hasClass("deletemacid")&&n.deletemacidTable(l.data())});const t={pagingType:"full_numbers",destroy:!0,lengthChange:!0,ordering:!0,responsive:!0,data:this.allSubscribed,columns:[{data:"name"},{data:"poNo"},{data:"project_code"},{data:"no_of_devices"},{data:"subscriptionStartDate"},{data:"subscriptionEndDate"},{defaultContent:i}]};this.macdata=$("#temp_mac_table").DataTable(t);const n=this}deleteDeviceTable(i,t){var n=this;if(this.devicesArray=this.devicesArray.filter(a=>a.deviceName!==i.deviceName),this.addUnifierID.valid){let a=this.addUnifierID.value;a.devices=this.devicesArray,console.log("The final data to be edited is here ",a),this.deviceForm.reset(),this.showDeviceForm=!1,this.allSubscribed=this.allSubscribed.map(s=>s.name===this.addUnifierID.value.name?a:s),console.log("After update of mac id data is here ",this.allSubscribed),this.allClientDetails={PK:this.createClientField.get("clientID")?.value,SK:this.createClientField.get("clientID")?.value,clientName:this.createClientField.value.clientName,mobile:this.createClientField.value.mobile,emailID:this.createClientField.value.email,subscription:JSON.stringify(this.allSubscribed)},console.log("after updating",this.allClientDetails);const l=Math.ceil((new Date).getTime()/1e3),u={P1:this.allClientDetails.PK,P2:this.allClientDetails.clientName,P3:this.allClientDetails.mobile,P4:this.allClientDetails.emailID,P5:l};this.api.UpdateClient(this.allClientDetails).then(function(){var s=(0,y.Z)(function*(c){c?(yield n.fetchTimeMachineById(1,n.allClientDetails.PK,"update",u),n.devicesTable(),n.toast.open("Client Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),n.addFromService()):alert("Error in updating Client Configuration")});return function(c){return s.apply(this,arguments)}}()).catch(s=>{console.log("error for updating",s)})}}editDeviceTable(i,t){console.log("devices data is here",i),this.deviceEdit=!0,this.showDeviceForm=!0,this.deviceForm=this.fb.group({deviceName:i.deviceName,macID:i.macID,simNo:i.simNo,imei:i.imei,subscriptionStartDate:i.subscriptionStartDate,subscriptionEndDate:i.subscriptionEndDate,comments:i.comments,publish_freq:i.publish_freq,subs_type:i.subs_type}),this.adminLogin||this.deviceForm.disable(),this.cd.detectChanges()}updateDevice(){let i=this.deviceForm.value;return this.devicesArray=this.devicesArray.map(n=>n.deviceName==i.deviceName?i:n),console.log("After update the array of devices is ",this.devicesArray),this.deviceEdit=!1,this.showDeviceForm=!1,this.devicesTable(),document.getElementById("advancedOptions")?.classList.remove("show"),T().fire({customClass:{container:"my-swal"},position:"center",title:"Device is Successfully Updated",text:"Confirm Changes by Clicking Submit/Update",icon:"success"})}editmacidTable(i){console.log("mac id to edit is:",i),this.editOperation=!0,this.showDeviceForm=!1,this.uniquemac="",this.files=i.fileUpload?i.fileUpload:[],console.log("All the files are here",this.files),this.addUnifier=!0,this.currentMACSelected=i.name,this.auditTrialServices.audit_trail("2.1","Client","View",`"${this.createClientField.get("clientID")?.value}" ClientID (${this.currentMACSelected}) MAC ID was Viewed`,"1"),this.addUnifierID=this.fb.group({name:[{value:i.name,disabled:!this.adminLogin||this.editOperation},[g.kI.required]],poNo:[{value:i.poNo,disabled:!this.adminLogin},[g.kI.required]],invoiceNo:{value:i.invoiceNo,disabled:!this.adminLogin},invoiceAmount:{value:i.invoiceAmount,disabled:!this.adminLogin},invoiceDate:[{value:i.invoiceDate,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]],warrantyStartDate:[{value:i.warrantyStartDate,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]],warrantyEndDate:[{value:i.warrantyEndDate,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]],subscriptionStartDate:[{value:i.subscriptionStartDate,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]],simService:{value:i.simService,disabled:!this.adminLogin},type_of_service:{value:i.type_of_service,disabled:!this.adminLogin},mac_SimNo:{value:i.mac_SimNo,disabled:!this.adminLogin},mac_Imei:{value:i.mac_Imei,disabled:!this.adminLogin},project_code:[{value:i.project_code,disabled:!this.adminLogin},[g.kI.required]],subscriptionEndDate:[{value:i.subscriptionEndDate,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]],update_device:{value:i.update_device,disabled:!this.adminLogin},no_of_devices:[{value:i.no_of_devices,disabled:!this.adminLogin},[g.kI.required]],fileUpload:{value:"",disabled:!this.adminLogin},comments:{value:i.comments,disabled:!this.adminLogin},mac_subs_type:[{value:i.mac_subs_type,disabled:!this.adminLogin},[g.kI.required]],dateUpdated:[{value:i.dateUpdated,disabled:!this.adminLogin},[g.kI.required],[this.asyncDateValidator()]]}),this.selectedIdentifier=i,this.selectedIdentifier&&this.selectedIdentifier.devices&&(this.devicesArray=this.selectedIdentifier.devices,console.log("This are the set of devices ",this.selectedIdentifier.devices)),this.scrollToBottom(),this.cd.detectChanges()}yearLengthValidator(){return i=>{const t=i.value;return t?4===new Date(t).getFullYear().toString().length?null:{invalidYear:{value:i.value}}:null}}AsyncDateValidator(){return i=>(0,M.of)(i.value).pipe((0,G.b)(300),(0,R.U)(t=>{const n=new Date(t),[a,l,u]=[n.getFullYear(),n.getMonth()+1,n.getDate()];return`${a}-${l.toString().padStart(2,"0")}-${u.toString().padStart(2,"0")}`===t?null:{invalidDate:!0}}),(0,j.K)(()=>(0,M.of)(null)))}asyncDateValidator(){return i=>(i.dirty||i.touched)&&i.value?(0,M.of)(i.value).pipe((0,G.b)(300),(0,R.U)(t=>{const n=new Date(t),[a,l,u]=[n.getFullYear(),n.getMonth()+1,n.getDate()],c=`${a}-${l.toString().padStart(2,"0")}-${u.toString().padStart(2,"0")}`===t,p=4===a.toString().length;return c&&p?null:{invalidDate:!0}}),(0,j.K)(()=>(0,M.of)(null))):(0,M.of)(null)}deletemacidTable(i){var t=this;return(0,y.Z)(function*(){t.allSubscribed=t.allSubscribed.filter(s=>s.name!==i.name),t.spinner.show(),console.log("After deletion this is the object",t.allSubscribed);const n=yield t.preprocess(t.allSubscribed);t.allClientDetails={PK:t.createClientField.get("clientID")?.value,SK:t.createClientField.get("clientID")?.value,clientName:t.createClientField.value.clientName,mobile:t.createClientField.value.mobile,emailID:t.createClientField.value.email,subscription:JSON.stringify(t.allSubscribed)},console.log("after updating",t.allClientDetails);const a=Math.ceil((new Date).getTime()/1e3),l={P1:t.allClientDetails.PK,P2:t.allClientDetails.clientName,P3:t.allClientDetails.mobile,P4:t.allClientDetails.emailID,P5:a,P6:n},u={P1:i.name,P2:t.allClientDetails.PK};t.api.UpdateClient(t.allClientDetails).then(function(){var s=(0,y.Z)(function*(c){if(c){const p=`Subscriptions/${t.createClientField.get("clientID")?.value}/${i.name.toString()}`;yield t.removeFolder(p),yield t.fetchTimeMachineById(1,t.allClientDetails.PK,"update",l),yield t.deleteMacLookup(1,i.name,"delete",u),t.auditTrialServices.audit_trail("2.1","Client","Delete",`"${t.allClientDetails.PK}" Client (${i.name}) Unifier Mac was Deleted`,"1"),t.macTable(),yield t.loading(),t.toast.open("Client Configuration updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),t.addFromService(),t.spinner.hide()}else alert("Error in updating Client Configuration")});return function(c){return s.apply(this,arguments)}}()).catch(s=>{t.spinner.hide(),console.log("error for updating",s)})})()}get email(){return this.emailForm.get("email")}addEmail(){const i=this.email?.value.trim();this.email?.valid?(null===this.editingIndex?this.emailArray.includes(i)?this.error="Email already added.":(this.emailArray.push(i),this.clearError()):(this.emailArray[this.editingIndex]=i,this.editingIndex=null,this.clearError()),this.emailForm.reset()):this.error="Invalid email address."}setEditingIndex(i){this.editingIndex=i,this.email?.setValue(this.emailArray[i])}removeIndex(i){i>=0&&i<this.emailArray.length&&this.emailArray.splice(i,1)}clearError(){this.errorday=null}isEditing(){return null!==this.editingIndex}get day(){return this.reminderForm.get("day")}addday(){this.updatedDaycheck=!0;const i=this.day?.value.toString().trim();this.day?.valid?(null===this.editingIndexday?this.custome_days.includes(i)?this.errorday="Day already added.":(this.custome_days.push(i),this.clearError()):(this.custome_days[this.editingIndexday]=i,this.editingIndexday=null,this.clearError()),this.validUpdate=!0,this.cd.detectChanges(),this.reminderForm.reset()):this.errorday="Invalid day."}setEditingIndexday(i){this.editingIndexday=i,this.day?.setValue(this.custome_days[i])}removeIndexday(i){i>=0&&i<this.custome_days.length&&this.custome_days.splice(i,1)}clearErrorday(){this.errorday=null}isEditingday(){return null!==this.editingIndexday}onFileUpload(i){this.spinner.show();const t=i.target.files[0];if(console.log("File added is here ",t),!t)return void T().fire({icon:"warning",title:"No file selected",text:"Please select a file to upload."});const n=this.addUnifierID.get("name")?.value;n&&""!==n.trim()?this.uploadFile(t).then(a=>{}):T().fire({icon:"warning",title:"MAC ID required",text:"Please enter a valid MAC ID before uploading a file."})}uploadFile(i){var t=this;return(0,y.Z)(function*(){const a=`Subscriptions/${t.createClientField.get("clientID")?.value}/${t.addUnifierID.get("name")?.value}/${i.name}`;try{const l=yield A.Ke.put(a,i,{contentType:i.type});t.files.push({name:i.name}),l&&(t.editOperation?yield t.updateunifier(!0):yield t.addunifier(!0).then(()=>{t.editOperation=!0})),t.cd.detectChanges(),console.log("File uploaded path is ",t.files)}catch(l){console.error("File upload failed:",l)}})()}downloadFile(i){var t=this;return(0,y.Z)(function*(){const n=`Subscriptions/${t.createClientField.get("clientID")?.value}/${t.addUnifierID.get("name")?.value}/${i}`;try{const a=yield A.Ke.get(n,{download:!0});let l;if(a.Body instanceof Blob)l=a.Body;else{if(!(a.Body instanceof ReadableStream))throw new Error("Unsupported body type");l=yield new Response(a.Body).blob()}const u=window.URL.createObjectURL(l),s=document.createElement("a");s.href=u,s.download=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(u)}catch(a){console.error("File download failed:",a)}})()}removeFile(i){var t=this;return(0,y.Z)(function*(){t.spinner.show();const n=`Subscriptions/${t.createClientField.get("clientID")?.value}/${t.addUnifierID.get("name")?.value}/${i}`;try{yield A.Ke.remove(n),console.log("File removed successfully:",i),t.files=t.files.filter(a=>a.name!==i),t.editOperation?t.updateunifier(!0):t.addunifier(!1),t.cd.detectChanges()}catch(a){console.error("File removal failed:",a)}})()}viewFile(i){var t=this;return(0,y.Z)(function*(){const n=`Subscriptions/${t.createClientField.get("clientID")?.value}/${t.addUnifierID.get("name")?.value}/${i}`;try{const a=yield A.Ke.get(n,{download:!0});let l;if(a.Body instanceof Blob)l=a.Body;else{if(!(a.Body instanceof ReadableStream))throw new Error("Unsupported body type");l=yield new Response(a.Body).blob()}const u=window.URL.createObjectURL(l);window.open(u,"_blank"),window.URL.revokeObjectURL(u)}catch(a){console.error("File view failed:",a)}})()}removeFolder(i){var t=this;return(0,y.Z)(function*(){try{console.log("File path is ",i);const n=yield A.Ke.list(i);for(const a of n)yield A.Ke.remove(a.key),console.log("File removed successfully:",a.key);yield A.Ke.remove(i),t.files=[],t.cd.detectChanges()}catch(n){console.error("Folder removal failed:",n)}})()}checkUniqueMac(i){console.log("Unique mac is ",i.target.value),this.uniquemac="";const t=this.macIDArray.find(n=>n.P1==i.target.value.trim());console.log("Dublicate check mac array is here ",t),t&&t.P1&&t.P2&&(this.uniquemac=`MAC ID is already added to ${t.P2} client `)}applyFilters(){this.filterFlag=!0,this.selectedfilter="",this.selectedfilter=$("#statusFilter").val();const i=$("#statusFilter").val();console.log("Selected filter is here ",i),this.filteredData=[],"all"==i?this.filteredData=this.lookup_data_user:""==i?this.filteredData=this.lookup_data_user.filter(t=>void 0===t.P6||t.P6===i):(this.filteredData=this.lookup_data_user.filter(t=>t.P6===i),console.log("Filtered result is here ",this.filteredData)),$("#client_lookup_table").DataTable().clear().draw(),this.dataform=[],this.getTableUser(this.filteredData,"notImp")}chunkArray(i,t){const n=[];for(let a=0;a<i.length;a+=t)n.push(i.slice(a,a+t));return n}processClientBatches(i,t){var n=this;return(0,y.Z)(function*(){const a=n.chunkArray(i,t);n.All_Client_Configuration=[];for(const l of a)try{yield n.getClientBatch(l)}catch(u){console.error("Error fetching batch:",u)}})()}downloadFilter(){var i=this;return(0,y.Z)(function*(){i.spinner.show();let t=[],n=[];i.filterFlag?(t=i.filteredData,n=t.map(l=>l.P1)):(t=i.lookup_data_user,n=t.map(l=>l.clientID)),console.log("Client List is here",n);try{yield i.processClientBatches(n,100),console.log("All the client configuration are here ",i.All_Client_Configuration),i.spinner.show();const l=new Set;l.add("PK"),l.add("clientName"),l.add("mobile"),l.add("emailID"),l.add("clientDesc"),i.All_Client_Configuration.forEach(C=>{C&&C.subscription&&C.subscription.forEach(U=>{Object.keys(U).forEach(f=>{"devices"!==f&&"fileUpload"!==f&&"cc_email"!==f&&"update_device"!==f&&l.add(`subscription-${f}`)})})});const u=["PK","clientName","mobile","emailID","clientDesc","subscription-name","subscription-no_of_devices","subscription-mac_Imei","subscription-mac_SimNo","subscription-type_of_service","subscription-mac_subs_type","subscription-simService","subscription-poNo","subscription-project_code","subscription-invoiceAmount","subscription-invoiceDate","subscription-invoiceNo","subscription-warrantyStartDate","subscription-warrantyEndDate","subscription-subscriptionStartDate","subscription-subscriptionEndDate","subscription-comments","subscription-dateUpdated"],s=Array.from(l).sort((C,U)=>u.indexOf(C)-u.indexOf(U)),c={PK:"Client ID",clientName:"Client Name",mobile:"Mobile Number",emailID:"Email ID",clientDesc:"Client Description","subscription-name":"Unifier macID","subscription-comments":"Subscription Comments","subscription-type_of_service":"Subscription Type of Service","subscription-no_of_devices":"Number of Devices","subscription-subscriptionEndDate":"Subscription End Date","subscription-invoiceAmount":"Subscription Invoice Amount","subscription-warrantyEndDate":"Subscription Warranty End Date","subscription-project_code":"Project Code","subscription-invoiceDate":"Invoice Date","subscription-dateUpdated":"Subscription Date Updated","subscription-mac_Imei":"IMEI Number","subscription-warrantyStartDate":"Subscription Warranty Start Date","subscription-mac_subs_type":"Subscription MAC Subscription Type","subscription-poNo":"Subscription PO No","subscription-simService":"Subscription SIM Service","subscription-mac_SimNo":"Subscription MAC SIM No","subscription-invoiceNo":"Subscription Invoice No","subscription-subscriptionStartDate":"Subscription Start Date"},p=[];i.All_Client_Configuration.forEach(C=>{const U={};s.forEach(f=>{U[f]=f.startsWith("subscription-")?"":C[f]?Array.isArray(C[f])?C[f].join(", "):C[f]:""}),p.push(U),C&&C.subscription&&"all"==i.selectedfilter?C.subscription.forEach(f=>{const Z={};s.forEach(_=>{if(_.startsWith("subscription-")){const D=_.split("-")[1];Z[_]=f[D]?Array.isArray(f[D])?f[D].join(", "):f[D]:""}else Z[_]=""}),p.push(Z)}):C&&C.subscription&&"expired"==i.selectedfilter?C.subscription.forEach(f=>{const Z={};s.forEach(_=>{if(_.startsWith("subscription-")){const D=_.split("-")[1];Z[_]=f[D]?Array.isArray(f[D])?f[D].join(", "):f[D]:""}else Z[_]=""}),i.daysBetweenDates(new Date,new Date(f.subscriptionEndDate))<=0&&p.push(Z)}):C&&C.subscription&&"yet_to_expire"==i.selectedfilter?C.subscription.forEach(f=>{const Z={};s.forEach(_=>{if(_.startsWith("subscription-")){const D=_.split("-")[1];Z[_]=f[D]?Array.isArray(f[D])?f[D].join(", "):f[D]:""}else Z[_]=""}),i.daysBetweenDates(new Date,new Date(f.subscriptionEndDate))<=60&&i.daysBetweenDates(new Date,new Date(f.subscriptionEndDate))>=0&&p.push(Z)}):C&&C.subscription&&C.subscription.forEach(f=>{const Z={};s.forEach(_=>{if(_.startsWith("subscription-")){const D=_.split("-")[1];Z[_]=f[D]?Array.isArray(f[D])?f[D].join(", "):f[D]:""}else Z[_]=""}),i.daysBetweenDates(new Date,new Date(f.subscriptionEndDate))>60&&p.push(Z)})});const h=new(Y().Workbook),b=h.addWorksheet("Client and Subscription Data"),v=s.map(C=>c[C]||C);b.addRow(v);const I={font:{bold:!0,color:{argb:"FFFFFFFF"}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"4F81BD"}},border:{top:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}}},alignment:{horizontal:"center",vertical:"middle"},numFmt:"General",protection:{locked:!0}};b.getRow(1).eachCell({includeEmpty:!0},C=>{C.style=I}),p.forEach(C=>{b.addRow(s.map(U=>C[U]||""))});const q=1,k={fill:{type:"pattern",pattern:"solid",fgColor:{argb:"AFD3E2"}},numFmt:"",font:{},alignment:{},protection:{},border:{}};b.eachRow({includeEmpty:!0},(C,U)=>{if(U>1){const f=C.getCell(q);f.value&&(f.style=k)}}),s.forEach((C,U)=>{const f=Math.max(C.length,c[C]?.length||10);b.getColumn(U+1).width=f+2}),b.views=[{state:"frozen",xSplit:1,ySplit:1}];const P=`Subscription_data_${(new Date).getDate()}_${(new Date).getMonth()+1}_${(new Date).getFullYear()}.xlsx`;h.xlsx.writeBuffer().then(C=>{const U=new Blob([C],{type:"application/octet-stream"}),f=document.createElement("a");f.href=URL.createObjectURL(U),f.download=P,document.body.appendChild(f),f.click(),document.body.removeChild(f)}),i.spinner.hide()}catch(l){console.error("Error in downloadFilter:",l),i.spinner.hide()}})()}daysBetweenDates(i,t){const n=t.getTime()-i.getTime();return Math.ceil(n/864e5)}getClientBatch(i){return new Promise((t,n)=>{let a=[...i];const l=new Set,s={type:"batchGet",table_name:"client",keys:a.map(c=>l.has(c)?(console.warn(`Duplicate PK found: ${c}`),null):(l.add(c),{PK:c,SK:c})).filter(c=>null!==c)};this.rdtConfig.postData(s).subscribe({next:c=>{let p=c;for(let h=0;h<p.length;h++)this.All_Client_Configuration.push(p[h]);console.log("iam in get clientID",this.All_Client_Configuration),t()},error:c=>{console.error("Error rdt Batch:",c),n(c)}})})}applyMacFilter(i){var t=this;return(0,y.Z)(function*(){t.spinner.show();const n=i.value;console.log("Selected filter:",n);let a=[],l=[];a=t.lookup_data_user,l=a.map(s=>s.P1),console.log("clientlist ",l),console.log("Selected Clients ",typeof t.selectedClients),0==t.selectedClients.includes("All")&&(l=l.filter(s=>t.selectedClients.includes(s))),console.log("Client List is here",JSON.parse(JSON.stringify(l)));try{yield t.processClientBatches(l,100),console.log("All the client configuration are here ",t.All_Client_Configuration);const s=new Set;s.add("PK"),s.add("clientName"),s.add("mobile"),s.add("emailID"),s.add("clientDesc"),t.All_Client_Configuration.forEach(f=>{f&&f.subscription&&f.subscription.forEach(Z=>{Object.keys(Z).forEach(_=>{"devices"!==_&&"fileUpload"!==_&&"cc_email"!==_&&"update_device"!==_&&s.add(`subscription-${_}`)})})});const c=["PK","clientName","mobile","emailID","clientDesc","subscription-name","subscription-no_of_devices","subscription-mac_Imei","subscription-mac_SimNo","subscription-type_of_service","subscription-mac_subs_type","subscription-simService","subscription-poNo","subscription-project_code","subscription-invoiceAmount","subscription-invoiceDate","subscription-invoiceNo","subscription-warrantyStartDate","subscription-warrantyEndDate","subscription-subscriptionStartDate","subscription-subscriptionEndDate","subscription-comments","subscription-dateUpdated"],p=Array.from(s).sort((f,Z)=>c.indexOf(f)-c.indexOf(Z)),h={PK:"Client ID",clientName:"Client Name",mobile:"Mobile Number",emailID:"Email ID",clientDesc:"Client Description","subscription-name":"Unifier macID","subscription-comments":"Subscription Comments","subscription-type_of_service":"Subscription Type of Service","subscription-no_of_devices":"Number of Devices","subscription-subscriptionEndDate":"Subscription End Date","subscription-invoiceAmount":"Subscription Invoice Amount","subscription-warrantyEndDate":"Subscription Warranty End Date","subscription-project_code":"Project Code","subscription-invoiceDate":"Invoice Date","subscription-dateUpdated":"Subscription Date Updated","subscription-mac_Imei":"IMEI Number","subscription-warrantyStartDate":"Subscription Warranty Start Date","subscription-mac_subs_type":"Subscription MAC Subscription Type","subscription-poNo":"Subscription PO No","subscription-simService":"Subscription SIM Service","subscription-mac_SimNo":"Subscription MAC SIM No","subscription-invoiceNo":"Subscription Invoice No","subscription-subscriptionStartDate":"Subscription Start Date"},b=[];t.All_Client_Configuration.forEach(f=>{const Z={};p.forEach(_=>{Z[_]=_.startsWith("subscription-")?"":f[_]?Array.isArray(f[_])?f[_].join(", "):f[_]:""}),b.push(Z),f&&f.subscription&&"expired"==n?f.subscription.forEach(_=>{const D={};p.forEach(w=>{if(w.startsWith("subscription-")){const S=w.split("-")[1];D[w]=_[S]?Array.isArray(_[S])?_[S].join(", "):_[S]:""}else D[w]=""}),t.daysBetweenDates(new Date,new Date(_.subscriptionEndDate))<=0&&b.push(D)}):f&&f.subscription&&"all"==n?f.subscription.forEach(_=>{const D={};p.forEach(w=>{if(w.startsWith("subscription-")){const S=w.split("-")[1];D[w]=_[S]?Array.isArray(_[S])?_[S].join(", "):_[S]:""}else D[w]=""}),b.push(D)}):f&&f.subscription&&f.subscription.forEach(_=>{const D={};p.forEach(w=>{if(w.startsWith("subscription-")){const S=w.split("-")[1];D[w]=_[S]?Array.isArray(_[S])?_[S].join(", "):_[S]:""}else D[w]=""}),t.daysBetweenDates(new Date,new Date(_.subscriptionEndDate))<=60&&t.daysBetweenDates(new Date,new Date(_.subscriptionEndDate))>=0&&b.push(D)})});const v=new(Y().Workbook),I=v.addWorksheet("Client and Subscription Data"),F=p.map(f=>h[f]||f);I.addRow(F);const q={font:{bold:!0,color:{argb:"FFFFFFFF"}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"4F81BD"}},border:{top:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}}},alignment:{horizontal:"center",vertical:"middle"},numFmt:"General",protection:{locked:!0}};I.getRow(1).eachCell({includeEmpty:!0},f=>{f.style=q}),b.forEach(f=>{I.addRow(p.map(Z=>f[Z]||""))});const P=1,C={fill:{type:"pattern",pattern:"solid",fgColor:{argb:"AFD3E2"}},numFmt:"",font:{},alignment:{},protection:{},border:{}};I.eachRow({includeEmpty:!0},(f,Z)=>{if(Z>1){const _=f.getCell(P);_.value&&(_.style=C)}}),p.forEach((f,Z)=>{const _=Math.max(f.length,h[f]?.length||10);I.getColumn(Z+1).width=_+2}),I.views=[{state:"frozen",xSplit:1,ySplit:1}];const U=`Subscription_data_${(new Date).getDate()}_${(new Date).getMonth()+1}_${(new Date).getFullYear()}.xlsx`;v.xlsx.writeBuffer().then(f=>{const Z=new Blob([f],{type:"application/octet-stream"}),_=document.createElement("a");_.href=URL.createObjectURL(Z),_.download=U,document.body.appendChild(_),_.click(),document.body.removeChild(_),t.toast.open("File Downloaded Successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})}),t.spinner.hide()}catch(s){console.error("Error in downloadFilter:",s),t.spinner.hide()}})()}fetchMacIDs(i){var t=this;return(0,y.Z)(function*(){console.log("Iam called Bro");try{const n=yield t.api.GetLookupMasterTable("DeviceMacs",i);if(n&&n.items)if("string"==typeof n.items){let a=JSON.parse(n.items);if(console.log("d1 =",a),Array.isArray(a)){for(let l=0;l<a.length;l++){const u=a[l];if(null==u)break;{const s=Object.keys(u)[0],{P1:c,P2:p}=u[s];t.macIDArray.push({P1:c,P2:p}),console.log("d2 =",t.macIDArray)}}console.log("Lookup sorting",t.macIDArray),yield t.fetchMacIDs(i+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else console.log(),console.log("All the unique MAC ID are here BTW",t.macIDArray)}catch(n){console.error("Error:",n)}})()}fetchSmsCredits(){var i=this;return(0,y.Z)(function*(){i.smsCredits=yield i.getSmsCredits(),i.showSmsCredits=!0,setTimeout(()=>{console.log("SMS credit false"),i.showSmsCredits=!1,i.cd.detectChanges()},3e3),i.cd.detectChanges()})()}getSmsCredits(){var i=this;return(0,y.Z)(function*(){const t=new O.WM({"Content-Type":"application/x-www-form-urlencoded"}),n=(new O.LE).set("apikey",i.apiKey);try{const a=yield(0,ie.n)(i.http.post(i.apiUrl,n.toString(),{headers:t}));return console.log("SMS Balance",JSON.stringify(a.balance)),a.balance.sms}catch(a){return console.error("Error fetching SMS credits:",a.error||a.message),null}})()}showSmsHistoryModal(){const i=this.modal.open(ae,{backdrop:"static",keyboard:!0,windowClass:"sms-history-modal",centered:!0});i.componentInstance.smsHistory=this.smsHistoryStorage||[],i.componentInstance.clientID=this.tempClientHolder||"",i.result.then(t=>{console.log("Modal closed with result:",t)},t=>{console.log("Modal dismissed:",t)})}scrollToBottom(){setTimeout(()=>{this.targetElement&&(this.targetElement.nativeElement.scrollIntoView({behavior:"smooth",block:"start"}),console.log("Scrolled to target element"))},100)}}return r=m,(0,d.Z)(m,"\u0275fac",function(i){return new(i||r)(e.Y36(g.QS),e.Y36(z.F),e.Y36(se.t),e.Y36(B.ux),e.Y36(ce.H7),e.Y36(H.F0),e.Y36(e.sBO),e.Y36(K.t2),e.Y36(z.F),e.Y36(O.eN),e.Y36(de.C),e.Y36(L.FF))}),(0,d.Z)(m,"\u0275cmp",e.Xpm({type:r,selectors:[["app-client"]],viewQuery:function(i,t){if(1&i&&(e.Gf(pe,5),e.Gf(fe,5),e.Gf(ge,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.closeClient=n.first),e.iGM(n=e.CRH())&&(t.modalContent=n.first),e.iGM(n=e.CRH())&&(t.targetElement=n.first)}},decls:215,vars:35,consts:[[1,"card","mb-5","mb-xl-8"],[1,"card-header","border-0","pt-5"],[1,"card-title","align-items-start","flex-column"],[1,"card-label","fw-bolder","fs-3","mb-1"],[1,"card-toolbar"],["type","button","class","btn btn-sm btn-primary","data-bs-toggle","modal","data-bs-target","#clientModal",3,"disabled","click",4,"ngIf"],[1,"card-body","py-3"],[1,"info-container","mb-4",2,"padding","1rem 2.25rem"],[1,"info-list"],[1,"color-box","expired"],[1,"color-box","near-expiry"],[1,"color-box","not-expiring"],["style","display:flex;flex-direction: row;align-items: last baseline;",4,"ngIf"],[1,"table-responsive"],["id","client_lookup_table",1,"table","table-bordered","table-responsive-sm"],[4,"ngIf"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],["id","clientModal","tabindex","-1","aria-labelledby","clientModalLabel","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content",2,"width","1200px","transform","translate(-27%, 0px)"],[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body",2,"overflow-y","auto","max-height","800px"],["modalContent",""],[1,"fv-row",3,"formGroup"],[1,"card-body","border-top","p-9"],[1,"container"],[1,"row"],[1,"col-lg-4"],["for","imageInput1",1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","file","id","imageInput1",1,"form-control",3,"change"],["class","image-preview","style","background-color: white;",3,"ngClass",4,"ngIf"],["class","btn btn-sm btn-success fw-bolder ms-2 fs-8 py-1 px-3 ",4,"ngIf"],["for","imageInput2",1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","file","id","imageInput2",1,"form-control",3,"change"],["for","imageInput3",1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","file","id","imageInput3",1,"form-control",3,"change"],["class","image-preview","style","background-color: black;",3,"ngClass",4,"ngIf"],["for","imageInput4",1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","file","id","imageInput4",1,"form-control",3,"change"],[1,"col-md-4"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","required"],["type","text","placeholder","Enter client ID","name","clientID","formControlName","clientID","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],[2,"color","#fc1900"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],["type","text","placeholder","Enter client name","name","clientName","formControlName","clientName","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["type","text","placeholder","Enter client Description","name","clientdesc","formControlName","clientdesc","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["type","text","placeholder","Enter mobile number","name","mobile","formControlName","mobile","minlength","10","maxlength","10","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keypress"],[1,"required","col-lg-12","col-form-label","fw-bold","fs-6"],["type","number","min","0","appPreventScroll","","placeholder","Enter Polling Time","name","pollingTime","formControlName","pollingTime","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["type","email","placeholder","Enter email","name","email","formControlName","email","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],["style","color: #fc1900;",4,"ngIf"],[1,"col-lg-12","col-form-label","fw-bold","fs-6"],["type","number","appPreventScroll","","placeholder","Enter Telegram ID","name","telegramID","formControlName","telegramID",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],[1,"col-lg-6","col-form-label","fw-bold","fs-6"],["type","text","placeholder","Enter custom url","name","customUrl","formControlName","customUrl",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","smsGateway","name","smsGateway",1,"form-select","form-select-solid","form-select-lg"],["disabled","",3,"value","selected"],["value","textLocal"],["value","exotel"],["type","number","formControlName","smsLimit","name","smsLimit","min","0","oninput","this.value = this.value.replace(/[^0-9]/g, '')","step","1","placeholder","Enter SMS limit",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],[1,"col-md-4",2,"padding-top","40px"],[1,"form-check","form-check-inline","form-check-solid","me-5"],["name","health_permission","type","checkbox","formControlName","health_permission",1,"form-check-input"],[1,"fw-bold","ps-2","fs-6"],["name","device_permission","type","checkbox","formControlName","device_permission",1,"form-check-input"],[1,"form-check","form-check-inline","form-check-solid","me-5",2,"padding-top","5px"],["name","alert_permission","type","checkbox","formControlName","alert_permission",1,"form-check-input"],["name","email_permi","type","checkbox","formControlName","email_permission",1,"form-check-input"],["name","sms","type","checkbox","formControlName","sms_permission",1,"form-check-input"],["name","telegram_permission","type","checkbox","formControlName","telegram_permission",1,"form-check-input"],[1,"col-md-4","form-check","form-switch"],[1,"col-lg-12",2,"padding-top","40px"],["formControlName","enableClient","type","checkbox",1,"col-lg-6","form-check-input"],[1,"col-lg-6","col-form-label","fw-bold","fs-6",2,"padding-top","0px"],["class","col-md-4",3,"click",4,"ngIf"],["class","container mt-4","style","border: 1px solid black;border-radius: 5px;",4,"ngIf"],[1,"container",2,"display","none"],["formArrayName","metadata"],[4,"ngFor","ngForOf"],["type","button","ngbTooltip","Add Carefully!!!",1,"btn","btn-sm","btn-icon","btn-primary",2,"font-size","5px",3,"click"],[1,"svg-icon","svg-icon-3",3,"inlineSVG"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-danger"],["closeClient",""],["type","submit","class","btn btn-sm btn-primary",3,"hidden","disabled","click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary not-allowed",3,"disabled","click",4,"ngIf"],["class","fv-row",3,"formGroup",4,"ngIf"],["id","filterMACID","tabindex","-1","aria-labelledby","macIdFilterModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-content"],["id","macIdFilterModalLabel",1,"modal-title"],[1,"modal-body"],[1,"mb-3"],["for","macFilter",1,"form-label"],["id","macFilter",1,"form-select"],["macFilter",""],["value","all"],["value","expired"],["value","near_expiry"],["appearance","fill","class","w-100",4,"ngIf"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","data-bs-toggle","modal","data-bs-target","#clientModal",1,"btn","btn-sm","btn-primary",3,"disabled","click"],[2,"display","flex","flex-direction","row","align-items","last baseline"],[1,"filter-container"],["for","statusFilter"],["id","statusFilter"],["value",""],["value","yet_to_expire"],["type","button",1,"btn","btn-primary","btn-active-color-dark","btn-sm",3,"click"],[2,"margin-left","auto"],["type","button","data-bs-toggle","modal","data-bs-target","#filterMACID",1,"btn","btn-primary","btn-sm"],[2,"position","relative","display","inline-block","text-align","center"],["class","sms-credits-bubble animate-fade-in",4,"ngIf"],[1,"sms-credits-bubble","animate-fade-in"],[1,"modal-title"],[1,"image-preview",2,"background-color","white",3,"ngClass"],[1,"img-fluid","rounded",2,"max-width","120px","max-height","120px",3,"src"],[1,"btn","btn-sm","btn-success","fw-bolder","ms-2","fs-8","py-1","px-3"],[1,"image-preview",2,"background-color","black",3,"ngClass"],[1,"fv-plugins-message-container","invalid-feedback"],[1,"col-md-4",3,"click"],[1,"col-lg-12",2,"padding-top","30px"],["type","submit",1,"btn","btn-sm","btn-dark"],[1,"container","mt-4",2,"border","1px solid black","border-radius","5px"],[1,"d-flex","align-items-center","mb-4",3,"formGroup"],["formControlName","day","type","number","appPreventScroll","","min","0","max","999","placeholder","Enter custom Remainder days",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["type","button",1,"btn","btn-success",3,"click"],["class","text-danger",4,"ngIf"],[1,"text-danger"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"list-group",2,"display","flex","flex-direction","row","gap","1%","flex-wrap","wrap"],["style","max-width: 22%;","class","form-control form-control-lg form-control-solid mb-3 d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"form-control","form-control-lg","form-control-solid","mb-3","d-flex","justify-content-between","align-items-center",2,"max-width","22%"],[1,"btn","custom-primary","btn-sm",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"alert","alert-danger","mt-3"],["class","col-md-4",4,"ngIf"],["formControlName","email","placeholder","Enter an email address",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["style","max-width: 45%;","class","form-control form-control-lg form-control-solid mb-3 d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"form-control","form-control-lg","form-control-solid","mb-3","d-flex","justify-content-between","align-items-center",2,"max-width","45%"],[3,"formGroupName"],["type","text","formControlName","key","placeholder","key",2,"margin","2px"],["type","text","formControlName","value","placeholder","value"],["type","button","ngbTooltip","Delete Carefully!!!",1,"btn","btn-sm","btn-icon","btn-danger",2,"font-size","5px",3,"click"],[1,"svg-icon","svg-icon-1",3,"inlineSVG"],["type","submit",1,"btn","btn-sm","btn-primary",3,"hidden","disabled","click"],["type","button",1,"btn","btn-sm","btn-primary","not-allowed",3,"disabled","click"],[1,"subs_btn"],[1,"subscription-heading"],[1,"advanced-options","mt-4","mb-4"],["type","button",1,"btn","btn-sm","btn-dark","btn-advanced",3,"click"],[1,"fas","fa-chevron-down"],["id","advancedmacid",1,"collapse"],[1,"card"],[1,"card-body"],["id","temp_mac_table",1,"table","table-row-dashed","table-row-gray-300","align-middle","gs-0","gy-4"],[1,"row",2,"display","flex","flex-direction","row","justify-content","flex-start","align-items","center"],[1,"btn","btn-primary","btn-sm",3,"disabled","click"],["class","col-md-4","style","display: none;",4,"ngIf"],[1,"col-md-4",2,"display","none"],["formControlName","update_mac","name","update_mac",1,"form-select","form-select-solid","form-select-lg",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["targetElement",""],["formControlName","name","placeholder","Enter unifier ID name",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"keyup"],["type","number","appPreventScroll","","placeholder","Enter No of Devices","name","no_of_devices","formControlName","no_of_devices","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","mac_SimNo","placeholder","Enter SIM No.",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","simService","placeholder","Enter SIM Service",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","mac_Imei","placeholder","Enter IMEI",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","poNo","placeholder","Enter PO No.",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],[1,"container","mt-4","mb-4","p-3",2,"border","1px black ridge","border-radius","5px","display","none"],[1,"mt-1",2,"text-align","center"],[1,"advanced-options","mt-4"],["id","advancedOptions",1,"collapse"],["id","temp_device_tabel",1,"table","table-row-dashed","table-row-gray-300","align-middle","gs-0","gy-4"],[1,"mb-3","mt-3"],["type","button",1,"btn","btn-primary","btn-sm",3,"disabled","click"],["formControlName","project_code","placeholder","Enter Project Code",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","invoiceNo","placeholder","Enter Invoice No.",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","invoiceAmount","placeholder","Enter Invoice Amount",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","type_of_service","type","text","placeholder","Enter Product/Service",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","mac_subs_type",1,"form-select","form-select-solid","form-select-lg","fw-bold"],["value","","disabled",""],["value","golden"],["value","silver"],["value","platinum"],["formControlName","comments","placeholder","Enter comments",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","invoiceDate","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","warrantyStartDate","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","warrantyEndDate","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","subscriptionStartDate","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","subscriptionEndDate","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","dateUpdated","type","date",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["class","col-md-4 mt-4",4,"ngIf"],["formControlName","update_device","name","update_device",1,"form-select","form-select-solid","form-select-lg",3,"change"],[3,"formGroup"],["formControlName","simNo","placeholder","Enter SIM No.",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","publish_freq","placeholder","Enter Publish frequency",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","imei","placeholder","Enter IMEI",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","subscriptionEndDate","type","date","max","1979-12-31",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["formControlName","subs_type",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0","custom-select"],["class","col-md-4 mt-3",4,"ngIf"],[1,"col-md-4","mt-3"],["type","button",1,"btn","btn-success",3,"disabled","click"],["formControlName","fileUpload","type","file",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0",3,"change"],["style","max-width: 100%;","class","form-control form-control-lg form-control-solid mb-3 d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],["class","tootipData"],["toolcontent",""],[1,"form-control","form-control-lg","form-control-solid","mb-3","d-flex","justify-content-between","align-items-center",2,"max-width","100%"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-dark","btn-sm",3,"ngbTooltip","click"],[1,"col-md-4","mt-4"],["appearance","fill",1,"w-100"],["multiple","",3,"ngModel","ngModelChange"]],template:function(i,t){if(1&i){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2)(3,"span",3),e._uU(4," Client Configuration"),e.qZA()(),e.TgZ(5,"div",4),e.YNc(6,he,2,1,"button",5),e.qZA()()(),e.TgZ(7,"div",0)(8,"div",6)(9,"div",7)(10,"ul",8)(11,"li"),e._UZ(12,"span",9),e._uU(13," Red - Expired"),e.qZA(),e.TgZ(14,"li"),e._UZ(15,"span",10),e._uU(16," Orange - Expiring Soon(2 months)"),e.qZA(),e.TgZ(17,"li"),e._UZ(18,"span",11),e._uU(19," Green - Not yet expired(2 months)"),e.qZA()(),e.YNc(20,be,20,1,"div",12),e.qZA(),e.TgZ(21,"div",13)(22,"table",14)(23,"thead"),e.YNc(24,ve,15,0,"tr",15),e.YNc(25,Ce,13,0,"tr",15),e.qZA()()()()(),e.TgZ(26,"ngx-spinner",16)(27,"p",17),e._uU(28,"Please wait while we complete your request"),e.qZA()(),e.TgZ(29,"div",18)(30,"div",19)(31,"div",20)(32,"div",21),e.YNc(33,ye,2,0,"h2",22),e.YNc(34,Ze,2,0,"h2",22),e._UZ(35,"button",23),e.qZA(),e.TgZ(36,"div",24,25)(38,"div",26)(39,"div",27)(40,"div",28)(41,"div",29)(42,"div",30)(43,"label",31),e._uU(44,"Client Logo"),e.qZA(),e.TgZ(45,"input",32),e.NdJ("change",function(l){return t.onFileUploaded(l,"imageInput1")}),e.qZA(),e.YNc(46,De,2,4,"div",33),e.TgZ(47,"span"),e.YNc(48,xe,2,0,"a",34),e.qZA()(),e.TgZ(49,"div",30)(50,"label",35),e._uU(51," Favicon Logo"),e.qZA(),e.TgZ(52,"input",36),e.NdJ("change",function(l){return t.onFileUploaded(l,"imageInput2")}),e.qZA(),e.YNc(53,Ie,2,4,"div",33),e.TgZ(54,"span"),e.YNc(55,Ue,2,0,"a",34),e.qZA()(),e.TgZ(56,"div",30)(57,"label",37),e._uU(58,"Client Logo (Dark Theme)"),e.qZA(),e.TgZ(59,"input",38),e.NdJ("change",function(l){return t.onFileUploaded(l,"imageInput3")}),e.qZA(),e.YNc(60,Te,2,4,"div",39),e.TgZ(61,"span"),e.YNc(62,we,2,0,"a",34),e.qZA()(),e.TgZ(63,"div",30)(64,"label",40),e._uU(65," Favicon Logo (Dark theme)"),e.qZA(),e.TgZ(66,"input",41),e.NdJ("change",function(l){return t.onFileUploaded(l,"imageInput4")}),e.qZA(),e.YNc(67,Se,2,4,"div",39),e.TgZ(68,"span"),e.YNc(69,Ae,2,0,"a",34),e.qZA()(),e.TgZ(70,"div",42)(71,"label",43),e._uU(72," Client ID"),e.qZA(),e.TgZ(73,"input",44),e.NdJ("keyup",function(l){return t.checkUniqueIdentifier(l)}),e.qZA(),e.TgZ(74,"span",45),e._uU(75),e.qZA(),e.YNc(76,Fe,2,0,"div",46),e.qZA(),e.TgZ(77,"div",42)(78,"label",43),e._uU(79," Client Name"),e.qZA(),e._UZ(80,"input",47),e.YNc(81,ke,2,0,"div",46),e.qZA()()(),e.TgZ(82,"div",28)(83,"div",29)(84,"div",42)(85,"label",43),e._uU(86,"Client Description"),e.qZA(),e._UZ(87,"input",48),e.YNc(88,qe,2,0,"div",46),e.qZA(),e.TgZ(89,"div",42)(90,"label",43),e._uU(91," Mobile"),e.qZA(),e.TgZ(92,"input",49),e.NdJ("keypress",function(l){return t.keyPress(l)}),e.qZA(),e.YNc(93,Pe,2,0,"div",46),e.qZA(),e.TgZ(94,"div",42)(95,"label",50),e._uU(96,"Dashboard Polling Time (sec) "),e.qZA(),e._UZ(97,"input",51),e.qZA()()(),e.TgZ(98,"div",28)(99,"div",29)(100,"div",42)(101,"label",43),e._uU(102," Email "),e.qZA(),e.TgZ(103,"input",52),e.NdJ("keyup",function(l){return t.checkMail(l)}),e.qZA(),e.YNc(104,Ne,2,1,"span",53),e.YNc(105,Me,2,1,"span",53),e.YNc(106,Ee,2,0,"div",46),e.qZA(),e.TgZ(107,"div",42)(108,"label",54),e._uU(109," Telegram Channel ID "),e.qZA(),e._UZ(110,"input",55),e.qZA(),e.TgZ(111,"div",42)(112,"label",56)(113,"b"),e._uU(114,"Custom Url"),e.qZA()(),e._UZ(115,"input",57),e.qZA(),e.TgZ(116,"div",42)(117,"label",56)(118,"b"),e._uU(119,"SMS gateway"),e.qZA()(),e.TgZ(120,"select",58)(121,"option",59),e._uU(122,"Select SMS gateway"),e.qZA(),e.TgZ(123,"option",60),e._uU(124,"Text Local"),e.qZA(),e.TgZ(125,"option",61),e._uU(126,"Exotel"),e.qZA()()(),e.TgZ(127,"div",42)(128,"label",56)(129,"b"),e._uU(130,"SMS Notification Limit"),e.qZA()(),e._UZ(131,"input",62),e.qZA(),e.TgZ(132,"div",63)(133,"label",64),e._UZ(134,"input",65),e.TgZ(135,"span",66),e._uU(136,"Health Check "),e.qZA()(),e.TgZ(137,"label",64),e._UZ(138,"input",67),e.TgZ(139,"span",66),e._uU(140,"Device Timeout "),e.qZA()(),e.TgZ(141,"label",68),e._UZ(142,"input",69),e.TgZ(143,"span",66),e._uU(144,"Alert Timeout "),e.qZA()()(),e.TgZ(145,"div",42)(146,"label",54),e._uU(147,"Client Permission"),e.qZA(),e.TgZ(148,"label",64),e._UZ(149,"input",70),e.TgZ(150,"span",66),e._uU(151,"Email "),e.qZA()(),e.TgZ(152,"label",64),e._UZ(153,"input",71),e.TgZ(154,"span",66),e._uU(155,"SMS "),e.qZA()(),e.TgZ(156,"label",64),e._UZ(157,"input",72),e.TgZ(158,"span",66),e._uU(159,"Telegram "),e.qZA()()(),e.TgZ(160,"div",73)(161,"div",74),e._UZ(162,"input",75),e.TgZ(163,"label",76)(164,"b"),e._uU(165,"Enable Client"),e.qZA()()()(),e.YNc(166,Oe,4,0,"div",77),e.qZA()(),e.TgZ(167,"div",28),e._UZ(168,"div",29),e.qZA(),e.TgZ(169,"div",28),e._UZ(170,"div",29),e.qZA(),e.YNc(171,He,18,8,"div",78),e.YNc(172,ze,6,3,"div",78),e.TgZ(173,"div",79)(174,"label",54),e._uU(175,"Metadata"),e.qZA(),e.ynx(176,80),e.YNc(177,We,10,2,"ng-container",81),e.BQk(),e.TgZ(178,"button",82),e.NdJ("click",function(){return t.add()}),e._UZ(179,"span",83),e.qZA()(),e.TgZ(180,"div",84)(181,"button",85,86),e._uU(183,"Cancel"),e.qZA(),e.YNc(184,Ve,2,2,"button",87),e.YNc(185,Xe,2,1,"button",88),e.qZA()()(),e._UZ(186,"hr"),e.YNc(187,it,38,3,"div",89),e.TgZ(188,"div",27),e.YNc(189,wt,144,22,"div",89),e.qZA()()()()(),e.TgZ(190,"div",90)(191,"div",19)(192,"div",91)(193,"div",21)(194,"h5",92),e._uU(195,"Filter by MAC ID"),e.qZA(),e._UZ(196,"button",23),e.qZA(),e.TgZ(197,"div",93)(198,"div",94)(199,"label",95),e._uU(200,"Select Filter:"),e.qZA(),e.TgZ(201,"select",96,97)(203,"option",98),e._uU(204,"All"),e.qZA(),e.TgZ(205,"option",99),e._uU(206,"Expired"),e.qZA(),e.TgZ(207,"option",100),e._uU(208,"Expiring Soon"),e.qZA()()(),e.YNc(209,At,5,2,"mat-form-field",101),e.qZA(),e.TgZ(210,"div",84)(211,"button",102),e._uU(212,"Close"),e.qZA(),e.TgZ(213,"button",103),e.NdJ("click",function(){e.CHM(n);const l=e.MAs(202);return e.KtG(t.applyMacFilter(l))}),e._uU(214,"Download"),e.qZA()()()()()}if(2&i){let n,a,l,u,s;e.xp6(6),e.Q6J("ngIf",t.hideDeleteButton),e.xp6(14),e.Q6J("ngIf",t.adminLogin),e.xp6(4),e.Q6J("ngIf",!0===t.hideDeleteButton),e.xp6(1),e.Q6J("ngIf",!1===t.hideDeleteButton),e.xp6(1),e.Q6J("fullScreen",!0),e.xp6(7),e.Q6J("ngIf",t.showHeading),e.xp6(1),e.Q6J("ngIf",!t.showHeading),e.xp6(4),e.Q6J("formGroup",t.createClientField),e.xp6(8),e.Q6J("ngIf",t.imageUrls[0]),e.xp6(2),e.Q6J("ngIf",t.imageUrls[0]),e.xp6(5),e.Q6J("ngIf",t.imageUrls[1]),e.xp6(2),e.Q6J("ngIf",t.imageUrls[1]),e.xp6(5),e.Q6J("ngIf",t.imageUrls[2]),e.xp6(2),e.Q6J("ngIf",t.imageUrls[2]),e.xp6(5),e.Q6J("ngIf",t.imageUrls[3]),e.xp6(2),e.Q6J("ngIf",t.imageUrls[3]),e.xp6(6),e.Oqu(t.errorForUniqueID),e.xp6(1),e.Q6J("ngIf",(null==(n=t.createClientField.get("clientID"))?null:n.hasError("required"))&&(null==(n=t.createClientField.get("clientID"))?null:n.touched)),e.xp6(5),e.Q6J("ngIf",(null==(a=t.createClientField.get("clientName"))?null:a.hasError("required"))&&(null==(a=t.createClientField.get("clientName"))?null:a.touched)),e.xp6(7),e.Q6J("ngIf",(null==(l=t.createClientField.get("clientdesc"))?null:l.hasError("required"))&&(null==(l=t.createClientField.get("clientdesc"))?null:l.touched)),e.xp6(5),e.Q6J("ngIf",(null==(u=t.createClientField.get("mobile"))?null:u.hasError("required"))&&(null==(u=t.createClientField.get("mobile"))?null:u.touched)),e.xp6(11),e.Q6J("ngIf",t.errorForInvalidEmail),e.xp6(1),e.Q6J("ngIf",t.errorForUniqueEmail),e.xp6(1),e.Q6J("ngIf",(null==(s=t.createClientField.get("email"))?null:s.hasError("required"))&&(null==(s=t.createClientField.get("email"))?null:s.touched)),e.xp6(15),e.Q6J("value",null),e.xp6(45),e.Q6J("ngIf",t.smsHistoryStorage&&t.smsHistoryStorage.length>0),e.xp6(5),e.Q6J("ngIf",t.adminLogin),e.xp6(1),e.Q6J("ngIf",t.adminLogin),e.xp6(5),e.Q6J("ngForOf",t.metadata().controls),e.xp6(2),e.Q6J("inlineSVG","./assets/media/icons/duotune/arrows/arr075.svg"),e.xp6(5),e.Q6J("ngIf",t.showModal),e.xp6(1),e.Q6J("ngIf",!t.showModal),e.xp6(2),e.Q6J("ngIf",t.showSubscription),e.xp6(2),e.Q6J("ngIf",t.addUnifier),e.xp6(20),e.Q6J("ngIf",(null==t.listofSK?null:t.listofSK.length)>0)}},dependencies:[N.mk,N.sg,N.O5,K.Ro,g._Y,g.YN,g.Kr,g.Fj,g.wV,g.Wl,g.EJ,g.JJ,g.JL,g.Q7,g.wO,g.nD,g.qQ,g.Fd,g.sg,g.u,g.x0,g.CE,L._L,W.KE,W.hX,V.gD,ue.ey,g.On,X.d$,me],styles:[".btn-close[_ngcontent-%COMP%]{background-color:#f1416c}.tab-content[_ngcontent-%COMP%]   .tab-pane[_ngcontent-%COMP%]{padding:0;margin:0}.card-body[_ngcontent-%COMP%]{margin:0;padding:0}.btn-advanced[_ngcontent-%COMP%]{position:relative;display:inline-block;color:#fff;border:none;padding:8px 16px;font-weight:700;cursor:pointer;outline:none;overflow:hidden;transition:background-color .3s,color .3s,transform .3s;border-radius:4px}.btn-advanced[_ngcontent-%COMP%]:hover{background-color:#007bff;color:#fff;transform:translateY(-2px)}.btn-advanced[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{margin-left:5px;transition:transform .3s ease}.btn-advanced[_ngcontent-%COMP%]:hover   .fas[_ngcontent-%COMP%]{transform:translate(5px)}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.7s}.btn[_ngcontent-%COMP%]{cursor:pointer}.subs_heading[_ngcontent-%COMP%]{background-color:red;border:none;border-radius:10px;color:#fff;padding:1%;width:-moz-fit-content;width:fit-content;text-align:center}.btn[_ngcontent-%COMP%]{font-weight:700}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.7s}.error[_ngcontent-%COMP%]{color:red;margin-top:10px}button[_ngcontent-%COMP%]{margin-left:10px}.email-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}.email-item[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:.375rem;background-color:#f8f9fa;box-shadow:0 .125rem .25rem #00000013;padding:1rem;display:flex;justify-content:space-between;align-items:center}.email-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1rem}.alert-danger[_ngcontent-%COMP%]{border-radius:.375rem}.custom-primary[_ngcontent-%COMP%]{background-color:#ff6f1e;color:#fff}.custom-primary[_ngcontent-%COMP%]:hover{background-color:#ff6f1e;color:#fff;opacity:1;transform:translateY(-2px);transition:.5s}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{background:white;padding:20px;border-radius:8px;box-shadow:0 0 10px #0000001a}.subs_btn[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;justify-content:center}.subscription-heading[_ngcontent-%COMP%]{font-size:2rem;background:linear-gradient(135deg,#FF5733,#FF0000);color:#fff;padding:1rem;border-radius:15px;text-align:center;margin:0 auto;width:-moz-fit-content;width:fit-content;box-shadow:0 4px 8px #0003;font-family:Arial,sans-serif;text-transform:uppercase}.info_table[_ngcontent-%COMP%]{margin-left:10px}.info-container[_ngcontent-%COMP%]{background:#f9f9f9;border-radius:8px;padding:1rem;border:1px solid #ddd}.info-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin-bottom:.5rem}.info-list[_ngcontent-%COMP%]{list-style-type:none;padding:0}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;align-items:center}.color-box[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:4px;display:inline-block;margin-right:.5rem}.color-box.expired[_ngcontent-%COMP%]{background-color:red}.color-box.near-expiry[_ngcontent-%COMP%]{background-color:orange}.color-box.not-expiring[_ngcontent-%COMP%]{background-color:#0f0}.filter-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.filter-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1rem;color:#333;display:block;margin-bottom:.5rem}#statusFilter[_ngcontent-%COMP%]{width:100%;padding:.5rem;font-size:1rem;border:1px solid #ced4da;border-radius:.25rem;background-color:#fff;color:#495057;box-shadow:0 0 #00000020;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}#statusFilter[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #268fff40}.image-preview[_ngcontent-%COMP%]{display:none;transition:opacity .3s ease;position:absolute;top:10%;left:50%;transform:translate(-50%);z-index:10}.show-preview[_ngcontent-%COMP%]{display:block}#imageInput1[_ngcontent-%COMP%]:hover + .image-preview[_ngcontent-%COMP%], #imageInput2[_ngcontent-%COMP%]:hover + .image-preview[_ngcontent-%COMP%], #imageInput3[_ngcontent-%COMP%]:hover + .image-preview[_ngcontent-%COMP%], #imageInput4[_ngcontent-%COMP%]:hover + .image-preview[_ngcontent-%COMP%]{display:block}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:120px;max-height:120px}.sms-credits-bubble[_ngcontent-%COMP%]{position:absolute;top:-40px;left:50%;transform:translate(-50%);background-color:#0d6efd;color:#fff;padding:8px 12px;border-radius:20px;font-weight:700;box-shadow:0 4px 12px #0003;z-index:1000;opacity:0;animation:_ngcontent-%COMP%_fadeInUp .4s ease forwards}@keyframes _ngcontent-%COMP%_fadeInUp{0%{transform:translate(-50%) translateY(10px);opacity:0}to{transform:translate(-50%) translateY(0);opacity:1}}"]})),m})();var kt=x(32296),qt=x(17700);let Pt=(()=>{var r;class m{}return r=m,(0,d.Z)(m,"\u0275fac",function(i){return new(i||r)}),(0,d.Z)(m,"\u0275mod",e.oAB({type:r})),(0,d.Z)(m,"\u0275inj",e.cJS({imports:[N.ez,K.ef,B.ZX,g.UX,L.IJ,qt.Is,V.LD,kt.ot,O.JF,g.u5,H.Bz.forChild([{path:"",component:Ft}]),X.vi.forRoot()]})),m})()}}]);