"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[9930],{79930:(ve,B,S)=>{S.r(B),S.d(B,{SendModule:()=>De});var m=S(86656),K=S(96814),j=S(22939),$=S(64190),x=S(15861),V=S(56223),q=S(11486),Y=S(90775),G=S.n(Y),Q=S(48847),W=S(13519),M=S.n(W),O=S(43093),o=S(65879),H=S(31552),Z=S(5588),X=S(74260),F=S(36624),U=S(88672),ee=S(14934);let te=(()=>{var b;class w{constructor(){(0,m.Z)(this,"columnValidations",{"Unifier Identifier":{required:!0,validate:(t,e)=>({isValid:!0})},"Device Name":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Device Name must be text"}},"Display Label":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?" "==t.charAt(0)?{isValid:!1,error:"Display Label cannot have spaces at start"}:{isValid:!0}:{isValid:!1,error:"Display Label must be text"}},Longitude:{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Longitude must be a number"}:{isValid:!0}},Latitude:{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Latitude must be a number"}:{isValid:!0}},Altitude:{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Altitude must be a number"}:{isValid:!0}},"Company ID":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Company ID must be text"}},"Reading Device Type":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?" "==t.charAt(0)?{isValid:!1,error:"Reading Device Type cannot have spaces at start"}:{isValid:!0}:{isValid:!1,error:"Reading Device Type must be text"}},"Writing Device Type":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?" "==t.charAt(0)?{isValid:!1,error:"Writing Device Type cannot have spaces at start"}:{isValid:!0}:{isValid:!1,error:"Writing Device Type must be text"}},"Operational Hours":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Operational Hours must be text"}:{isValid:!1,error:"Operational Hours must be a text"}},"Device Timeout":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Device Timeout must be text"}:{isValid:!1,error:"Device Timeout must be a text"}},"Transmission Interval":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Transmission Interval must be a number"}:{isValid:!0}},"Alert Timeout":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Alert Timeout must be a number"}:{isValid:!0}},"Device List":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Device List must be text"}:{isValid:!1,error:"Device List must be a text"}},"Primary Devices":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Primary Devices must be text"}:{isValid:!1,error:"Primary Devices must be a text"}},"Secondary Devices":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Secondary Devices must be text"}:{isValid:!1,error:"Secondary Devices must be a text"}},"Monthly Schedule Calculation Day":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Monthly Schedule Calculation Day must be a number"}:{isValid:!0}},"Disable Alerts":{required:!1,validate:(t,e)=>({isValid:!0})},"Device Profile":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Device Profile must be text"}:{isValid:!1,error:"Device Profile must be a text"}},"MQTT ID":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"MQTT ID must be text"}:{isValid:!1,error:"MQTT ID must be a text"}},"Block Number":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Block Number must be a number"}:{isValid:!0}},"X-axis":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"X-axis must be a number"}:{isValid:!0}},"Y-axis":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Y-axis must be a number"}:{isValid:!0}},"Z-axis":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Z-axis must be a number"}:{isValid:!0}},"Enable Device":{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Enable Device must be boolean such as true/false"}:{isValid:!0}},Critical:{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Critical must be boolean such as true/false"}:{isValid:!0}},"Custom Schedule":{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Custom Schedule must be boolean such as true/false"}:{isValid:!0}},Redundant:{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Redundant must be boolean such as true/false"}:{isValid:!0}},"Disable Alerts Enable":{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Disable Alerts Enable must be boolean such as true/false"}:{isValid:!0}},Reports:{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Reports must be boolean such as true/false"}:{isValid:!0}},Dashboard:{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Dashboard must be boolean such as true/false"}:{isValid:!0}}})}getColumnLetter(t){let e="";for(;t>=0;)e=String.fromCharCode(t%26+65)+e,t=Math.floor(t/26)-1;return e}isString(t){return"string"==typeof t||t instanceof String}isNumber(t){return!isNaN(Number(t))&&"boolean"!=typeof t}isInteger(t){return Number.isInteger(Number(t))}isPositive(t){return t>0}isWhitespace(t){return/\s/.test(t)}validateExcelFile(t,e,r,i,n,a,u,g,l,d,v){var f=this;return(0,x.Z)(function*(){return new Promise((C,c)=>{const s=[],T=[],E=[],L=a.map(h=>h.P2),I=t.slice(1).map(h=>h[1]),A=t.slice(1).map(h=>h[2]);console.log("All the mapped Devices are here ",I);try{const h=t[0];Object.entries(f.columnValidations).forEach(([p,N])=>{if(N.required&&!h.includes(p)){const D=Object.keys(f.columnValidations).indexOf(p);s.push({row:1,column:p,columnLetter:f.getColumnLetter(D),value:"Missing",error:`Required column "${p}" is missing`})}});for(let p=1;p<t.length;p++){const N=t[p];if(0===N.length)break;h.forEach((D,R)=>{const P=f.columnValidations[D];if(P){const _=N[R],k=f.getColumnLetter(R);if(P.required&&(null==_||""===_)&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:`${D} is required`}),"Unifier Identifier"===D&&P.required&&null!=_&&null!=_&&""!=_&&_&&isNaN(_)&&0==r.map(z=>z.name).includes(_.trim())?s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Unifier Identifier doesn't exist"}):"Unifier Identifier"===D&&null!=_&&null!=_&&""!=_&&isNaN(_)&&r.map(z=>z.name).includes(_.trim())&&0==f.validateDevice(_,r,a)&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:`Insufficient Devices in MAC ID ${_}`}),"Device Name"===D&&null!=_&&null!=_&&""!=_&&P.required&&isNaN(_)&&_&&e.includes(_.trim())&&!i?s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Device Name already present"}):"Device Name"===D&&null!=_&&null!=_&&""!=_&&P.required&&isNaN(_)&&0==e.includes(_.trim())&&i&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Device Name does not exist"}),"Device Name"===D&&P.required&&null!=_&&null!=_&&""!=_&&_&&I.filter(J=>J==_.trim()).length>1&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Duplicate Device found with name"}),"Device Name"===D&&P.required&&!d&&(console.log("Location tree devices are here ",v),null!=_&&null!=_&&""!=_&&isNaN(_)&&_.trim()&&_.trim()&&0==v.includes(_.trim())&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Device not found or You Dont have Access to update this Device"})),"Display Label"===D&&P.required&&null!=_&&null!=_&&""!=_&&isNaN(_)&&_&&L.includes(_.trim())&&!i&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Display Label already present"}),"Display Label"===D&&null!=_&&null!=_&&""!=_&&P.required&&_&&isNaN(_)&&A.filter(J=>J==_.trim()).length>1&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Duplicate Device found with name"}),"Company ID"===D&&P.required&&null!=_&&null!=_&&""!=_&&_&&isNaN(_)&&0==u.includes(_.trim())&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Company ID does not exist"}),"Reading Device Type"===D&&P.required&&null!=_&&null!=_&&""!=_&&_&&isNaN(_)&&0==g.includes(_.trim())&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Reading Device Type does not exist"}),"Writing Device Type"===D&&P.required&&null!=_&&null!=_&&""!=_&&_&&isNaN(_)&&0==l.includes(_.trim())&&s.push({row:p+1,column:D,columnLetter:k,value:_,error:"Writing Device Type does not exist"}),null!=_&&""!==_){const z=P.validate(_,p+1);z.isValid||s.push({row:p+1,column:D,columnLetter:k,value:_,error:z.error})}}}),i?E.push(N):T.push(N)}console.log("Errors array is here ",s),C({isValid:0===s.length,errors:s,createRows:T,updateRows:E})}catch(h){c(`Error processing data: ${h.message}`)}})})()}formatValidationErrors(t){return t.map(e=>`Row ${e.row}, Column ${e.columnLetter} (${e.column}): ${e.error}${e.value?` (${e.value})`:""}`)}validateDevice(t,e,r){try{const i=new Set,n=r.filter(u=>{const g=i.has(u.P1);return i.add(u.P1),!g}),a=t;if(a){const u=e.filter(l=>a===l.name),g=n.filter(l=>void 0!==l.P8&&l.P8==u[0].name);if(console.log("All the devices with same macID",g),Array.isArray(g)&&0!=g.length)return u[0].no_of_devices>g.length}return!0}catch(i){console.error("Something went wrong on change selection",i)}}}return b=w,(0,m.Z)(w,"\u0275fac",function(t){return new(t||b)}),(0,m.Z)(w,"\u0275prov",o.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"})),w})(),ie=(()=>{var b;class w{constructor(){(0,m.Z)(this,"columnValidations",{MN:{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?" "==t.charAt(0)?{isValid:!1,error:"MN cannot have spaces at start"}:{isValid:!0}:{isValid:!1,error:"MN must be text"}},"Alert Data Type":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Alert Data Type must be text"}},"Alert Variable Type":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Alert Variable Type must be text"}},"Alert Value Prediction":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Alert Value Prediction must be a number"}:{isValid:!0}},"Parameter ID":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)?this.isWhitespace(t)?{isValid:!1,error:"Parameter ID cannot contains space"}:{isValid:!0}:{isValid:!1,error:"Parameter ID must be text"}},"Parameter ID1":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)?this.isWhitespace(t)?{isValid:!1,error:"Parameter ID1 cannot contains space"}:{isValid:!0}:{isValid:!1,error:"Parameter ID1 must be text"}},"Parameter ID2":{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)?this.isWhitespace(t)?{isValid:!1,error:"Parameter ID2 cannot contains space"}:{isValid:!0}:{isValid:!1,error:"Parameter ID2 must be text"}},Equation:{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Equation must be text"}},"Alert %":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Alert % must be a number"}:{isValid:!0}},Value:{required:!1,validate:(t,e)=>this.isString(t)&&isNaN(t)||"boolean"==typeof t?{isValid:!1,error:"Value must be a number"}:{isValid:!0}},"Notification Matrix ID":{required:!1,validate:(t,e)=>({isValid:!0})},Severity:{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Severity must be text"}},"Text Active":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Text Active must be text"}},"Text Closed":{required:!0,validate:(t,e)=>this.isString(t)&&isNaN(t)?{isValid:!0}:{isValid:!1,error:"Text Closed must be text"}},"Text Snoozed":{required:!0,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Text Snoozed must be text"}:{isValid:!1,error:"Text Snoozed must be a text"}},"Alert time":{required:!1,validate:(t,e)=>null!=t&&""!==t&&"boolean"!=typeof t&&"true"!==t&&"false"!==t?{isValid:!1,error:"Enable Device must be boolean such as true/false"}:{isValid:!0}},"Operational Schedule":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Operational Schedule be text"}:{isValid:!1,error:"Operational Schedule must be a text"}},"Binding Reading Parameter":{required:!1,validate:(t,e)=>this.isString(t)?isNaN(t)?{isValid:!0}:{isValid:!1,error:"Binding Reading Parameter must be text"}:{isValid:!1,error:"Binding Reading Parameter must be a text"}}})}getColumnLetter(t){let e="";for(;t>=0;)e=String.fromCharCode(t%26+65)+e,t=Math.floor(t/26)-1;return e}isString(t){return"string"==typeof t||t instanceof String}isNumber(t){return!isNaN(Number(t))&&"boolean"!=typeof t}isInteger(t){return Number.isInteger(Number(t))}isPositive(t){return t>0}isWhitespace(t){return/\s/.test(t)}validateExcelFile(t,e,r,i,n,a,u,g,l,d,v){var f=this;return(0,x.Z)(function*(){return new Promise((C,c)=>{const s=[],T=[],E=[];try{const L=t[0];Object.entries(f.columnValidations).forEach(([I,A])=>{if(A.required&&!L.includes(I)){const h=Object.keys(f.columnValidations).indexOf(I);s.push({row:1,column:I,columnLetter:f.getColumnLetter(h),value:"Missing",error:`Required column "${I}" is missing`})}});for(let I=1;I<t.length;I++){const A=t[I];if(0===A.length)break;L.forEach((h,p)=>{const N=f.columnValidations[h];if(N){const D=A[p];let R=f.getColumnLetter(p);if(N.required&&(null==D||""===D)&&s.push({row:I+1,column:h,columnLetter:R,value:D,error:`${h} is required`}),"MN"===h&&N.required&&null!=D&&null!=D&&""!=D&&isNaN(D)&&0==e.includes(D.trim())&&s.push({row:I+1,column:h,columnLetter:R,value:D,error:"MN does not exist"}),null!=D&&null!=D&&"Alert Data Type"==h&&isNaN(D)&&D.endsWith("Prediction")){const P=A[3]?A[3]:"";R=f.getColumnLetter(3),(null==P||null==P||""==P)&&s.push({row:I+1,column:h,columnLetter:R,value:P,error:"Alert Value Prediction is required"})}if(null!=D&&null!=D&&"Alert Variable Type"==h)if(isNaN(D)&&"Constant"==D){const P=[4,8,9];for(let _=0;_<P.length;_++){const k=A[P[_]];R=f.getColumnLetter(P[_]),(null==k||null==k||""==k)&&s.push({row:I+1,column:h,columnLetter:R,value:k,error:`${L[P[_]]} is required`})}}else if(isNaN(D)&&"Parameter"==D){const P=[5,6,8];for(let _=0;_<P.length;_++){const k=A[P[_]];R=f.getColumnLetter(P[_]),(null==k||null==k||""==k)&&s.push({row:I+1,column:h,columnLetter:R,value:k,error:`${L[P[_]]} is required`})}}else{const P=A[7];R=f.getColumnLetter(7),(null==P||null==P||""==P)&&s.push({row:I+1,column:h,columnLetter:R,value:P,error:`${L[7]} is required`})}if("Notification Matrix ID"===h&&D&&null!=D&&null!=D&&""!=D&&0==r.includes(D.toString())&&s.push({row:I+1,column:h,columnLetter:R,value:D,error:"Notification Matrix ID doesn't exist"}),"Operational Schedule"===h&&D&&null!=D&&null!=D&&""!=D&&0==a.includes(D)&&s.push({row:I+1,column:h,columnLetter:R,value:D,error:"Operational Schedule doesn't exist"}),null!=D&&""!==D){const P=N.validate(D,I+1);P.isValid||s.push({row:I+1,column:h,columnLetter:R,value:D,error:P.error})}}}),i?E.push(A):T.push(A)}console.log("Errors array is here ",s),C({isValid:0===s.length,errors:s,createRows:T,updateRows:E})}catch(L){c(`Error processing data: ${L.message}`)}})})()}formatValidationErrors(t){return t.map(e=>`Row ${e.row}, Column ${e.columnLetter} (${e.column}): ${e.error}${e.value?` (${e.value})`:""}`)}validateDevice(t,e,r){try{const i=new Set,n=r.filter(u=>{const g=i.has(u.P1);return i.add(u.P1),!g}),a=t;if(a){const u=e.filter(l=>a===l.name),g=n.filter(l=>void 0!==l.P8&&l.P8==u[0].name);if(console.log("All the devices with same macID",g),Array.isArray(g)&&0!=g.length)return u[0].no_of_devices>g.length}return!0}catch(i){console.error("Something went wrong on change selection",i)}}}return b=w,(0,m.Z)(w,"\u0275fac",function(t){return new(t||b)}),(0,m.Z)(w,"\u0275prov",o.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"})),w})();const ae=["fileUpload"],re=["container"];function oe(b,w){1&b&&(o.TgZ(0,"small",7),o._uU(1,"Please select a type."),o.qZA())}function ne(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"div",5)(1,"label",6),o._uU(2,"Upload Excel File"),o.qZA(),o.TgZ(3,"input",26),o.NdJ("change",function(e){o.CHM(y);const r=o.oxw();return o.KtG(r.onFileChange(e))}),o.qZA()()}}function se(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"button",27),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();let r;return o.KtG(e.onFileSelected(null==(r=e.createDynamicSendField.get("type"))?null:r.value,"update"))}),o._uU(1," \u270f\ufe0f Update "),o.qZA()}if(2&b){const y=o.oxw();let t;o.Q6J("disabled",!(null!=(t=y.createDynamicSendField.get("type"))&&t.value)||y.macMismatch)}}function le(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"button",28),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();let r;return o.KtG(e.fetchLoggedInClientDevice(null==(r=e.createDynamicSendField.get("type"))?null:r.value))}),o._uU(1," \u{1f4e5} Get Data "),o.qZA()}if(2&b){const y=o.oxw();let t;o.Q6J("disabled",!(null!=(t=y.createDynamicSendField.get("type"))&&t.value)||y.macMismatch)}}function de(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"button",29),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();let r;return o.KtG(e.onFileSelected(null==(r=e.createDynamicSendField.get("type"))?null:r.value,"add"))}),o._uU(1," \u2795 Add New "),o.qZA()}if(2&b){const y=o.oxw();let t;o.Q6J("disabled",!(null!=(t=y.createDynamicSendField.get("type"))&&t.value)||y.macMismatch)}}function ue(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"button",30),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();let r;return o.KtG(e.download(null==(r=e.createDynamicSendField.get("type"))?null:r.value))}),o._UZ(1,"i",31),o._uU(2," Download "),o.qZA()}if(2&b){const y=o.oxw();let t;o.Q6J("disabled",!(null!=(t=y.createDynamicSendField.get("type"))&&t.value)||y.macMismatch)}}function ce(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"div",32)(1,"button",33),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();return o.KtG(e.prevPage())}),o._uU(2,"Previous"),o.qZA(),o.TgZ(3,"span"),o._uU(4),o.qZA(),o.TgZ(5,"button",33),o.NdJ("click",function(){o.CHM(y);const e=o.oxw();return o.KtG(e.nextPage())}),o._uU(6,"Next"),o.qZA()()}if(2&b){const y=o.oxw();o.xp6(1),o.Q6J("disabled",0===y.currentPage),o.xp6(3),o.AsE("Page ",y.currentPage+1," of ",y.totalPages,""),o.xp6(1),o.Q6J("disabled",y.currentPage>=y.totalPages-1)}}function he(b,w){if(1&b&&(o.TgZ(0,"div",42),o._uU(1),o.qZA()),2&b){const y=o.oxw(2);o.xp6(1),o.Oqu(y.error)}}function pe(b,w){if(1&b&&(o.TgZ(0,"tr")(1,"td",50),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA()()),2&b){const y=w.$implicit;o.xp6(2),o.Oqu(y.split(",")[0].replace("Row ","")),o.xp6(2),o.Oqu(y.split(":")[0].split(",")[1].trim()),o.xp6(2),o.Oqu(y.split(":")[1].trim())}}function ge(b,w){if(1&b&&(o.TgZ(0,"div",43)(1,"div",42)(2,"div",44)(3,"strong"),o._uU(4,"Errors Found:"),o.qZA(),o.TgZ(5,"span",45),o._uU(6),o.qZA()(),o.TgZ(7,"div",46)(8,"table",47)(9,"thead",48)(10,"tr")(11,"th"),o._uU(12,"Row"),o.qZA(),o.TgZ(13,"th"),o._uU(14,"Column"),o.qZA(),o.TgZ(15,"th"),o._uU(16,"Error"),o.qZA()()(),o.TgZ(17,"tbody"),o.YNc(18,pe,7,3,"tr",49),o.qZA()()()()()),2&b){const y=o.oxw(2);o.xp6(6),o.hij("",y.validationErrors.length," issues"),o.xp6(12),o.Q6J("ngForOf",y.validationErrors)}}function fe(b,w){if(1&b){const y=o.EpF();o.TgZ(0,"div",34)(1,"h5",35),o._uU(2,"Validation Issues"),o.qZA(),o.TgZ(3,"button",36),o.NdJ("click",function(){const r=o.CHM(y).$implicit;return o.KtG(r.dismiss())}),o.qZA()(),o.TgZ(4,"div",37),o.YNc(5,he,2,1,"div",38),o.YNc(6,ge,19,2,"div",39),o.qZA(),o.TgZ(7,"div",40)(8,"button",41),o.NdJ("click",function(){const r=o.CHM(y).$implicit;return o.KtG(r.dismiss())}),o._uU(9,"Close"),o.qZA()()}if(2&b){const y=o.oxw();o.xp6(5),o.Q6J("ngIf",y.error),o.xp6(1),o.Q6J("ngIf",y.validationErrors.length>0)}}const me=function(){return["device_xlsx","alerts_xlsx"]};let _e=(()=>{var b;class w{constructor(t,e,r,i,n,a,u,g,l,d,v,f,C,c,s,T){(0,m.Z)(this,"fb",void 0),(0,m.Z)(this,"api",void 0),(0,m.Z)(this,"toast",void 0),(0,m.Z)(this,"getDiagnostics",void 0),(0,m.Z)(this,"operationalscheduleType",void 0),(0,m.Z)(this,"getReadingDeviceType",void 0),(0,m.Z)(this,"getWritingDeviceType",void 0),(0,m.Z)(this,"companyConfiguration",void 0),(0,m.Z)(this,"locationPermissionService",void 0),(0,m.Z)(this,"router",void 0),(0,m.Z)(this,"DynamicApi",void 0),(0,m.Z)(this,"cd",void 0),(0,m.Z)(this,"spinner",void 0),(0,m.Z)(this,"modalService",void 0),(0,m.Z)(this,"excelDeviceValidator",void 0),(0,m.Z)(this,"excelAlertValidator",void 0),(0,m.Z)(this,"fileUpload",void 0),(0,m.Z)(this,"previewData",[[],[]]),(0,m.Z)(this,"getFinalData",[]),(0,m.Z)(this,"fileName","test.xlsx"),(0,m.Z)(this,"readData",[[],[]]),(0,m.Z)(this,"mappedValues",{}),(0,m.Z)(this,"grid",void 0),(0,m.Z)(this,"specific_devices",void 0),(0,m.Z)(this,"MN_name",void 0),(0,m.Z)(this,"multipleDevices",[]),(0,m.Z)(this,"renameKeys",[]),(0,m.Z)(this,"ADD_finalData",{}),(0,m.Z)(this,"userClientIDCognito",void 0),(0,m.Z)(this,"macMismatch",!1),(0,m.Z)(this,"loggedUserClientID",void 0),(0,m.Z)(this,"data_temp",[]),(0,m.Z)(this,"uniqueDevicesList",[]),(0,m.Z)(this,"uniqueDevicelabelList",[]),(0,m.Z)(this,"tempMultiData",[]),(0,m.Z)(this,"tempMultiAlerts",[]),(0,m.Z)(this,"alertAllDetails",{}),(0,m.Z)(this,"opsList_Alerts",[]),(0,m.Z)(this,"opsList_Device",[]),(0,m.Z)(this,"rdtList",[]),(0,m.Z)(this,"wdtList",[]),(0,m.Z)(this,"companyList",[]),(0,m.Z)(this,"bindingParametersList",[]),(0,m.Z)(this,"parametersList",[]),(0,m.Z)(this,"temp_EnableDevice",""),(0,m.Z)(this,"temp_Critical",""),(0,m.Z)(this,"temp_CustomSchedule",""),(0,m.Z)(this,"temp_Redundant",""),(0,m.Z)(this,"temp_DisableAlerts",""),(0,m.Z)(this,"temp_Reports",""),(0,m.Z)(this,"temp_Dashboard",""),(0,m.Z)(this,"temp_Enable_alert_time",""),(0,m.Z)(this,"temp_add_Operational_schedule",""),(0,m.Z)(this,"temp_alert_Enable_Email",""),(0,m.Z)(this,"temp_alert_Enable_SMS",""),(0,m.Z)(this,"temp_alert_Enable_Telegram",""),(0,m.Z)(this,"temp_alert_Enable_type_1",""),(0,m.Z)(this,"temp_alert_Enable_type_2",""),(0,m.Z)(this,"temp_alert_Enable_type_3",""),(0,m.Z)(this,"temp_alert_Enable_type_4",""),(0,m.Z)(this,"temp_alert_Enable_type_5",""),(0,m.Z)(this,"allPermissions_user",void 0),(0,m.Z)(this,"hideUpdateButton",!1),(0,m.Z)(this,"hideGetButton",!1),(0,m.Z)(this,"error",void 0),(0,m.Z)(this,"validationErrors",[]),(0,m.Z)(this,"selectedFile",void 0),(0,m.Z)(this,"device_timeout",["Disabled","15_minute","30_minute","1_hour","6_hour","12_hour","1_day","7_day"]),(0,m.Z)(this,"container",void 0),(0,m.Z)(this,"createDynamicSendField",void 0),(0,m.Z)(this,"files",[]),(0,m.Z)(this,"maxlength",500),(0,m.Z)(this,"clientID",void 0),(0,m.Z)(this,"lookup_data_temp1",[]),(0,m.Z)(this,"lookup_data_user",[]),(0,m.Z)(this,"lookup_devices",[]),(0,m.Z)(this,"lookup_company",[]),(0,m.Z)(this,"lookup_operational",[]),(0,m.Z)(this,"username",void 0),(0,m.Z)(this,"showAlldevice",!1),(0,m.Z)(this,"locationTree",void 0),(0,m.Z)(this,"allMacID",[]),(0,m.Z)(this,"savedFileEvent",void 0),(0,m.Z)(this,"validExcelData",[]),(0,m.Z)(this,"allRDTDetails",{}),(0,m.Z)(this,"Lookupdata",[]),(0,m.Z)(this,"listofNMIds",[]),(0,m.Z)(this,"pagedPreviewData",[]),(0,m.Z)(this,"pageSize",50),(0,m.Z)(this,"currentPage",0),(0,m.Z)(this,"totalPages",void 0),this.fb=t,this.api=e,this.toast=r,this.getDiagnostics=i,this.operationalscheduleType=n,this.getReadingDeviceType=a,this.getWritingDeviceType=u,this.companyConfiguration=g,this.locationPermissionService=l,this.router=d,this.DynamicApi=v,this.cd=f,this.spinner=C,this.modalService=c,this.excelDeviceValidator=s,this.excelAlertValidator=T}ngOnInit(){var t=this;return(0,x.Z)(function*(){t.initializeSendFields(),t.userClientIDCognito=t.getDiagnostics.getLoggedUserDetails(),t.loggedUserClientID=t.userClientIDCognito.attributes["custom:clientID"],t.username=t.userClientIDCognito.attributes["custom:username"],t.clientID=t.userClientIDCognito.attributes["custom:clientID"]+"#device",t.allPermissions_user=JSON.parse(JSON.parse(JSON.stringify(localStorage.getItem("permissionDetails")))),t.getOperationalSchedule(1),t.fetchNMData(1),t.getRDT(1),t.getWDT(1),t.getCompany(1),t.fetchDevicesList(1),t.checkPermission(),yield t.getuserConfiguration(),t.showAlldevice||(yield t.getLocationConfiguration())})()}getClientinfo(){var t=this;return(0,x.Z)(function*(){try{yield t.api.GetClient(t.loggedUserClientID,t.loggedUserClientID).then(function(){var e=(0,x.Z)(function*(r){if(r&&r.subscription){console.log("Result is here ",r);const i=JSON.parse(r.subscription);t.allMacID=i.map(u=>u.name),t.allMacID=i.map(u=>({name:u.name,no_of_devices:u.no_of_devices})),console.log("all the mac id are here",t.allMacID);const n=new Set,a=t.lookup_devices.filter(u=>{const g=n.has(u.P1);return n.add(u.P1),!g});console.log("Devices are here for checking macIDs",a);for(let u of t.allMacID){const g=a.filter(l=>void 0!==l.P8&&l.P8==u.name);if(g.length>u.no_of_devices){const l=g.length-u.no_of_devices;M().fire({title:"<strong>Device Count Mismatch</strong>",icon:"warning",html:`\n                    <p>The number of devices added for MAC ID <strong>${u.name}</strong> exceeds the allotted number of <strong>${u.no_of_devices}</strong>.</p>\n                    <p>Please remove <strong>${l}</strong> devices and <strong>reload the page</strong> to proceed with device configuration.</p>\n                `,confirmButtonText:"OK",confirmButtonColor:"#3085d6",backdrop:"\n                    rgba(0,0,123,0.4)\n                    url('https://example.com/your-image.jpg')\n                    left top\n                    no-repeat\n                ",allowOutsideClick:!1}).then(()=>{t.macMismatch=!0});break}}t.cd.detectChanges()}});return function(r){return e.apply(this,arguments)}}())}catch(e){console.error("Failed to fetch client Information ",e)}})()}getuserConfiguration(){var t=this;return(0,x.Z)(function*(){console.log("We will get the user configuration now ",t.username);try{const e=yield t.api.GetUserManagement(t.username,t.loggedUserClientID);e&&(console.log("Fetched user is here",e),Array.isArray(e.device_permission)&&1==e.device_permission.length&&"All"==e.device_permission[0]&&1==e.device_permission.length&&e.location_permission&&"All"==e.location_permission[0]&&e.device_type_permission&&"All"==e.device_type_permission[0]&&(t.showAlldevice=!0))}catch(e){console.log("Error fetching user Configuration",e)}})()}getLocationConfiguration(){var t=this;return(0,x.Z)(function*(){try{const e=yield t.locationPermissionService.fetchGlobalLocationTree();if(!e)throw new Error("No data returned");if(console.log("Data from location:",e),e)try{if(Array.isArray(e)){const r=e.filter(i=>"device"===i.node_type);t.locationTree=Array.from(new Set(r.map(i=>i.mn||""))),console.log("Filtered devices are here which will be shown",t.locationTree)}else console.error("Parsed tree is not an array")}catch(r){console.error("Error parsing JSON",r)}}catch(e){console.error("Error fetching location configuration",e)}})()}checkPermission(){let t=!1,e=!1;console.log("this.allPermissions_user",this.allPermissions_user);for(let r=0;r<this.allPermissions_user.length;r++)"Device - xlsx Update"===this.allPermissions_user[r]?(t=!0,this.hideGetButton=!0,this.hideUpdateButton=!0):"Device - xlsx View"===this.allPermissions_user[r]&&(e=!0,this.hideGetButton=!0,this.hideUpdateButton=!1);t&&e||t||e?this.hideGetButton=!0:this.router.navigate(["/404"])}initializeSendFields(){this.createDynamicSendField=this.fb.group({type:["",V.kI.required]})}getOperationalSchedule(t){var e=this;return(0,x.Z)(function*(){console.log("Iam called Bro");try{const r=yield e.api.GetLookupMasterTable(e.loggedUserClientID+"#operationalschedule",t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;{const u=Object.keys(a)[0],{P1:g,P2:l,P3:d}=a[u];e.lookup_operational.push({P1:g,P2:l,P3:d})}}e.lookup_operational.sort((n,a)=>a.P3-n.P3),console.log("Lookup sorting",e.lookup_operational),yield e.getOperationalSchedule(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",e.lookup_operational);for(let i=0;i<=e.lookup_operational.length;i++)0==i&&(e.opsList_Alerts.push("Disabled"),e.opsList_Device.push("None"),e.opsList_Alerts.push("None")),1==i&&e.opsList_Alerts.push("Always"),0!==i&&(e.opsList_Alerts.push(e.lookup_operational[i-1]?.P1),e.opsList_Device.push(e.lookup_operational[i-1]?.P1));console.log("result op list",e.opsList_Device)}}catch(r){console.error("Error:",r)}})()}getRDT(t){var e=this;return(0,x.Z)(function*(){console.log("iam trying to fetch",e.loggedUserClientID);try{const r=yield e.api.GetLookupMasterTable(e.loggedUserClientID+"#rdt",t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;{const u=Object.keys(a)[0],{P1:g,P2:l,P3:d,P4:v}=a[u];e.lookup_data_temp1.push({P1:g,P2:l,P3:d,P4:v})}}e.lookup_data_temp1.sort((n,a)=>a.P4-n.P4),console.log("Lookup sorting",e.lookup_data_temp1),yield e.getRDT(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log();for(let i=0;i<e.lookup_data_temp1.length;i++)e.rdtList.push(e.lookup_data_temp1[i].P1);console.log("RDT to be displayed",e.rdtList)}}catch(r){console.error("Error:",r)}})()}getBindingParameters(t){console.log("this.parametersList.length",this.parametersList)}getWDT(t){var e=this;return(0,x.Z)(function*(){console.log("Iam called Bro");try{const r=yield e.api.GetLookupMasterTable(e.loggedUserClientID+"#wdt",t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;{const u=Object.keys(a)[0],{P1:g,P2:l,P3:d,P4:v}=a[u];e.lookup_data_user.push({P1:g,P2:l,P3:d,P4:v})}}e.lookup_data_user.sort((n,a)=>a.P4-n.P4),console.log("Lookup sorting",e.lookup_data_user),yield e.getWDT(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),console.log("Permissions to be displayed",e.lookup_data_user),e.wdtList=[];for(let i=0;i<e.lookup_data_user.length;i++)e.wdtList.push(e.lookup_data_user[i]?.P1)}}catch(r){console.error("Error:",r)}})()}getCompany(t){var e=this;return(0,x.Z)(function*(){console.log("Iam called Bro");try{const r=yield e.api.GetLookupMasterTable(e.loggedUserClientID+"#company",t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;{const u=Object.keys(a)[0],{P1:g,P2:l,P3:d}=a[u];e.lookup_company.push({P1:g,P2:l,P3:d})}}e.lookup_company.sort((n,a)=>a.P3-n.P3),console.log("Lookup sorting",e.lookup_company),yield e.getCompany(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log(),e.companyList=[];for(let i=0;i<e.lookup_company.length;i++)e.companyList.push(e.lookup_company[i]?.P1);console.log("All the company ID are :",e.companyList),console.log("Company to be displayed",e.lookup_company)}}catch(r){console.error("Error:",r)}})()}fetchDevicesList(t){var e=this;return(0,x.Z)(function*(){console.log("iam trying to fetch",e.clientID);try{const r=yield e.api.GetLookupMasterTable(e.clientID,t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;{const u=Object.keys(a)[0],{P1:g,P2:l,P3:d,P4:v,P5:f,P6:C,P7:c,P8:s}=a[u];e.lookup_devices.push({P1:g,P2:l,P3:d,P4:v,P5:f,P6:C,P7:c,P8:s})}}e.lookup_devices.sort((n,a)=>a.P5-n.P5),console.log("Lookup sorting",e.lookup_devices),yield e.fetchDevicesList(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.listOfItems is not a string.");else{console.log("Device Configuration Datas",e.lookup_devices),e.uniqueDevicesList=[],e.uniqueDevicelabelList=[],e.getClientinfo();for(let i=0;i<e.lookup_devices.length;i++)e.uniqueDevicesList.push(e.lookup_devices[i]?.P1),e.uniqueDevicelabelList.push(e.lookup_devices[i]?.P2);console.log("All the devices are :",e.uniqueDevicesList)}}catch(r){console.error("Error:",r)}})()}onFileChange(t){this.savedFileEvent=t.target.files[0];const e=t.target,r=new FileReader;if(!t.target.value.includes(".xlsx"))return this.toast.open(" Error :Invalid file format","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});r.onload=i=>{const a=q.ij(i.target.result,{type:"binary"}),g=a.Sheets[a.SheetNames[0]];this.previewData=q.P6.sheet_to_json(g,{header:1}),this.MN_name=q.P6.sheet_to_json(g,{raw:!0}),console.log("grid initialize",this.grid),this.grid||(this.grid=Q({parentNode:this.container.nativeElement,data:[]}),this.grid.style.heigth="1440px",this.grid.style.width="100%"),this.grid.data=this.previewData,this.previewData=this.grid.data,this.currentPage=0,this.updatePagedData(),this.grid.addEventListener("afteredit",l=>{this.previewData[this.currentPage*this.pageSize+l.rowIndex][l.cellIndex]=l.value,console.log("this.previewData ",this.previewData)})},r.readAsBinaryString(e.files[0])}download(t){this.macMismatch=!1;let e,r,i={};"device_xlsx"==t&&(e=[["Unifier Identifier","Device Name","Display Label","Longitude","Latitude","Altitude","Company ID","Reading Device Type","Writing Device Type","Operational Hours","Device Timeout","Transmission Interval","Alert Timeout","Device List","Primary Devices","Secondary Devices","Monthly Schedule Calculation Day","Disable Alerts","MQTT ID","Device Profile","Block Number","X-axis","Y-axis","Z-axis","Enable Device","Critical","Custom Schedule","Redundant","Disable Alerts Enable","Reports","Dashboard","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"]],r="device.xlsx",i={"Device Timeout":["Disabled","15_minute","30_minute","1_hour","6_hour","12_hour","1_day","7_day"]}),"alerts_xlsx"==t&&(e=[["MN","Alert Data Type","Alert Variable Type","Alert Value Prediction","Parameter ID","Parameter ID1","Parameter ID2","Equation","Operator","Value","Alert %","Severity","Test Active","Test Closed","Test Snoozed","Alert time","Operational Schedule","Enable Email","Enable SMS","Enable Telegram","Enable Type 1","Enable Type 2","Enable Type 3","Enable Type 4","Enable Type 5","Number of Binding Parameter","Binding Reading Parameter","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5","Max Escalation Level","Escalation level"]],r="alerts.xlsx");const n=new(G().Workbook),a=n.addWorksheet("Device");this.grid.data.forEach(g=>{a.addRow(g)}),a.columns=e[0].map(()=>({width:50}));const u=["Unifier Identifier","Device Name","Display Label","Longitude","Latitude","Company ID","Reading Device Type","Writing Device Type","MN","Alert Data Type","Alert Variable Type","Parameter ID","Parameter ID1","Parameter ID2","Equation","Operator","Value","Alert %","Severity","Text Active","Text Closed","Text Snoozed"];e[0].forEach((g,l)=>{if(a.getCell(1,l+1).style={fill:{type:"pattern",pattern:"solid",fgColor:{argb:u.includes(g)?"FF0000":"FFA500"}},font:{bold:!0,color:{argb:"FFFFFF"}}},i[g]){const v=a.getColumn(l+1).letter;a.dataValidations.add(`${v}2:${v}1000`,{type:"list",allowBlank:!0,formulae:[`"${i[g].join(",")}"`]})}}),n.xlsx.writeBuffer().then(g=>{const l=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=document.createElement("a");d.href=URL.createObjectURL(l),d.download=r,d.click()}).catch(g=>{console.error("Error writing the file",g)})}onFileSelected(t,e){this.handleFile(this.savedFileEvent,e,t)}handleFile(t,e,r){var i=this;return(0,x.Z)(function*(){let n=!1,a=!1;if("add"!==e?(n=!0,"device_xlsx"==r?a=!0:yield M().fire({position:"center",title:"Alerts will be added/updated",html:'<div style="text-align: justify;">Non-existing Alerts will result in the creation of a new Alerts, and any existing Alerts will be updated make sure to use GET alerts before updating.</div>',icon:"warning",allowOutsideClick:!1,showCancelButton:!0,confirmButtonText:"Continue"}).then(u=>{u.dismiss!==M().DismissReason.cancel&&(a=!0)})):"device_xlsx"==r?a=!0:yield M().fire({position:"center",title:"Alerts will be replaced",html:'<div style="text-align: justify;">All the Excel Alerts will be replacing the existing Alerts.</div>',icon:"warning",allowOutsideClick:!1,showCancelButton:!0,confirmButtonText:"Continue"}).then(u=>{u.dismiss!==M().DismissReason.cancel&&(a=!0)}),console.log("Confirm flag is here ",a),a){if(console.log("Target file is here ",t),console.log("data Grid is here ",i.grid.data),i.error="",i.validationErrors=[],!t.name.toLowerCase().endsWith(".xlsx"))return void(i.error="Please select an XLSX file");if(t.size>5242880)return void(i.error="File size must be less than 5MB");i.selectedFile=t;try{let u={};if(u="device_xlsx"==r?yield i.excelDeviceValidator.validateExcelFile(i.previewData,i.uniqueDevicesList,i.allMacID,n,i.loggedUserClientID,i.lookup_devices,i.companyList,i.rdtList,i.wdtList,i.showAlldevice,i.locationTree):yield i.excelAlertValidator.validateExcelFile(i.previewData,i.uniqueDevicesList,i.listofNMIds,n,i.loggedUserClientID,i.opsList_Alerts,[],[],[],[],[]),u.isValid){if(i.validExcelData=u,!i.selectedFile||i.validationErrors.length>0)return;try{const g=i.validExcelData.createRows,l=i.validExcelData.updateRows;if(i.spinner.show(),g&&Array.isArray(g)&&g.length>0&&!n&&"device_xlsx"==r)for(let d of g)yield i.createNewDevice(d);if(l&&Array.isArray(l)&&l.length>0&&n&&"device_xlsx"==r){console.log("Update operation is called ");for(let d of l)yield i.updateDevice(d)}g&&Array.isArray(g)&&g.length>0&&!n&&"device_xlsx"!=r&&(yield i.createAlertsDevice(g,"add")),l&&Array.isArray(l)&&l.length>0&&n&&"device_xlsx"!=r&&(yield i.updateAlertsDevice(l,"update"),console.log("Update operation will be performed for RDT paramters")),console.log("Data to be added/update is here ",g),n||"device_xlsx"!=r?n&&"device_xlsx"==r?M().fire({icon:"success",title:`${l.length} Device updated Successfully`,showConfirmButton:!0}):n&&"device_xlsx"!=r?M().fire({icon:"success",title:`${l.length} Alerts updated Successfully`,showConfirmButton:!0}):M().fire({icon:"success",title:`${g.length} Alerts Added Successfully`,showConfirmButton:!0}):M().fire({icon:"success",title:`${g.length} Device added Successfully`,showConfirmButton:!0})}catch(g){i.error="Error uploading file. Please try again."}finally{i.spinner.hide()}}else i.validationErrors="device_xlsx"==r?i.excelDeviceValidator.formatValidationErrors(u.errors):i.excelAlertValidator.formatValidationErrors(u.errors),i.openFileUploadModal(i.fileUpload)}catch(u){console.log("Error message is here ",u),i.error=u.message||"Error validating file",i.selectedFile=null}}})()}updateAlertsDevice(t,e){var r=this;return(0,x.Z)(function*(){console.log("Alerts to be updated are here ",t);const i=a=>"string"==typeof a?a.split(","):[a],n=t.reduce((a,u)=>{const g=u[0]?.trim();return a[g]||(a[g]=[]),a[g].push(u),a},{});console.log("Grouped data is here ",n);try{for(const a of Object.keys(n)){const u=r.lookup_devices.find(d=>d.P1==a);console.log("Filtered Lookup is here ",u);const g=[];for(const d of n[a]){let v=[];try{if(d&&d[18]&&null!=d[18]&&null!=d[18]&&""!=d[18]){const f=i(d[18]);if(f&&Array.isArray(f)&&f.length>0)for(let C of f)v.push({text:C,value:C&&C.split("-")[0]})}}catch(f){console.log("Error while setting the binding paramters ",f)}g.push({alert_datatype:d[1]&&d[1]||"",alert_variabletype:d[2]&&d[2]||"",alertValuePrediction:d[3]&&!isNaN(d[3])?parseInt(d[3]):"",parameterID:d[4]&&d[4]||"",parameterID1:d[5]&&d[5]||"",parameterID2:d[6]&&d[6]||"",equTextarea:d[7]&&d[7]||"",notificationMatrixId:d[11]&&d[11]||"",parameter_operator:d[8]&&d[8]||"",operator:d[8]&&d[8]||"",operator_value:d[9]&&d[9]||"",alert_percent:d[10]&&!isNaN(d[10])?parseInt(d[10]):"",severity:d[12]&&d[12]||"",alert_text_active:d[13]&&d[13]||"",alert_text_closed:d[14]&&d[14]||"",alert_text_snoozed:d[15]&&d[15]||"",alert_time:!!d[16]&&("string"!=typeof d[16]||"true"!==d[16]&&"false"!==d[16]?d[16]:JSON.parse(d[16])),operational_schedule:d[17]&&d[17]||"",binding_parameter:v||[],alertID:d[19]&&d[19]||r.username+"_"+r.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500))})}const l=yield r.api.GetDeviceConfiguration(a,r.loggedUserClientID);if(console.log("Result is here ",l),l&&l.alerts_configured){const d=JSON.parse(l.alerts_configured)||[];if(d&&Array.isArray(d))for(const c of g){const s=d.findIndex(T=>T.alertID===c.alertID);-1!==s?d[s]=c:d.push(c)}console.log("Alerts Configured for Device is ",d,n[a]);const v=Math.ceil((new Date).getTime()/1e3),f={P1:u.P1,P2:u.P2,P3:u.P3,P4:u.P4,P5:v,P6:u.P6,P7:u.P7,P8:u.P8};r.allRDTDetails={},r.allRDTDetails={PK:u.P1,SK:r.loggedUserClientID,alerts_configured:JSON.stringify(d)},console.log("Device final packet is here ",r.allRDTDetails),console.log("items are here ",f),(yield r.api.UpdateDeviceConfiguration(r.allRDTDetails))?yield r.fetchTimeMachineById(1,f.P1,"update",f):console.log("Error in Adding Alerts for ",r.allRDTDetails.PK)}}}catch(a){console.log("Error updating alerts ",a)}})()}createAlertsDevice(t,e){var r=this;return(0,x.Z)(function*(){console.log("Alerts to be updated are here ",t);const i=a=>"string"==typeof a?a.split(","):[a],n=t.reduce((a,u)=>{const g=u[0]?.trim();return a[g]||(a[g]=[]),a[g].push(u),a},{});console.log("Grouped data is here ",n);try{for(const a of Object.keys(n)){const u=[],g=r.lookup_devices.find(f=>f.P1==a);console.log("Filtered Lookup is here ",g);for(const f of n[a]){let C=[];try{if(f&&f[18]&&null!=f[18]&&null!=f[18]&&""!=f[18]){const c=i(f[18]);if(c&&Array.isArray(c)&&c.length>0)for(let s of c)C.push({text:s,value:s&&s.split("-")[0]})}}catch(c){console.log("Error while setting the binding paramters ",c)}u.push({alert_datatype:f[1]&&f[1]||"",alert_variabletype:f[2]&&f[2]||"",alertValuePrediction:f[3]&&!isNaN(f[3])?parseInt(f[3]):"",parameterID:f[4]&&f[4]||"",parameterID1:f[5]&&f[5]||"",parameterID2:f[6]&&f[6]||"",equTextarea:f[7]&&f[7]||"",notificationMatrixId:f[11]&&f[11]||"",parameter_operator:f[8]&&f[8]||"",operator:f[8]&&f[8]||"",operator_value:f[9]&&f[9]||"",alert_percent:f[10]&&!isNaN(f[10])?parseInt(f[10]):"",severity:f[12]&&f[12]||"",alert_text_active:f[13]&&f[13]||"",alert_text_closed:f[14]&&f[14]||"",alert_text_snoozed:f[15]&&f[15]||"",alert_time:!!f[16]&&("string"!=typeof f[16]||"true"!==f[16]&&"false"!==f[16]?f[16]:JSON.parse(f[16])),operational_schedule:f[17]&&f[17]||"",binding_parameter:C||[],alertID:r.username+"_"+r.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500))})}const l=Math.ceil((new Date).getTime()/1e3),d={P1:g.P1,P2:g.P2,P3:g.P3,P4:g.P4,P5:l,P6:g.P6,P7:g.P7,P8:g.P8};r.allRDTDetails={},r.allRDTDetails={PK:g.P1,SK:r.loggedUserClientID,alerts_configured:JSON.stringify(u)},console.log("Device final packet is here ",r.allRDTDetails),console.log("items are here ",d),(yield r.api.UpdateDeviceConfiguration(r.allRDTDetails))?yield r.fetchTimeMachineById(1,d.P1,"update",d):console.log("Error in Adding Alerts for ",r.allRDTDetails.PK)}}catch(a){console.log("Error creating alerts ",a)}})()}updateDevice(t){var e=this;return(0,x.Z)(function*(){try{console.log("User Details are here ",t),e.allRDTDetails={};try{e.allRDTDetails={PK:t[1]&&t[1].trim()||"",SK:e.loggedUserClientID,unifier_identifier:t[0]||"",alerts_duration:t[17]||"",block_number:t[20]&&!isNaN(t[20])?parseInt(t[20]):"",company_id:t[6]||"",deviceProfile:t[19]||"",rdt_by_type:t[7]||"",data_interval:t[11]&&!isNaN(t[11])?parseInt(t[11]):0,reading_device_type:t[7]&&t[7].trim()||"",writing_device_type:t[7]&&t[8].trim()||"",mn:t[1].trim()||"",mn_label:t[2].trim()||"",longitude:t[3]&&!isNaN(t[3])?parseFloat(t[3]).toString():"",latitude:t[4]&&!isNaN(t[4])?parseFloat(t[4]).toString():"",altitude:t[5]&&!isNaN(t[5])?parseFloat(t[5]).toString():"",operational_hours:t[9]||"",device_timeout:t[10]||"",svg_x:t[21]&&!isNaN(t[21])?parseInt(t[21]).toString():"",svg_y:t[22]&&!isNaN(t[22])?parseInt(t[22]).toString():"",svg_z:t[23]&&!isNaN(t[23])?parseInt(t[23]).toString():"",schedule_month_generation_day:isNaN(t[16])?"":parseInt(t[16]),enable_device:!!t[24]&&("string"!=typeof t[24]||"true"!==t[24]&&"false"!==t[24]?t[24]:JSON.parse(t[24])),critical:!!t[25]&&("string"!=typeof t[25]||"true"!==t[25]&&"false"!==t[25]?t[25]:JSON.parse(t[25])),customSchedule:!!t[26]&&("string"!=typeof t[26]||"true"!==t[26]&&"false"!==t[26]?t[26]:JSON.parse(t[26])),redundant:!!t[27]&&("string"!=typeof t[27]||"true"!==t[27]&&"false"!==t[27]?t[27]:JSON.parse(t[27])),disable_alerts:!!t[28]&&("string"!=typeof t[28]||"true"!==t[28]&&"false"!==t[28]?t[28]:JSON.parse(t[28])),report:!!t[29]&&("string"!=typeof t[29]||"true"!==t[29]&&"false"!==t[29]?t[29]:JSON.parse(t[29])),dashboard:!!t[30]&&("string"!=typeof t[30]||"true"!==t[30]&&"false"!==t[30]?t[30]:JSON.parse(t[30])),deviceslist:t[13]||"",primary_devices:t[14]||"",secondary_devices:t[15]||"",alertslist:"",alert_timeout:t[12]&&!isNaN(t[12])?parseInt(t[12]):"",reserved:t[18]||"",updatedTime:new Date};const i=Math.ceil((new Date).getTime()/1e3),n={P1:e.allRDTDetails.PK,P2:e.allRDTDetails.mn_label,P3:e.allRDTDetails.reading_device_type,P4:e.allRDTDetails.company_id,P5:i,P6:e.allRDTDetails.longitude,P7:e.allRDTDetails.latitude,P8:e.allRDTDetails.unifier_identifier};Object.keys(e.allRDTDetails).forEach(u=>{Number.isNaN(e.allRDTDetails[u])&&(e.allRDTDetails.item=null)}),console.log("Device final packet is here ",e.allRDTDetails),console.log("items are here ",n),(yield e.api.UpdateDeviceConfiguration(e.allRDTDetails))?(yield e.fetchTimeMachineById(1,n.P1,"update",n),e.fetchDevicesList(1)):console.log("Error in Creating New Configuration for ",e.allRDTDetails.PK)}catch(i){e.spinner.hide(),console.log("err for creation",i),e.toast.open("Error in Creating New Device Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}catch(r){console.log("Error in object Creation ",r)}})()}createNewDevice(t){var e=this;return(0,x.Z)(function*(){try{console.log("User Details are here ",t),e.allRDTDetails={};try{e.allRDTDetails={PK:t[1].trim()||"",SK:e.loggedUserClientID,unifier_identifier:t[0]||"",alerts_duration:t[17]||"",block_number:t[20]&&!isNaN(t[20])?parseInt(t[20]):"",company_id:t[6]||"",deviceProfile:t[19]||"",rdt_by_type:t[7]||"",data_interval:t[11]&&!isNaN(t[11])?parseInt(t[11]):0,reading_device_type:t[7].trim()||"",writing_device_type:t[8].trim()||"",mn:t[1].trim()||"",mn_label:t[2].trim()||"",longitude:t[3]&&!isNaN(t[3])?parseFloat(t[3]).toString():"",latitude:t[4]&&!isNaN(t[4])?parseFloat(t[4]).toString():"",altitude:t[5]&&!isNaN(t[5])?parseFloat(t[5]).toString():"",operational_hours:t[9]||"",device_timeout:t[10]||"",svg_x:t[21]&&!isNaN(t[21])?parseInt(t[21]).toString():"",svg_y:t[22]&&!isNaN(t[22])?parseInt(t[22]).toString():"",svg_z:t[23]&&!isNaN(t[23])?parseInt(t[23]).toString():"",schedule_month_generation_day:isNaN(t[16])?"":parseInt(t[16]),enable_device:!!t[24]&&("string"!=typeof t[24]||"true"!==t[24]&&"false"!==t[24]?t[24]:JSON.parse(t[24])),critical:!!t[25]&&("string"!=typeof t[25]||"true"!==t[25]&&"false"!==t[25]?t[25]:JSON.parse(t[25])),customSchedule:!!t[26]&&("string"!=typeof t[26]||"true"!==t[26]&&"false"!==t[26]?t[26]:JSON.parse(t[26])),redundant:!!t[27]&&("string"!=typeof t[27]||"true"!==t[27]&&"false"!==t[27]?t[27]:JSON.parse(t[27])),disable_alerts:!!t[28]&&("string"!=typeof t[28]||"true"!==t[28]&&"false"!==t[28]?t[28]:JSON.parse(t[28])),report:!!t[29]&&("string"!=typeof t[29]||"true"!==t[29]&&"false"!==t[29]?t[29]:JSON.parse(t[29])),dashboard:!!t[30]&&("string"!=typeof t[30]||"true"!==t[30]&&"false"!==t[30]?t[30]:JSON.parse(t[30])),deviceslist:t[13]||"",primary_devices:t[14]||"",secondary_devices:t[15]||"",alertslist:"",alert_timeout:t[12]&&!isNaN(t[12])?parseInt(t[12]):"",reserved:t[18]||"",updatedTime:new Date};const i=Math.ceil((new Date).getTime()/1e3),n={P1:e.allRDTDetails.PK,P2:e.allRDTDetails.mn_label,P3:e.allRDTDetails.reading_device_type,P4:e.allRDTDetails.company_id,P5:i,P6:e.allRDTDetails.longitude,P7:e.allRDTDetails.latitude,P8:e.allRDTDetails.unifier_identifier};Object.keys(e.allRDTDetails).forEach(u=>{Number.isNaN(e.allRDTDetails[u])&&(e.allRDTDetails.item=null)}),console.log("Device final packet is here ",e.allRDTDetails),console.log("items are here ",n),(yield e.api.CreateDeviceConfiguration(e.allRDTDetails))?(yield e.createLookUpTimeMachine(n,1),e.showAlldevice||e.DynamicApi.sendData({type:"device_permission",deviceName:n.P2,userName:e.username,clientID:e.loggedUserClientID}).subscribe(g=>{console.log("Response from Lambda:",g),e.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},g=>{console.error("Error:",g)}),e.fetchDevicesList(1)):console.log("Error in Creating New Configuration for ",e.allRDTDetails.PK)}catch(i){e.spinner.hide(),console.log("err for creation",i),e.toast.open("Error in Creating New Device Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}}catch(r){console.log("Error in object Creation ",r)}})()}openFileUploadModal(t){this.modalService.open(t,{backdrop:"static",keyboard:!1,size:"lg"})}exportTemplate(t){""==t&&this.toast.open("Select type","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let e,r,i={};"device_xlsx"==t&&(e=[["Unifier Identifier","Device Name","Display Label","Longitude","Latitude","Altitude","Company ID","Reading Device Type","Writing Device Type","Operational Hours","Device Timeout","Transmission Interval","Alert Timeout","Device List","Primary Devices","Secondary Devices","Monthly Schedule Calculation Day","Disable Alerts","MQTT ID","Device Profile","Block Number","X-axis","Y-axis","Z-axis","Enable Device","Critical","Custom Schedule","Redundant","Disable Alerts Enable","Reports","Dashboard","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"],["","","","","","","","","","None","15_minute","",3,"NONE","NONE","NONE",1,"","","","","","","",!0,"","","","","","","","","","","","",""]],r="device.xlsx",i={"Device Timeout":["Disabled","15_minute","30_minute","1_hour","6_hour","12_hour","1_day","7_day"]}),"alerts_xlsx"==t&&(e=[["MN","Alert Data Type","Alert Variable Type","Alert Value Prediction","Parameter ID","Parameter ID1","Parameter ID2","Equation","Operator","Value","Alert %","Notification Matrix ID","Severity","Text Active","Text Closed","Text Snoozed","Alert time","Operational Schedule","Binding Reading Parameter","Reserved 1","Reserved 2","Reserved 3","Reserved 4","Reserved 5"],["","","","","","","","","","","","","","","","","","","","","","","","","",""]],r="alerts.xlsx",i={"Alert Data Type":["Spontaneous","Accumulated - Hour","Accumulated - Day","Accumulated - Month","Spontaneous - Prediction","Accumulated Hour - Prediction","Accumulated Day - Prediction","Accumulated Month - Prediction"],Operator:["Lesser than <","Greater than >","Greater than or Equal to >=","Lesser than or Equal to <=","Equal to ==","Not Equal to !=","Logical AND &&","Logical OR ||","XOR"],Severity:["Major","Minor"],"Alert Variable Type":["Constant","Parameter","Equation"]});const n=new(G().Workbook),a=n.addWorksheet("Device");a.addRows(e),a.columns=e[0].map(()=>({width:50}));const u=["Unifier Identifier","Device Name","Display Label","Longitude","Latitude","Company ID","Reading Device Type","Writing Device Type","MN","Alert Data Type","Alert Variable Type","Parameter ID","Parameter ID1","Parameter ID2","Equation","Operator","Value","Alert %","Severity","Text Active","Text Closed","Text Snoozed"];e[0].forEach((g,l)=>{if(a.getCell(1,l+1).style={fill:{type:"pattern",pattern:"solid",fgColor:{argb:u.includes(g)?"FF0000":"FFA500"}},font:{bold:!0,color:{argb:"FFFFFF"}}},i[g]){const v=a.getColumn(l+1).letter;a.dataValidations.add(`${v}2:${v}1000`,{type:"list",allowBlank:!0,formulae:[`"${i[g].join(",")}"`]})}}),n.xlsx.writeBuffer().then(g=>{const l=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=document.createElement("a");d.href=URL.createObjectURL(l),d.download=r,d.click()}).catch(g=>{console.error("Error writing the file",g)})}createMultiDeviceConfig(t){var e=this;return(0,x.Z)(function*(){if(e.macMismatch=!1,"alerts_xlsx"==t){let r="",n="",a="",u=[],g="",l="",d="",f=[],C="false",c="true";if(0===e.previewData[0].length)return e.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!e.grid.data||e.grid.data.length<2||!e.grid.data[1][0])return e.toast.open(" Error :Empty File should not be added","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let s=1;s<e.grid.data.length;s++)if(e.ADD_finalData={},g="",l="",d="",f=[],e.grid.data[s][0]&&e.grid.data[s][0].trim().length>=2){if(null==e.grid.data[s][0]||""===e.grid.data[s][0]||void 0===e.grid.data[s][0])return e.toast.open("Column:A  Row: "+s+" Device is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let E;if(console.log("checkDeviceMN",null==e.grid.data[s][1]||null==e.grid.data[s][1]||e.grid.data[s][1].length<2),null==e.grid.data[s][0]||null==e.grid.data[s][0]||""===e.grid.data[s][0])return e.toast.open("Column:A  Row: "+s+" MN is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][0].charCodeAt(0))return e.toast.open("Column:A  Row: "+s+" MN should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!e.showAlldevice&&(console.log("devices are here BTW",e.locationTree),console.log("value is here to be checked ",e.grid.data[s][1]),e.grid.data&&e.grid.data[s][0]&&0==e.locationTree.includes(e.grid.data[s][0])))return M().fire({title:`${e.grid.data[s][0]} Device not found or You Dont have Access to update this Device`});for(let p=0;p<e.uniqueDevicesList.length&&e.uniqueDevicesList[p]!==e.grid.data[s][0].trim();p++)if(p==e.uniqueDevicesList.length-1)return void e.toast.open(e.grid.data[s][0]+" Column:A  Device not exists","Add Correct Device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][1]||null==e.grid.data[s][1]||""==e.grid.data[s][1])return e.toast.open("Column:B  Row: "+s+" Alert Datatype is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(r=e.grid.data[s][1].trim(),null==r||null==r)return e.toast.open("Column:B  Row: "+s+" Alert Datatype is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][1].charCodeAt(0))return e.toast.open("Column:B  Row: "+s+" alert data type shouldn't starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][2]||null==e.grid.data[s][2]||""==e.grid.data[s][2])return e.toast.open("Column:C  Row: "+s+" Alert Variable Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==["Equation","Parameter","Constant"].includes(e.grid.data[s][2]))return e.toast.open("Column:C  Row: "+s+" Alert Variable Type is Invalid values should be 'Equation','Parameter','Contant'","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(n=e.grid.data[s][2].trim(),r.includes("Prediction")){if("Equation"===n)return e.toast.open("Column:C  Row: "+s+" Variable type not exists for prediction","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][3]||""===e.grid.data[s][3])return e.toast.open("Column:D  Row: "+s+" Alert value prediction should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(e.grid.data[s][3]))return e.toast.open("Column:D  Row: "+s+" Alert value prediction must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Constant"===n){if(null===e.grid.data[s][4]||""===e.grid.data[s][4]||void 0===e.grid.data[s][4])return e.toast.open("Column:E  Row: "+s+" Parameter ID should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][4].charCodeAt(0))return e.toast.open("Column:E  Row: "+s+" Parameter ID should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][8]||""===e.grid.data[s][8])return e.toast.open("Column:I  Row: "+s+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(a=e.grid.data[s][8].trim(),null==a||""===a)return e.toast.open("Column:I  Row: "+s+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===a.charCodeAt(0))return e.toast.open("Column:I  Row: "+s+" Operator should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!(a.includes("<")||a.includes(">")||a.includes("<=")||a.includes(">=")||a.includes("==")||a.includes("!=")||a.includes("&&")||a.includes("||")||a.includes("XOR")))return e.toast.open("Column:I  Row: "+s+" Operator is wrong","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][9]||""===e.grid.data[s][9])return e.toast.open("Column:J  Row: "+s+" Value should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(e.grid.data[s][9]))return e.toast.open("Column:J  Row: "+s+" Value must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(e.grid.data[s][9])))return e.toast.open("Column:J  Row: "+s+" Value should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(e.grid.data[s][9])<0)return e.toast.open("Column:J  Row: "+s+" value should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Parameter"===n){if(null==e.grid.data[s][5]||""===e.grid.data[s][5])return e.toast.open("Column:F  Row: "+s+" Parameter ID1 should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][5].charCodeAt(0))return e.toast.open("Column:F  Row: "+s+" Parameter ID1 should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][6]||""===e.grid.data[s][6])return e.toast.open("Column:G  Row: "+s+" Parameter ID2 should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][6].charCodeAt(0))return e.toast.open("Column:G  Row: "+s+" Parameter ID2 should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][8]||""===e.grid.data[s][8])return e.toast.open("Column:I  Row: "+s+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(a=e.grid.data[s][8].trim(),null==a||""===a)return e.toast.open("Column:I  Row: "+s+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===a.charCodeAt(0))return e.toast.open("Column:I  Row: "+s+" Operator should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!(a.includes("<")||a.includes(">")||a.includes("<=")||a.includes(">=")||a.includes("==")||a.includes("!=")||a.includes("&&")||a.includes("||")||a.includes("XOR")))return e.toast.open("Column:I  Row: "+s+" Operator is wrong","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Equation"===n){if(null==e.grid.data[s][7]||""===e.grid.data[s][7])return e.toast.open("Column:H  Row: "+s+" Equation should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(console.log("this.grid.data[allData][9].charCodeAt(0)",e.grid.data[s][7].charCodeAt(0)),32===e.grid.data[s][7].charCodeAt(0))return e.toast.open("Column:H  Row: "+s+" Equation should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if(!1!==isNaN(e.grid.data[s][10]))return e.toast.open("Column:K  Row: "+s+" Alert % must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][10]||""===e.grid.data[s][10])return e.toast.open("Column:K  Row: "+s+" Alert % should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(e.grid.data[s][10])))return e.toast.open("Column:K  Row: "+s+" Alert % should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(e.grid.data[s][10])<0)return e.toast.open("Column:K  Row: "+s+" Alert % should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][11]||""===e.grid.data[s][11])return e.toast.open("Column:L  Row: "+s+" Notification matrix ID should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][11].charCodeAt(0))return e.toast.open("Column:L  Row: "+s+" Notification Matrix ID should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][12]||""===e.grid.data[s][12])return e.toast.open("Column:M  Row: "+s+" Severity should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][12].charCodeAt(0))return e.toast.open("Column:M  Row: "+s+" Severity should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!e.grid.data[s][12].includes("Major")&&!e.grid.data[s][12].includes("Minor"))return e.toast.open("Column:M  Row: "+s+" Severity should be Major or Minor","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][13]||""===e.grid.data[s][13])return e.toast.open("Column:N  Row: "+s+" Active should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][14]||""===e.grid.data[s][14])return e.toast.open("Column:O  Row: "+s+" Closed should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==e.grid.data[s][15]||""===e.grid.data[s][15])return e.toast.open("Column:P  Row: "+s+" Snoozed should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===e.grid.data[s][15].charCodeAt(0))return e.toast.open("Column:P  Row: "+s+" Snoozed should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(e.temp_Enable_alert_time=e.grid.data[s][16],null==e.temp_Enable_alert_time||""===e.temp_Enable_alert_time)return e.toast.open(e.temp_Enable_alert_time+" Column:Q  Row: "+s+" Enable Alert time should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null!=e.temp_Enable_alert_time&&""!==e.temp_Enable_alert_time){let p="";if("boolean"==typeof e.temp_Enable_alert_time?p=JSON.stringify(e.temp_Enable_alert_time).trim().toLowerCase():0==isNaN(e.temp_Enable_alert_time)||(p=e.temp_Enable_alert_time.trim().toLowerCase()),p!==c&&p!==C)return e.toast.open(e.temp_Enable_alert_time+"Column:Q  Row: "+s+" Enable Alert time must be true","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(p!==C&&p!==c)return e.toast.open(e.temp_Enable_alert_time+" Column:Q  Row: "+s+" Enable Alert time must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((p==c||p==C)&&(e.temp_Enable_alert_time=p),e.temp_add_Operational_schedule=e.grid.data[s][17],p===c)e.temp_add_Operational_schedule="Always";else if(p===C&&null!=e.temp_add_Operational_schedule&&""!==e.temp_add_Operational_schedule)for(let N=0;N<e.opsList_Alerts.length&&e.opsList_Alerts[N]!==e.temp_add_Operational_schedule.trim();N++)if(N==e.opsList_Alerts.length-1)return void e.toast.open(e.temp_add_Operational_schedule+" Column:Q  Added schedule not exists in list","Add Correct Device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else e.temp_Enable_alert_time=C;null!=e.grid.data[s][18]&&""!==e.grid.data[s][18]&&void 0!==e.grid.data[s][18]&&(E=e.grid.data[s][18].includes(",")?e.grid.data[s][18].split(","):e.grid.data[s][18]),e.ADD_finalData.PK=e.grid.data[s][0].trim(),e.ADD_finalData.SK=e.userClientIDCognito.attributes["custom:clientID"],e.ADD_finalData.alerts_configured=[],e.renameKeys.push(Object.keys(e.ADD_finalData)),e.renameKeys[1]="alert_datatype",e.renameKeys[2]="alert_variabletype",e.renameKeys[3]="alertValuePrediction",e.renameKeys[4]="parameterID",e.renameKeys[5]="parameterID1",e.renameKeys[6]="parameterID2",e.renameKeys[7]="equTextarea",e.renameKeys[8]="operator",e.renameKeys[9]="operator_value",e.renameKeys[10]="alert_percent",e.renameKeys[11]="notificationMatrixId",e.renameKeys[12]="severity",e.renameKeys[13]="alert_text_active",e.renameKeys[14]="alert_text_closed",e.renameKeys[15]="alert_text_snoozed",e.renameKeys[16]="alert_time",e.renameKeys[17]="operational_schedule",e.renameKeys[19]="binding_parameter";for(let p=0;p<e.grid.data[0].length;p++)null==e.grid.data[s][p]?(e.grid.data[s][p]=null,e.ADD_finalData[e.renameKeys[p]]=e.grid.data[s][p]):(4==p&&""!==e.grid.data[s][p]&&null!=e.grid.data[s][p]&&(g=e.grid.data[s][p]),5==p&&""!==e.grid.data[s][p]&&null!=e.grid.data[s][p]&&(l=e.grid.data[s][p]),6==p&&""!==e.grid.data[s][p]&&null!=e.grid.data[s][p]&&(d=e.grid.data[s][p]),e.ADD_finalData[e.renameKeys[p]]=e.grid.data[s][p]);console.log("after all data looped",e.ADD_finalData),delete e.ADD_finalData.undefined,delete e.ADD_finalData["PK,SK,alerts_configured"],e.ADD_finalData.updatedTime=new Date,e.ADD_finalData.alert_datatype=r,e.ADD_finalData.alert_variabletype=n,e.ADD_finalData.operator=a,e.ADD_finalData.parameterID=g,e.ADD_finalData.parameterID1=l,e.ADD_finalData.parameterID2=d,e.ADD_finalData.binding_parameter=E,e.ADD_finalData.operational_schedule=e.temp_add_Operational_schedule,u.push(e.ADD_finalData),g="",l="",d="";let L=[];for(let p=0;p<u.length;p++)L.push({PK:u[p].PK,SK:u[p].SK,updatedTime:u[p].updatedTime});const I=L.map(p=>p.PK),A=L.filter(({PK:p},N)=>!I.includes(p,N+1));console.log("filtered",A);let h=[];for(let p=0;p<A.length;p++)h.push({PK:A[p].PK,SK:A[p].SK,alerts_configured:[],updatedTime:A[p].updatedTime});for(let p=0;p<u.length;p++)for(let N=0;N<h.length;N++)"PK"in h[N]&&h[N].PK==u[p].PK?h[N].alerts_configured.push({alertID:e.username+"_"+e.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500)),alert_datatype:u[p].alert_datatype,alert_variabletype:u[p].alert_variabletype,parameterID:u[p].parameterID,parameterID1:u[p].parameterID1,parameterID2:u[p].parameterID2,equTextarea:u[p].equTextarea,operator:u[p].operator,operator_value:u[p].operator_value,alert_percent:u[p].alert_percent,alertValuePrediction:u[p].alertValuePrediction,notificationMatrixId:u[p].notificationMatrixId,severity:u[p].severity,alert_text_active:u[p].alert_text_active,alert_text_closed:u[p].alert_text_closed,alert_text_snoozed:u[p].alert_text_snoozed,alert_time:u[p].alert_time,operational_schedule:u[p].operational_schedule,binding_parameter:u[p].binding_parameter,parameter_operator:"Parameter"==u[p].alert_variabletype?u[p].operator:void 0}):"PK"in h[N]||(h[N].PK=u[p].PK,h[N].alerts_configured=[],h[N].alerts_configured.push({alertID:e.username+"_"+e.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500)),alert_datatype:u[p].alert_datatype,alert_variabletype:u[p].alert_variabletype,parameterID:u[p].parameterID,parameterID1:u[p].parameterID1,parameterID2:u[p].parameterID2,equTextarea:u[p].equTextarea,operator:u[p].operator,operator_value:u[p].operator_value,alert_percent:u[p].alert_percent,alertValuePrediction:u[p].alertValuePrediction,notificationMatrixId:u[p].notificationMatrixId,severity:u[p].severity,alert_text_active:u[p].alert_text_active,alert_text_closed:u[p].alert_text_closed,alert_text_snoozed:u[p].alert_text_snoozed,alert_time:u[p].alert_time,operational_schedule:u[p].operational_schedule,binding_parameter:u[p].binding_parameter,parameter_operator:"Parameter"==u[p].alert_variabletype?u[p].operator:void 0}));e.tempMultiAlerts=h;for(let p=0;p<e.tempMultiAlerts.length;p++)e.tempMultiAlerts[p].alerts_configured=JSON.stringify(e.tempMultiAlerts[p].alerts_configured)}e.sendMultipleDeviceAlertsDB(0)}})()}sendMultipleDeviceAlertsDB(t){var e=this;return(0,x.Z)(function*(){if(e.spinner.show(),t<e.tempMultiAlerts.length){let r;console.log("this.multi alerts index",e.tempMultiAlerts[t]);try{yield e.api.GetDeviceConfiguration(e.tempMultiAlerts[t].PK,e.loggedUserClientID).then(function(){var a=(0,x.Z)(function*(u){u&&(r=u,console.log("Data coming from DB is :",r))});return function(u){return a.apply(this,arguments)}}())}catch(a){console.log("Cannot fetch the device :",a)}const i=Math.ceil((new Date).getTime()/1e3),n={P1:r.mn,P2:r.mn_label,P3:r.reading_device_type,P4:r.company_id,P5:i,P6:r.longitude,P7:r.latitude,P8:r.unifier_identifier};e.api.UpdateDeviceConfiguration(e.tempMultiAlerts[t]).then(function(){var a=(0,x.Z)(function*(u){console.log("added index",t),u?(yield e.fetchTimeMachineById(1,n.P1,"update",n),e.sendMultipleDeviceAlertsDB(t+1)):(e.spinner.hide(),alert("Error in Creating Alerts Configuration"))});return function(u){return a.apply(this,arguments)}}()).catch(a=>{e.spinner.hide(),console.log("err for creation",a),e.toast.open("Error in Creating Alerts Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}else e.spinner.hide(),e.toast.open(e.tempMultiAlerts.length+" Device's Alerts added successfully "," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})})()}sendMultipleDeviceDB(t){var e=this;if(this.spinner.show(),console.log("this.tempMultiData.length",this.tempMultiData.length),t<this.tempMultiData.length){const r=Math.ceil((new Date).getTime()/1e3),i={P1:this.tempMultiData[t].PK,P2:this.tempMultiData[t].mn_label,P3:this.tempMultiData[t].reading_device_type,P4:this.tempMultiData[t].company_id,P5:r,P6:this.tempMultiData[t].longitude,P7:this.tempMultiData[t].latitude,P8:this.tempMultiData[t].unifier_identifier};this.api.CreateDeviceConfiguration(this.tempMultiData[t]).then(function(){var n=(0,x.Z)(function*(a){console.log("added index",t),a?(e.showAlldevice||e.DynamicApi.sendData({type:"device_permission",deviceName:i.P2,userName:e.username,clientID:e.loggedUserClientID}).subscribe(g=>{console.log("Response from Lambda:",g),e.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},g=>{console.error("Error:",g)}),yield e.createLookUpTimeMachine(i,1),e.sendMultipleDeviceDB(t+1)):alert("Error in Creating New Configuration")});return function(a){return n.apply(this,arguments)}}()).catch(n=>{this.spinner.hide(),console.log("err for creation",n),this.toast.open("Error in Creating New Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}else this.spinner.hide(),this.toast.open("Total Devices added successfully is  "+t," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})}createLookUpTimeMachine(t,e){var r=this;return(0,x.Z)(function*(){try{console.log("iam a calleddd dude",t,e);const i=yield r.api.GetLookupMasterTable(r.clientID,e);let n=[];if(null!=i&&i.items&&"string"==typeof i.items&&(n=JSON.parse(i.items)),null!=i&&n.length<r.maxlength){let a=[];i.items&&"string"==typeof i.items&&JSON.parse(i.items).forEach(d=>{for(const v in d)Object.prototype.hasOwnProperty.call(d,v)&&a.push(d[v])}),a.unshift(t),a=a.map((l,d)=>({[`L${d+1}`]:l})),console.log("newdata 11111111 :>> ",a);let u={PK:r.clientID,SK:i.SK,createdTime:"",updatedTime:"",items:JSON.stringify(a)};const g=yield r.api.UpdateLookupMasterTable(u);console.log("createResponse :>> ",g)}else if(null==i){let a=[];a.push(t),a=a.map((l,d)=>({[`L${d+1}`]:l}));let u={SK:e,PK:r.clientID,items:JSON.stringify(a)};console.log(u);const g=yield r.api.CreateLookupMasterTable(u);console.log(g)}else yield r.createLookUpTimeMachine(t,e+1)}catch(i){console.log("err :>> ",i)}})()}fetchLoggedInClientDevice(t){var e=this;return(0,x.Z)(function*(){if(e.multipleDevices=[],e.validationErrors=[],e.macMismatch=!1,"alerts_xlsx"==t)for(let i=1;i<e.grid.data.length;i++)e.grid.data[i]&&e.grid.data[i][0]&&e.grid.data[i][0].trim().length>=2&&e.multipleDevices.push(e.grid.data[i][0].trim());if("device_xlsx"==t){console.log("grid data",e.grid.data);for(let i=1;i<e.grid.data.length;i++)if(e.grid.data[i]&&e.grid.data[i][1]){console.log("All the unique ID are here :",e.uniqueDevicesList);for(let n=0;n<e.uniqueDevicesList.length&&e.grid.data[i][1].trim()!==e.uniqueDevicesList[n].trim();n++)n==e.uniqueDevicesList.length-1&&e.validationErrors.push({row:i+1,column:"Device Name",columnLetter:"B",value:e.grid.data[i][1],error:"Device Name doesn't exists"});e.multipleDevices.push(e.grid.data[i][1].trim())}console.log("this.multipleDevices",e.multipleDevices)}if(e.validationErrors.length>0)return e.validationErrors=e.excelDeviceValidator.formatValidationErrors(e.validationErrors),void e.openFileUploadModal(e.fileUpload);if(0==e.multipleDevices.length)return e.toast.open(e.grid.data[1][0]+" Column:B  Row: 1 Add MN name","MN should not be empty",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});e.multipleDevices=Array.from(new Set(e.multipleDevices));const r={items:[]};console.log("Before getting the devices,",r),console.log("Multiple devices are here ",e.multipleDevices),e.spinner.show();for(let i of e.multipleDevices){if(!e.showAlldevice&&e.locationTree&&0==e.locationTree.includes(i))return e.spinner.hide(),M().fire({title:`${i} Device does not exist or you Don't have Permission to access it`});try{let n=yield e.api.GetDeviceConfiguration(i,e.loggedUserClientID);n&&r.items.push(n)}catch(n){console.error("Error fetching device configuration:",n)}}if(console.log("All the devices are here :",e.multipleDevices),console.log("after devices fetched",r),0==r.items?.length)return e.spinner.hide(),e.toast.open("No devices found","Check other device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(r&&r.items&&r.items.length>0){if(console.log("multiple devices after fetching",r.items),"device_xlsx"==t){e.specific_devices=r.items,delete e.specific_devices[0].__typename;for(let i=0;i<r.items.length;i++){e.grid.data[i+1][0]=r.items[i]?.unifier_identifier,e.grid.data[i+1][1]=r.items[i]?.mn,e.grid.data[i+1][2]=r.items[i]?.mn_label,e.grid.data[i+1][3]=r.items[i]?.longitude,e.grid.data[i+1][4]=r.items[i]?.latitude,e.grid.data[i+1][5]=r.items[i]?.altitude,e.grid.data[i+1][6]=r.items[i]?.company_id,e.grid.data[i+1][7]=r.items[i]?.reading_device_type,e.grid.data[i+1][8]=r.items[i]?.writing_device_type,e.grid.data[i+1][9]=r.items[i]?.operational_hours,e.grid.data[i+1][10]=r.items[i]?.device_timeout,e.grid.data[i+1][11]=r.items[i]?.data_interval,e.grid.data[i+1][12]=r.items[i]?.alert_timeout,e.grid.data[i+1][13]=r.items[i]?.deviceslist,e.grid.data[i+1][14]=r.items[i]?.primary_devices,e.grid.data[i+1][15]=r.items[i]?.secondary_devices,e.grid.data[i+1][16]=r.items[i]?.schedule_month_generation_day,e.grid.data[i+1][17]=r.items[i]?.alerts_duration,e.grid.data[i+1][18]=r.items[i]?.reserved,e.grid.data[i+1][19]=r.items[i]?.deviceProfile,e.grid.data[i+1][20]=r.items[i]?.block_number,e.grid.data[i+1][21]=r.items[i]?.svg_x,e.grid.data[i+1][22]=r.items[i]?.svg_y,e.grid.data[i+1][23]=r.items[i]?.svg_z,e.grid.data[i+1][24]=r.items[i]?.enable_device,e.grid.data[i+1][25]=r.items[i]?.critical,e.grid.data[i+1][26]=r.items[i]?.customSchedule,e.grid.data[i+1][27]=r.items[i]?.redundant,e.grid.data[i+1][28]=r.items[i]?.disable_alerts,e.grid.data[i+1][29]=r.items[i]?.report,e.grid.data[i+1][30]=r.items[i]?.dashboard;let n=JSON.parse(JSON.parse(JSON.stringify(r.items[i]?.metadata))),a=36;if(Array.isArray(n)&&0==n.length)e.grid.data[i+1][35]=n.length;else if(Array.isArray(n)&&n.length>=1){e.grid.data[i+1][35]=n.length;let u=[],g=[];for(let d=0;d<n.length;d++)u[d]=n[d].key,g[d]=n[d].value;let l=a+n.length;for(let d=a;d<l;d++)e.grid.data[0][d+1*(d-a)]="Key"+(d+1-a),e.grid.data[0][d+1+1*(d-a)]="Value"+(d+1-a),e.grid.data[i+1][d+1*(d-a)]=u[d-a],e.grid.data[i+1][d+1+1*(d-a)]=g[d-a];u=[],g=[]}}if(e.grid.data=e.grid.data,e.previewData=e.grid.data,e.currentPage=0,e.updatePagedData(),e.grid.addEventListener("afteredit",i=>{e.previewData[e.currentPage*e.pageSize+i.rowIndex][i.cellIndex]=i.value,console.log("this.previewData ",e.previewData)}),e.grid.data)return e.spinner.hide(),e.toast.open("Device Fetched","Check",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("alerts_xlsx"==t){e.spinner.hide(),e.specific_devices=r.items,console.log("specific devices",e.specific_devices);let i=[],n=[],a=[],u=[],g=[];for(let l=0;l<e.specific_devices.length;l++)if(i=JSON.parse(e.specific_devices[l].alerts_configured),console.log("alert datas",i),null===i)g.push(e.specific_devices[l].PK),e.toast.open("No Alerts found for this device "+g.toString(),"Check other device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});else{for(let d=0;d<i.length;d++)n.push({PK:e.specific_devices[l].PK,alert_datatype:i[d].alert_datatype,alert_variabletype:i[d].alert_variabletype,alertValuePrediction:i[d].alertValuePrediction,parameterID:i[d].parameterID,parameterID1:i[d].parameterID1,parameterID2:i[d].parameterID2,equTextarea:i[d].equTextarea,notificationMatrixId:i[d].notificationMatrixId,operator:i[d].operator,operator_value:i[d].operator_value,alert_percent:i[d].alert_percent,severity:i[d].severity,alert_text_active:i[d].alert_text_active,alert_text_closed:i[d].alert_text_closed,alert_text_snoozed:i[d].alert_text_snoozed,alert_time:i[d].alert_time,operational_schedule:i[d].operational_schedule,binding_parameter:i[d].binding_parameter.map(v=>v.text).toString(),alertID:i[d].alertID});if(0==l){a.push([]);for(let d=0;d<e.grid.data[0].length;d++)a[0].push(e.grid.data[0][d])}for(let d=0;d<n.length;d++){a.push([]);for(let f=0;f<e.grid.data[0].length;f++)a[a.length-1].push("");let v=a.length-1;if(a[v][0]=n[d].PK,a[v][1]=n[d].alert_datatype,a[v][2]=n[d].alert_variabletype,a[v][3]=n[d].alertValuePrediction,a[v][4]=n[d].parameterID,a[v][5]=n[d].parameterID1,a[v][6]=n[d].parameterID2,a[v][7]=n[d].equTextarea,a[v][8]=n[d].operator,a[v][9]=n[d].operator_value,a[v][10]=n[d].alert_percent,a[v][11]=n[d].notificationMatrixId,a[v][12]=n[d].severity,a[v][13]=n[d].alert_text_active,a[v][14]=n[d].alert_text_closed,a[v][15]=n[d].alert_text_snoozed,a[v][16]=n[d].alert_time,a[v][17]=n[d].operational_schedule,a[v][18]=n[d].binding_parameter,a[v][19]=n[d].alertID,n[d].levels&&n[d].levels.length>=1){for(let f=0;f<n[d].levels.length;f++)u[f]=n[d].levels[f].noOflevels;console.log("levels_values",u),a[v][33]=u.toString()}u=[],0==n[d].hasOwnProperty("levels")&&(a[v][33]=0)}console.log("assigning fetched data to grid",e.grid.data),console.log("grid_data_temp",a),n=[]}e.grid.data=a,e.previewData=e.grid.data,e.currentPage=0,e.updatePagedData(),e.grid.addEventListener("afteredit",l=>{e.previewData[e.currentPage*e.pageSize+l.rowIndex][l.cellIndex]=l.value,console.log("this.previewData ",e.previewData)}),console.log("grid data",e.grid.data)}}})()}updateMultiDevice(t){if(this.macMismatch=!1,"device_xlsx"==t){this.tempMultiData=[];let r=[];if(0===this.previewData[0].length)return this.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.grid.data||this.grid.data.length<2||!this.grid.data[1][0])return this.toast.open(" Error :Empty File should not be added","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let i=1;i<=this.grid.data.length-1;i++)if(this.ADD_finalData={},r=[],this.grid.data[i][0]&&this.grid.data[i][0].trim().length>=1){if(null==this.grid.data[i][0]||""===this.grid.data[i][0]||void 0===this.grid.data[i][0])return this.toast.open("Column:A  Row: "+i+" Unifier Identifier is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let u,n="true",a="false";for(let l=0;l<this.uniqueDevicesList.length&&this.grid.data[i][1].trim()!==this.uniqueDevicesList[l];l++)if(l==this.uniqueDevicesList.length-1)return void this.toast.open(this.grid.data[i][1]+" Column:B  Row: "+i+" Device not exists","Add existing Device Name",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][1]||null==this.grid.data[i][1]||""==this.grid.data[i][1])return this.toast.open("Column:B  Row: "+i+" Device Name is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.showAlldevice&&(console.log("devices are here BTW",this.locationTree),console.log("value is here to be checked ",this.grid.data[i][1]),this.grid.data&&this.grid.data[i][1]&&0==this.locationTree.includes(this.grid.data[i][1])))return M().fire({title:`${this.grid.data[i][1]} Device not found or You Dont have Access to update this Device`});if(32===this.grid.data[i][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+i+"Device Name doesn't start with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][2]||""===this.grid.data[i][2])return this.toast.open("Column:C  Row: "+i+"Device Label is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][3]||""===this.grid.data[i][3])return this.toast.open("Column:D  Row: "+i+"Longitude is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.grid.data[i][3])||""===this.grid.data[i][3])return this.toast.open("Column:D  Row: "+i+"Longitude must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][4]||""===this.grid.data[i][4])return this.toast.open("Column:E  Row: "+i+"Latitude is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.grid.data[i][4])||""===this.grid.data[i][4])return this.toast.open("Column:E  Row: "+i+"Latitude must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((null==this.grid.data[i][5]||null==this.grid.data[i][5]||1==isNaN(this.grid.data[i][5]))&&void 0!==this.grid.data[i][5]&&1==isNaN(this.grid.data[i][5]))return this.toast.open("Column:F  Row: "+i+"Altitude must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null!=this.grid.data[i][5]&&""!==this.grid.data[i][5]&&void 0!==this.grid.data[i][5]&&void 0!==this.grid.data[i][5]&&JSON.parse(this.grid.data[i][5])<0)return this.toast.open("Column:F  Row: "+i+" Altitude should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][6]||""===this.grid.data[i][6])return this.toast.open("Column:G  Row: "+i+"Company ID is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let l=0;l<this.companyList.length&&this.grid.data[i][6].trim()!==this.companyList[l];l++)if(l==this.companyList.length-1)return void this.toast.open(this.grid.data[i][6]+" Column:G  Row: "+i+" Company ID doesn't exists in this client","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][7]||""===this.grid.data[i][7])return this.toast.open("Column:H  Row: "+i+"Reading Device Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let l=0;l<this.rdtList.length&&this.grid.data[i][7].trim()!==this.rdtList[l];l++)if(l==this.rdtList.length-1)return void this.toast.open(this.grid.data[i][7]+" Column:H  Row: "+i+" RDT doesn't exists in this client","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][8]||""===this.grid.data[i][8])return this.toast.open("Column:I  Row: "+i+"Writing Device Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});console.log("wdt",this.grid.data[i][8]);for(let l=0;l<this.wdtList.length&&this.wdtList[l]!==this.grid.data[i][8].trim();l++)if(l==this.wdtList.length-1)return void this.toast.open(this.grid.data[i][8]+" Column:I  Row: "+i+" WDT doesn't exists in this client","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][9]||""===this.grid.data[i][9])return this.toast.open("Column:J  Row: "+i+" Operational Hours is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});console.log("this.opsList_Device",this.opsList_Device);for(let l=0;l<this.opsList_Device.length&&this.opsList_Device[l]!==this.grid.data[i][9].trim();l++)if(l==this.opsList_Device.length-1)return void this.toast.open(this.grid.data[i][9]+" Column:J  Row: "+i+" OS doesn't exists in this client","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][10]||""===this.grid.data[i][10])return this.toast.open("Column:K  Row: "+i+" Device Timeout is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let l=0;l<this.device_timeout.length&&this.device_timeout[l]!==this.grid.data[i][10].trim();l++)if(l==this.device_timeout.length-1)return void this.toast.open(this.grid.data[i][10]+" Column:K  Row: "+i+" Device Timeout is invalid","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][11]||""===this.grid.data[i][11])return this.toast.open("Column:L  Row: "+i+" Transmission Interval is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.grid.data[i][11])||""===this.grid.data[i][11])return this.toast.open("Column:L  Row: "+i+" Transmission Interval must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(this.grid.data[i][11])))return this.toast.open("Column:L  Row: "+i+" Transmission Interval should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(this.grid.data[i][11])<0)return this.toast.open("Column:L  Row: "+i+" Transmission Interval should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null!=this.grid.data[i][12]&&""!==this.grid.data[i][12]&&void 0!==this.grid.data[i][12]&&void 0!==this.grid.data[i][12]){if(0==Number.isInteger(JSON.parse(this.grid.data[i][12])))return this.toast.open("Column:M  Row: "+i+" Alert Timeout should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(this.grid.data[i][12])<0)return this.toast.open("Column:M  Row: "+i+" Alert Timeout should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if(null==this.grid.data[i][13]||""===this.grid.data[i][13])return this.toast.open("Column:N  Row: "+i+" Device list is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][14]||""===this.grid.data[i][14])return this.toast.open("Column:O  Row: "+i+" Primary Devices is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][15]||""===this.grid.data[i][15])return this.toast.open("Column:P  Row: "+i+" Secondary Devices is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[i][16]||""===this.grid.data[i][16])return this.toast.open("Column:Q  Row: "+i+" Monthly Schedule Calculation Day is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(console.log("JSON.parse(this.grid.data[allData][16])",JSON.parse(this.grid.data[i][16])),!1!==isNaN(this.grid.data[i][16]))return this.toast.open("Column:Q  Row: "+i+" Monthly Schedule Calculation Day must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(this.grid.data[i][16])))return this.toast.open("Column:Q  Row: "+i+" Month should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(this.grid.data[i][16])<1||JSON.parse(this.grid.data[i][16])>28)return this.toast.open("Column:Q  Row: "+i+" Value Should be greater than 0 and less than 29","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((null!=this.grid.data[i][17]||""!=this.grid.data[i][17]||null!=this.grid.data[i][17])&&(u=this.grid.data[i][17]),this.temp_EnableDevice=this.grid.data[i][23],null!=this.temp_EnableDevice&&""!==this.temp_EnableDevice){let l="";if("boolean"==typeof this.temp_EnableDevice?l=JSON.stringify(this.temp_EnableDevice).trim().toLowerCase():0==isNaN(this.temp_EnableDevice)||(l=this.temp_EnableDevice.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_EnableDevice+"Column:X  Row: "+i+" Enable Device must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open("Column:X  Row: "+i+" Enable Device must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_EnableDevice=l)}else this.temp_EnableDevice=a;if(this.temp_Critical=this.grid.data[i][24],null!=this.temp_Critical&&""!==this.temp_Critical){let l="";if("boolean"==typeof this.temp_Critical?l=JSON.stringify(this.temp_Critical).trim().toLowerCase():0==isNaN(this.temp_Critical)||(l=this.temp_Critical.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_Critical+"Column:Y  Row: "+i+" Critical must be boolean or false","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_Critical=l)}else this.temp_Critical=a;if(this.temp_CustomSchedule=this.grid.data[i][25],null!=this.temp_CustomSchedule){let l="";if("boolean"==typeof this.temp_CustomSchedule?l=JSON.stringify(this.temp_CustomSchedule).trim().toLowerCase():0==isNaN(this.temp_CustomSchedule)||(l=this.temp_CustomSchedule.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_CustomSchedule+"Column:Z  Row: "+i+" CustomSchedule must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open(this.temp_CustomSchedule+"Column:Z  Row: "+i+" CustomSchedule must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_CustomSchedule=l)}else this.temp_CustomSchedule=a;if(this.temp_Redundant=this.grid.data[i][26],null!=this.temp_Redundant){let l="";if("boolean"==typeof this.temp_Redundant?l=JSON.stringify(this.temp_Redundant).trim().toLowerCase():0==isNaN(this.temp_Redundant)||(l=this.temp_Redundant.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_Redundant+"Column:AA  Row: "+i+" Redundant must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open("Column:AA  Row: "+i+" Redundant must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_Redundant=l)}else this.temp_Redundant=a;if(this.temp_DisableAlerts=this.grid.data[i][27],null!=this.temp_DisableAlerts){let l="";if("boolean"==typeof this.temp_DisableAlerts?l=JSON.stringify(this.temp_DisableAlerts).trim().toLowerCase():0==isNaN(this.temp_DisableAlerts)||(l=this.temp_DisableAlerts.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_DisableAlerts+"Column:AB  Row: "+i+" Disable alerts must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open(this.temp_DisableAlerts+"Column:AB  Row: "+i+" Disable alerts must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_DisableAlerts=l)}else this.temp_DisableAlerts=a;if(this.temp_Reports=this.grid.data[i][28],null!=this.temp_Reports&&""!==this.temp_Reports){let l="";if("boolean"==typeof this.temp_Reports?l=JSON.stringify(this.temp_Reports).trim().toLowerCase():0==isNaN(this.temp_Reports)||(l=this.temp_Reports.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_Reports+"Column:AC  Row: "+i+" Report must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open(this.temp_Reports+"Column:AC  Row: "+i+" Report must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_Reports=l)}else this.temp_Reports=a;if(this.temp_Dashboard=this.grid.data[i][29],null!=this.temp_Dashboard&&""!==this.temp_Dashboard){let l="";if("boolean"==typeof this.temp_Dashboard?l=JSON.stringify(this.temp_Dashboard).trim().toLowerCase():0==isNaN(this.temp_Dashboard)||(l=this.temp_Dashboard.trim().toLowerCase()),l!==n&&l!==a)return this.toast.open(this.temp_Dashboard+"Column:AD  Row: "+i+" Dashboard must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(l!==a&&l!==n)return this.toast.open(this.temp_Dashboard+"Column:AD  Row: "+i+" Dashboard must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});(l==n||l==a)&&(this.temp_Dashboard=l)}else this.temp_Dashboard=a;if(null!=this.grid.data[i][35]&&""!==this.grid.data[i][35]&&!1!==isNaN(this.grid.data[i][35]))return this.toast.open("Column:AJ  Row: "+i+" Metadata must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let g=35;for(let l=1;l<=this.grid.data[i][35];l++,g++)r.push({key:this.grid.data[i][g+l],value:this.grid.data[i][g+l+1]});for(let l=0;l<r.length;l++)if(void 0===r[l].key||""===r[l].key||void 0===r[l].value||""===r[l].value)return this.toast.open("Column:AJ  Row: "+i+" Metadata should be equal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});this.ADD_finalData.PK=this.grid.data[i][1],this.ADD_finalData.SK=this.userClientIDCognito.attributes["custom:clientID"],this.renameKeys.push(Object.keys(this.ADD_finalData)),console.log("this.renameKeys",this.renameKeys),this.renameKeys[0]="unifier_identifier",this.renameKeys[1]="mn",this.renameKeys[2]="mn_label",this.renameKeys[3]="longitude",this.renameKeys[4]="latitude",this.renameKeys[5]="altitude",this.renameKeys[6]="company_id",this.renameKeys[7]="reading_device_type",this.renameKeys[8]="writing_device_type",this.renameKeys[9]="operational_hours",this.renameKeys[10]="device_timeout",this.renameKeys[11]="data_interval",this.renameKeys[12]="alert_timeout",this.renameKeys[13]="deviceslist",this.renameKeys[14]="primary_devices",this.renameKeys[15]="secondary_devices",this.renameKeys[16]="schedule_month_generation_day",this.renameKeys[17]="reserved",this.renameKeys[18]="deviceProfile",this.renameKeys[19]="block_number",this.renameKeys[20]="svg_x",this.renameKeys[21]="svg_y",this.renameKeys[22]="svg_z",this.renameKeys[23]="enable_device",this.renameKeys[24]="critical",this.renameKeys[25]="customSchedule",this.renameKeys[26]="redundant",this.renameKeys[27]="disable_alerts",this.renameKeys[28]="report",this.renameKeys[29]="dashboard",this.renameKeys[35]="metadata";for(var e=0;e<this.grid.data[0].length;e++)null==this.grid.data[i][e]?(this.grid.data[i][e]=null,this.ADD_finalData[this.renameKeys[e]]=this.grid.data[i][e]):(35==e&&(this.grid.data[i][e]=JSON.stringify(r.length)),this.ADD_finalData[this.renameKeys[e]]=this.grid.data[i][e]);delete this.ADD_finalData.undefined,this.ADD_finalData.updatedTime=new Date,this.ADD_finalData.metadata=JSON.stringify(r),console.log("after metadata is added ",this.ADD_finalData),this.ADD_finalData.enable_device=this.temp_EnableDevice,this.ADD_finalData.critical=this.temp_Critical,this.ADD_finalData.customSchedule=this.temp_CustomSchedule,this.ADD_finalData.redundant=this.temp_Redundant,this.ADD_finalData.disable_alerts=this.temp_DisableAlerts,this.ADD_finalData.report=this.temp_Reports,this.ADD_finalData.dashboard=this.temp_Dashboard,this.ADD_finalData.reserved=u,console.log("before update values are",this.ADD_finalData),delete this.ADD_finalData["PK,SK"],this.tempMultiData.push(this.ADD_finalData)}this.updateMultipleDeviceDB(0)}if("alerts_xlsx"==t){let r="",i="",n="",a=[],u="",g="",l="",d=[],f="false",C="true";if(0===this.previewData[0].length)return this.toast.open(" Error :No file is selected","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.grid.data||this.grid.data.length<2||!this.grid.data[1][0])return this.toast.open(" Error :Empty File should not be updated","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let c=1;c<this.grid.data.length;c++)if(this.ADD_finalData={},u="",g="",l="",d=[],this.grid.data[c][0]&&this.grid.data[c][0].trim().length>=2){if(null==this.grid.data[c][0]||""===this.grid.data[c][0])return this.toast.open("Column:A  Row: "+c+" Device is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});let T;if(console.log("checkDeviceMN",null==this.grid.data[c][1]||null==this.grid.data[c][1]||this.grid.data[c][1].length<2),null==this.grid.data[c][0]||null==this.grid.data[c][0]||""===this.grid.data[c][0])return this.toast.open("Column:A  Row: "+c+" MN is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.showAlldevice&&this.grid.data&&this.grid.data[c][0]&&0==this.locationTree.includes(this.grid.data[c][0]))return M().fire({title:`${this.grid.data[c][0]} Device not found or You Dont have Access to update this Device`});if(32===this.grid.data[c][0].charCodeAt(0))return this.toast.open("Column:A  Row: "+c+" MN should not starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});for(let h=0;h<this.uniqueDevicesList.length&&this.uniqueDevicesList[h]!==this.grid.data[c][0].trim();h++)if(h==this.uniqueDevicesList.length-1)return void this.toast.open(this.grid.data[c][0]+" Column:A  Device not exists","Add Correct Device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][1]||null==this.grid.data[c][1]||""==this.grid.data[c][1])return this.toast.open("Column:B  Row: "+c+" Alert Datatype is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(r=this.grid.data[c][1].trim(),null==r||null==r)return this.toast.open("Column:B  Row: "+c+" Alert Datatype is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][1].charCodeAt(0))return this.toast.open("Column:B  Row: "+c+" alert data type shouldn't starts with space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][2]||null==this.grid.data[c][2]||""==this.grid.data[c][2])return this.toast.open("Column:C  Row: "+c+" Alert Variable Type is needed","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(i=this.grid.data[c][2].trim(),r.includes("Prediction")){if("Equation"===i)return this.toast.open("Column:C  Row: "+c+" Variable type not exists for prediction","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][3]||""===this.grid.data[c][3])return this.toast.open("Column:D  Row: "+c+" Alert value prediction should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!1!==isNaN(this.grid.data[c][3]))return this.toast.open("Column:D  Row: "+c+" Alert value prediction must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Constant"===i){if(null===this.grid.data[c][4]||""===this.grid.data[c][4]||void 0===this.grid.data[c][4])return this.toast.open("Column:E  Row: "+c+" Parameter ID should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][4].charCodeAt(0))return this.toast.open("Column:E  Row: "+c+" Parameter ID should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][8]||""===this.grid.data[c][8])return this.toast.open("Column:I  Row: "+c+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(n=this.grid.data[c][8].trim(),null==n||""===n)return this.toast.open("Column:I  Row: "+c+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===n.charCodeAt(0))return this.toast.open("Column:I  Row: "+c+" Operator should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!(n.includes("<")||n.includes(">")||n.includes("<=")||n.includes(">=")||n.includes("==")||n.includes("!=")||n.includes("&&")||n.includes("||")||n.includes("XOR")))return this.toast.open("Column:I  Row: "+c+" Operator is wrong","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Parameter"===i){if(null==this.grid.data[c][5]||""===this.grid.data[c][5])return this.toast.open("Column:F  Row: "+c+" Parameter ID1 should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][5].charCodeAt(0))return this.toast.open("Column:F  Row: "+c+" Parameter ID1 should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][6]||""===this.grid.data[c][6])return this.toast.open("Column:G  Row: "+c+" Parameter ID2 should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][6].charCodeAt(0))return this.toast.open("Column:G  Row: "+c+" Parameter ID2 should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][8]||""===this.grid.data[c][8])return this.toast.open("Column:I  Row: "+c+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(n=this.grid.data[c][8].trim(),null==n||""===n)return this.toast.open("Column:I  Row: "+c+" Operator should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===n.charCodeAt(0))return this.toast.open("Column:I  Row: "+c+" Operator should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!(n.includes("<")||n.includes(">")||n.includes("<=")||n.includes(">=")||n.includes("==")||n.includes("!=")||n.includes("&&")||n.includes("||")||n.includes("XOR")))return this.toast.open("Column:I  Row: "+c+" Operator is wrong","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if("Equation"===i){if(null==this.grid.data[c][7]||""===this.grid.data[c][7])return this.toast.open("Column:H  Row: "+c+" Equation should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][7].charCodeAt(0))return this.toast.open("Column:H  Row: "+c+" Equation should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}if(!1!==isNaN(this.grid.data[c][10]))return this.toast.open("Column:K  Row: "+c+" Alert % must be number","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][10]||""===this.grid.data[c][10])return this.toast.open("Column:K  Row: "+c+" Alert % should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(0==Number.isInteger(JSON.parse(this.grid.data[c][10])))return this.toast.open("Column:K  Row: "+c+" Alert % should not be in decimal","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(JSON.parse(this.grid.data[c][10])<0)return this.toast.open("Column:K  Row: "+c+" Alert % should not be negative","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][11]||""===this.grid.data[c][11])return this.toast.open("Column:L  Row: "+c+" Notification matrix ID should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][11].charCodeAt(0))return this.toast.open("Column:L  Row: "+c+" Notification Matrix ID should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][12]||""===this.grid.data[c][12])return this.toast.open("Column:L  Row: "+c+" Severity should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][12].charCodeAt(0))return this.toast.open("Column:L  Row: "+c+" Severity should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(!this.grid.data[c][12].includes("Major")&&!this.grid.data[c][12].includes("Minor"))return this.toast.open("Column:L  Row: "+c+" Severity should be major or minor","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][13]||""===this.grid.data[c][13])return this.toast.open("Column:M  Row: "+c+" Active should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][14]||""===this.grid.data[c][14])return this.toast.open("Column:N  Row: "+c+" Closed should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null==this.grid.data[c][15]||""===this.grid.data[c][15])return this.toast.open("Column:O  Row: "+c+" Snoozed should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(32===this.grid.data[c][15].charCodeAt(0))return this.toast.open("Column:O  Row: "+c+" Snoozed should not contains space","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(this.temp_Enable_alert_time=this.grid.data[c][16],null==this.temp_Enable_alert_time||""===this.temp_Enable_alert_time)return this.toast.open(this.temp_Enable_alert_time+" Column:P  Row: "+c+" Enable Alert time should not be empty","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(null!=this.temp_Enable_alert_time&&""!==this.temp_Enable_alert_time){let h="";if("boolean"==typeof this.temp_Enable_alert_time?h=JSON.stringify(this.temp_Enable_alert_time).trim().toLowerCase():0==isNaN(this.temp_Enable_alert_time)||(h=this.temp_Enable_alert_time.trim().toLowerCase()),h!==C&&h!==f)return this.toast.open(this.temp_Enable_alert_time+"Column:P  Row: "+c+" Enable Alert time must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if(h!==f&&h!==C)return this.toast.open(this.temp_Enable_alert_time+" Column:P  Row: "+c+" Enable Alert time must be boolean","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"});if((h==C||h==f)&&(this.temp_Enable_alert_time=h),this.temp_add_Operational_schedule=this.grid.data[c][17],h===C)this.temp_add_Operational_schedule="Always";else if(h===f&&null!=this.temp_add_Operational_schedule&&""!==this.temp_add_Operational_schedule)for(let p=0;p<this.opsList_Alerts.length&&this.opsList_Alerts[p]!==this.temp_add_Operational_schedule.trim();p++)if(p==this.opsList_Alerts.length-1)return void this.toast.open(this.temp_add_Operational_schedule+" Column:Q  Added schedule not exists in list","Add Correct Device",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})}else this.temp_Enable_alert_time=f;console.log("Binding paramters are here ",this.grid.data[c][18]),null!=this.grid.data[c][18]&&""!==this.grid.data[c][18]&&void 0!==this.grid.data[c][18]&&(T=this.grid.data[c][18].includes(",")?this.grid.data[c][18].split(","):this.grid.data[c][18]),this.ADD_finalData.PK=this.grid.data[c][0].trim(),this.ADD_finalData.SK=this.userClientIDCognito.attributes["custom:clientID"],this.ADD_finalData.alerts_configured=[],this.renameKeys.push(Object.keys(this.ADD_finalData)),this.renameKeys[1]="alert_datatype",this.renameKeys[2]="alert_variabletype",this.renameKeys[3]="alertValuePrediction",this.renameKeys[4]="parameterID",this.renameKeys[5]="parameterID1",this.renameKeys[6]="parameterID2",this.renameKeys[7]="equTextarea",this.renameKeys[8]="operator",this.renameKeys[9]="operator_value",this.renameKeys[10]="alert_percent",this.renameKeys[11]="notificationMatrixId",this.renameKeys[12]="severity",this.renameKeys[13]="alert_text_active",this.renameKeys[14]="alert_text_closed",this.renameKeys[15]="alert_text_snoozed",this.renameKeys[16]="alert_time",this.renameKeys[17]="operational_schedule",this.renameKeys[18]="binding_parameter",this.renameKeys[19]="alertID";for(let h=0;h<this.grid.data[0].length;h++)null==this.grid.data[c][h]?(this.grid.data[c][h]=null,this.ADD_finalData[this.renameKeys[h]]=this.grid.data[c][h]):(4==h&&""!==this.grid.data[c][h]&&null!=this.grid.data[c][h]&&(u=this.grid.data[c][h]),5==h&&""!==this.grid.data[c][h]&&null!=this.grid.data[c][h]&&(g=this.grid.data[c][h]),6==h&&""!==this.grid.data[c][h]&&null!=this.grid.data[c][h]&&(l=this.grid.data[c][h]),this.ADD_finalData[this.renameKeys[h]]=this.grid.data[c][h]);console.log("after all data looped",this.ADD_finalData),delete this.ADD_finalData.undefined,delete this.ADD_finalData["PK,SK,alerts_configured"],this.ADD_finalData.updatedTime=new Date,this.ADD_finalData.alert_datatype=r,this.ADD_finalData.alert_variabletype=i,this.ADD_finalData.operator=n,this.ADD_finalData.parameterID=u,this.ADD_finalData.parameterID1=g,this.ADD_finalData.parameterID2=l,this.ADD_finalData.binding_parameter=T,this.ADD_finalData.alertID=this.grid.data[c][19],a.push(this.ADD_finalData),console.log("allAlerts",a);let E=[];for(let h=0;h<a.length;h++)E.push({PK:a[h].PK,SK:a[h].SK,updatedTime:a[h].updatedTime});const L=E.map(h=>h.PK),I=E.filter(({PK:h},p)=>!L.includes(h,p+1));console.log("filtered",I);let A=[];for(let h=0;h<I.length;h++)A.push({PK:I[h].PK,SK:I[h].SK,alerts_configured:[],updatedTime:I[h].updatedTime});for(let h=0;h<a.length;h++)for(let p=0;p<A.length;p++)"PK"in A[p]&&A[p].PK==a[h].PK?A[p].alerts_configured.push({alert_datatype:a[h].alert_datatype,alert_variabletype:a[h].alert_variabletype,alertValuePrediction:a[h].alertValuePrediction,parameterID:a[h].parameterID,parameterID1:a[h].parameterID1,parameterID2:a[h].parameterID2,equTextarea:a[h].equTextarea,operator:a[h].operator,operator_value:a[h].operator_value,alert_percent:a[h].alert_percent,notificationMatrixId:a[h].notificationMatrixId,severity:a[h].severity,alert_text_active:a[h].alert_text_active,alert_text_closed:a[h].alert_text_closed,alert_text_snoozed:a[h].alert_text_snoozed,alert_time:a[h].alert_time,operational_schedule:a[h].operational_schedule,binding_parameter:a[h].binding_parameter,parameter_operator:"Parameter"==a[h].alert_variabletype?a[h].operator:void 0,alertID:null==a[h].alertID||""==a[h].alertID||null==a[h].alertID?this.username+"_"+this.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500)):a[h].alertID}):"PK"in A[p]||(A[p].PK=a[h].PK,A[p].alerts_configured=[],A[p].alerts_configured.push({alert_datatype:a[h].alert_datatype,alert_variabletype:a[h].alert_variabletype,alertValuePrediction:a[h].alertValuePrediction,parameterID:a[h].parameterID,parameterID1:a[h].parameterID1,parameterID2:a[h].parameterID2,notificationMatrixId:a[h].notificationMatrixId,equTextarea:a[h].equTextarea,operator:a[h].operator,operator_value:a[h].operator_value,alert_percent:a[h].alert_percent,severity:a[h].severity,alert_text_active:a[h].alert_text_active,alert_text_closed:a[h].alert_text_closed,alert_text_snoozed:a[h].alert_text_snoozed,alert_time:a[h].alert_time,operational_schedule:a[h].operational_schedule,binding_parameter:a[h].binding_parameter,parameter_operator:"Parameter"==a[h].alert_variabletype?a[h].operator:void 0,alertID:null==a[h].alertID||""==a[h].alertID||null==a[h].alertID?this.username+"_"+this.loggedUserClientID+"_"+(Math.floor(Date.now()/1e3)+(0,O.Iyf)(1,500)):a[h].alertID}));console.log("new object",A),this.tempMultiAlerts=A;for(let h=0;h<this.tempMultiAlerts.length;h++)this.tempMultiAlerts[h].alerts_configured=JSON.stringify(this.tempMultiAlerts[h].alerts_configured)}this.updateMultipleDeviceAlertsDB(0)}}updateMultipleDeviceDB(t){var e=this;if(this.spinner.show(),t<this.tempMultiData.length){const r=Math.ceil((new Date).getTime()/1e3),i={P1:this.tempMultiData[t].PK,P2:this.tempMultiData[t].mn_label,P3:this.tempMultiData[t].reading_device_type,P4:this.tempMultiData[t].company_id,P5:r,P6:this.tempMultiData[t].longitude,P7:this.tempMultiData[t].latitude,P8:this.tempMultiData[t].unifier_identifier};this.api.UpdateDeviceConfiguration(this.tempMultiData[t]).then(function(){var n=(0,x.Z)(function*(a){a?(yield e.fetchTimeMachineById(1,i.P1,"update",i),e.updateMultipleDeviceDB(t+1)):(e.spinner.hide(),alert("Error in updating Configuration"))});return function(a){return n.apply(this,arguments)}}()).catch(n=>{this.spinner.hide(),console.log("error for updating",n)})}else this.spinner.hide(),this.toast.open("Devices updated successfully "+t," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})}fetchTimeMachineById(t,e,r,i){var n=this;return(0,x.Z)(function*(){try{const a=yield n.api.GetLookupMasterTable(n.clientID,t);if(a&&a.items){let u=yield JSON.parse(a.items),g=u.findIndex(l=>l[Object.keys(l)[0]].P1===e);if(-1!==g){if("update"===r){u[g][`L${g+1}`]=i;const d=[];for(let v=0;v<u.length;v++){const f=Object.keys(u[v])[0],C=`L${v+1}`;if(f){const c={[C]:u[v][f]},s=d.findIndex(T=>Object.keys(T)[0]===C);-1!==s?Object.assign(d[s][C],u[v][f]):d.push(c)}else console.error(`Original key not found for renaming in data[${v}].`)}u=d}else"delete"===r&&u.splice(g,1);let l={PK:n.clientID,SK:a.SK,items:JSON.stringify(u)};yield n.api.UpdateLookupMasterTable(l)}else yield new Promise(l=>setTimeout(l,500)),yield n.fetchTimeMachineById(t+1,e,r,i)}else M().fire({position:"top-right",icon:"error",title:`ID ${e} not found`,showConfirmButton:!1,timer:1500})}catch(a){console.error("Error:",a)}})()}updateMultipleDeviceAlertsDB(t){var e=this;return(0,x.Z)(function*(){if(t<e.tempMultiAlerts.length){let r;console.log("this.multi alerts index",e.tempMultiAlerts[t]),console.log("All the alerts data and the device is",e.tempMultiAlerts[t]);try{yield e.api.GetDeviceConfiguration(e.tempMultiAlerts[t].PK,e.loggedUserClientID).then(function(){var a=(0,x.Z)(function*(u){u&&(r=u,console.log("Data coming from DB is :",r))});return function(u){return a.apply(this,arguments)}}())}catch(a){console.log("Cannot fetch the device :",a)}const i=Math.ceil((new Date).getTime()/1e3),n={P1:r.mn,P2:r.mn_label,P3:r.reading_device_type,P4:r.company_id,P5:i,P6:r.longitude,P7:r.latitude,P8:r.unifier_identifier};e.api.UpdateDeviceConfiguration(e.tempMultiAlerts[t]).then(function(){var a=(0,x.Z)(function*(u){u?(yield e.fetchTimeMachineById(1,n.P1,"update",n),e.updateMultipleDeviceAlertsDB(t+1)):alert("Error in Updating Alerts Configuration")});return function(u){return a.apply(this,arguments)}}()).catch(a=>{console.log("err for creation",a),e.toast.open("Error in Updation of Alerts Configuration ","Check again",{duration:5e3,horizontalPosition:"right",verticalPosition:"top"})})}else e.toast.open(e.tempMultiAlerts.length+" Device's Alerts updated successfully "," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})})()}validateDevice(t){var e=this;return(0,x.Z)(function*(){try{const r=new Set,i=e.lookup_devices.filter(a=>{const u=r.has(a.P1);return r.add(a.P1),!u}),n=t;if(n){const a=e.allMacID.filter(g=>n===g.name),u=i.filter(g=>void 0!==g.P8&&g.P8==a[0].name);if(console.log("All the devices with same macID",u),Array.isArray(u)&&0!=u.length&&!(a[0].no_of_devices>u.length))return M().fire({title:`Insufficient Devices in MAC ID ${a[0].name}!`,text:`You are limited to add ${a[0].no_of_devices} devices for this MAC ID. Please purchase additional devices to proceed.`,icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6",allowOutsideClick:!1,allowEscapeKey:!1}),!1}return!0}catch(r){console.error("Something went wrong on change selection",r)}})()}fetchNMData(t){var e=this;return(0,x.Z)(function*(){try{console.log(e.clientID,t);const r=yield e.api.GetLookupMasterTable(e.loggedUserClientID+"#notification_matrix",t);if(r&&r.items)if("string"==typeof r.items){let i=JSON.parse(r.items);if(Array.isArray(i)){for(let n=0;n<i.length;n++){const a=i[n];if(null==a)break;console.log("server Response",a),e.Lookupdata.push(a)}yield e.fetchNMData(t+1)}else console.error("Invalid data format - not an array.")}else console.error("response.items is not a string.");else{e.listofNMIds=[];for(let i=0;i<e.Lookupdata.length;i++){const n=e.Lookupdata[i][`L${i+1}`];e.listofNMIds.includes(n.P1)||e.listofNMIds.push(n.P1)}e.listofNMIds=Array.from(new Set(e.listofNMIds)),e.listofNMIds.push("Always"),e.listofNMIds.push("None"),e.listofNMIds.push("Disabled"),console.log("All the notification matrix are here ",e.listofNMIds)}}catch(r){console.error("Error:",r),console.log("Finished parsing through the pages"),console.log("ADDING TO THE TABLE")}})()}updatePagedData(){const t=this.currentPage*this.pageSize;this.pagedPreviewData=this.previewData.slice(t,t+this.pageSize),this.totalPages=Math.ceil(this.previewData.length/this.pageSize),this.grid.data=this.pagedPreviewData,this.cd.detectChanges()}loadGridData(t){this.previewData=t,this.currentPage=0,this.updatePagedData()}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.updatePagedData())}prevPage(){this.currentPage>0&&(this.currentPage--,this.updatePagedData())}}return b=w,(0,m.Z)(w,"\u0275fac",function(t){return new(t||b)(o.Y36(V.QS),o.Y36(H.t),o.Y36(j.ux),o.Y36(Z.F),o.Y36(Z.F),o.Y36(Z.F),o.Y36(Z.F),o.Y36(Z.F),o.Y36(X.G),o.Y36($.F0),o.Y36(F.y),o.Y36(o.sBO),o.Y36(U.t2),o.Y36(ee.FF),o.Y36(te),o.Y36(ie))}),(0,m.Z)(w,"\u0275cmp",o.Xpm({type:b,selectors:[["app-send"]],viewQuery:function(t,e){if(1&t&&(o.Gf(ae,7),o.Gf(re,5)),2&t){let r;o.iGM(r=o.CRH())&&(e.fileUpload=r.first),o.iGM(r=o.CRH())&&(e.container=r.first)}},decls:35,vars:11,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-atom",3,"fullScreen"],[2,"color","white"],[1,"card","p-5","modern-card","shadow",3,"formGroup"],[1,"mb-4","text-primary","fw-bold"],[1,"row","g-4"],[1,"col-md-6"],[1,"form-label","fw-semibold","text-dark"],[1,"text-danger"],["formControlName","type","required","",1,"form-select","custom-select"],["value","","disabled","","selected",""],["value","device_xlsx"],["value","alerts_xlsx"],["class","text-danger",4,"ngIf"],["class","col-md-6",4,"ngIf"],[1,"col-12"],[1,"scroll-grid-container"],[1,"sticky-toolbar","d-flex","flex-wrap","gap-2","p-2","bg-white","border-bottom","shadow-sm"],[1,"btn","btn-warning","text-dark",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["class","btn btn-info text-white",3,"disabled","click",4,"ngIf"],["class","btn btn-success",3,"disabled","click",4,"ngIf"],["class","btn btn-dark",3,"disabled","click",4,"ngIf"],["id","grid",1,"excel-output","modern-grid","mt-4"],["container",""],["class","pagination-controls d-flex justify-content-between align-items-center mt-3",4,"ngIf"],["fileUpload",""],["type","file","accept",".xlsx",1,"form-control","modern-file",3,"change"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-info","text-white",3,"disabled","click"],[1,"btn","btn-success",3,"disabled","click"],[1,"btn","btn-dark",3,"disabled","click"],[1,"bi","bi-download","fs-5"],[1,"pagination-controls","d-flex","justify-content-between","align-items-center","mt-3"],[1,"btn","btn-outline-secondary","btn-sm",3,"disabled","click"],[1,"modal-header","bg-danger","text-white"],[1,"modal-title"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],["class","alert alert-danger",4,"ngIf"],["class","validation-errors mt-3",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"alert","alert-danger"],[1,"validation-errors","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"badge","bg-danger"],[1,"validation-list","mt-2",2,"max-height","200px","overflow-y","auto"],[1,"table","table-sm","table-bordered","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"text-center",2,"width","60px"]],template:function(t,e){if(1&t&&(o.TgZ(0,"ngx-spinner",0)(1,"p",1),o._uU(2,"Please wait while we complete your request"),o.qZA()(),o.TgZ(3,"div",2)(4,"h4",3),o._uU(5,"Device"),o.qZA(),o.TgZ(6,"div",4)(7,"div",5)(8,"label",6),o._uU(9,"Type "),o.TgZ(10,"span",7),o._uU(11,"*"),o.qZA()(),o.TgZ(12,"select",8)(13,"option",9),o._uU(14,"Select Type"),o.qZA(),o.TgZ(15,"option",10),o._uU(16,"Device"),o.qZA(),o.TgZ(17,"option",11),o._uU(18,"Alerts"),o.qZA()(),o.YNc(19,oe,2,0,"small",12),o.qZA(),o.YNc(20,ne,4,0,"div",13),o.TgZ(21,"div",14)(22,"div",15)(23,"div",16)(24,"button",17),o.NdJ("click",function(){let i;return e.exportTemplate(null==(i=e.createDynamicSendField.get("type"))?null:i.value)}),o._uU(25," \u2b07 Export Template "),o.qZA(),o.YNc(26,se,2,1,"button",18),o.YNc(27,le,2,1,"button",19),o.YNc(28,de,2,1,"button",20),o.YNc(29,ue,3,1,"button",21),o.qZA(),o._UZ(30,"div",22,23),o.YNc(32,ce,7,4,"div",24),o.qZA()()(),o.YNc(33,fe,10,2,"ng-template",null,25,o.W1O),o.qZA()),2&t){let r,i,n;o.Q6J("fullScreen",!0),o.xp6(3),o.Q6J("formGroup",e.createDynamicSendField),o.xp6(16),o.Q6J("ngIf",(null==(r=e.createDynamicSendField.get("type"))?null:r.hasError("required"))&&(null==(r=e.createDynamicSendField.get("type"))?null:r.touched)),o.xp6(1),o.Q6J("ngIf",o.DdM(10,me).includes(null==(i=e.createDynamicSendField.get("type"))?null:i.value)),o.xp6(4),o.Q6J("disabled",!(null!=(n=e.createDynamicSendField.get("type"))&&n.value)),o.xp6(2),o.Q6J("ngIf",e.hideUpdateButton&&e.savedFileEvent),o.xp6(1),o.Q6J("ngIf",e.hideGetButton&&e.savedFileEvent),o.xp6(1),o.Q6J("ngIf",e.hideUpdateButton&&e.savedFileEvent),o.xp6(1),o.Q6J("ngIf",e.hideUpdateButton&&e.savedFileEvent),o.xp6(3),o.Q6J("ngIf",e.totalPages)}},dependencies:[K.sg,K.O5,V.YN,V.Kr,V.EJ,V.JJ,V.JL,V.Q7,V.sg,V.u,U.Ro],styles:[".spinner-text[_ngcontent-%COMP%]{color:#fff;font-size:1rem;text-align:center}.modern-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;border:none}.custom-select[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:6px;background-color:#f8f9fa;transition:all .3s ease}.custom-select[_ngcontent-%COMP%]:focus{border-color:#4c6ef5;box-shadow:0 0 0 .2rem #4c6ef540}.modern-file[_ngcontent-%COMP%]{border-radius:6px;border:1px solid #ced4da;background-color:#f8f9fa;transition:all .3s}.modern-file[_ngcontent-%COMP%]:focus{border-color:#4c6ef5;box-shadow:0 0 0 .2rem #4c6ef540}button[_ngcontent-%COMP%]{transition:.3s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:scale(1.03)}.modern-grid[_ngcontent-%COMP%]{background-color:#f1f3f5;padding:1rem;border:1px solid #dee2e6;border-radius:8px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff}.table-danger[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#ffa8a8}.scroll-grid-container[_ngcontent-%COMP%]{position:relative;height:500px;overflow-y:auto;border:1px solid #dee2e6;border-radius:10px;background:#f9f9f9}.sticky-toolbar[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:#fff;border-radius:10px 10px 0 0}"]})),w})(),De=(()=>{var b;class w{}return b=w,(0,m.Z)(w,"\u0275fac",function(t){return new(t||b)}),(0,m.Z)(w,"\u0275mod",o.oAB({type:b})),(0,m.Z)(w,"\u0275inj",o.cJS({imports:[K.ez,j.ZX,V.UX,U.ef,$.Bz.forChild([{path:"",component:_e}])]})),w})()}}]);