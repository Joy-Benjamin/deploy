"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[4247],{94247:(Ct,U,m)=>{m.r(U),m.d(U,{AuthModule:()=>yt});var s=m(86656),f=m(96814),a=m(56223),k=m(69862),g=m(64190),p=m(15861),t=m(65879),q=m(62381),y=m(31552),L=m(77536);const O=["root",""],S=function(){return[]};function N(r,i){if(1&r&&(t.TgZ(0,"a",10),t._UZ(1,"img",11),t.qZA()),2&r){const c=t.oxw();t.xp6(1),t.Q6J("src",c.clientLogo==t.DdM(1,S)||null==c.clientLogo||null==c.clientLogo?"./assets/media/Wimate_latest.png":"dark-sidebar"!==c.currentLayoutType?c.clientLogo&&c.clientLogo[0]&&c.clientLogo[0]:c.clientLogo&&c.clientLogo&&c.clientLogo[2]&&c.clientLogo[2],t.LSH)}}function J(r,i){1&r&&(t.TgZ(0,"a",10),t._UZ(1,"img",12),t.qZA())}let D=(()=>{var r;class i{constructor(e,o,n,l,u){(0,s.Z)(this,"layout",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"api",void 0),(0,s.Z)(this,"cd",void 0),(0,s.Z)(this,"getImage",void 0),(0,s.Z)(this,"linkElement",void 0),(0,s.Z)(this,"splashScreenLogoElement",void 0),(0,s.Z)(this,"unsubscribe",[]),(0,s.Z)(this,"today",new Date),(0,s.Z)(this,"currentUrl",void 0),(0,s.Z)(this,"currentLayoutType",void 0),(0,s.Z)(this,"showLogo",!1),(0,s.Z)(this,"clientLogo",[]),this.layout=e,this.router=o,this.api=n,this.cd=l,this.getImage=u,this.splashScreenLogoElement=document.getElementById("splash-screen-logo"),this.linkElement=document.querySelector("link[rel*='icon']")}ngOnInit(){var e=this;return(0,p.Z)(function*(){const o=e.layout.currentLayoutTypeSubject.asObservable().subscribe(u=>{e.currentLayoutType=u,console.log("Current layout type is",e.currentLayoutType)});e.unsubscribe.push(o);const n=window.location.href;new URL(n),e.clientLogo=yield e.getImage.getClientLogo(),console.log("Client logos are here ",e.clientLogo),e.showLogo=!0,e.linkElement&&e.clientLogo&&(e.linkElement.href="dark-sidebar"!==e.currentLayoutType?e.clientLogo&&e.clientLogo[1]&&e.clientLogo[1]:e.clientLogo&&e.clientLogo[3]&&e.clientLogo[3]),document.body.classList.add("bg-white"),e.cd.detectChanges()})()}getLogo(e){var o=this;return(0,p.Z)(function*(){try{const n=yield o.api.GetLookupMasterTable(e,1);if(n&&n.items){const l=JSON.parse(n.items);console.log("Metadata is here ",l),o.clientLogo=l.clientLogo1,console.log("Custom Logo is here ",o.clientLogo)}}catch{console.log("Error fetching the client Logo")}})()}ngOnDestroy(){document.body.classList.remove("bg-white"),this.unsubscribe.forEach(e=>e.unsubscribe())}}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)(t.Y36(q.Pb),t.Y36(g.F0),t.Y36(y.t),t.Y36(t.sBO),t.Y36(L.p))}),(0,s.Z)(i,"\u0275cmp",t.Xpm({type:r,selectors:[["body","root",""]],attrs:O,decls:20,vars:2,consts:[[1,"d-flex","flex-column","flex-column-fluid","bgi-position-y-bottom","position-x-center","bgi-no-repeat","bgi-size-contain","bgi-attachment-fixed","background"],[1,"d-flex","flex-center","flex-column","flex-column-fluid","p-10","pb-lg-20"],["routerLink","/home","class","mb-12",4,"ngIf"],[1,"w-lg-500px","bg-white","rounded","shadow-sm","p-10","p-lg-15","mx-auto"],[1,"text-muted","fs-7","mt-2","bounce",2,"font-weight","bold","color","#333","background","#f8f9fa","padding","5px 10px","border-radius","5px"],["href","https://www.wimate.in/","target","_blank",2,"text-decoration","none"],[2,"background","none","color","#007bff"],[1,"d-flex","flex-center","flex-column-auto","p-10"],[1,"d-flex","align-items-center","fw-bold","fs-6"],[1,"text-muted","text-hover-primary","px-2","cursor-pointer"],["routerLink","/home",1,"mb-12"],["alt","Logo",2,"width","300px",3,"src"],["alt","Logo","src","./assets/Your paragraph text.gif",2,"width","300px"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,N,2,2,"a",2),t.YNc(3,J,2,0,"a",2),t.TgZ(4,"div",3),t._UZ(5,"router-outlet"),t.qZA(),t.TgZ(6,"div",4)(7,"span"),t._uU(8,"Powered by"),t.qZA(),t.TgZ(9,"a",5)(10,"mark",6),t._uU(11,"Wimate"),t.qZA()()()(),t.TgZ(12,"div",7)(13,"div",8)(14,"a",9),t._uU(15,"About"),t.qZA(),t.TgZ(16,"a",9),t._uU(17,"Contact"),t.qZA(),t.TgZ(18,"a",9),t._uU(19,"Contact Us"),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.showLogo),t.xp6(1),t.Q6J("ngIf",!o.showLogo))},dependencies:[f.O5,g.lC,g.rH],styles:["[_nghost-%COMP%]{height:100%}.background[_ngcontent-%COMP%]{background:linear-gradient(to bottom,white,#D1E9F6)}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.bounce[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 1s ease}"]})),i})();var E=m(10446);class Q{static MatchPassword(i){const c=i.get("password")?.value,e=i.get("cPassword")?.value;c!==e&&i.get("cPassword")?.setErrors({ConfirmPassword:!0})}}var A=m(20553),h=m(5816),Y=m(13519),P=m.n(Y),Z=m(83405);function M(r,i){1&r&&(t.ynx(0),t.TgZ(1,"div",30)(2,"div",31),t._uU(3," The registration details are incorrect "),t.qZA()(),t.BQk())}function R(r,i){1&r&&(t.ynx(0),t.TgZ(1,"div",32)(2,"div",33),t._uU(3," 'Passsword' and 'Confirm Password' didn't match. "),t.qZA()(),t.BQk())}function B(r,i){1&r&&(t.ynx(0),t.TgZ(1,"span",34),t._uU(2,"Submit"),t.qZA(),t.BQk())}function K(r,i){1&r&&(t.ynx(0),t.TgZ(1,"span",35),t._uU(2," Please wait... "),t._UZ(3,"span",36),t.qZA(),t.BQk()),2&r&&(t.xp6(1),t.Udp("display","block"))}function V(r,i){if(1&r&&(t.ynx(0),t.TgZ(1,"div",32)(2,"div",33)(3,"span",37),t._uU(4),t.qZA()()(),t.BQk()),2&r){const c=t.oxw().message;t.xp6(4),t.hij(" ",c," ")}}function G(r,i){if(1&r&&t.YNc(0,V,5,1,"ng-container",10),2&r){const c=i.control;t.Q6J("ngIf",c.hasError(i.validation)&&(c.dirty||c.touched))}}const b=function(r,i){return{"is-invalid":r,"is-valid":i}},z=function(r){return{validation:"required",message:"Fullname is required",control:r}},j=function(r){return{validation:"minlength",message:"Fullname should have at least 3 symbols",control:r}},W=function(r){return{validation:"maxLength",message:"Fullname should have maximum 100 symbols",control:r}},X=function(r){return{validation:"required",message:"Email is required",control:r}},$=function(r){return{validation:"email",message:"Email is invalid",control:r}},H=function(r){return{validation:"minlength",message:"Email should have at least 3 symbols",control:r}},tt=function(r){return{validation:"maxLength",message:"Email should have maximum 360 symbols",control:r}},et=function(r){return{validation:"required",message:"Password is required",control:r}},ot=function(r){return{validation:"minlength",message:"Password should have at least 3 symbols",control:r}},rt=function(r){return{validation:"maxLength",message:"Password should have maximum 100 symbols",control:r}},nt=function(r){return{validation:"required",message:"Confirm Password is required",control:r}},st=function(r){return{validation:"minlength",message:"Confirm Password should have at least 3 symbols",control:r}},it=function(r){return{validation:"maxLength",message:"Confirm Password should have maximum 100 symbols",control:r}};let at=(()=>{var r;class i{constructor(e,o,n){(0,s.Z)(this,"fb",void 0),(0,s.Z)(this,"authService",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"registrationForm",void 0),(0,s.Z)(this,"hasError",void 0),(0,s.Z)(this,"isLoading$",void 0),(0,s.Z)(this,"user",void 0),(0,s.Z)(this,"unsubscribe",[]),this.fb=e,this.authService=o,this.router=n,this.isLoading$=this.authService.isLoading$,this.authService.currentUserValue&&this.router.navigate(["/"])}ngOnInit(){this.user={},this.initForm()}get f(){return this.registrationForm.controls}initForm(){this.registrationForm=this.fb.group({name:["",a.kI.compose([a.kI.required,a.kI.minLength(3),a.kI.maxLength(100)])],email:["qwe@qwe.qwe",a.kI.compose([a.kI.required,a.kI.email,a.kI.minLength(3),a.kI.maxLength(320)])],password:["",a.kI.compose([a.kI.required,a.kI.minLength(3),a.kI.maxLength(100)])],cPassword:["",a.kI.compose([a.kI.required,a.kI.minLength(3),a.kI.maxLength(100)])],phone_number:["",a.kI.compose([a.kI.minLength(10),a.kI.minLength(12)])],agree:[!1,a.kI.compose([a.kI.required])]},{validator:Q.MatchPassword})}submit(){if(console.log("form details",this.registrationForm),this.registrationForm.valid){var o=new h.AM({UserPoolId:A.N.cognito.cognitoUserPoolId,ClientId:A.N.cognito.cognitoAppClientId}),n=[];let l={email:this.registrationForm.value.email};for(let u in l){let d={Name:u,Value:l[u]};console.log("attribute data",d);let v=new h.KC(d);n.push(v)}console.log(n),o.signUp(this.registrationForm.value.email,this.registrationForm.value.name,n,[],(u,d)=>{if(u)return console.log("err on signup",u),alert(u.message||JSON.stringify(u)),void P().fire({position:"center",icon:"warning",showCancelButton:!0,allowOutsideClick:!1});this.router.navigate(["/auth/confirmRegistration"])})}else alert("Invalid")}ngOnDestroy(){this.unsubscribe.forEach(e=>e.unsubscribe())}}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)(t.Y36(a.QS),t.Y36(Z.e),t.Y36(g.F0))}),(0,s.Z)(i,"\u0275cmp",t.Xpm({type:r,selectors:[["app-registration"]],decls:65,vars:80,consts:[["novalidate","novalidate","id","kt_login_signup_form",1,"form","w-100","fv-plugins-bootstrap5","fv-plugins-framework",3,"formGroup","ngSubmit"],[1,"mb-10","text-center"],[1,"text-dark","mb-3"],[1,"text-gray-400","fw-bold","fs-4"],["routerLink","/auth/login",1,"link-primary","fw-bolder"],["type","button",1,"btn","btn-light-primary","fw-bolder","w-100","mb-10"],["alt","Logo","src","./assets/media/svg/brand-logos/google-icon.svg",1,"h-20px","me-3"],[1,"d-flex","align-items-center","mb-10"],[1,"border-bottom","border-gray-300","mw-50","w-100"],[1,"fw-bold","text-gray-400","fs-7","mx-2"],[4,"ngIf"],[1,"row","fv-row","mb-7"],[1,"form-label","fw-bolder","text-dark","fs-6"],["type","text","name","name","formControlName","name","placeholder","Fullname","autocomplete","off",1,"form-control","form-control-lg","form-control-solid",3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"fv-row","mb-7"],["type","email","placeholder","Email","name","email","formControlName","email","autocomplete","off",1,"form-control","form-control-lg","form-control-solid",3,"ngClass"],[1,"mb-10","fv-row"],["type","password","placeholder","Password","name","password","formControlName","password","autocomplete","off",1,"form-control","form-control-lg","form-control-solid",3,"ngClass"],[1,"fv-row","mb-5"],["type","password","placeholder","Confirm password","name","cPassword","autocomplete","off","formControlName","cPassword",1,"form-control","form-control-lg","form-control-solid",3,"ngClass"],[1,"fv-row","mb-10"],[1,"form-check","form-check-custom","form-check-solid"],["id","kt_login_toc_agree","type","checkbox","formControlName","agree","name","agree",1,"form-check-input"],["for","kt_login_toc_agree",1,"form-check-label","fw-bold","text-gray-700","fs-6"],["href","https://keenthemes.com/metronic/?page=faq","target","_blank",1,"ms-1","link-primary"],[1,"text-center"],["type","submit","id","kt_sign_up_submit",1,"btn","btn-lg","btn-primary","w-100","mb-5",3,"disabled"],["routerLink","/auth/login","type","button","id","kt_login_signup_form_cancel_button",1,"btn","btn-lg","btn-light-primary","w-100","mb-5"],["formError",""],[1,"mb-lg-15","alert","alert-danger"],[1,"alert-text","font-weight-bold"],[1,"fv-plugins-message-container"],[1,"fv-help-block"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],["role","alert"]],template:function(e,o){if(1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(1,"div",1)(2,"h1",2),t._uU(3,"Create an Account"),t.qZA(),t.TgZ(4,"div",3),t._uU(5," Already have an account? "),t.TgZ(6,"a",4),t._uU(7,"Sign in?"),t.qZA()()(),t.TgZ(8,"button",5),t._UZ(9,"img",6),t._uU(10,"Sign in with Google "),t.qZA(),t.TgZ(11,"div",7),t._UZ(12,"div",8),t.TgZ(13,"span",9),t._uU(14,"OR"),t.qZA(),t._UZ(15,"div",8),t.qZA(),t.YNc(16,M,4,0,"ng-container",10),t.TgZ(17,"div",11)(18,"label",12),t._uU(19,"Fullname"),t.qZA(),t._UZ(20,"input",13),t.GkF(21,14)(22,14)(23,14),t.qZA(),t.TgZ(24,"div",15)(25,"label",12),t._uU(26,"Email"),t.qZA(),t._UZ(27,"input",16),t.GkF(28,14)(29,14)(30,14)(31,14),t.qZA(),t.TgZ(32,"div",17)(33,"label",12),t._uU(34,"Password"),t.qZA(),t._UZ(35,"input",18),t.GkF(36,14)(37,14)(38,14),t.qZA(),t.TgZ(39,"div",19)(40,"label",12),t._uU(41,"Confirm Password"),t.qZA(),t._UZ(42,"input",20),t.GkF(43,14)(44,14)(45,14),t.YNc(46,R,4,0,"ng-container",10),t.qZA(),t.TgZ(47,"div",21)(48,"div",22),t._UZ(49,"input",23),t.TgZ(50,"label",24),t._uU(51," I Agree the\xa0"),t.TgZ(52,"a",25),t._uU(53,"terms and conditions"),t.qZA(),t._uU(54,". "),t.qZA()()(),t.TgZ(55,"div",26)(56,"button",27),t.YNc(57,B,3,0,"ng-container",10),t.ALo(58,"async"),t.YNc(59,K,4,2,"ng-container",10),t.ALo(60,"async"),t.qZA(),t.TgZ(61,"a",28),t._uU(62," Cancel "),t.qZA()()(),t.YNc(63,G,1,1,"ng-template",null,29,t.W1O)),2&e){const n=t.MAs(64);t.Q6J("formGroup",o.registrationForm),t.xp6(6),t.Udp("margin-left","5px"),t.xp6(10),t.Q6J("ngIf",o.hasError),t.xp6(4),t.Q6J("ngClass",t.WLB(42,b,o.registrationForm.controls.name.invalid,o.registrationForm.controls.name.valid)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(45,z,o.registrationForm.controls.name)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(47,j,o.registrationForm.controls.name)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(49,W,o.registrationForm.controls.name)),t.xp6(4),t.Q6J("ngClass",t.WLB(51,b,o.registrationForm.controls.email.invalid,o.registrationForm.controls.email.valid)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(54,X,o.registrationForm.controls.email)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(56,$,o.registrationForm.controls.email)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(58,H,o.registrationForm.controls.email)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(60,tt,o.registrationForm.controls.email)),t.xp6(4),t.Q6J("ngClass",t.WLB(62,b,o.registrationForm.controls.password.invalid,o.registrationForm.controls.password.valid)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(65,et,o.registrationForm.controls.password)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(67,ot,o.registrationForm.controls.password)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(69,rt,o.registrationForm.controls.password)),t.xp6(4),t.Q6J("ngClass",t.WLB(71,b,o.registrationForm.controls.cPassword.invalid,o.registrationForm.controls.cPassword.valid)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(74,nt,o.registrationForm.controls.cPassword)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(76,st,o.registrationForm.controls.cPassword)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(78,it,o.registrationForm.controls.cPassword)),t.xp6(1),t.Q6J("ngIf",o.registrationForm.controls.cPassword.errors&&o.registrationForm.controls.cPassword.errors.ConfirmPassword),t.xp6(10),t.Q6J("disabled",o.registrationForm.invalid||!o.registrationForm.controls.agree.value),t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(58,38,o.isLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(60,40,o.isLoading$))}},dependencies:[f.mk,f.O5,f.tP,g.rH,a._Y,a.Fj,a.Wl,a.JJ,a.JL,a.sg,a.u,f.Ov],styles:["[_nghost-%COMP%]{width:100%}@media (min-width: 992px){[_nghost-%COMP%]   .login-form[_ngcontent-%COMP%]{width:100%;max-width:450px}[_nghost-%COMP%]   .login-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}}"]})),i})();var C=m(22939),lt=m(16519),ut=m(36624),x=m(88672),I=m(6593);function ct(r,i){1&r&&(t.TgZ(0,"div",19),t._uU(1," ClientID is required "),t.qZA())}function mt(r,i){1&r&&(t.TgZ(0,"div",19),t._uU(1," Confirmation code is required "),t.qZA())}function dt(r,i){1&r&&(t.TgZ(0,"div",19),t._uU(1," New Password is required "),t.qZA())}let gt=(()=>{var r;class i{constructor(e,o,n,l,u,d,v,_,F){(0,s.Z)(this,"fb",void 0),(0,s.Z)(this,"authService",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"api",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"auditService",void 0),(0,s.Z)(this,"DynamicApi",void 0),(0,s.Z)(this,"spinner",void 0),(0,s.Z)(this,"titleService",void 0),(0,s.Z)(this,"forgotPasswordForm",void 0),(0,s.Z)(this,"user",void 0),(0,s.Z)(this,"unsubscribe",[]),(0,s.Z)(this,"tempUser",void 0),(0,s.Z)(this,"sk_clientID",void 0),(0,s.Z)(this,"userEmail",void 0),(0,s.Z)(this,"errorForInvalidName",""),(0,s.Z)(this,"storedResponse",void 0),this.fb=e,this.authService=o,this.router=n,this.api=l,this.toast=u,this.auditService=d,this.DynamicApi=v,this.spinner=_,this.titleService=F}ngOnInit(){this.user={},this.initForm();const e=localStorage.getItem("userDetails");console.log("userString ",e),this.user=e?JSON.parse(e):null,this.listAllCognitoUsers(),this.titleService.setTitle("Forgot Password"),console.log("Title is being set")}listAllCognitoUsers(){var e=this;return(0,p.Z)(function*(){const n={type:"cognitoServices",event:{path:"/listAllUsers",queryStringParameters:{},clientID:"dummy"}};try{const l=yield e.DynamicApi.getData(n);console.log("Response is here ",JSON.parse(l.body)),e.storedResponse=JSON.parse(l.body).users.map(u=>({username:u.username,email:u.attributes.email,userID:u.attributes["custom:userID"],clientID:u.attributes["custom:clientID"]})).find(u=>u.username.toLowerCase()==e.user.username.toLowerCase()),console.log("All the cognito users list is here ",e.storedResponse),e.storedResponse&&(e.sk_clientID=e.storedResponse.clientID,e.userEmail=e.storedResponse.email)}catch(l){console.error("Error calling dynamic lambda:",l)}})()}initForm(){this.forgotPasswordForm=this.fb.group({newpassword:["",a.kI.compose([a.kI.required,a.kI.minLength(5)])],code:["",a.kI.required],client:["",a.kI.required]}),console.log("User details are here ",this.user)}forgotCognitoPassword(){var e=this;this.user.code=this.forgotPasswordForm.get("code")?.value,console.log("user details",this.user);let o={PK:this.user.username,SK:this.sk_clientID,name:this.forgotPasswordForm.value.newpassword};this.user&&0!=JSON.stringify(this.forgotPasswordForm.value.newpassword).trim().length?this.authService.forgotPasswordSubmission(this.user,this.forgotPasswordForm.value.newpassword).then((0,p.Z)(function*(){yield e.api.UpdateUserManagement(o).then(function(){var n=(0,p.Z)(function*(l){l?(e.auditService.getLocaldata().then(d=>{e.auditService.audit_trailforgotPassword(e.user.username,e.sk_clientID,"2.1","Login Module","Forgot Password","Request for Password Change","1")}),e.DynamicApi.sendData({type:"forgot_password",username:e.user.username,email:e.userEmail,password:e.forgotPasswordForm.value.newpassword}).subscribe(d=>{console.log("Response from Lambda:",d),e.auditService.audit_trailforgotPassword(e.user.username,e.sk_clientID,"2.1","Login Module","Forgot Password","Password change credentials email sent successfully.","1"),e.toast.open("Mail Sent Successfully"," ",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})},d=>{console.error("Error calling dynamic lambda:",d)}),yield e.updateCognitoAttributesV2(e.user.username,e.forgotPasswordForm.value.newpassword),e.toast.open("Password Updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}),e.router.navigate(["/auth/signIn"])):(e.router.navigate(["/auth/signIn"]),alert("Error in updating user Configuration"))});return function(l){return n.apply(this,arguments)}}()).catch(n=>{e.router.navigate(["/auth/signIn"]),console.log("error for updating",n)})})).catch(n=>{this.router.navigate(["/auth/signIn"]),alert(n)}):(this.router.navigate(["/auth/signIn"]),alert("Please enter valid password"))}updateCognitoAttributesV2(e,o){var n=this;return(0,p.Z)(function*(){const l={Username:e,Password:o},d=new h.AM({UserPoolId:"ap-south-1_Gn44inxvx",ClientId:"t23vmu9vielnfdl3b4o02ho87"}),_=new h.ws({Username:e,Pool:d}),F=new h.sD(l),Pt=Object.entries({"custom:name":o}).map(([w,T])=>new h.KC({Name:w,Value:T}));try{const w=yield n.authenticateUserAsync(_,F);console.log("Authenticated successfully",w);const T=yield n.updateAttributesAsync(_,Pt);console.log("Attributes updated successfully",T)}catch(w){console.error("Error during Cognito update:",w)}})()}authenticateUserAsync(e,o){return new Promise((n,l)=>{e.authenticateUser(o,{onSuccess:n,onFailure:l})})}updateAttributesAsync(e,o){return new Promise((n,l)=>{e.updateAttributes(o,(u,d)=>{if(u)return l(u);n(d)})})}checkName_asPassword(e){console.log("getPassword",e),this.errorForInvalidName="",!1===/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[A-Za-z0-9_]).{8,}$/.test(e.target.value)&&(this.errorForInvalidName="Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 8 of length")}}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)(t.Y36(a.QS),t.Y36(Z.e),t.Y36(g.F0),t.Y36(y.t),t.Y36(C.ux),t.Y36(lt.C),t.Y36(ut.y),t.Y36(x.t2),t.Y36(I.Dx))}),(0,s.Z)(i,"\u0275cmp",t.Xpm({type:r,selectors:[["app-forgot-password"]],decls:34,vars:5,consts:[[1,"mb-lg-5","alert","alert-warning"],[1,"form-label","fs-6","fw-bolder",2,"margin-bottom","0px"],[3,"formGroup"],[1,"card-body","border-top"],[1,"column"],[1,"col-md-12",2,"display","none"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","required"],["type","text","placeholder","Enter your company name","name","client","formControlName","client","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[1,"col-md-12"],["type","text","placeholder","Enter confirmation code","name","code","formControlName","code","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","Enter New Password","name","newPassword","autocomplete","off","formControlName","newpassword","required","",1,"form-control","form-control-lg","form-control-solid",3,"keyup"],[2,"color","#fc1900"],[1,"d-flex","flex-wrap","justify-content-center","pb-lg-0"],["type","submit",1,"btn","btn-lg","btn-primary","fw-bolder","me-4",3,"click"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],["routerLink","/auth/login",1,"btn","btn-lg","btn-danger","fw-bolder"],[1,"fv-plugins-message-container","invalid-feedback"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"label",1),t._uU(2,"Resetting Password, Take a look in your email."),t.qZA()(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Enter Company Name"),t.qZA(),t._UZ(9,"input",7),t.YNc(10,ct,2,0,"div",8),t.qZA(),t.TgZ(11,"div",9)(12,"label",6),t._uU(13," Confirmation Code"),t.qZA(),t._UZ(14,"input",10),t.YNc(15,mt,2,0,"div",8),t.qZA(),t.TgZ(16,"div",9)(17,"label",6),t._uU(18," New password"),t.qZA(),t.TgZ(19,"input",11),t.NdJ("keyup",function(l){return o.checkName_asPassword(l)}),t.qZA(),t.TgZ(20,"span",12),t._uU(21),t.qZA(),t.YNc(22,dt,2,0,"div",8),t.qZA(),t._UZ(23,"br"),t.TgZ(24,"div",13)(25,"button",14),t.NdJ("click",function(){return o.forgotCognitoPassword()}),t.TgZ(26,"span",15),t._uU(27,"Submit"),t.qZA(),t.ynx(28),t.TgZ(29,"span",16),t._uU(30," Please wait... "),t._UZ(31,"span",17),t.qZA(),t.BQk(),t.qZA(),t.TgZ(32,"a",18),t._uU(33," Cancel "),t.qZA()()()()()),2&e){let n,l,u;t.xp6(3),t.Q6J("formGroup",o.forgotPasswordForm),t.xp6(7),t.Q6J("ngIf",(null==(n=o.forgotPasswordForm.get("code"))?null:n.hasError("required"))&&(null==(n=o.forgotPasswordForm.get("code"))?null:n.touched)),t.xp6(5),t.Q6J("ngIf",(null==(l=o.forgotPasswordForm.get("code"))?null:l.hasError("required"))&&(null==(l=o.forgotPasswordForm.get("code"))?null:l.touched)),t.xp6(6),t.Oqu(o.errorForInvalidName),t.xp6(1),t.Q6J("ngIf",(null==(u=o.forgotPasswordForm.get("newpassword"))?null:u.hasError("required"))&&(null==(u=o.forgotPasswordForm.get("newpassword"))?null:u.touched))}},dependencies:[f.O5,g.rH,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u],styles:["[_nghost-%COMP%]{width:100%}@media (min-width: 992px){[_nghost-%COMP%]   .login-form[_ngcontent-%COMP%]{width:100%;max-width:450px}[_nghost-%COMP%]   .login-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}"]})),i})(),pt=(()=>{var r;class i{constructor(e){(0,s.Z)(this,"authService",void 0),this.authService=e,this.authService.logout()}ngOnInit(){}}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)(t.Y36(Z.e))}),(0,s.Z)(i,"\u0275cmp",t.Xpm({type:r,selectors:[["app-logout"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"logout works!"),t.qZA())}})),i})();function ft(r,i){1&r&&(t.TgZ(0,"div",20),t._uU(1," ClientID is required "),t.qZA())}function ht(r,i){1&r&&(t.TgZ(0,"div",20),t._uU(1," Username or Email is required "),t.qZA())}function vt(r,i){1&r&&(t.TgZ(0,"div",20),t._uU(1," New Password is required "),t.qZA())}const Zt=[{path:"",component:D,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:E.G,data:{returnUrl:window.location.pathname}},{path:"registration",component:at},{path:"forgot-password",component:gt},{path:"forgot-interface",component:(()=>{var r;class i{constructor(e,o,n,l,u,d){(0,s.Z)(this,"fb",void 0),(0,s.Z)(this,"authService",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"api",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"titleService",void 0),(0,s.Z)(this,"forgotPasswordForm",void 0),(0,s.Z)(this,"errorForInvalidName",""),(0,s.Z)(this,"user",void 0),(0,s.Z)(this,"tempUserData",[]),(0,s.Z)(this,"unsubscribe",[]),(0,s.Z)(this,"tempUser",void 0),(0,s.Z)(this,"sk_clientID",void 0),this.fb=e,this.authService=o,this.router=n,this.api=l,this.toast=u,this.titleService=d}ngOnInit(){this.user={},this.initForm();const e=localStorage.getItem("userDetails");this.user=e?JSON.parse(e):null,this.titleService.setTitle("Forgot Password"),console.log("Title is being set")}fetchAllusers(e){var o=this;return(0,p.Z)(function*(){o.tempUserData=[];try{const n=yield o.api.ListUserManagements({PK:{in:e}},500);o.tempUserData=n.items,n.items&&n.items.length>0&&(o.sk_clientID=n.items[0]?.clientID),console.log("Fetched users:",n.items)}catch(n){console.error("Fetch error:",n)}})()}initForm(){this.forgotPasswordForm=this.fb.group({newpassword:["",a.kI.compose([a.kI.required,a.kI.minLength(5)])],code:["",a.kI.required],client:["",a.kI.required],auth_input:["",a.kI.required]}),console.log("User details are here ",this.user)}forgotCognitoPassword(){var e=this;return(0,p.Z)(function*(){const o=e.forgotPasswordForm.get("auth_input")?.value;let n;1==o.includes("@")&&(n=yield e.fetchAllusers(o)),console.log("Here is the result :",n),e.user.code=e.forgotPasswordForm.get("code")?.value,console.log("user details",e.user);let l={PK:e.user.username,SK:e.sk_clientID,name:e.forgotPasswordForm.value.newpassword};e.user&&0!=JSON.stringify(e.forgotPasswordForm.value.newpassword).trim().length?e.authService.forgotPasswordSubmission(e.user,e.forgotPasswordForm.value.newpassword).then((0,p.Z)(function*(){yield e.api.UpdateUserManagement(l).then(function(){var u=(0,p.Z)(function*(d){d?e.toast.open("Password Updated successfully","",{duration:2e3,horizontalPosition:"right",verticalPosition:"top"}):alert("Error in updating user Configuration")});return function(d){return u.apply(this,arguments)}}()).catch(u=>{console.log("error for updating",u)}),e.router.navigate(["/auth/signIn"])})).catch(u=>{alert(u)}):alert("Please enter valid password")})()}forgotPasswordClicked(){var e=this;return(0,p.Z)(function*(){const o=e.forgotPasswordForm.get("auth_input")?.value;let n;if(1==o.includes("@")&&(yield e.fetchAllusers([o]),console.log("User fetched is here ",e.tempUserData),0==e.tempUserData.length))return P().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Email is invalid",showCancelButton:!0,allowOutsideClick:!1});n=e.tempUserData&&e.tempUserData[0]&&e.tempUserData?.[0].username?{email:e.tempUserData?.[0].username,password:e.forgotPasswordForm.get("newpassword")?.value,username:e.tempUserData?.[0].username,code:"",showPassword:!1}:{email:e.forgotPasswordForm.get("auth_input")?.value,password:e.forgotPasswordForm.get("newpassword")?.value,username:e.forgotPasswordForm.get("auth_input")?.value,code:"",showPassword:!1},console.log("All the user details are here ",n),localStorage.setItem("userDetails",JSON.stringify(n)),n&&""!=n.email?e.authService.forgotCognitoPassword(n).then(l=>{console.log("Forgot password data is here ",l),e.router.navigate(["/auth/forgot-password"])}).catch(l=>{alert(l)}):P().fire({customClass:{container:"swal2-container"},position:"center",icon:"warning",title:"Username Should not be null",showCancelButton:!0,allowOutsideClick:!1})})()}checkName_asPassword(e){console.log("getPassword",e),this.errorForInvalidName="",!1===/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[A-Za-z0-9_]).{8,}$/.test(e.target.value)&&(this.errorForInvalidName="Field must contains at least 1 numeric character,at least 1 lowercase letter,at least 1 uppercase letter,at least 1 special character,minimum 8 of length")}}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)(t.Y36(a.QS),t.Y36(Z.e),t.Y36(g.F0),t.Y36(y.t),t.Y36(C.ux),t.Y36(I.Dx))}),(0,s.Z)(i,"\u0275cmp",t.Xpm({type:r,selectors:[["app-forgot-pass-interface"]],decls:36,vars:5,consts:[[3,"formGroup"],[1,"card-body"],[1,"fs-2hx","fw-bold","text-gray-800","text-center","mb-5",2,"display","flex","align-items","center"],[1,"me-2","fs-1",2,"color","var(--bs-primary)"],[1,"text-gray-500","mt-1","fw-semibold","fs-7",2,"color","#373A40"],[1,"column"],[1,"col-md-12",2,"display","none"],[1,"col-lg-12","col-form-label","fw-bold","fs-6","required"],["type","text","placeholder","Enter your company name","name","client","formControlName","client","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["class","fv-plugins-message-container invalid-feedback",4,"ngIf"],[1,"col-md-12"],["type","text","placeholder","Enter Username/Email","name","auth_input","formControlName","auth_input","required","",1,"form-control","form-control-lg","form-control-solid","mb-3","mb-lg-0"],["placeholder","Enter New Password","name","newPassword","autocomplete","off","formControlName","newpassword","required","",1,"form-control","form-control-lg","form-control-solid",3,"keyup"],[2,"color","#fc1900"],[1,"d-flex","flex-wrap","justify-content-center","pb-lg-0"],["type","submit",1,"btn","btn-lg","btn-success","fw-bolder","me-4",3,"click"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],["routerLink","/auth/login",1,"btn","btn-lg","btn-danger","fw-bolder"],[1,"fv-plugins-message-container","invalid-feedback"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._uU(4,"Forgot Password?"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Enter your email or username to recieve the confirmation code to reset your password"),t.qZA()(),t.TgZ(7,"div",5)(8,"div",6)(9,"label",7),t._uU(10,"Username/Email"),t.qZA(),t._UZ(11,"input",8),t.YNc(12,ft,2,0,"div",9),t.qZA(),t.TgZ(13,"div",10)(14,"label",7),t._uU(15,"Username/Email"),t.qZA(),t._UZ(16,"input",11),t.YNc(17,ht,2,0,"div",9),t.qZA(),t.TgZ(18,"div",6)(19,"label",7),t._uU(20," New password"),t.qZA(),t.TgZ(21,"input",12),t.NdJ("keyup",function(l){return o.checkName_asPassword(l)}),t.qZA(),t.TgZ(22,"span",13),t._uU(23),t.qZA(),t.YNc(24,vt,2,0,"div",9),t.qZA(),t._UZ(25,"br"),t.TgZ(26,"div",14)(27,"button",15),t.NdJ("click",function(){return o.forgotPasswordClicked()}),t.TgZ(28,"span",16),t._uU(29,"Next"),t.qZA(),t.ynx(30),t.TgZ(31,"span",17),t._uU(32," Please wait... "),t._UZ(33,"span",18),t.qZA(),t.BQk(),t.qZA(),t.TgZ(34,"a",19),t._uU(35," Cancel "),t.qZA()()()()()),2&e){let n,l,u;t.Q6J("formGroup",o.forgotPasswordForm),t.xp6(12),t.Q6J("ngIf",(null==(n=o.forgotPasswordForm.get("code"))?null:n.hasError("required"))&&(null==(n=o.forgotPasswordForm.get("code"))?null:n.touched)),t.xp6(5),t.Q6J("ngIf",(null==(l=o.forgotPasswordForm.get("auth_input"))?null:l.hasError("required"))&&(null==(l=o.forgotPasswordForm.get("auth_input"))?null:l.touched)),t.xp6(6),t.Oqu(o.errorForInvalidName),t.xp6(1),t.Q6J("ngIf",(null==(u=o.forgotPasswordForm.get("newpassword"))?null:u.hasError("required"))&&(null==(u=o.forgotPasswordForm.get("newpassword"))?null:u.touched))}},dependencies:[f.O5,g.rH,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u],styles:[".btn-success[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);transition:.5s}"]})),i})()},{path:"logout",component:pt},{path:"",redirectTo:"login",pathMatch:"full"},{path:"**",redirectTo:"login",pathMatch:"full"}]}];let bt=(()=>{var r;class i{}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)}),(0,s.Z)(i,"\u0275mod",t.oAB({type:r})),(0,s.Z)(i,"\u0275inj",t.cJS({imports:[g.Bz.forChild(Zt),g.Bz]})),i})();var _t=m(63660);let yt=(()=>{var r;class i{}return r=i,(0,s.Z)(i,"\u0275fac",function(e){return new(e||r)}),(0,s.Z)(i,"\u0275mod",t.oAB({type:r})),(0,s.Z)(i,"\u0275inj",t.cJS({imports:[f.ez,_t.q,bt,a.u5,a.UX,k.JF,C.ZX,x.ef]})),i})()}}]);